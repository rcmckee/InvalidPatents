<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US7519990 - Managing network traffic flow - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_8a2b04e7bf975d5171d8e4c0b6365c7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_8a2b04e7bf975d5171d8e4c0b6365c7a__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Managing network traffic flow"><meta name="DC.contributor" content="Michael Xie" scheme="inventor"><meta name="DC.contributor" content="Fortinet, Inc." scheme="assignee"><meta name="DC.date" content="2003-7-21" scheme="dateSubmitted"><meta name="DC.description" content="A method for managing network traffic flow is provided. The method includes receiving network traffic content, storing at least a portion of the network traffic content to a memory, sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected. Another method for managing network traffic flow includes receiving network traffic content, flagging the network traffic content, sending the flagged network traffic content to a module, which is configured to pass unflagged data to a user and prevent flagged data from being sent to the user, and sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected."><meta name="DC.date" content="2009-4-14" scheme="issued"><meta name="DC.relation" content="US:20010042214:A1" scheme="references"><meta name="DC.relation" content="US:20020094090:A1" scheme="references"><meta name="DC.relation" content="US:20020188839:A1" scheme="references"><meta name="DC.relation" content="US:20030004689:A1" scheme="references"><meta name="DC.relation" content="US:20030014662:A1" scheme="references"><meta name="DC.relation" content="US:20030061496:A1" scheme="references"><meta name="DC.relation" content="US:20030145228:A1" scheme="references"><meta name="DC.relation" content="US:20050021613:A1" scheme="references"><meta name="DC.relation" content="US:20050251570:A1" scheme="references"><meta name="DC.relation" content="US:5539659" scheme="references"><meta name="DC.relation" content="US:5557742" scheme="references"><meta name="DC.relation" content="US:5790799" scheme="references"><meta name="DC.relation" content="US:5892348" scheme="references"><meta name="DC.relation" content="US:5946487" scheme="references"><meta name="DC.relation" content="US:5991881" scheme="references"><meta name="DC.relation" content="US:6009467" scheme="references"><meta name="DC.relation" content="US:6067575" scheme="references"><meta name="DC.relation" content="US:6119175" scheme="references"><meta name="DC.relation" content="US:6279113" scheme="references"><meta name="DC.relation" content="US:6338141" scheme="references"><meta name="DC.relation" content="US:6453345" scheme="references"><meta name="DC.relation" content="US:6513122" scheme="references"><meta name="DC.relation" content="US:6519703" scheme="references"><meta name="DC.relation" content="US:6637026" scheme="references"><meta name="DC.relation" content="US:6654882" scheme="references"><meta name="DC.relation" content="US:6826697" scheme="references"><meta name="DC.relation" content="US:7181765" scheme="references"><meta name="DC.relation" content="US:7181769" scheme="references"><meta name="DC.relation" content="US:7185368" scheme="references"><meta name="citation_reference" content="&quot;U.S. Appl. No. 10/624,452, Final Office Action Mailed Oct. 17, 2008&quot;, FOAR, 2pgs."><meta name="citation_reference" content="&quot;U.S. Appl. No. 10/624,452, Response filed Jul. 30, 2008 to Non-Final Office Action mailed Apr. 30, 2008&quot;, 10 pgs."><meta name="citation_reference" content="U.S. Appl. No. 10/624,914 Final Office Action mailed Jul. 10, 2008, FOAR, 17 PgS."><meta name="citation_patent_number" content="US:7519990"><meta name="citation_patent_application_number" content="US:10/624,941"><link rel="canonical" href="http://www.google.com/patents/US7519990"/><meta property="og:url" content="http://www.google.com/patents/US7519990"/><meta name="title" content="Patent US7519990 - Managing network traffic flow"/><meta name="description" content="A method for managing network traffic flow is provided. The method includes receiving network traffic content, storing at least a portion of the network traffic content to a memory, sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected. Another method for managing network traffic flow includes receiving network traffic content, flagging the network traffic content, sending the flagged network traffic content to a module, which is configured to pass unflagged data to a user and prevent flagged data from being sent to the user, and sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected."/><meta property="og:title" content="Patent US7519990 - Managing network traffic flow"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("KIztU5OBLtirggTCroGAAw"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407723702.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("GRC"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("KIztU5OBLtirggTCroGAAw"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407723702.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("GRC"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us7519990?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US7519990"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=Utm0BQABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS7519990&amp;usg=AFQjCNFRz37tf1Ip-uruH9OOpxLCH-XsDA" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US7519990.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US7519990.pdf"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US7519990" style="display:none"><span itemprop="description">A method for managing network traffic flow is provided. The method includes receiving network traffic content, storing at least a portion of the network traffic content to a memory, sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains...</span><span itemprop="url">http://www.google.com/patents/US7519990?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US7519990 - Managing network traffic flow</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US7519990 - Managing network traffic flow" title="Patent US7519990 - Managing network traffic flow"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US7519990 B1</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 10/624,941</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Apr 14, 2009</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">Jul 21, 2003</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">Jul 19, 2002</td></tr><tr><td class="patent-bibdata-heading">Fee status<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The fee status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status or dates listed."></span></td><td class="single-patent-bibdata">Paid</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Also published as</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US8140660">US8140660</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8239949">US8239949</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8244863">US8244863</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8788650">US8788650</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8789183">US8789183</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20090168651">US20090168651</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20120102196">US20120102196</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20130254382">US20130254382</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20130263271">US20130263271</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">10624941, </span><span class="patent-bibdata-value">624941, </span><span class="patent-bibdata-value">US 7519990 B1, </span><span class="patent-bibdata-value">US 7519990B1, </span><span class="patent-bibdata-value">US-B1-7519990, </span><span class="patent-bibdata-value">US7519990 B1, </span><span class="patent-bibdata-value">US7519990B1</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Michael+Xie%22">Michael Xie</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Fortinet,+Inc.%22">Fortinet, Inc.</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US7519990.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7519990.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7519990.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (29),</span> <span class="patent-bibdata-value"><a href="#npl-citations">Non-Patent Citations</a> (3),</span> <span class="patent-bibdata-value"><a href="#forward-citations">Referenced by</a> (20),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (9),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/7519990&usg=AFQjCNGbi2jb7U88wbcNnvxBA81u4MtPEA">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D7519990&usg=AFQjCNHOw1M1-oNGwt289IxXYd6ZSmsO1Q">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D7519990B1%26KC%3DB1%26FT%3DD&usg=AFQjCNEEs7RfpD7J6ADNpxwrR3N6KJQ_pw">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT71671099" lang="EN" load-source="patent-office">Managing network traffic flow</invention-title></span><br><span class="patent-number">US 7519990 B1</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA53225758" lang="EN" load-source="patent-office"> <div num="p-0001" class="abstract">A method for managing network traffic flow is provided. The method includes receiving network traffic content, storing at least a portion of the network traffic content to a memory, sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected. Another method for managing network traffic flow includes receiving network traffic content, flagging the network traffic content, sending the flagged network traffic content to a module, which is configured to pass unflagged data to a user and prevent flagged data from being sent to the user, and sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(9)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00000.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00000.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00001.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00001.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00002.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00002.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00003.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00003.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00004.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00004.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00005.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00005.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00006.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00006.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00007.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00007.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519990B1/US07519990-20090414-D00008.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519990B1/US07519990-20090414-D00008.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(47)</span></span></div><div class="patent-text"><div mxw-id="PCLM13126365" lang="EN" load-source="patent-office" class="claims">
  <div class="claim"> <div id="CLM-00001" num="00001" class="claim">
    <div class="claim-text">1. A device for managing network traffic flow, the device comprising:
<div class="claim-text">a first processor, the first processor configured to
<div class="claim-text">receive network traffic content,</div>
<div class="claim-text">determine whether a protocol of the network traffic content matches a prescribed protocol of network traffic content that could contain content desired to be detected by comparing a type of the network traffic content with a prescribed type,</div>
<div class="claim-text">store the network traffic content in a stack when the protocol of the network traffic content matches the prescribed protocol, and</div>
<div class="claim-text">perform filtering of the network traffic if the type of the network traffic content does not match the prescribed type; and</div>
</div>
<div class="claim-text">a second processor associated with the stack, wherein the second processor is configured to determine whether the network traffic content contains the content desired to be detected if the type of the network traffic content matches the prescribed type.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00002" num="00002" class="claim">
    <div class="claim-text">2. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first processor comprises a general purpose processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00003" num="00003" class="claim">
    <div class="claim-text">3. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first processor comprises an ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00004" num="00004" class="claim">
    <div class="claim-text">4. The device of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the ASIC processor is a semi-custom ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00005" num="00005" class="claim">
    <div class="claim-text">5. The device of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the ASIC processor is a programmable ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00006" num="00006" class="claim">
    <div class="claim-text">6. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first processor is further configured to send the network traffic content to a user when the protocol of the network traffic content does not match the prescribed protocol.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00007" num="00007" class="claim">
    <div class="claim-text">7. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the stack.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00008" num="00008" class="claim">
    <div class="claim-text">8. The device of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the stack is implemented in the first processor or in the second processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00009" num="00009" class="claim">
    <div class="claim-text">9. The device of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the stack is configured to store the network traffic content in accordance with the protocol of the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00010" num="00010" class="claim">
    <div class="claim-text">10. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first or the second processor is further configured to assemble the at least a portion of the network traffic content with the rest of the network traffic content, and transmit the network traffic content to a user when it is determined that the network traffic content does not contain the content desired to be detected.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00011" num="00011" class="claim">
    <div class="claim-text">11. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second processor comprises an ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00012" num="00012" class="claim">
    <div class="claim-text">12. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first or the second processor is further configured to flag the network traffic content when the protocol of the network traffic content matches the prescribed protocol, and send the flagged network traffic content to a memory.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00013" num="00013" class="claim">
    <div class="claim-text">13. The device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the second processor comprises an ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00014" num="00014" class="claim">
    <div class="claim-text">14. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the content desired to be detected is selected from the group consisting of a virus, a worm, a web content, a Trojan agent, an email spam, and a packet transmitted by a hacker.</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00015" num="00015" class="claim">
    <div class="claim-text">15. A method for managing network traffic flow, the method comprising:
<div class="claim-text">receiving network traffic content at a first processor;</div>
<div class="claim-text">determining whether a protocol of the network traffic content matches with a prescribed protocol of network traffic content that could contain content desired to be detected by comparing a type of the network traffic content with a prescribed type;</div>
<div class="claim-text">performing filtering of the network traffic by the first processor if the type of the network traffic content does not match the prescribed type;</div>
<div class="claim-text">storing the network traffic content in a stack when the protocol of the network traffic content matches the prescribed protocol, the stack associated with a module including a second processor that is configured to determine whether the network traffic content contain content desired to be detected if the type of the network traffic content matches the prescribed type; and</div>
<div class="claim-text">sending at least a portion of the network traffic content to a memory when the protocol of the network traffic content matches the prescribed protocol;</div>
<div class="claim-text">wherein the first and second processors are parts of a device.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00016" num="00016" class="claim">
    <div class="claim-text">16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the network traffic content is stored in the stack in accordance with the protocol of the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00017" num="00017" class="claim">
    <div class="claim-text">17. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">assembling the at least a portion of the network traffic content with the rest of the network traffic content, and sending the network traffic content to a user when it is determined that the network traffic content does not contain the content desired to be detected.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00018" num="00018" class="claim">
    <div class="claim-text">18. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">flagging the network traffic content when the protocol of the network traffic content matches the prescribed protocol; and</div>
<div class="claim-text">storing the flagged network traffic content in a memory.</div>
</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00019" num="00019" class="claim">
    <div class="claim-text">19. A device for managing network traffic flow, the device comprising:
<div class="claim-text">a first processor, the first processor configured to
<div class="claim-text">receive network traffic content,</div>
<div class="claim-text">flag the network traffic content by inserting data or modifying a portion of the network traffic content,</div>
<div class="claim-text">send the flagged network traffic content to a module, the module configured to pass unflagged data to a user and prevent flagged data from being sent to the user, and</div>
<div class="claim-text">send a copy of the network traffic content to a second processor, the second processor configured to determine whether the network traffic content contains content desired to be detected; and</div>
</div>
<div class="claim-text">the second processor.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00020" num="00020" class="claim">
    <div class="claim-text">20. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the first processor is further configured to transmit the network traffic content to a user when it is determined that the network traffic content does not contain the content desired to be detected.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00021" num="00021" class="claim">
    <div class="claim-text">21. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the module comprises a memory, a buffer, or at least a portion of a processor.</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00022" num="00022" class="claim">
    <div class="claim-text">22. A method for managing network traffic flow, the method comprising:
<div class="claim-text">receiving network traffic content at a first processor;</div>
<div class="claim-text">flagging the network traffic content by inserting data or modifying a portion of the network traffic content;</div>
<div class="claim-text">sending the flagged network traffic content to a module, the module configured to pass unflagged data to a user and prevent flagged data from being sent to the user; and</div>
<div class="claim-text">sending a copy of the network traffic content to a second processor, the second processor configured to determine whether the network traffic content contains content desired to be detected;</div>
<div class="claim-text">wherein the first and second processors are parts of a device.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00023" num="00023" class="claim">
    <div class="claim-text">23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising transmitting the network traffic content to a user when it is determined that the network traffic content does not contain the content desired to be detected.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00024" num="00024" class="claim">
    <div class="claim-text">24. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a memory coupled to the first processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00025" num="00025" class="claim">
    <div class="claim-text">25. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the first processor is configured to pass a portion of the network traffic content downstream before the second processor finishes processing the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00026" num="00026" class="claim">
    <div class="claim-text">26. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the first processor and the second processor are parts of a processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00027" num="00027" class="claim">
    <div class="claim-text">27. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the processor comprises an ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00028" num="00028" class="claim">
    <div class="claim-text">28. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the first processor is configured to flag the network traffic content by modifying data associated with the network traffic content or by inserting data to the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00029" num="00029" class="claim">
    <div class="claim-text">29. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein a portion of the network traffic content is passed downstream before the processor finishes processing the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00030" num="00030" class="claim">
    <div class="claim-text">30. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the second processor comprises an ASIC processor.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00031" num="00031" class="claim">
    <div class="claim-text">31. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the network traffic content is flagged by modifying data associated with the network traffic content or by inserting data to the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00032" num="00032" class="claim">
    <div class="claim-text">32. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the content desired to be detected is undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00033" num="00033" class="claim">
    <div class="claim-text">33. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the content desired to be detected is undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00034" num="00034" class="claim">
    <div class="claim-text">34. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the content desired to be detected is undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00035" num="00035" class="claim">
    <div class="claim-text">35. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the content desired to be detected is undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00036" num="00036" class="claim">
    <div class="claim-text">36. The device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein flagging the network traffic content indicates that the data may contain undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00037" num="00037" class="claim">
    <div class="claim-text">37. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein flagging the network traffic content indicates that the data may contain undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00038" num="00038" class="claim">
    <div class="claim-text">38. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein flagging the network traffic content indicates that the data may contain undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00039" num="00039" class="claim">
    <div class="claim-text">39. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein flagging the network traffic content indicates that the data may contain undesirable content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00040" num="00040" class="claim">
    <div class="claim-text">40. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining whether a protocol of the network traffic content matches a prescribed protocol of network traffic content that could contain content desired to be detected further includes:
<div class="claim-text">comparing a port over which the network traffic content was received with preassigned ports to determine the type of content being screened.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00041" num="00041" class="claim">
    <div class="claim-text">41. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein determining whether a protocol of the network traffic content matches with a prescribed protocol of network traffic content that could contain content desired to be detected further includes:
<div class="claim-text">comparing a port over which the network traffic content was received with preassigned ports to determine the type of content being screened.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00042" num="00042" class="claim">
    <div class="claim-text">42. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the second processor is configured to determine whether the network traffic content contains content desired to be detected by:
<div class="claim-text">comparing a port over which the network traffic content was received with preassigned ports to determine the type of content being screened.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00043" num="00043" class="claim">
    <div class="claim-text">43. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the determining whether the network traffic content contains content desired to be detected performed by the second processor includes:
<div class="claim-text">comparing a port over which the network traffic content was received with preassigned ports to determine the type of content being screened.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00044" num="00044" class="claim">
    <div class="claim-text">44. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at least one of the first processor and the second processor are configured to decrypt the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00045" num="00045" class="claim">
    <div class="claim-text">45. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">decrypting the network traffic content.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00046" num="00046" class="claim">
    <div class="claim-text">46. The device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein at least one of the first processor and the second processor are configured to decrypt the network traffic content.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00047" num="00047" class="claim">
    <div class="claim-text">47. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising:
<div class="claim-text">decrypting the network traffic content.</div>
</div>
  </div>
</div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES18513403" lang="EN" load-source="patent-office" class="description">
<heading>RELATED APPLICATION DATA</heading> <p num="p-0002">This application claims priority to U.S. Provisional Application Nos. 60/397,147, 60/397,304, 60/397,033, 60/397,302, 60/397,034, all filed Jul. 19, 2002, the disclosures of which are expressly incorporated by reference herein.</p>
<heading>BACKGROUND OF THE INVENTION</heading> <p num="p-0003">1. Field of the Invention</p>
  <p num="p-0004">The field of the invention relates to computer systems and computer networks, and more particularly, to systems and methods for detecting content of computer and network traffic.</p>
  <p num="p-0005">2. Background of the Invention</p>
  <p num="p-0006">The generation and spreading of computer viruses are major problems in computer systems and computer networks. A computer virus is a program that is capable of attaching to other programs or sets of computer instructions, replicating itself, and/or performing unsolicited or malicious actions on a computer system. Viruses may be embedded in email attachments, files downloaded from Internet, and macros in MS Office files. The damage that can be done by a computer virus may range from mild interference with a program, such as a display of unsolicited messages or graphics, to complete destruction of data on a user's hard drive or server.</p>
  <p num="p-0007">To provide protection from viruses, most organizations have installed virus scanning software on computers in their network. However, these organizations may still be vulnerable to a virus attack until every host in their network has received updated anti-virus software. With new attacks reported almost weekly, organizations are constantly exposed to virus attacks, and spend significant resources ensuring that all hosts are constantly updated with new anti-virus information. Furthermore, anti-virus programs that operate at the application-level require enormous computing resources, making such anti-virus programs expensive to deploy and manage.</p>
  <p num="p-0008">Besides virus attacks, many organizations also face the challenge of dealing with inappropriate content, such as email spam, misuse of networks in the form of browsing or downloading inappropriate content, and use of the network for non-productive tasks. Many organizations are struggling to control access to appropriate content without unduly restricting access to legitimate material and services. Currently, the most popular solution for blocking unwanted web activity is to block access to a list of banned or blacklisted web sites and pages based on their URLs. However, such approach may be unnecessarily restrictive, preventing access to valid content in web sites that may contain only a limited amount of undesirable material. As with virus scanning, the list of blocked URLs requires constant updating.</p>
  <p num="p-0009">Many email spam elimination systems also use blacklists to eliminate unwanted email messages. These systems match incoming email messages against a list of mail servers that have been pre-identified to be spam hosts, and prevent user access of messages from these servers. However, spammers often launch email spam from different hosts every time, making it difficult to maintain a list of spam servers.</p>
  <p num="p-0010">Accordingly, improved systems and methods for detecting content of computer and network traffic would be useful.</p>
  <heading>SUMMARY OF THE INVENTION</heading> <p num="p-0011">In some embodiments of the invention, a method for managing network traffic flow includes receiving network traffic content, determining whether a protocol of the network traffic content matches with a prescribed protocol of network traffic content that could contain content desired to be detected, and storing the network traffic content in a stack when the protocol of the network traffic content matches the prescribed protocol.</p>
  <p num="p-0012">In other embodiments of the invention, a method for managing network traffic flow includes receiving network traffic content, storing at least a portion of the network traffic content to a memory, and sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected.</p>
  <p num="p-0013">In other embodiments of the invention, a method for managing network traffic flow includes receiving network traffic content, flagging the network traffic content, sending the flagged network traffic content to a module, which is configured to pass unflagged data to a user and prevent flagged data from being sent to the user, and sending a copy of the network traffic content to a processor, which determines whether the network traffic content contains content desired to be detected.</p>
  <p num="p-0014">Other aspects and features of the invention will be evident from reading the following detailed description of the preferred embodiments, which are intended to illustrate, not limit, the invention.</p>
<description-of-drawings> <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading> <p num="p-0015">The drawings illustrate the design and utility of preferred embodiments of the present invention, in which similar elements are referred to by common reference numerals. In order to better appreciate how advantages and objects of the present inventions are obtained, a more particular description of the present inventions briefly described above will be rendered by reference to specific embodiments thereof, which are illustrated in the accompanying drawings. Understanding that these drawings depict only typical embodiments of the invention and are not therefore to be considered limiting its scope, the invention will be described and explained with additional specificity and detail through the use of the accompanying drawings.</p>
    <p num="p-0016"> <figref idrefs="DRAWINGS">FIG. 1</figref> illustrates a detection device in accordance with some embodiments of the invention, and an example of a network environment in which detection device can be operated;</p>
    <p num="p-0017"> <figref idrefs="DRAWINGS">FIG. 2</figref> illustrates a block diagram of detection device of <figref idrefs="DRAWINGS">FIG. 1</figref>;</p>
    <p num="p-0018"> <figref idrefs="DRAWINGS">FIG. 3</figref> illustrates an architecture of the processor of detection device of <figref idrefs="DRAWINGS">FIG. 2</figref>;</p>
    <p num="p-0019"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a flow chart showing a process for detecting content of network traffic;</p>
    <p num="p-0020"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a table listing examples of predicate that may be used to control a logic of processor of <figref idrefs="DRAWINGS">FIG. 2</figref>;</p>
    <p num="p-0021"> <figref idrefs="DRAWINGS">FIG. 6</figref> illustrates a block diagram of a detection device in accordance with alternative embodiments of the invention, particularly showing detection device including a compiler;</p>
    <p num="p-0022"> <figref idrefs="DRAWINGS">FIG. 7</figref> illustrates a block diagram of another detection device in accordance with alternative embodiments of the invention, particularly showing the detection device including a processor configured for managing network traffic flow;</p>
    <p num="p-0023"> <figref idrefs="DRAWINGS">FIG. 8</figref> shows examples of operation that may be performed by components of detection device of <figref idrefs="DRAWINGS">FIG. 7</figref>; and</p>
    <p num="p-0024"> <figref idrefs="DRAWINGS">FIG. 9</figref> is a diagram of a computer hardware system with which embodiments of the present invention can be implemented.</p>
  </description-of-drawings> <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading> <p num="p-0025">Various embodiments of the present invention are described hereinafter with reference to the figures. It should be noted that the figures are not drawn to scale and that elements of similar structures or functions are represented by like reference numerals throughout the figures. It should also be noted that the figures are only intended to facilitate the description of specific embodiments of the invention. They are not intended as an exhaustive description of the invention or as a limitation on the scope of the invention. In addition, an illustrated embodiment needs not have all the aspects or advantages of the invention shown. An aspect or an advantage described in conjunction with a particular embodiment of the present invention is not necessarily limited to that embodiment and can be practiced in any other embodiments of the present invention even if not so illustrated.</p>
  <p num="p-0026"> <figref idrefs="DRAWINGS">FIG. 1</figref> illustrates a detection device <b>10</b> in accordance with embodiments of the present invention, and an example of a network environment in which detection device <b>10</b> can be operated. Detection device <b>10</b> is configured to detect a program content, such as a virus, and/or a non-program content, such as a web content, being transmitted from Internet <b>12</b> to users <b>14</b> <i>a</i>-<i>e</i>. For example, a sender <b>18</b> connected to Internet <b>12</b> may send files containing viruses, worms, or other malicious programs, to one or more of the users <b>14</b> <i>a</i>-<i>c </i>and server <b>16</b> via Internet <b>12</b>. Viruses may also be copied from a server <b>20</b> and transmitted to users <b>14</b> <i>a</i>-<i>c </i>and network server <b>16</b> through Internet <b>12</b>. Viruses transmitted to network server <b>16</b> may also infect users <b>14</b> <i>d </i>and <b>14</b> <i>e </i>connected to network server <b>16</b>. Detection device <b>10</b> scans network traffic content transmitted from Internet <b>12</b> and prevents undesirable content, such as a virus, a worm, an email spam, and a web page containing undesirable content, from being transmitted to users <b>14</b> <i>a</i>-<i>e</i>. Besides detecting content, detection device <b>10</b> may also modify or re-direct network traffic content such that, for examples, a virus may be removed from a network stream, or a HTTP request may be blocked. In some embodiments, detection device <b>10</b> may be implemented as a firewall, a component of a firewall, or a component that is configured to be coupled to a firewall.</p>
  <p num="p-0027"> <figref idrefs="DRAWINGS">FIG. 2</figref> shows content detection device <b>10</b> of <figref idrefs="DRAWINGS">FIG. 1</figref> in further detail. As shown in <figref idrefs="DRAWINGS">FIG. 2</figref>, detection device <b>10</b> includes a memory <b>22</b> and a processor <b>24</b> coupled to memory <b>22</b>. Detection device <b>10</b> also includes a first input port <b>202</b> for inputting data to memory <b>22</b>, a second input port <b>204</b> for receiving network traffic packets from Internet <b>12</b> or a network, and an output port <b>206</b> coupled to processor <b>24</b>. Output port <b>206</b> is configured for transmitting filtered network traffic packets to user <b>14</b>. In alternative embodiments, memory <b>22</b> can be implemented as a part of processor <b>24</b>.</p>
  <p num="p-0028">Memory <b>22</b> is adapted for storing data to be processed by processor <b>24</b>. Data may be transmitted to memory <b>22</b> via input port <b>202</b> from a user or an administrator. For example, a user or an administrator can transmit data to memory <b>22</b> via a wire, a telephone line, a T1-line, a cable of a cable modem, or other types of transmitter connected to port <b>202</b>. Data may also be transmitted to memory <b>22</b> via an infrared transmitter, in which case, port <b>202</b> would include an infrared receiver. In the illustrated embodiments, memory <b>22</b> is adapted for storing one or more signatures, each of which associated with content desired to be detected by detection device <b>10</b>. The signatures will be described in detail below.</p>
  <p num="p-0029">In the illustrated embodiments, the processor <b>24</b> includes an application-specific integrated circuit (ASIC), such as a semi-custom ASIC processor or a programmable ASIC processor. ASICs, such as those described in Application-Specific Integrated Circuits by Michael J. S. Smith, Addison-Wesley Pub Co. (1st Edition, June 1997), are well known in the art of circuit design, and therefore will not be described in further detail herein. Processor <b>24</b> is configured to receive packets from Internet <b>12</b>, process packets based on data stored in memory <b>22</b>, and generate a result based on the processing of the packets. It should be noted that processor <b>24</b> is not limited to those described previously, and that processor <b>24</b> can also be any of a variety of circuits or devices that are capable of performing the functions described herein. For example, in alternative embodiments, processor <b>24</b> can include a general purpose processor, such as a Pentium processor.</p>
  <p num="p-0030"> <figref idrefs="DRAWINGS">FIG. 3</figref> shows an architecture of processor <b>24</b> in accordance with some embodiments of the present invention. Processor <b>24</b> includes a first I/O buffer and logic <b>302</b>, an internal storage <b>306</b>, a second I/O buffer and logic <b>308</b>, a register <b>312</b>, and a scanning logic <b>314</b>. I/O buffer and logic <b>302</b> is configured for processing data (e.g., information associated with content desired to be detected) received from an external memory <b>304</b> such that data of desirable format can be stored in internal storage <b>306</b>. I/O buffer and logic <b>308</b> is configured for processing decrypted network traffic content received from an external memory <b>310</b> (such as a RAM) such that data of desirable format can be stored in register <b>312</b>. In some embodiments of the invention, one or both of I/O buffer and logics <b>302</b> and <b>308</b> can also process data generated by scanning logic <b>314</b> such that data of desirable format can be transmitted to external storages <b>304</b> and <b>310</b>, respectively. Scanning logic <b>314</b> processes network traffic content stored in register <b>312</b> base on data stored in internal memory <b>306</b>, and determines whether network traffic content contains content desired to be detected. In the illustrated embodiments of the invention, I/O buffer and logics <b>302</b>, <b>308</b>, and scanning logic <b>314</b> are implemented in processor <b>24</b>. In alternative embodiments, separate processors or components may be used to implement buffer and logics <b>302</b> and <b>308</b> and scanning logic <b>314</b>. In addition, internal storage <b>306</b> and register <b>312</b> can both be implemented using a single memory, such as memory <b>22</b>. In alternative embodiments, internal storage <b>306</b> and register <b>312</b> can each be implemented using a separate memory.</p>
  <p num="p-0031">A method <b>400</b> for detecting network traffic content using detection device <b>10</b> will now be described with reference to <figref idrefs="DRAWINGS">FIG. 4</figref>. Initially, content pattern recognition language (CPRL) is used to create a signature, which represents a symbolic detection model for certain prescribed content, such as a virus, a worm, a web content, a Trogent agent, an email spam, a packet transmitted by a hacker, etc., desired to be detected (Step <b>402</b>). Depending on an implementation of the CPRL, in some embodiments of the invention, the signature may be expressed in a form similar to a set of sentences or phrases in predicate logic. The pattern recognition signature created for a given content desired to be detected is tested for validity, compiled, and interpreted by a set of functions implemented using processor <b>24</b>. In some embodiments of the invention, the CPRL used is a programming language that supports testing, branching, looping, and/or recursion.</p>
  <p num="p-0032"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a table showing examples of predicates that can be used to create a signature of content desired to be detected. Column <b>502</b> shows identifications of predicates that are the basic roots or components of a CPRL. Although only identifications “A” through “X” are shown, in alternative embodiments, a predicate identification can also includes other letters, a number, a combination of letters, mathematical operator, logical operator, punctuations, and/or combination thereof. Column <b>506</b> shows mnemonics represented by respective predicates.</p>
  <p num="p-0033">Column <b>504</b> shows formats in which predicates A-Z are used. For examples, predicate “D” has “label” as its argument, and predicate “M” has “name” as its argument. In some embodiments, the argument of a predicate may include one or a combination of bytes, with each of the bytes having two characters. In alternative embodiments, the argument can also include a number, a letter, a combination of letters, a sentence, a mathematical operator, a logical operator, a punctuation, and/or combination thereof. In other embodiments, a predicate may not require an argument.</p>
  <p num="p-0034">In the illustrated embodiments, each predicate of a signature is compiled into a byte stream that controls a logic of processor <b>24</b>. Column <b>510</b> describes functions that are performed by processor <b>24</b> based on respective predicates. Appendix A provides exemplary specifications for the predicates illustrated in <figref idrefs="DRAWINGS">FIG. 5</figref>. It should be understood by those skilled in the art that the functions prescribed by the predicates should not be limited to the examples shown in <figref idrefs="DRAWINGS">FIG. 5</figref>, and that other functions may also be prescribed to be performed by processor <b>24</b> based on other predicates. Each function prescribed by the respective predicate may return a variable, such as a Boolean value, a number, a pointer, a “void”, or other types of return value (Column <b>512</b>).</p>
  <p num="p-0035">The predicates may be categorized by the types of function they perform (Column <b>508</b>). In the illustrated embodiments, CPRL includes five families of predicates, namely, “Test”, “Decision”, “Iteration”, “Function”, and “Pointer”. A “test” type predicate provides instruction that causes processor <b>24</b> to test one or more variables using a prescribed operation. A “decision” type predicate provides instruction that causes processor <b>24</b> to decide which operation to perform based on a prescribed condition. An “iteration” type predicate provides instruction that causes processor <b>24</b> to repeat a prescribed function. A “function” type predicate provides instruction that causes the processor <b>24</b> to execute a prescribed function. A “pointer” type predicate provides instruction that causes processor <b>24</b> to position or reset a buffer stream pointer. Although five types of predicates are shown, in alternative embodiments, CPRL may have other different types of predicates.</p>
  <p num="p-0036">Like predicate logic, the signature codified using CPRL is treated as a formula made up of logical elements and is rule-based. Accordingly, each signature must meet these rules in order to form a well-formed formula (wff). Codifying signature using a predicate-based system is advantageous in that the codified signature is much more readable and intuitive than memorizing and using an extensive collection of pattern recognition directives in a form of hexadecimal code instructions embedded in a signature stream. In some embodiments, the predicates can be formalized such that they are similar to inline macros, thereby allowing a user to easily create signatures without having to learn a completely new set of programming language.</p>
  <p num="p-0037">Unlike traditional virus signatures, which are used to detect virus using byte-by-byte comparison, a signature created using CPRL represent one or more instructions that control an operation of a processor being used to detect content. For examples, a signature created using CPRL may provide instructions for calling functions, pointing to a different signature, calling an interpreter of the signature recursively, responding to a returned information, and/or performing other functions. As such, CPRL is a true pattern recognition language, and is far more powerful then traditional antivirus signatures. It should be understood by those skilled in the art that the scope of the invention is not limited to the examples of CPRL described previously, and that other languages or symbolic models may also be used to codify signatures.</p>
  <p num="p-0038">The signature(s) may be codified by one or more service providers. For example, when a new virus is discovered, a service provider may codify the corresponding signature and send the signature to the detection device <b>10</b> as an update. Alternatively, or additionally, one or more users may also codify the signature if a new virus is discovered. The codifying of the signature(s) may be performed on a computer platform. For example, a suitable editor may be used for writing and/or editing the signature(s). In some embodiments, an integrated development environment (IDE) may be employed for writing and/or editing the signature(s). A graphical interface may also be used to assist writing and/or editing the signature(s). The signature, (i.e., resulting code) may be stored in a computer readable medium for future processing.</p>
  <p num="p-0039">Returning to <figref idrefs="DRAWINGS">FIG. 4</figref>, the signature is next compiled into a byte stream or machine language such that the signature can be processed by processor <b>24</b>, and the compiled data is stored within a memory of detection device <b>10</b> (Step <b>404</b>). The compiling of the signature may be performed by a suitable compiler. In some embodiments, after the signature is compiled, the compiled code (e.g., in a form of byte streams) is transmitted to memory <b>22</b> of detection device <b>10</b> via a telephone line, a T1-line, a wireless transmitter, etc. In such case, internal storage <b>306</b> may be used to store signatures that are processed the most frequent. In other embodiments, instead of storing the compiled code in memory <b>22</b>, the compiled code is stored in a separate memory. In such case, memory <b>22</b> may be used to store signatures that are processed the most frequent.</p>
  <p num="p-0040">In the illustrated embodiments, the compiling is performed by a compiler that is not a part of detection device <b>10</b>. In alternative embodiments, the detection device <b>10</b> may include a compiler <b>602</b> for compiling the signature (<figref idrefs="DRAWINGS">FIG. 6</figref>). In such case, the signature, in its un-compiled form, may be stored within memory <b>22</b> of the detection device <b>10</b>, and the compiled signature may be stored in internal storage <b>306</b>, in memory <b>22</b>, or another separate memory of detection device <b>10</b>.</p>
  <p num="p-0041">Next, detection device <b>10</b> receives network traffic packets to be screened (Step <b>406</b>). For examples, web content, emails, and other data transmitted through a network may be decrypted and converted into packets, which are then sent to processor <b>24</b> of detection device <b>10</b> via input port <b>204</b> for processing. I/O buffer and logic <b>308</b> may be used to translate decrypted network traffic content into a format such that the decrypted network traffic content can be processed by processor <b>24</b>. In some embodiments, processor <b>24</b> may receive a plurality of sessions (of network traffic) concurrently. In such case, processor <b>24</b> may execute one or more instruction on a first session, execute one or more instruction on a second session, and then switch back and execute additional instruction on the first session.</p>
  <p num="p-0042">Based on the compiled signatures, processor <b>24</b> executes one or more functions to determine whether the network traffic content matches the content desired to be detected (Step <b>408</b>). For example, processor <b>24</b> may execute scanning logic <b>314</b> based on one or more instructions prescribed by a CPRL signature, and determine whether the network traffic content matches or is associated with the content desired to be detected.</p>
  <p num="p-0043">Processor <b>24</b> may detect a variety of contents based on instructions prescribed by CPRL signatures. For example, a signature may provide instruction that causes processor <b>24</b> to perform worm scanning. When configured to perform worm scanning, processor <b>24</b> may scan HTTP requests by scanning their originating web page for known viral patterns such as Code Red, which is programmed to gain entry to a server. To scan email attachments for worms, processor <b>24</b> may look for filenames, such as readme.exe and sample.exe, known to be used by worms.</p>
  <p num="p-0044">In other embodiments, based on instructions prescribed by CPRL signatures, processor <b>24</b> may also detect virus by performing signature scanning, macro scanning, and heuristic scanning (e.g., static heuristic scanning or dynamic heuristic scanning). To perform signature scanning, processor <b>24</b> may scan target file for byte-strings that are known to identify viruses. If all of the byte strings for a particular virus are matched, the virus is considered present in the file. To perform macro scanning, processor <b>24</b> may extract one or more macros from MS Office file and scan them for known macro virus strings. Processor <b>24</b> may also analyze macros for peculiar behavior such as importing code, exporting code, writing to a registry, and/or attempting to disable a security feature. If any of the macro tests produces a positive result, a macro virus is deemed present in the MS Office file. To perform heuristic scanning, processor <b>24</b> may scan files for known byte strings that indicate a presence of a virus. For example, in the program byte, “B4 09 BA 20 01 CD 21 B8 02 3D BA 12 34 CD 21 CC B8 FF 4C CD 21”, processor <b>24</b> can match the signature, “B8 02 3D BA ?? ?? CD 21” (representing a program that opens a file), and the signature, “B8 ?? 4C CD 21” (representing a program that terminates itself).</p>
  <p num="p-0045">In other embodiments, based on instructions prescribed by CPRL signatures, processor <b>24</b> may also detect a hacking of a computer system. For example, a CPRL signature may provide one or more instructions to processor <b>24</b> that causes processor to detect a SYN packet, which may be sent by a hacker to determine which ports of a gateway are opened. It should be understood by those skilled in the art that the types of content that can be detected by processor <b>24</b> are not limited to those discussed previously, and that other types of content, such as a web content, an email spam, a Trogent agent, or other undesirable content may also be detected by controlling the logic of processor <b>24</b> using a CPRL signature.</p>
  <p num="p-0046">In further embodiments of the invention, processor <b>24</b> may also search for a variety of target files, such as files that may be executable (e.g., .exe, .bat, and .com), visual basic files (.vbs), compressed files (.zip, .gzip, .tar, .hta, and .rar), screen saver files (.scr), dynamic link libraries (.dll), MS Office files, or other types of files. Processor <b>24</b> may also be configured such that it is capable to parse Multipurpose Internet Mail Extensions (MIME) files to find target file(s). In alternative embodiments, a separate processor, such as a general purpose processor may be used to search for target files that may contain content desired to be detected. The target files are then transmitted to processor <b>24</b>, which determines whether the target files contain content desired to be detected.</p>
  <p num="p-0047">If it is determined that network traffic content matches with content desired to be detected, processor <b>24</b> then prevents such network traffic content from being transmitted to users (Step <b>412</b>). In some embodiments of the invention, processor <b>24</b> may cause a message to be sent to a user, notifying the user that a prescribed content has been detected. In other embodiments of the invention, processor <b>24</b> may cause a detected content to be erased, or remove undesirable portion(s) of the network traffic content before transmitting it to a user.</p>
  <p num="p-0048">If it is determined network traffic content does not match with content desired to be detected, processor <b>24</b> then passes such content to a user (Step <b>414</b>).</p>
  <p num="p-0049"> <figref idrefs="DRAWINGS">FIG. 7</figref> shows detection device <b>700</b> in accordance with alternative embodiments of the invention. As shown in <figref idrefs="DRAWINGS">FIG. 7</figref>, in addition to memory <b>22</b> and processor <b>24</b>, detection device <b>700</b> also includes a second processor <b>702</b> (network traffic management module) configured for managing network traffic flow. Processor <b>702</b> includes a protocol differentiator <b>704</b> for determining the types of content being screened, a packet processing module <b>706</b> that performs basic functions of a network gateway, and a stack <b>708</b> for receiving data to be processed by processor <b>24</b>. In some embodiments, stack <b>708</b> may convert network traffic content into content stream that can be processed by processor <b>24</b>. Processor <b>702</b> can be a Pentium processor, a Motorola processor, or other processor capable of performing the functions described herein. In the illustrated embodiments, stack <b>708</b> is a program that is implemented in processor <b>702</b>. In alternative embodiments, stack <b>708</b> is a program that is implemented in processor <b>24</b>, or in both processors <b>24</b> and <b>702</b>. In other embodiments of the invention, stack <b>708</b> can be a device, such as a memory device, that is a part of processor <b>24</b> or <b>702</b>. In alternative embodiments, stack <b>708</b> can also be a separate device coupled to processor <b>702</b> or to processor <b>24</b>. In such case, processor <b>702</b> or processor <b>24</b> does not include stack <b>708</b>. In further embodiments of the invention, processor <b>24</b> and processor <b>702</b> may be implemented using a single processor.</p>
  <p num="p-0050">During use, network traffic is sent to processor <b>702</b> via port <b>204</b>. Protocol differentiator <b>704</b> examines headers of the network traffic and determines the types of content being screened. In some embodiments of the invention, each type of network traffic content is pre-assigned to a port of a network gateway by a default configuration. For example, HTTP, SMTP, POP, IMAP, and FTP data may each be pre-assigned to be transmitted through a designated port. In such case, protocol differentiator <b>704</b> can determine a type of content based on an identification of a port transmitting the network content. In other embodiments of the invention, protocol differentiator <b>704</b> can be configured to scan all available ports in order to determine a type of the network traffic content being screened.</p>
  <p num="p-0051">Next, depending on the type of content received or the content protocol, protocol differentiator <b>704</b> passes network traffic data to either packet processing module <b>706</b> or stack <b>708</b>. For example, certain types of network traffic content, such as DNS data or telnet data, may be considered as “safe” traffic content, while other types of network traffic content, such as HTTP content or emails, may be considered as “unsafe” traffic content (i.e., content that may contain virus, worms, or undesirable material). In the illustrated embodiments, protocol differentiator <b>704</b> is configured to pass safe traffic content to packet processing module <b>706</b>, and unsafe traffic content to stack <b>708</b>. In alternative embodiments, protocol differentiator <b>704</b> is configured to pass potentially undesirable network traffic content to both packet processing module <b>706</b> and stack <b>708</b>. In such case, network traffic content that can be screened by conventional content filtering techniques may be passed to packet processing module <b>706</b>, while other network traffic content, such as those that may contain virus or worms, may be passed to stack <b>708</b>. In some embodiments of the invention, processor <b>702</b> may be programmable or configurable such that a user can prescribe certain types of network traffic content to be passed to packet processing module <b>706</b> or to stack <b>708</b>.</p>
  <p num="p-0052">After network traffic content is transmitted to packet processing module <b>706</b>, packet processing module <b>706</b> processes the network traffic content to determine whether to pass the network traffic content to a user. In the illustrated embodiments, packet processing module <b>706</b> is configurable to have different content filtering settings. In such case, packet processing module <b>706</b> either blocks or allows content stream to be passed to a user, depending on the content filtering settings of packet processing module <b>706</b>. For example, packet processing module <b>706</b> can scan web and email traffic for undesirable non-program content, such as a key word or a phrase, and blocks the entire message or the particular page that contains the undesirable content when a match is found. Alternatively, or additionally, packet processing module <b>706</b> can also send a message notifying a user. In some embodiments, packet processing module <b>706</b> may also perform one or more basic functions of a network gateway. For example, packet processing module <b>706</b> may include a firewall module that performs stateful inspection. Alternatively, or additionally, packet processing module <b>706</b> may also include a decryption module for decrypting incoming network content before transmitting the content to a user. Packet processing module <b>706</b> may also be configured to perform other basic or known functions of a network gateway. In alternative embodiments, firewall module and/or decryption module may be implemented as part(s) of processor <b>24</b>. Those skilled in the art understands that protocol differentiator <b>704</b>, packet processing module <b>706</b>, stack <b>708</b>, fire module, and decryption module may be implemented using hardware, software, or any combination thereof.</p>
  <p num="p-0053">As discussed previously, unsafe traffic content are transmitted from protocol differentiator <b>704</b> to stack <b>708</b>. Stack <b>708</b> converts the traffic content into content stream such that it can be processed by processor <b>24</b>. In the illustrated embodiments, as network traffic content are received in stack <b>708</b>, they may be organized and stored in stack <b>708</b> according to their service or protocol type. For example, HTTP stream, FTP stream, and email stream may each be stored in a designated memory slot of stack <b>708</b>. In alternative embodiments, network traffic content may be stored in stack <b>708</b> in accordance with the order in which they are received, according to certain prescribed protocol or traffic shaping rules, or in accordance with other prescribed arrangements.</p>
  <p num="p-0054">Next, processor <b>24</b> receives network content stream from stack <b>708</b> and analyzes the network content to determine if they contain a virus, a worm, a web content, a Trogent agent, an email spam, a packet transmitted by a hacker, or other undesirable content. Particularly, processor <b>24</b> may execute one or more functions to determine whether the network traffic content matches content desired to be detected, which is codified by a signature using CPRL, as discussed previously. The operations of processor <b>24</b> and memory <b>22</b> are described above in reference to <figref idrefs="DRAWINGS">FIG. 2</figref>. If it is determined that network traffic content matches content desired to be detected, processor <b>24</b> or processor <b>702</b> may prevent the network traffic content from being sent to a user, send a message to a user, or remove the undesirable portion from the network traffic content before transmitting it to the user. If it is determined that network traffic content does not match content desired to be detected, processor <b>24</b> then passes such content to a user. In the illustrated embodiments, processor <b>24</b> is configured to pass the content to a user. Alternatively, processor <b>24</b> may signal stack <b>708</b> or processor <b>702</b> to transmit the content to the user.</p>
  <p num="p-0055">In the previously described embodiments, network traffic content transmitted to protocol differentiator <b>704</b> are either passed to packet processing module <b>706</b> or to stack <b>708</b>. However, this needs not be the case. In alternative embodiments, in addition to traffic content that doesn't need to be processed by processor <b>24</b>, protocol differentiator <b>704</b> may also pass at least a portion of traffic content that needs to be processed by processor <b>24</b> to packet processing module <b>706</b> (<figref idrefs="DRAWINGS">FIG. 8</figref>). As shown in <figref idrefs="DRAWINGS">FIG. 8</figref>, packets A and B are both transmitted to protocol differentiator <b>704</b>. Based on the file type or protocol of packet A, protocol differentiator <b>704</b> determines that packet A does not need to be processed by processor <b>24</b>. As such, protocol differentiator <b>704</b> passes packet A to packet processing module <b>706</b>, which in turn, scans packet A and passes packet A to a user. On the other hand, based on the file type or protocol of packet B, protocol differentiator <b>704</b> determines that packet B is to be processed by processor <b>24</b>. In such case, protocol differentiator <b>704</b> may make a copy of packet B and passes it to stack <b>708</b>. Protocol differentiator <b>704</b> also transmits a portion of packet B to packet processing module <b>706</b> where the portion of packet B is temporarily stored, while processor <b>24</b> processes packet B to determine if it contains undesirable content. Alternatively, instead of transmitting the portion of packet B to packet processing module <b>706</b>, protocol differentiator <b>704</b> may transmit a portion of packet B to a separate module (not shown), such as a memory, a buffer, or a processor, where the portion of packet B is temporarily stored. In such case, the separate module is configured for storing data ready to be sent to the user. If processor <b>24</b> determines that packet B does not contain undesirable content, processor <b>24</b> then signals stack <b>708</b> to transmit the rest of packet B to packet processing module <b>706</b> (or to the separate module if one is provided), which in turn, assembles packet B and passes packet B to the user. On the other hand, if processor <b>24</b> determines that packet B contains undesirable content, packet B is not passed to the user. In such case, processor <b>24</b> may cause a message to be sent to the user indicating that undesirable content has been detected, remove the undesirable portion from the network traffic content before transmitting to the user, and/or delete the network traffic content in its entirety.</p>
  <p num="p-0056">The above described configuration is advantageous in that a packet (e.g., packet B) can be advanced through a traffic stream while it is being examined by processor <b>24</b> to determine if it contains undesirable content, thereby improving an efficiency of detection device <b>700</b>. In alternative embodiments of the invention, instead of having protocol differentiator <b>704</b> transmit a copy of packet B to stack <b>708</b>, packet processing module <b>706</b> can be configured to make a copy of packet B and transmit packet B to stack <b>708</b>.</p>
  <p num="p-0057">In the previously described embodiments, protocol differentiator <b>704</b> passes a portion of packet B to packet processing module <b>706</b> (or to a separate module if one is provided). However this needs not be the case. In alternative embodiments, instead of transmitting a portion of packet B, the entire packet B may be transmitted from protocol differentiator <b>704</b> to packet processing module <b>706</b>. In such case, protocol differentiator <b>704</b> may flag packet B (e.g., by modifying a header, adding a header, or inserting data, e.g., a flag data, to packet B) before transmitting packet B to packet processing module <b>706</b> (or to buffer). The flag data added to packet B is designed to signal packet processing module <b>706</b> not to pass packet B to user until it is determined that packet B is a safe traffic content. Towards this end, signal packet processing module <b>706</b> is configured such that it passes non-flagged data and prevents flagged data from being sent to a user. When processor <b>24</b> determines that packet B does not contain an undesirable content, processor <b>24</b> can then signal packet processing module <b>706</b> to pass packet B to user.</p>
  <p num="p-0058">Although detection device <b>10</b> or <b>700</b> has been described as a hardware unit that is configured to be coupled to a user interface, such as a computer, those skilled in the art understand that a computer system may also be used to implement detection device to perform the same or similar functions described herein. <figref idrefs="DRAWINGS">FIG. 9</figref> is a block diagram that illustrates an embodiment of a computer system <b>1200</b> upon which embodiments of the invention may be implemented. Computer system <b>1200</b> includes a bus <b>1202</b> or other communication mechanism for communicating information, and a processor <b>1204</b> coupled with bus <b>1202</b> for processing information. Computer system <b>1200</b> also includes a main memory <b>1206</b>, such as a random access memory (RAM) or other dynamic storage device, coupled to bus <b>1202</b> for storing information and instructions to be executed by processor <b>1204</b>. Main memory <b>1206</b> also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor <b>1204</b>. Computer system <b>1200</b> may further include a read only memory (ROM) <b>1208</b> or other static storage device coupled to bus <b>1202</b> for storing static information and instructions for processor <b>1204</b>. A data storage device <b>1210</b>, such as a magnetic disk or optical disk, is provided and coupled to bus <b>1202</b> for storing information and instructions.</p>
  <p num="p-0059">Computer system <b>1200</b> may be coupled via bus <b>1202</b> to a display <b>1212</b>, such as a cathode ray tube (CRT), for displaying information to a user. An input device <b>1214</b>, including alphanumeric and other keys, is coupled to bus <b>1202</b> for communicating information and command selections to processor <b>1204</b>. Another type of user input device is cursor control <b>1216</b>, such as a mouse, a trackball, or cursor direction keys for communicating direction information and command selections to processor <b>1204</b> and for controlling cursor movement on display <b>1212</b>. This input device typically has two degrees of freedom in two axes, a first axis (e.g., x) and a second axis (e.g., y), that allows the device to specify positions in a plane.</p>
  <p num="p-0060">The invention is related to the use of computer system <b>1200</b> for processing network traffic content. According to some embodiments of the invention, such use may be provided by computer system <b>1200</b> in response to processor <b>1204</b> executing one or more sequences of one or more instructions contained in the main memory <b>1206</b>. Such instructions may be read into main memory <b>1206</b> from another computer-readable medium, such as storage device <b>1210</b>. Execution of the sequences of instructions contained in main memory <b>1206</b> causes processor <b>1204</b> to perform the process steps described herein. One or more processors in a multi-processing arrangement may also be employed to execute the sequences of instructions contained in main memory <b>1206</b>. In alternative embodiments, hard-wired circuitry may be used in place of or in combination with software instructions to implement the invention. Thus, embodiments of the invention are not limited to any specific combination of hardware circuitry and software.</p>
  <p num="p-0061">The term “computer-readable medium” as used herein refers to any medium that participates in providing instructions to processor <b>1204</b> for execution. Such a medium may take many forms, including but not limited to, non-volatile media, volatile media, and transmission media. Non-volatile media includes, for example, optical or magnetic disks, such as storage device <b>1210</b>. Volatile media includes dynamic memory, such as main memory <b>1206</b>. Transmission media includes coaxial cables, copper wire and fiber optics, including the wires that comprise bus <b>1202</b>. Transmission media can also take the form of acoustic or light waves, such as those generated during radio wave and infrared data communications.</p>
  <p num="p-0062">Common forms of computer-readable media include, for example, a floppy disk, a flexible disk, hard disk, magnetic tape, or any other magnetic medium, a CD-ROM, any other optical medium, punch cards, paper tape, any other physical medium with patterns of holes, a RAM, a PROM, and EPROM, a FLASH-EPROM, any other memory chip or cartridge, a carrier wave as described hereinafter, or any other medium from which a computer can read.</p>
  <p num="p-0063">Various forms of computer-readable media may be involved in carrying one or more sequences of one or more instructions to processor <b>1204</b> for execution. For example, the instructions may initially be carried on a magnetic disk of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system <b>1200</b> can receive the data on the telephone line and use an infrared transmitter to convert the data to an infrared signal. An infrared detector coupled to bus <b>1202</b> can receive the data carried in the infrared signal and place the data on bus <b>1202</b>. Bus <b>1202</b> carries the data to main memory <b>1206</b>, from which processor <b>1204</b> retrieves and executes the instructions. The instructions received by main memory <b>1206</b> may optionally be stored on storage device <b>1210</b> either before or after execution by processor <b>1204</b>.</p>
  <p num="p-0064">Computer system <b>1200</b> also includes a communication interface <b>1218</b> coupled to bus <b>1202</b>. Communication interface <b>1218</b> provides a two-way data communication coupling to a network link <b>1220</b> that is connected to a local network <b>1222</b>. For example, communication interface <b>1218</b> may be an integrated services digital network (ISDN) card or a modem to provide a data communication connection to a corresponding type of telephone line. As another example, communication interface <b>1218</b> may be a local area network (LAN) card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation, communication interface <b>1218</b> sends and receives electrical, electromagnetic or optical signals that carry data streams representing various types of information.</p>
  <p num="p-0065">Network link <b>1220</b> typically provides data communication through one or more networks to other devices. For example, network link <b>1220</b> may provide a connection through local network <b>1222</b> to a host computer <b>1224</b>. The data streams transported over the network link <b>1220</b> can comprise electrical, electromagnetic or optical signals. The signals through the various networks and the signals on network link <b>1220</b> and through communication interface <b>1218</b>, which carry data to and from computer system <b>1200</b>, are exemplary forms of carrier waves transporting the information. Computer system <b>1200</b> can send messages and receive data, including program code, through the network(s), network link <b>1220</b>, and communication interface <b>1218</b>. Although one network link <b>1220</b> is shown, in alternative embodiments, communication interface <b>1218</b> can provide coupling to a plurality of network links, each of which connected to one or more local networks. In some embodiments, computer system <b>1200</b> may receive data from one network, and transmit the data to another network. Computer system <b>1200</b> may process and/or modify the data before transmitting it to another network.</p>
  <p num="p-0066">Although the methods and the detection devices have been described with reference to detecting a virus, a worm, a web content, a Trogent agent, an email spam, and a packet transmitted by a hacker, it should be understood that the same or similar methods and devices may also be used to detect other content. Particularly, the predicates described herein, or similar predicates, may also be used to codify other types of content (as defined by a user) that is desired to be detected. In addition, although examples of predicates have been described, in alternative embodiments, other types of predicates, languages, or symbolic models, may be used to create a signature to thereby codify content desired to be detected. Also, the operations performed by processor <b>14</b> and processor <b>702</b> can be performed by any combination of hardware and software within the scope of the invention, and should not be limited to particular embodiments comprising a particular definition of “processor”. Furthermore, it should be noted that the configuration of detection device should not be limited to the examples shown previously, and that detection device may have other configurations as long as it can perform the functions described herein. For example, in some embodiments, the functions performed by processor <b>24</b> and processor <b>702</b> may be implemented using a single processor. In addition, protocol differentiator <b>704</b>, packet processing module <b>706</b>, stack <b>708</b>, fire module, and decryption module may be implemented in processor <b>24</b>, processor <b>702</b>, or another processor, which may or may not include a memory unit.</p>
  <p num="p-0067">Although particular embodiments of the present inventions have been shown and described, it will be understood that it is not intended to limit the present inventions to the preferred embodiments, and it will be obvious to those skilled in the art that various changes and modifications may be made without departing from the spirit and scope of the present inventions. The specification and drawings are, accordingly, to be regarded in an illustrative rather than restrictive sense. The present inventions are intended to cover alternatives, modifications, and equivalents, which may be included within the spirit and scope of the present inventions as defined by the claims.</p>
  <heading>APPENDIX A</heading> <heading>Exemplary Specifications for Predicates</heading> <p num="p-0068"> <tables id="TABLE-US-00001" num="00001"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="1"> <colspec colname="1" colwidth="217pt" align="center"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="1" rowsep="1" class="description-td" colspan="1">TABLE 1</td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td namest="1" nameend="1" align="center" rowsep="1" class="description-td" colspan="1"> </td> </tr> <tr class="description-tr"> <td class="description-td">Predicate Letter Summary</td> </tr> <tr class="description-tr"> <td class="description-td">Alphabetical list of predicate letters with details</td> </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="6"> <colspec colname="1" colwidth="14pt" align="left"> </colspec> <colspec colname="2" colwidth="21pt" align="left"> </colspec> <colspec colname="3" colwidth="35pt" align="left"> </colspec> <colspec colname="4" colwidth="35pt" align="left"> </colspec> <colspec colname="5" colwidth="35pt" align="left"> </colspec> <colspec colname="6" colwidth="77pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Re-</td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> </tr> <tr class="description-tr"> <td class="description-td">ID</td> <td class="description-td">turn</td> <td class="description-td">Predicate</td> <td class="description-td">Mnemonic</td> <td class="description-td">Family</td> <td class="description-td">Description</td> </tr> <tr class="description-tr"> <td namest="1" nameend="6" align="center" rowsep="1" class="description-td" colspan="6"> </td> </tr> <tr class="description-tr"> <td class="description-td">A</td> <td class="description-td">b</td> <td class="description-td">A(z)</td> <td class="description-td">Ascii</td> <td class="description-td">Test</td> <td class="description-td">Test literal string</td> </tr> <tr class="description-tr"> <td class="description-td">B</td> <td class="description-td">b</td> <td class="description-td">B(m)</td> <td class="description-td">Bitmask</td> <td class="description-td">Test</td> <td class="description-td">Test using bitmask</td> </tr> <tr class="description-tr"> <td class="description-td">C</td> <td class="description-td">V</td> <td class="description-td">C( )</td> <td class="description-td">Case</td> <td class="description-td">Decision</td> <td class="description-td">Branch using multiple</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">cases</td> </tr> <tr class="description-tr"> <td class="description-td">D</td> <td class="description-td">V</td> <td class="description-td">D(label)</td> <td class="description-td">Do</td> <td class="description-td">Iteration</td> <td class="description-td">Start Loop (ends on</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">lable)</td> </tr> <tr class="description-tr"> <td class="description-td">E</td> <td class="description-td">V</td> <td class="description-td">E(f,</td> <td class="description-td">Each</td> <td class="description-td">Iteration</td> <td class="description-td">Repeat function with</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">b,</td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">each byte in list</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">b . . . )</td> </tr> <tr class="description-tr"> <td class="description-td">F</td> <td class="description-td">V</td> <td class="description-td">F(n, f)</td> <td class="description-td">For</td> <td class="description-td">Iteration</td> <td class="description-td">Repeat function on n</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">buffer bytes</td> </tr> <tr class="description-tr"> <td class="description-td">G</td> <td class="description-td">V</td> <td class="description-td">G (label)</td> <td class="description-td">Goto</td> <td class="description-td">Decision</td> <td class="description-td">Goto label in sig</td> </tr> <tr class="description-tr"> <td class="description-td">H</td> <td class="description-td">B</td> <td class="description-td">H(d)</td> <td class="description-td">Heuristic</td> <td class="description-td">Test</td> <td class="description-td">Test d against heuristic</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">flags</td> </tr> <tr class="description-tr"> <td class="description-td">I</td> <td class="description-td">V</td> <td class="description-td">I(f, I)</td> <td class="description-td">If</td> <td class="description-td">Decision</td> <td class="description-td">If test f branch else</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">continue</td> </tr> <tr class="description-tr"> <td class="description-td">J</td> <td class="description-td">V</td> <td class="description-td">J(size)</td> <td class="description-td">Jump</td> <td class="description-td">Pointer</td> <td class="description-td">Jump using buffer value</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">of size</td> </tr> <tr class="description-tr"> <td class="description-td">K</td> <td class="description-td">B</td> <td class="description-td">K(re-</td> <td class="description-td">Keyword</td> <td class="description-td">Function</td> <td class="description-td">Process keyword</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">served)</td> </tr> <tr class="description-tr"> <td class="description-td">L</td> <td class="description-td">B</td> <td class="description-td">L(b)</td> <td class="description-td">Literal</td> <td class="description-td">Test</td> <td class="description-td">Test literal</td> </tr> <tr class="description-tr"> <td class="description-td">M</td> <td class="description-td">V</td> <td class="description-td">M(name)</td> <td class="description-td">Macro</td> <td class="description-td">Function</td> <td class="description-td">Execute macro NAME</td> </tr> <tr class="description-tr"> <td class="description-td">N</td> <td class="description-td">B</td> <td class="description-td">N(logic)</td> <td class="description-td">Near</td> <td class="description-td">Test</td> <td class="description-td">Test using relative logic</td> </tr> <tr class="description-tr"> <td class="description-td">O</td> <td class="description-td">B</td> <td class="description-td">O(n,</td> <td class="description-td">Order</td> <td class="description-td">Test</td> <td class="description-td">Order (sort) n buffer</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">method)</td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">bytes using method</td> </tr> <tr class="description-tr"> <td class="description-td">P</td> <td class="description-td">V</td> <td class="description-td">P(name)</td> <td class="description-td">Process/</td> <td class="description-td">Function</td> <td class="description-td">Execute process name</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">Procedure</td> </tr> <tr class="description-tr"> <td class="description-td">Q</td> <td class="description-td">B</td> <td class="description-td">Q(logic)</td> <td class="description-td">Query</td> <td class="description-td">Test</td> <td class="description-td">Test using ranged logic</td> </tr> <tr class="description-tr"> <td class="description-td">R</td> <td class="description-td">V</td> <td class="description-td">R(p)</td> <td class="description-td">Rewind</td> <td class="description-td">Pointer</td> <td class="description-td">Reset buffer stream</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">pointer</td> </tr> <tr class="description-tr"> <td class="description-td">S</td> <td class="description-td">B</td> <td class="description-td">S (n, k)</td> <td class="description-td">Seek</td> <td class="description-td">Pointer</td> <td class="description-td">Reposition buffer stream</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">pointer</td> </tr> <tr class="description-tr"> <td class="description-td">T</td> <td class="description-td">B</td> <td class="description-td">T(logic)</td> <td class="description-td">Test</td> <td class="description-td">Test</td> <td class="description-td">Test using positional</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">logic</td> </tr> <tr class="description-tr"> <td class="description-td">U</td> <td class="description-td">b</td> <td class="description-td">U(z)</td> <td class="description-td">Uppercase</td> <td class="description-td">Test</td> <td class="description-td">Test after uppercasing</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">buffer string</td> </tr> <tr class="description-tr"> <td class="description-td">V</td> <td class="description-td">b</td> <td class="description-td">V(logic)</td> <td class="description-td">Variable</td> <td class="description-td">Test</td> <td class="description-td">Test using set summation</td> </tr> <tr class="description-tr"> <td class="description-td">W</td> <td class="description-td">b</td> <td class="description-td">W(c)</td> <td class="description-td">Wildcard</td> <td class="description-td">Test</td> <td class="description-td">Simply (one byte)</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">wildcards</td> </tr> <tr class="description-tr"> <td class="description-td">X</td> <td class="description-td">b</td> <td class="description-td">X(b)</td> <td class="description-td">Xray/Xor</td> <td class="description-td">Test</td> <td class="description-td">Test using xor mask</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">based on b</td> </tr> <tr class="description-tr"> <td namest="1" nameend="6" align="center" rowsep="1" class="description-td" colspan="6"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Breakdown by predicate type:
</p> <ul> <li id="ul0001-0001" num="0000"> <ul> <li id="ul0002-0001" num="0068">Test 12 predicates</li> <li id="ul0002-0002" num="0069">Pointer 3 Predicates</li> <li id="ul0002-0003" num="0070">Decision 3 Predicates</li> <li id="ul0002-0004" num="0071">Iteration 3 Predicates</li> <li id="ul0002-0005" num="0072">Function 3 Predicates
<br>
Predicate Format
<br>
Each primary predicate letter in CPRL has a corresponding mnemonic form. Some also have alternate (or alias) forms. For example F is the predicate letter for FIND as in:
</li> <li id="ul0002-0006" num="0073">B(m)=Bitmask(mask). Alternate form could be mask(mask) or nibble(mask).
<br>
Pointer Resolution
<br>
Pointer resolution is a critical issue in developing CRPL. This involves the position of two pointers. The first is the pointer to the current position in the buffer. The second is the pointer to the current position in the signature. The design specification of each and every predicate is unambiguous about where each pointer is located after completion. Moreover, the position for each of the pointers may be specified for each possible condition returned by the predicate (i.e. true, false, etc.).
<br>
Table 2. Hex Values Assigned to Predicate Letters
<br>
Table 2 below shows the extended function code assigned to predicate letters. Note that each letter has 10 (0x0A) usable code values assigned to it. This code values is the byte that follows the 0xDF (extended) byte that tells the interpreter that it is now dealing with a CPRL predicate.
<br>
Example A(“vermin”) would become DF 00 76 65 72 6D 69 6E where the second byte (00) represents the A predicate letter.
</li> </ul> </li> </ul> <p num="p-0069"> <tables id="TABLE-US-00002" num="00002"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="1" colwidth="49pt" align="left"> </colspec> <colspec colname="2" colwidth="42pt" align="left"> </colspec> <colspec colname="3" colwidth="126pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="3" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">A ascii</td> <td class="description-td"> 00/0x00</td> <td class="description-td"> </td> </tr> <tr class="description-tr"> <td class="description-td">B bitmask</td> <td class="description-td"> 10/0x0A</td> <td class="description-td">0A = get/push mask; 0B = pop/cmp mask;</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"> </td> <td class="description-td">simple not extended.</td> </tr> <tr class="description-tr"> <td class="description-td">C case</td> <td class="description-td"> 20/0x14</td> </tr> <tr class="description-tr"> <td class="description-td">D do</td> <td class="description-td"> 30/0x1E</td> </tr> <tr class="description-tr"> <td class="description-td">E each</td> <td class="description-td"> 40/0x28</td> </tr> <tr class="description-tr"> <td class="description-td">F for</td> <td class="description-td"> 50/0x32</td> </tr> <tr class="description-tr"> <td class="description-td">G goto</td> <td class="description-td"> 60/0x3C</td> </tr> <tr class="description-tr"> <td class="description-td">H heuristic</td> <td class="description-td"> 70/0x46</td> </tr> <tr class="description-tr"> <td class="description-td">I if</td> <td class="description-td"> 80/0x50</td> </tr> <tr class="description-tr"> <td class="description-td">J jump</td> <td class="description-td"> 90/0x5A</td> </tr> <tr class="description-tr"> <td class="description-td">K keyword</td> <td class="description-td">100/0x64</td> </tr> <tr class="description-tr"> <td class="description-td">L literal</td> <td class="description-td">110/0x6E</td> </tr> <tr class="description-tr"> <td class="description-td">M macro</td> <td class="description-td">120/0x78</td> </tr> <tr class="description-tr"> <td class="description-td">N near</td> <td class="description-td">130/0x82</td> <td class="description-td">82 = byt; 83 = word</td> </tr> <tr class="description-tr"> <td class="description-td">O rder</td> <td class="description-td">140/0x8C</td> </tr> <tr class="description-tr"> <td class="description-td">P process</td> <td class="description-td">150/0x96</td> </tr> <tr class="description-tr"> <td class="description-td">Q query</td> <td class="description-td">160/0xA0</td> <td class="description-td">A0 = byte; A1 = word</td> </tr> <tr class="description-tr"> <td class="description-td">R rewind</td> <td class="description-td">170/0xAA</td> </tr> <tr class="description-tr"> <td class="description-td">S seek</td> <td class="description-td">180/0xB4</td> <td class="description-td">See section on S Predicate overload</td> </tr> <tr class="description-tr"> <td class="description-td">T test</td> <td class="description-td">190/0xBE</td> <td class="description-td">BE = byte; BF = word</td> </tr> <tr class="description-tr"> <td class="description-td">U</td> <td class="description-td">200/0xCB</td> </tr> <tr class="description-tr"> <td class="description-td">uppercase</td> </tr> <tr class="description-tr"> <td class="description-td">V variable</td> <td class="description-td">210/0xD2</td> </tr> <tr class="description-tr"> <td class="description-td">W wildcard</td> <td class="description-td">220/0xDC</td> </tr> <tr class="description-tr"> <td class="description-td">X xor</td> <td class="description-td">230/0xE6</td> </tr> <tr class="description-tr"> <td namest="1" nameend="3" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Predicate Letter Descriptions
<br>
Note that any given predicate may have 2 or more forms. Descriptions may have the following format.
</p>
  <p num="p-0070"> <tables id="TABLE-US-00003" num="00003"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Mnemonic and Predicate</td> <td class="description-td"> </td> </tr> <tr class="description-tr"> <td class="description-td">Group</td> <td class="description-td">Boolean, Test, Logic/Math, Flow/Branch,</td> </tr> <tr class="description-tr"> <td class="description-td">Types</td> <td class="description-td">MZ, PE, etc</td> </tr> <tr class="description-tr"> <td class="description-td">Alias(es)</td> <td class="description-td">Alternate forms of predicate mnemonic.</td> </tr> <tr class="description-tr"> <td class="description-td">Arguments</td> <td class="description-td">Values defining the predicate usage.</td> </tr> <tr class="description-tr"> <td class="description-td">Returns</td> <td class="description-td">Result of predicate action (boolean, pointer,</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">etc.)</td> </tr> <tr class="description-tr"> <td class="description-td">Hex Pattern</td> <td class="description-td">Hexadecimal encoding of predicate letter.</td> </tr> <tr class="description-tr"> <td class="description-td">Sig Pointer Resolution</td> <td class="description-td">Default location of sig pointer after action.</td> </tr> <tr class="description-tr"> <td class="description-td">Buffer Pointer Resolution</td> <td class="description-td">Default location of buffer pointer after action.</td> </tr> <tr class="description-tr"> <td class="description-td">Logic and Flow</td> <td class="description-td">Flowchart of logic.</td> </tr> <tr class="description-tr"> <td class="description-td">Explanation</td> <td class="description-td">Details of predicate function.</td> </tr> <tr class="description-tr"> <td class="description-td">Example</td> <td class="description-td">Example in predicate and resultant hexadecimal</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">forms.</td> </tr> <tr class="description-tr"> <td class="description-td">Compiler Notes</td> <td class="description-td">Notes on testing, validating, and compiling</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">predicate.</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
A—ASCII (see also Uppercase)
<br>
The A predicate is used to compare text strings. It may allow for escape sequences as found in C, such as “\n” for new line. The strings may be included in quotation marks.
<br>
Note that the first argument in an A predicate may be the number of bytes in the stream. This is calculated and stored by the compiler.
</p>
  <p num="p-0071"> <tables id="TABLE-US-00004" num="00004"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Mnemonic and Predicate</td> <td class="description-td">Ascii—A( )</td> </tr> <tr class="description-tr"> <td class="description-td">Group</td> <td class="description-td">Test</td> </tr> <tr class="description-tr"> <td class="description-td">Types</td> <td class="description-td">Any</td> </tr> <tr class="description-tr"> <td class="description-td">Alias(es)</td> <td class="description-td">String( )</td> </tr> <tr class="description-tr"> <td class="description-td">Arguments</td> <td class="description-td">A string literal in C format allowing for escape</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">sequences.</td> </tr> <tr class="description-tr"> <td class="description-td">Returns</td> <td class="description-td">True on matching all characters, otherwise</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">false.</td> </tr> <tr class="description-tr"> <td class="description-td">Hex Pattern</td> <td class="description-td">Hexadecimal encoding of predicate letter.</td> </tr> <tr class="description-tr"> <td class="description-td">Sig Pointer Resolution</td> <td class="description-td">If true or false, point to byte following string</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">literal in sig.</td> </tr> <tr class="description-tr"> <td class="description-td">Buffer Pointer Resolution</td> <td class="description-td">If true, point to byte following string literal in</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">buffer, else reset pointer to start of tested string</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">literal in buffer.</td> </tr> <tr class="description-tr"> <td class="description-td">Logic and Flow</td> <td class="description-td">Function like strcmp. Compare each byte in sig</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">to each byte in buffer in sequence. Testing is</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">case sensitive. Returns true if all chars in string</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">literal and buffer match.</td> </tr> <tr class="description-tr"> <td class="description-td">Examples</td> <td class="description-td">A(“Another K00L virus”)</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">A(“Warning!\n You are infected!”)</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Predicate Format
<br>
DF 00 A(“string”)
<br>
DF 01 A(byte range, “string”)
<br>
DF 02 A(long start offset, long range, string)
<br>
DF 03 A(ALL, “string”)
<br>
DF 04 A(long range, “string”)
<br>
Description
<br>
DF 00 takes 1 argument: a string literal. It matches a string that starts at the current location.
<br>
DF 01 takes 2 arguments: an unsigned byte value (range) and a string literal. It searches from the current buffer pointer location for the first occurrence of the string literal within range, where range is the distance to look for the first byte in the string literal. Other chars in the string literal may be beyond range if the first char is within range.
<br>
DF 02 takes 3 arguments: an unsigned long value (start offset), an unsigned long value (range), and a string literal. It searches from the provided start offset for the first occurrence of the string literal within range, where range is the distance to look for the first byte in the string literal. Other chars in the string literal may be beyond range if the first char is within range.
<br>
DF 03 takes two arguments, the keyword ALL, and a string literal. It searches the entire buffer from the start looking for the first occurrence of the string literal.
<br>
DF 04 takes 2 arguments: an unsigned long value (range) and a string literal. It searches from the current buffer pointer location for the first occurrence of the string literal within range, where range is the distance to look for the first byte in the string literal. Other chars in the string literal may be beyond range if the first char is within range.
<br>
B—Bitmask
<br>
The bitmask predicate has three forms. The first is B(mask, byte) that simply applies the mask to the next byte in the buffer and compares it to byte. This becomes the wildcard 0xDE.
<br>
The other two may work in conjunction and are used in register matching.
<br>
The first is B(GET, REG), which gets the next byte in the buffer and used REG as a mask to extract the register bits. The resultant byte is stored in REG=OP format (explained below) by pushing it onto the registry stack.
<br>
The second is B(CMP,REG), which pops the registry mask byte off the registry stack, puts it into REG format and compares it to the next byte in the buffer.
<br>
There are three REG formats. OP (the registry bits in a single byte instruction), RG (the reg bits in a mod/rm byte), and RM (the r/m bits in a mod/rm byte).
</p>
  <p num="p-0072"> <tables id="TABLE-US-00005" num="00005"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Mnemonic and Predicate</td> <td class="description-td">BITMASK—B( )</td> </tr> <tr class="description-tr"> <td class="description-td">Group</td> <td class="description-td">test</td> </tr> <tr class="description-tr"> <td class="description-td">Types</td> <td class="description-td">binary</td> </tr> <tr class="description-tr"> <td class="description-td">Alias(es)</td> <td class="description-td">nibble (0xDE form)</td> </tr> <tr class="description-tr"> <td class="description-td">Arguments</td> <td class="description-td">2</td> </tr> <tr class="description-tr"> <td class="description-td">Returns</td> <td class="description-td">true or false</td> </tr> <tr class="description-tr"> <td class="description-td">Hex Patterns</td> <td class="description-td">B(mask, byte) is 0xDE (simple mask)</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">B(GET,REG) is 0xDF, 0x0A</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">B(CMP,REG) is 0xDF, 0x0B</td> </tr> <tr class="description-tr"> <td class="description-td">Sig Pointer Resolution</td> <td class="description-td">next predicate</td> </tr> <tr class="description-tr"> <td class="description-td">Buffer Pointer Resolution</td> <td class="description-td">next buffer byte</td> </tr> <tr class="description-tr"> <td class="description-td">Logic and Flow</td> <td class="description-td">B(mask, byte) AND buffer byte with mask.</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Compare byte. B(GET,REG) get byte, isolate</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">registry bits, push on stack. B(CMP,REG) pop</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">bitmask from stack, use as registry mask.</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
C—Case (see also If)
<br>
The C predicate functions by comparing the next byte in the buffer with a series of bytes. Each byte in the series is followed by a label byte. If any byte matches, the signature pointer moves to the related label in the sig.
<br>
In pseudocode this would appear as:
</p> <ul> <li id="ul0003-0001" num="0000"> <ul> <li id="ul0004-0001" num="0078">C(0E,@1,8E,@2,CD,@3), END or sig continues for no match then END</li> <li id="ul0004-0002" num="0079">@1: sig for case 0E . . . . . . . . . END</li> <li id="ul0004-0003" num="0080">@2: sig for case 8E . . . . . . . . . END</li> <li id="ul0004-0004" num="0081">@3: sig for case CD . . . . . . . . END
<br>
where @1 etc are labels and END means stop comparing.
<br>
G—Goto
<br>
The G predicate is simply a forward reference that instructs the interpreter to move the signature pointer to a new location. The argument is a specified label. This function is used to skip a segment of the signature. It is used in relation to an I predicate to end the else section and therefore functions as a break command.
<br>
Note on Labels: A label is not actually stored in a signature. Rather a forward reference is stored in the calling predicate. The forward reference may be an unsigned byte, which equals the number to add to the signature pointer in order to arrive at the first instruction after the label in the pseudocode.
<br>
Note that Goto uses a system of forward referencing jump points and landing points. So as to not restrict the length of signatures, these values are unsigned shorts.
<br>
Summary
<br>
The G predicate functions as a break or continue statement. It repositions the signature pointer and has no effect on the buffer pointer.
<br>
Predicate Format
<br>
DF 3C G(L1)
<br>
DF 3D G(true)
<br>
DF 3E G(false)
<br>
DF 3F G(fuzzy)
<br>
Description
<br>
The G predicate takes a single argument. The argument is a label token (such as L1). This label token has a corresponding label (such as L1:). After the predicate is interpreted the signature pointer is set to the offset of L1:
<br>
In addition to a label token, the G predicate can also take two other tokens that are used to terminate the signature completely:
</li> <li id="ul0004-0005" num="0082">G(TRUE) to signify that a we have found a match</li> <li id="ul0004-0006" num="0083">G(FALSE) to signify that a we have not found a match
<br>
I—If (see also Case)
<br>
The I predicate takes two arguments. A byte to compare and a label. It functions by comparing the next byte in the buffer with a argument byte. If the bytes match then the sig pointer is moved to the label location and processing continues. If the bytes do not match processing continues from the current signature location:
<br>
In pseudocode this would appear as:
</li> <li id="ul0004-0007" num="0084">I(0E,@1)</li> <li id="ul0004-0008" num="0085">continue sig comparison as if an else statement. END</li> <li id="ul0004-0009" num="0086">@1: continue sig for the 0E match.
<br>
J—Jump
<br>
The J predicate takes a single argument. It is used where a jump or call instruction in the buffer needs to be followed to its landing point. The argument indicates what bytes to use to calculate the landing point. The possible arguments are BYTE, WORD, and DWORD. Depending on the argument, the next one, two, or four bytes are used to calculate the landing point.
<br>
Note that the bytes will be in Intel format and may be so calculated.
<br>
Note also that all calculated values may be treated as signed values to permit moving to a relative location before or after the current buffer position.
<br>
L—Literal
<br>
The L predicate is used to encapsulate any literal byte stream. Note that values in this byte stream with a value from 0xD8 to 0xDF may be either:
</li> <li id="ul0004-0010" num="0087">inside an embedded L(byte) predicate (if the value is needed for detection), or</li> <li id="ul0004-0011" num="0088">replaced by an embedded W(1) (which simply replaces it with a 0xD8 wildcard)
<br>
Note that the first argument in an L predicate may be the number of bytes in the stream. This is calculated and stored by the compiler.
<br>
R—Re wind (see also Seek)
<br>
The R predicate takes a single argument. The argument is a byte that represents an unsigned offset. The R predicate moves the pointer to the start location in the buffer (where the signature testing began, usually the code entry point). The argument is an optional offset from that start location. Note that R(0) translates to the one byte wild card 0xDB and sets the pointer at the exact start location.
<br>
S—Seek (see also Rewind)
<br>
The S predicate functions like the fseek function. It takes two arguments, the first is a signed long offset that indicates the distance to move within the buffer. The second is a keyword that indicates the start location. The keywords are the same as in C:
</li> <li id="ul0004-0012" num="0089">SEEK_SET (0) From beginning of buffer.</li> <li id="ul0004-0013" num="0090">SEEK_CUR (1) From current location (relative)</li> <li id="ul0004-0014" num="0091">SEEK_END (2) From end of file.
<br>
To simplify matters, these keywords are not case sensitive and within the predicate can be truncated to SET, CUR, and END. A negative offset used with SEEK_SET may generate an error. A positive offset used with SEEK_END is interpreted the same as a negative value so that:
</li> <li id="ul0004-0015" num="0092">S(2000, SEEK_END)=S(−2000, SEEK_END).
<br>
Values calculated with SEEK_CUR are treated as relative sighed values.
<br>
U—Uppercase (see also ASCII)
<br>
The U predicate is used to compare text strings. Like the A predicate, it may allow for escape sequences as found in C, such as “\n” for new line. The strings may be included in quotation marks. The test string to be used may be input in all uppercase. If any chars in the test string are lower case, the compiler may uppercase them.
<br>
The predicate differs from the A predicate in that it is actually eliminates case-sensitivity. When a letter (in either case) is found that matches the first letter of the test string, each letter in the buffer is uppercased by the interpreter and compared to the corresponding letter in the test string.
<br>
Note that the first argument in a U predicate may be the number of bytes in the stream. This is calculated and stored by the compiler.
<br>
V—Variable
<br>
The V predicate counts matches for one or more test bytes within a specified range. The first argument is a keyword that specifies the test method to apply. The second byte is a benchmark value to test against. The third argument is the range of bytes. These are followed by one or more test bytes to match. In the compiled version of the signature, the fourth argument is the number of test bytes to match, which is calculated and stored by the compiler. The count is followed by the actual test byte(s).
<br>
The methods are represented by three separate extended (0xDF) functions:
</li> <li id="ul0004-0016" num="0093">EQ (0xD2) true if count=benchmark.</li> <li id="ul0004-0017" num="0094">GT (0xD3) true if count&gt;benchmark.</li> <li id="ul0004-0018" num="0095">LT (0xD4) true if count&lt;benchmark.
<br>
So if method=0, benchmark=8, range=32 (0x20) and the test bytes are 0xCD, 0xBE, and 0x21 then:
</li> <li id="ul0004-0019" num="0096">the predicate form would be V(EQ, 8, 32, 0xCD, 0xBE, 0x21),</li> <li id="ul0004-0020" num="0097">which translates to DF D2 08 20 03 CD BE 21
<br>
where the count 03 is added by the compiler.
<br>
W—Wildcard
<br>
The W predicate is used to represent the simple “skip” and slide wildcards.
<br>
W(1)=skip(1) and translates 0xD8 and ignores 1 byte
<br>
W(2)=skip(2) and translates 0xD9 and ignores 2 bytes
<br>
W(n)=skip(n) and translates 0xDA, n and ignores n bytes
<br>
W(n, b)=slide(n) and translates 0xDB, n, byte and searches n bytes for a byte matching b.
<br>
N, Q, T—Predicates
<br>
There are 3 logic predicates. Test, Near, and Query.
</li> <li id="ul0004-0021" num="0098">Test tests the next one or two bytes (depending on the logic).</li> <li id="ul0004-0022" num="0099">Near tests bytes within (plus or minus) 127 bytes of the current buffer position.</li> <li id="ul0004-0023" num="0100">Query tests bytes in the next 255 bytes of the current buffer position.
<br>
Each predicate takes an initial argument that represents the type of logic to apply in the test. The logic argument is followed by a variable number of other arguments. In Near and Query logic, the second argument is the range to search within the buffer. In Near logic the range is a signed byte (−128 to 127). In Query logic the range is an unsigned byte (0 to 255).
<br>
There are ten (10) logical operators. Each is represented in CPRL by a keyword. These keywords are not case sensitive. These keywords are reserved, so they can be used in a logic predicate or else in a quote (such as finding the word “and” in a byte stream).
<br>
There are four (4) primary logical keywords. These are AND, XOR, OR, and NOT. These four keywords can be used with any logic predicate.
<br>
There are six (6) additional keywords. These are NEG, POS, NZ, MOD, BIT, and REG. These six may be used with the Test predicate. They may be applied to the next byte in the buffer.
<br>
T(AND) may require 2 byte arguments and tests the next two bytes in the buffer.
<br>
T(XOR) may require 2 byte arguments and tests the next two bytes in the buffer.
<br>
T(OR) may require a list of 2 or more bytes and tests the next byte in the buffer.
<br>
T(NOT) may require a list of 1 or more bytes and tests the next byte in the buffer.
<br>
T(NEG) has no arguments. It returns true if the next byte in the buffer is negative.
<br>
T(POS) has no arguments. It returns true if the next byte in the buffer is positive.
<br>
T(NZ) has no arguments. It returns true if the next byte in the buffer is non-zero.
<br>
T(MOD) may require 2 byte argument, a divisor and mod to match.
<br>
T(BIT) may require 1 byte argument, a bitmask.
<br>
T(REG) may require 1 byte argument, a registry mask.
<br>
N(AND) may require a signed range byte and list of 2 or more test bytes.
<br>
N(XOR) may require a signed range byte and 2 test bytes.
<br>
N(OR) may require a signed range byte and list of 2 or more test bytes.
<br>
N(NOT) may require a signed range byte and list of 1 or more test bytes.
<br>
Q(AND) may require an unsigned range byte and list of 2 or more test bytes.
<br>
Q(XOR) may require an unsigned range byte and 2 test bytes.
<br>
Q(OR) may require an unsigned range byte and list of 2 or more test bytes.
<br>
Q(NOT) may require an unsigned range byte and list of 1 or more test bytes.
<br>
Table 3. Hex Values Assigned to Logical Operators
<br>
The following table gives the byte value assigned to each logical operator. This byte is used as the first argument in one of the logic predicate letters (T, N, Q).
</li> </ul> </li> </ul> <p num="p-0073"> <tables id="TABLE-US-00006" num="00006"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="56pt" align="left"> </colspec> <colspec colname="1" colwidth="21pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="center"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">AND</td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">XOR</td> <td class="description-td">1</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">OR</td> <td class="description-td">2</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">NOT</td> <td class="description-td">3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">NEG</td> <td class="description-td">4</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">POS</td> <td class="description-td">5</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">NZ</td> <td class="description-td">6</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">MOD</td> <td class="description-td">7</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">BIT</td> <td class="description-td">8</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">REG</td> <td class="description-td">9</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
For example T(or, 0xBB, 0xBF) translates to DF BE 02 BB BF. Where BE represents the T predicate letter and 02 represents the OR logical operator. This predicate would return true if the next letter in the buffer is either 0xBB or 0xBF.
<br>
Byte Stream Format
<br>
For input of literal byte streams, the individual bytes in the stream are not delimited by commas. The normal form of a literal byte stream is a simply hexadecimal form.
<br>
While a “solid” stream
</p> <ul> <li id="ul0005-0001" num="0000"> <ul> <li id="ul0006-0001" num="0102">L(DE83FFCD21B40AEB0005C3)
<br>
is traditional, a “broken” stream
</li> <li id="ul0006-0002" num="0103">L(DE 83 FF CD 21 B40A EB 00 05 C3)
<br>
is much easier to work with in actual practice.
<br>
In either case, each byte may be represented by two characters, even is a value is less than 10 hex.
</li> <li id="ul0006-0003" num="0104">56 78 01 DF 00 correct</li> <li id="ul0006-0004" num="0105">56 78 1 DF 0 wrong
<br>
Virus Name
<br>
The virus name location can remain consistent with the previous FortiNet, in that the name can precede the signature along with other flags such as signature type.
<br>
Suggested Input Format
<br>
It is easiest in practice to input a signature by placing a single predicate on each line along with comments. Here is a simple example:
</li> </ul> </li> </ul> <p num="p-0074"> <tables id="TABLE-US-00007" num="00007"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">“W32/Virus_Name.A”</td> <td class="description-td"> </td> </tr> <tr class="description-tr"> <td class="description-td">Win32</td> </tr> <tr class="description-tr"> <td class="description-td">L(EB DF 01 00 00)</td> <td class="description-td">// Match bytes in far call</td> </tr> <tr class="description-tr"> <td class="description-td">R(−4)</td> <td class="description-td">// Move buffer pointer back to start of call word</td> </tr> <tr class="description-tr"> <td class="description-td">J(LONG)</td> <td class="description-td">// Follow jump to landing point</td> </tr> <tr class="description-tr"> <td class="description-td">L(EB 00 00 00 00 1E)</td> <td class="description-td">// literal</td> </tr> <tr class="description-tr"> <td class="description-td">W(1)</td> <td class="description-td">// skip byte</td> </tr> <tr class="description-tr"> <td class="description-td">B4 00 8C C8 CD 13)</td> <td class="description-td">// literal</td> </tr> <tr class="description-tr"> <td class="description-td">W(5)</td> <td class="description-td">// skip next 5 bytes</td> </tr> <tr class="description-tr"> <td class="description-td">L(50 67 88 D1 AC)</td> <td class="description-td">// literal</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
The name and signature may be stored in a standard format, such as:
</p> <ul> <li id="ul0007-0001" num="0000"> <ul> <li id="ul0008-0001" num="0107">Full length (name+signature), length of name, name, 0, info flags, signature byte stream
<br>
When compiling a byte stream the compile may reconstruct each byte while ignoring any space characters).
<br>
Example of Polymorphic
<br>
Accurate detection of the Tequila virus may require a specific algorithm, which is given directly below in pseudocode.
<br>
Code:
</li> <li id="ul0008-0002" num="0108">Seek 68 (0x44) bytes back from end of file. This is the base point.</li> <li id="ul0008-0003" num="0109">If byte at this location is either 0x0E or 0x8C then continue else return false.</li> <li id="ul0008-0004" num="0110">If 0x0E then go to label L1:</li> <li id="ul0008-0005" num="0111">(First byte was 0x8C) If next is 0xCB then continue at label L2: else return false.</li> <li id="ul0008-0006" num="0112">L1:</li> <li id="ul0008-0007" num="0113">(First byte was 0x0E) If any of next 4 bytes is 0x1F continue else return false.</li> <li id="ul0008-0008" num="0114">L2:</li> <li id="ul0008-0009" num="0115">Reset pointer to base point.</li> <li id="ul0008-0010" num="0116">If 0x60 is found in the first 24 bytes then continue else return false.</li> <li id="ul0008-0011" num="0117">If byte immediately following 0x60 is 0x09 then continue else return false.</li> <li id="ul0008-0012" num="0118">Return true.
<br>
Tequila using a logical OR test and If predicate as in pseudo code above.
</li> </ul> </li> </ul> <p num="p-0075"> <tables id="TABLE-US-00008" num="00008"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="63pt" align="left"> </colspec> <colspec colname="2" colwidth="154pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">S(68,SEEK_END)</td> <td class="description-td">// Seek 68 (44h) bytes from eof</td> </tr> <tr class="description-tr"> <td class="description-td">T(OR, 0E, 8C)</td> <td class="description-td">// Test first byte for 0E or 8C (increments sig ptr)</td> </tr> <tr class="description-tr"> <td class="description-td">R(0)</td> <td class="description-td">// Reset pointer to first byte</td> </tr> <tr class="description-tr"> <td class="description-td">I(0E, L1)</td> <td class="description-td">// IF 0E go to label L1 (test does not increment sig</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">ptr)</td> </tr> <tr class="description-tr"> <td class="description-td">L(8C, CB)</td> <td class="description-td">// Else test for CB [could skip(1) and use L(CB)]</td> </tr> <tr class="description-tr"> <td class="description-td">G(L2)</td> <td class="description-td">// go to label L2</td> </tr> <tr class="description-tr"> <td class="description-td">L1:</td> <td class="description-td">// do if first byte was 0E</td> </tr> <tr class="description-tr"> <td class="description-td">W(5, 1F)</td> <td class="description-td">// search from sig base to locate 0x1F</td> </tr> <tr class="description-tr"> <td class="description-td">L2:</td> <td class="description-td">// do for either match at start</td> </tr> <tr class="description-tr"> <td class="description-td">R(0)</td> <td class="description-td">// reset under both conditions (0E or 8C)</td> </tr> <tr class="description-tr"> <td class="description-td">W(24, 60)</td> <td class="description-td">// search 24d bytes for 60h)</td> </tr> <tr class="description-tr"> <td class="description-td">L(09)</td> <td class="description-td">// test byte for 09h</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Here's Tequila using the Case predicate instead of the OR/If combo.
</p>
  <p num="p-0076"> <tables id="TABLE-US-00009" num="00009"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="70pt" align="left"> </colspec> <colspec colname="2" colwidth="133pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">S(68,SEEK_END)</td> <td class="description-td">// Seek 68 bytes from eof</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">C(0E, L1, 8C, L2)</td> <td class="description-td">// Case test first byte for 0E or 8C</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">L1:</td> <td class="description-td">// 0E</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">W(4, 1F)</td> <td class="description-td">// search four bytes for 0x1F</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">G(L3)</td> <td class="description-td">// go to label L3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">L2:</td> <td class="description-td">// 8C</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">L(CB)</td> <td class="description-td">// test next byte for CB</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">L3:</td> <td class="description-td">// continue for both</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">R(0)</td> <td class="description-td">// reset under both conditions (0E or 8C)</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">W(24, 60)</td> <td class="description-td">// search 24d bytes for 60h</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">L(09)</td> <td class="description-td">// test next byte after 60h for 09</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Enhancement to the CPRL
<br>
Introduction
<br>
CPRL is Fortinet's content pattern recognition language, it was originally designed to provide a flexible way to represent computer virus signatures. To make the best use of Fortinet's proprietary content scan technology (URL scan and keyword scan), it may be desirable to enhance CPRL to include more features than the original predicates, so that text patterns (English or foreign) can be represented using the same language. The benefit of doing so is to produce a unified language interface so that it can be implemented efficiently both by software codes and by hardware ASIC design.
<br>
To make it easy to understand, the enhancement of CPRL uses syntax similar to Regular Expression. The enhancement takes the form of a new predicates FRX( . . . ), which stands for Fortinet Regular Expression, syntax as follows:
<br>
Grammar
</p> <ul> <li id="ul0009-0001" num="0000"> <ul> <li id="ul0010-0001" num="0121">1. Single Character Metacharacters</li> <li id="ul0010-0002" num="0122">. matches any one character</li> <li id="ul0010-0003" num="0123">[ . . . ] matches any characters listed between the brackets</li> <li id="ul0010-0004" num="0124">[^ . . . ] matches any character except those listed between the brackets</li> <li id="ul0010-0005" num="0125">2. Quantifiers</li> <li id="ul0010-0006" num="0126">? matches any character zero or one time</li> <li id="ul0010-0007" num="0127">* matches the preceding element zero or more times</li> <li id="ul0010-0008" num="0128">+ matches the preceding element one or more times</li> <li id="ul0010-0009" num="0129">{num} matches the preceding element num times</li> <li id="ul0010-0010" num="0130">{min,max}matches the preceding element between min and max times</li> <li id="ul0010-0011" num="0131">3. anchors</li> <li id="ul0010-0012" num="0132">^ matches at the start of the line</li> <li id="ul0010-0013" num="0133">$ matches at the end of the line</li> <li id="ul0010-0014" num="0134">4. Escape characters</li> <li id="ul0010-0015" num="0135">\ Escape</li> <li id="ul0010-0016" num="0136">5. Logical operators</li> <li id="ul0010-0017" num="0137">| logical OR
<br>
Examples
<br>
FRX(“badsite\.com”)
</li> <li id="ul0010-0018" num="0138">matches exact string ‘badsite.com’
<br>
FRX(“badsite[0-9]\.com”)
</li> <li id="ul0010-0019" num="0139">Matches badsite followed by a number and then ‘.com’, for example
<br>
‘badsite1.com’, ‘badsite2.com’, etc.
<br>
FRX(“badsite[s]?\.com”)
</li> <li id="ul0010-0020" num="0140">Matches ‘badsite.com’ or ‘badsites.com’.
<br>
FRX(“badsite\.com$”)
</li> <li id="ul0010-0021" num="0141">Matches any string that end with ‘badsite.com’, such as ‘www.badsite.com’,
<br>
‘ftp.badsite.com’, etc.
<br>
FRX(“(bad|worse)site\.com”)
</li> <li id="ul0010-0022" num="0142">Matches ‘badsite.com’ or ‘worsesite.com’.</li> </ul> </li> </ul> </div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5539659">US5539659</a></td><td class="patent-data-table-td patent-date-value">Feb 18, 1994</td><td class="patent-data-table-td patent-date-value">Jul 23, 1996</td><td class="patent-data-table-td ">Hewlett-Packard Company</td><td class="patent-data-table-td ">Network analysis method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5557742">US5557742</a></td><td class="patent-data-table-td patent-date-value">Mar 7, 1994</td><td class="patent-data-table-td patent-date-value">Sep 17, 1996</td><td class="patent-data-table-td ">Haystack Labs, Inc.</td><td class="patent-data-table-td ">Method and system for detecting intrusion into and misuse of a data processing system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5790799">US5790799</a></td><td class="patent-data-table-td patent-date-value">Jun 9, 1997</td><td class="patent-data-table-td patent-date-value">Aug 4, 1998</td><td class="patent-data-table-td ">Digital Equipment Corporation</td><td class="patent-data-table-td ">System for sampling network packets by only storing the network packet that its error check code matches with the reference error check code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5892348">US5892348</a></td><td class="patent-data-table-td patent-date-value">Jun 26, 1997</td><td class="patent-data-table-td patent-date-value">Apr 6, 1999</td><td class="patent-data-table-td ">Switched Reluctance Drives Limited</td><td class="patent-data-table-td ">Matrix interpolation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5946487">US5946487</a></td><td class="patent-data-table-td patent-date-value">Jun 10, 1996</td><td class="patent-data-table-td patent-date-value">Aug 31, 1999</td><td class="patent-data-table-td ">Lsi Logic Corporation</td><td class="patent-data-table-td ">Object-oriented multi-media architecture</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5991881">US5991881</a></td><td class="patent-data-table-td patent-date-value">Nov 8, 1996</td><td class="patent-data-table-td patent-date-value">Nov 23, 1999</td><td class="patent-data-table-td ">Harris Corporation</td><td class="patent-data-table-td ">Network surveillance system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6009467">US6009467</a></td><td class="patent-data-table-td patent-date-value">Aug 29, 1997</td><td class="patent-data-table-td patent-date-value">Dec 28, 1999</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">System for checking status of supported functions of communication platforms at preselected intervals in order to allow hosts to obtain updated list of all supported functions</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6067575">US6067575</a></td><td class="patent-data-table-td patent-date-value">Dec 8, 1995</td><td class="patent-data-table-td patent-date-value">May 23, 2000</td><td class="patent-data-table-td ">Sun Microsystems, Inc.</td><td class="patent-data-table-td ">System and method for generating trusted, architecture specific, compiled versions of architecture neutral programs</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6119175">US6119175</a></td><td class="patent-data-table-td patent-date-value">Jun 8, 1998</td><td class="patent-data-table-td patent-date-value">Sep 12, 2000</td><td class="patent-data-table-td ">General Electric Company</td><td class="patent-data-table-td ">On-chip communication circuit and protocol for microcontroller-based ASICs</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6279113">US6279113</a></td><td class="patent-data-table-td patent-date-value">Jun 4, 1998</td><td class="patent-data-table-td patent-date-value">Aug 21, 2001</td><td class="patent-data-table-td ">Internet Tools, Inc.</td><td class="patent-data-table-td ">Dynamic signature inspection-based network intrusion detection</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6338141">US6338141</a></td><td class="patent-data-table-td patent-date-value">Sep 30, 1998</td><td class="patent-data-table-td patent-date-value">Jan 8, 2002</td><td class="patent-data-table-td ">Cybersoft, Inc.</td><td class="patent-data-table-td ">Method and apparatus for computer virus detection, analysis, and removal in real time</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6453345">US6453345</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 7, 1997</td><td class="patent-data-table-td patent-date-value">Sep 17, 2002</td><td class="patent-data-table-td ">Datadirect Networks, Inc.</td><td class="patent-data-table-td ">Network security and surveillance system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6513122">US6513122</a></td><td class="patent-data-table-td patent-date-value">Jun 29, 2001</td><td class="patent-data-table-td patent-date-value">Jan 28, 2003</td><td class="patent-data-table-td ">Networks Associates Technology, Inc.</td><td class="patent-data-table-td ">Secure gateway for analyzing textual content to identify a harmful impact on computer systems with known vulnerabilities</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6519703">US6519703</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 14, 2000</td><td class="patent-data-table-td patent-date-value">Feb 11, 2003</td><td class="patent-data-table-td ">James B. Joyce</td><td class="patent-data-table-td ">Methods and apparatus for heuristic firewall</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6637026">US6637026</a></td><td class="patent-data-table-td patent-date-value">Mar 1, 2000</td><td class="patent-data-table-td patent-date-value">Oct 21, 2003</td><td class="patent-data-table-td ">Intel Corporation</td><td class="patent-data-table-td ">Instruction reducing predicate copy</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6654882">US6654882</a></td><td class="patent-data-table-td patent-date-value">May 24, 2002</td><td class="patent-data-table-td patent-date-value">Nov 25, 2003</td><td class="patent-data-table-td ">Rackspace, Ltd</td><td class="patent-data-table-td ">Network security system protecting against disclosure of information to unauthorized agents</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6826697">US6826697</a></td><td class="patent-data-table-td patent-date-value">Aug 30, 2000</td><td class="patent-data-table-td patent-date-value">Nov 30, 2004</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">System and method for detecting buffer overflow attacks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7181765">US7181765</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 12, 2001</td><td class="patent-data-table-td patent-date-value">Feb 20, 2007</td><td class="patent-data-table-td ">Motorola, Inc.</td><td class="patent-data-table-td ">Method and apparatus for providing node security in a router of a packet network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7181769">US7181769</a></td><td class="patent-data-table-td patent-date-value">Jun 6, 2003</td><td class="patent-data-table-td patent-date-value">Feb 20, 2007</td><td class="patent-data-table-td ">Ncircle Network Security, Inc.</td><td class="patent-data-table-td ">Network security system having a device profiler communicatively coupled to a traffic monitor</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7185368">US7185368</a></td><td class="patent-data-table-td patent-date-value">Nov 30, 2001</td><td class="patent-data-table-td patent-date-value">Feb 27, 2007</td><td class="patent-data-table-td ">Lancope, Inc.</td><td class="patent-data-table-td ">Flow-based detection of network intrusions</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20010042214">US20010042214</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 6, 2001</td><td class="patent-data-table-td patent-date-value">Nov 15, 2001</td><td class="patent-data-table-td ">Radatti Peter V.</td><td class="patent-data-table-td ">Apparatus and methods for intercepting, examining and controlling code, data and files and their transfer</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20020094090">US20020094090</a></td><td class="patent-data-table-td patent-date-value">Dec 12, 2001</td><td class="patent-data-table-td patent-date-value">Jul 18, 2002</td><td class="patent-data-table-td ">Yoichiro Iino</td><td class="patent-data-table-td ">Information recording medium, information processing apparatus and method, program recording medium, and information processing system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20020188839">US20020188839</a></td><td class="patent-data-table-td patent-date-value">Jun 13, 2001</td><td class="patent-data-table-td patent-date-value">Dec 12, 2002</td><td class="patent-data-table-td ">Noehring Lee P.</td><td class="patent-data-table-td ">Method and system for high-speed processing IPSec security protocol packets</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20030004689">US20030004689</a></td><td class="patent-data-table-td patent-date-value">Jun 13, 2002</td><td class="patent-data-table-td patent-date-value">Jan 2, 2003</td><td class="patent-data-table-td ">Gupta Ramesh M.</td><td class="patent-data-table-td ">Hierarchy-based method and apparatus for detecting attacks on a computer system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20030014662">US20030014662</a></td><td class="patent-data-table-td patent-date-value">Jun 13, 2002</td><td class="patent-data-table-td patent-date-value">Jan 16, 2003</td><td class="patent-data-table-td ">Gupta Ramesh M.</td><td class="patent-data-table-td ">Protocol-parsing state machine and method of using same</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20030061496">US20030061496</a></td><td class="patent-data-table-td patent-date-value">Sep 26, 2001</td><td class="patent-data-table-td patent-date-value">Mar 27, 2003</td><td class="patent-data-table-td ">Mohan Ananda</td><td class="patent-data-table-td ">Method and apparatus for performing secure communications</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20030145228">US20030145228</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 31, 2002</td><td class="patent-data-table-td patent-date-value">Jul 31, 2003</td><td class="patent-data-table-td ">Janne Suuronen</td><td class="patent-data-table-td ">System and method of providing virus protection at a gateway</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20050021613">US20050021613</a></td><td class="patent-data-table-td patent-date-value">Jul 13, 2004</td><td class="patent-data-table-td patent-date-value">Jan 27, 2005</td><td class="patent-data-table-td ">Softricity, Inc.</td><td class="patent-data-table-td ">Method and apparatus for content protection in a secure content delivery system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20050251570">US20050251570</a></td><td class="patent-data-table-td patent-date-value">Apr 2, 2003</td><td class="patent-data-table-td patent-date-value">Nov 10, 2005</td><td class="patent-data-table-td ">John Heasman</td><td class="patent-data-table-td ">Intrusion detection system</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">Non-Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">Reference</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">"<a href='http://scholar.google.com/scholar?q="U.S.+Appl.+No.+10%2F624%2C452%2C+Final+Office+Action+Mailed+Oct.+17%2C+2008"'>U.S. Appl. No. 10/624,452, Final Office Action Mailed Oct. 17, 2008</a>", FOAR, 2pgs.</td></tr><tr><td class="patent-data-table-td ">2</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">"<a href='http://scholar.google.com/scholar?q="U.S.+Appl.+No.+10%2F624%2C452%2C+Response+filed+Jul.+30%2C+2008+to+Non-Final+Office+Action+mailed+Apr.+30%2C+2008"'>U.S. Appl. No. 10/624,452, Response filed Jul. 30, 2008 to Non-Final Office Action mailed Apr. 30, 2008</a>", 10 pgs.</td></tr><tr><td class="patent-data-table-td ">3</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">U.S. Appl. No. 10/624,914 Final Office Action mailed Jul. 10, 2008, FOAR, 17 PgS.</td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Referenced by</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Citing Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7797421">US7797421</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 15, 2006</td><td class="patent-data-table-td patent-date-value">Sep 14, 2010</td><td class="patent-data-table-td ">Amazon Technologies, Inc.</td><td class="patent-data-table-td ">Method and system for determining and notifying users of undesirable network content</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8140660">US8140660</a></td><td class="patent-data-table-td patent-date-value">Jul 21, 2003</td><td class="patent-data-table-td patent-date-value">Mar 20, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Content pattern recognition language processor and methods of using the same</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8239949">US8239949</a></td><td class="patent-data-table-td patent-date-value">Mar 13, 2009</td><td class="patent-data-table-td patent-date-value">Aug 7, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Managing network traffic flow</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8244863">US8244863</a></td><td class="patent-data-table-td patent-date-value">Jan 5, 2012</td><td class="patent-data-table-td patent-date-value">Aug 14, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Content pattern recognition language processor and methods of using the same</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8331234">US8331234</a></td><td class="patent-data-table-td patent-date-value">Sep 9, 2004</td><td class="patent-data-table-td patent-date-value">Dec 11, 2012</td><td class="patent-data-table-td ">Q1 Labs Inc.</td><td class="patent-data-table-td ">Network data flow collection and processing</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8385684">US8385684</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Feb 17, 2011</td><td class="patent-data-table-td patent-date-value">Feb 26, 2013</td><td class="patent-data-table-td ">Legend3D, Inc.</td><td class="patent-data-table-td ">System and method for minimal iteration workflow for image sequence depth enhancement</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8528086">US8528086</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 31, 2005</td><td class="patent-data-table-td patent-date-value">Sep 3, 2013</td><td class="patent-data-table-td ">Fireeye, Inc.</td><td class="patent-data-table-td ">System and method of detecting computer worms</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8539582">US8539582</a></td><td class="patent-data-table-td patent-date-value">Mar 12, 2007</td><td class="patent-data-table-td patent-date-value">Sep 17, 2013</td><td class="patent-data-table-td ">Fireeye, Inc.</td><td class="patent-data-table-td ">Malware containment and security analysis on connection</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8565093">US8565093</a></td><td class="patent-data-table-td patent-date-value">Jul 28, 2011</td><td class="patent-data-table-td patent-date-value">Oct 22, 2013</td><td class="patent-data-table-td ">Palo Alto Networks, Inc.</td><td class="patent-data-table-td ">Packet classification in a network security device</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8614955">US8614955</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 22, 2009</td><td class="patent-data-table-td patent-date-value">Dec 24, 2013</td><td class="patent-data-table-td ">Ixia</td><td class="patent-data-table-td ">Misdirected packet detection apparatus and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8635696">US8635696</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 28, 2013</td><td class="patent-data-table-td patent-date-value">Jan 21, 2014</td><td class="patent-data-table-td ">Fireeye, Inc.</td><td class="patent-data-table-td ">System and method of detecting time-delayed malicious traffic</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8654643">US8654643</a></td><td class="patent-data-table-td patent-date-value">Jul 27, 2011</td><td class="patent-data-table-td patent-date-value">Feb 18, 2014</td><td class="patent-data-table-td ">Ixia</td><td class="patent-data-table-td ">Wide field indexing for packet tracking</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8654654">US8654654</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 22, 2009</td><td class="patent-data-table-td patent-date-value">Feb 18, 2014</td><td class="patent-data-table-td ">Ixia</td><td class="patent-data-table-td ">Traffic distribution control</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8719255">US8719255</a></td><td class="patent-data-table-td patent-date-value">Sep 28, 2005</td><td class="patent-data-table-td patent-date-value">May 6, 2014</td><td class="patent-data-table-td ">Amazon Technologies, Inc.</td><td class="patent-data-table-td ">Method and system for determining interest levels of online content based on rates of change of content access</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8776229">US8776229</a></td><td class="patent-data-table-td patent-date-value">Aug 28, 2013</td><td class="patent-data-table-td patent-date-value">Jul 8, 2014</td><td class="patent-data-table-td ">Fireeye, Inc.</td><td class="patent-data-table-td ">System and method of detecting malicious traffic while reducing false positives</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8788650">US8788650</a></td><td class="patent-data-table-td patent-date-value">Jul 21, 2003</td><td class="patent-data-table-td patent-date-value">Jul 22, 2014</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Hardware based detection devices for detecting network traffic content and methods of using the same</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8789183">US8789183</a></td><td class="patent-data-table-td patent-date-value">Jul 21, 2003</td><td class="patent-data-table-td patent-date-value">Jul 22, 2014</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Detecting network traffic content</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20110069620">US20110069620</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 22, 2009</td><td class="patent-data-table-td patent-date-value">Mar 24, 2011</td><td class="patent-data-table-td ">Noah Gintis</td><td class="patent-data-table-td ">Misdirected Packet Detection Apparatus and Method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20110069622">US20110069622</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 22, 2009</td><td class="patent-data-table-td patent-date-value">Mar 24, 2011</td><td class="patent-data-table-td ">Noah Gintis</td><td class="patent-data-table-td ">Traffic Distribution Control</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20120120054">US20120120054</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Feb 17, 2011</td><td class="patent-data-table-td patent-date-value">May 17, 2012</td><td class="patent-data-table-td ">Jared Sandrew</td><td class="patent-data-table-td ">System and method for minimal iteration workflow for image sequence depth enhancement</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc726/defs726.htm&usg=AFQjCNG_-XRx1vivcRvidgiM5InbyBytrA#C726S013000">726/13</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc713/defs713.htm&usg=AFQjCNFeqk7obddJAU0rkLD-4_57iwcWXA#C713S154000">713/154</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0021000000">G06F21/00</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/145">H04L63/145</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/0236">H04L63/0236</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L43/04">H04L43/04</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=Utm0BQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/1425">H04L63/1425</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">H04L63/02B1</span>, <span class="nested-value">H04L63/14D1</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">Jun 5, 2012</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">4</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">May 31, 2011</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">THE PATENTABILITY OF CLAIMS 19-23, 25-31, 34, 35, 38-43, 46 AND 47 IS CONFIRMED. CLAIMS 1-18, 24, 32, 33, 36, 37, 44 AND 45 ARE CANCELLED.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jun 15, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100331</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Aug 18, 2009</td><td class="patent-data-table-td ">CC</td><td class="patent-data-table-td ">Certificate of correction</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_8a2b04e7bf975d5171d8e4c0b6365c7a.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U0uaejxocZhEQjmezAmhw94jbB2qw\u0026id=Utm0BQABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U3cdfsK2Xe35PDbyljzdG4rGD8SEQ\u0026id=Utm0BQABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U2dykwi-GoO8Gt2c0HtGDBe9bYPRg","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/Managing_network_traffic_flow.pdf?id=Utm0BQABERAJ\u0026output=pdf\u0026sig=ACfU3U1Lb4c7AdIMsjbgKH01ryUj3oOtJA"},"sample_url":"http://www.google.com/patents/reader?id=Utm0BQABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>