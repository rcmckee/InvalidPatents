<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US6516236 - Motion control systems - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_8a2b04e7bf975d5171d8e4c0b6365c7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_8a2b04e7bf975d5171d8e4c0b6365c7a__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Motion control systems"><meta name="DC.contributor" content="David W. Brown" scheme="inventor"><meta name="DC.contributor" content="Jay S. Clark" scheme="inventor"><meta name="DC.contributor" content="Roy-G-Biv Corporation" scheme="assignee"><meta name="DC.date" content="2001-12-10" scheme="dateSubmitted"><meta name="DC.description" content="A system for motion control in which an application is developed that is independent from the actual motion control hardware used to implement the system. The system comprises a software system that employs an application programming interface comprising component functions and a service provider interface comprising driver functions. A system programmer writes an application that calls the component functions. Code associated with the component functions relates these functions to the driver functions. A hardware designer writes driver code that implements the driver functions on a given motion control hardware product. The driver functions are separated into core and extended driver functions. All software drivers implement the core driver functions, while the software drivers need not contain code for implementing the extended driver functions. If the software driver does not contain code to implement an extended driver function, the functionality of the extended driver function is obtained through a combination of core driver functions. The system programmer may also select one or more streams that allow the control commands to be communicated to, and response data to be communicated from, motion control hardware."><meta name="DC.date" content="2003-2-4" scheme="issued"><meta name="DC.relation" content="EP:0275826:A1" scheme="references"><meta name="DC.relation" content="EP:0281427:A2" scheme="references"><meta name="DC.relation" content="EP:0442676:A2" scheme="references"><meta name="DC.relation" content="EP:0508912:A1" scheme="references"><meta name="DC.relation" content="EP:0583908:A2" scheme="references"><meta name="DC.relation" content="GB:2224896" scheme="references"><meta name="DC.relation" content="JP:S59228473" scheme="references"><meta name="DC.relation" content="US:4159417" scheme="references"><meta name="DC.relation" content="US:4418381" scheme="references"><meta name="DC.relation" content="US:4531182" scheme="references"><meta name="DC.relation" content="US:4713808" scheme="references"><meta name="DC.relation" content="US:4767334" scheme="references"><meta name="DC.relation" content="US:4809335" scheme="references"><meta name="DC.relation" content="US:4840602" scheme="references"><meta name="DC.relation" content="US:4846693" scheme="references"><meta name="DC.relation" content="US:4855725" scheme="references"><meta name="DC.relation" content="US:4857030" scheme="references"><meta name="DC.relation" content="US:4887966" scheme="references"><meta name="DC.relation" content="US:4897835" scheme="references"><meta name="DC.relation" content="US:4937737" scheme="references"><meta name="DC.relation" content="US:5095445" scheme="references"><meta name="DC.relation" content="US:5120065" scheme="references"><meta name="DC.relation" content="US:5126932" scheme="references"><meta name="DC.relation" content="US:5168441" scheme="references"><meta name="DC.relation" content="US:5175817" scheme="references"><meta name="DC.relation" content="US:5245703" scheme="references"><meta name="DC.relation" content="US:5247650" scheme="references"><meta name="DC.relation" content="US:5377258" scheme="references"><meta name="DC.relation" content="US:5390330" scheme="references"><meta name="DC.relation" content="US:5392207" scheme="references"><meta name="DC.relation" content="US:5402518" scheme="references"><meta name="DC.relation" content="US:5412757" scheme="references"><meta name="DC.relation" content="US:5450079" scheme="references"><meta name="DC.relation" content="US:5453933" scheme="references"><meta name="DC.relation" content="US:5465215" scheme="references"><meta name="DC.relation" content="US:5491813" scheme="references"><meta name="DC.relation" content="US:5493281" scheme="references"><meta name="DC.relation" content="US:5596994" scheme="references"><meta name="DC.relation" content="US:5604843" scheme="references"><meta name="DC.relation" content="US:5607336" scheme="references"><meta name="DC.relation" content="US:5608894" scheme="references"><meta name="DC.relation" content="US:5617528" scheme="references"><meta name="DC.relation" content="US:5636994" scheme="references"><meta name="DC.relation" content="US:5652866" scheme="references"><meta name="DC.relation" content="US:5655945" scheme="references"><meta name="DC.relation" content="US:5666161" scheme="references"><meta name="DC.relation" content="US:5670992" scheme="references"><meta name="DC.relation" content="US:5707289" scheme="references"><meta name="DC.relation" content="US:5733131" scheme="references"><meta name="DC.relation" content="US:5737523" scheme="references"><meta name="DC.relation" content="US:5746602" scheme="references"><meta name="DC.relation" content="US:5752880" scheme="references"><meta name="DC.relation" content="US:5764155" scheme="references"><meta name="DC.relation" content="US:5790178" scheme="references"><meta name="DC.relation" content="US:5800268" scheme="references"><meta name="DC.relation" content="US:5801946" scheme="references"><meta name="DC.relation" content="US:5846132" scheme="references"><meta name="DC.relation" content="US:5867385" scheme="references"><meta name="DC.relation" content="US:5907704" scheme="references"><meta name="DC.relation" content="US:5914876" scheme="references"><meta name="DC.relation" content="WO:1992011731:A2" scheme="references"><meta name="DC.relation" content="WO:1993008654:A1" scheme="references"><meta name="DC.relation" content="WO:1995007504:A1" scheme="references"><meta name="citation_reference" content="&quot;Requirements of Open Modular Architecture Controllers for Applications in the Automotive Industry&quot;; pub. Dec. 13, 1994; pp. 1-13."><meta name="citation_reference" content="&quot;Technologies Enabling Agile Manufacturing (TEAM) Intelligent Closed Loop Processing&quot;; pub. Jan. 11, 1996; 30 pages."><meta name="citation_reference" content="Aerotech Motion Control Product Guide; pp. 233-234."><meta name="citation_reference" content="Aimax-Win Product Brochure, TA Engineering Co., Inc.; 8 pages."><meta name="citation_reference" content="Altintas et al.; &quot;Design and Analysis of a Modular CNC System&quot;; pub. Mar. 4, 1990; pp. 305-316."><meta name="citation_reference" content="Chu and Wang; &quot;Development of a Practical SFC System for CNC Machine Shop&quot;; pub. 1994; pp. 362-367."><meta name="citation_reference" content="Compumotor Digiplan (1993-94) Catalog pp. 10-11."><meta name="citation_reference" content="ExperTune PID Tuning Software, Gerry Engineering Software; 6 pages."><meta name="citation_reference" content="Fedrowitz; IRL-Based Expansion of the Commonly Used High-Level Language C for Robot Programming: pub. Oct. 1995; 5 pages."><meta name="citation_reference" content="FIX Product Brochure, Intellution (1994); 6 pages."><meta name="citation_reference" content="Jackman; &quot;Robotic Control Using Sequential Function Charts&quot;; pub. 1996; pp. 120-128."><meta name="citation_reference" content="McGraw et al.; &quot;A Friendly Command, Control, and Information System for Astronomy&quot;; pub. 1996; pp. 356-367."><meta name="citation_reference" content="Microsoft; &quot;Object Linking and Embedding 2.0 Backgrounder&quot;; pub. Sep. 1993; pp. 1-15."><meta name="citation_reference" content="Microsoft; &quot;Open Systems: Technology, Leadership, and Collaboration&quot;; pub. Mar. 1994; pp. 1-15."><meta name="citation_reference" content="Microsoft; &quot;The Microsoft Object Technology Strategy&quot;; pub. Mar. 1994; pp. 1-33."><meta name="citation_reference" content="Microsoft; Microsoft OLE Today and Tomorrow: Technology Overview; pub. Dec. 1993; pp. 1-9."><meta name="citation_reference" content="Open, Modular Architecture Controls at GM Powertrain; pub. May 14, 1996; pp. 1-33."><meta name="citation_reference" content="OpenBatch Product Brief, PID, Inc.; 6 pages."><meta name="citation_reference" content="Oregon Micro Systems Product Guide: pp. 1-20."><meta name="citation_reference" content="Paragon TNT Product Brochure, Intec Controls Corp.; 6 pages."><meta name="citation_reference" content="PC/DSP-Series Motion Controller C Programming Guide; pp. 1-54."><meta name="citation_reference" content="PMAC Product Catalog, p. 43."><meta name="citation_reference" content="Precision Motion Controls Product Guide; p. 17."><meta name="citation_reference" content="Pritschow et al.; &quot;Open System Controllers: Challenge for the Future of the Machine Tool Industry&quot;; pub. Jan. 15, 1993; pp. 449-452."><meta name="citation_reference" content="Proctor et al.; &quot;Validation of Standard Interfaces from a Machine Control&quot;; pub. 1996; pp. 659-664."><meta name="citation_reference" content="Robert Anderson; &quot;SMART: A Modular Architecture for Robotics and Teleoperation&quot;; pub. 1993; pp. 416-421."><meta name="citation_reference" content="Software Products for Industrial Automation, ICONICS; 6 pages."><meta name="citation_reference" content="Sperling et al.; &quot;Enabling Open Control Systems: An Introduction to the OSACA System Platform&quot;; pub. May 1996; pp. 1-8."><meta name="citation_reference" content="Sue Chen, Jonathon Lin; &quot;Computer Numerical Control: Essentials in Programming and Networking&quot;; Part 5, Chapter 27; pp. 824-848."><meta name="citation_reference" content="The Complete, Computer-Based Automation Tool (IGSS) Seven Technologies A/S; 6 pages."><meta name="citation_reference" content="Web 3.0 Product Brochure, Trihedral Engineering Ltd. (1994); 6 pages."><meta name="citation_reference" content="William E. Ford; &quot;What Is an Open Architecture Robot Controller&quot;pub. Aug. 16, 1994; pp. 27-32."><meta name="citation_reference" content="Wosa Backgrounder: Delivering Enterprise Services to the Windows-based Desktop, Jul. 1993, Microsoft Development Library; pp. 1-19."><meta name="citation_reference" content="Wosa Inside Windows 95; pp. 348-351."><meta name="citation_reference" content="Wright et al.; &quot;Open Architecture Manufacturing: The Impact of Open-System Computers on Self-sustaining Machinery and the Machine Tool Industry&quot;; pp. 41-47."><meta name="citation_reference" content="Xanalog Model NL-SIM Product Brochure, Xanalog, 4 pages."><meta name="citation_patent_number" content="US:6516236"><meta name="citation_patent_application_number" content="US:10/021,669"><link rel="canonical" href="http://www.google.com/patents/US6516236"/><meta property="og:url" content="http://www.google.com/patents/US6516236"/><meta name="title" content="Patent US6516236 - Motion control systems"/><meta name="description" content="A system for motion control in which an application is developed that is independent from the actual motion control hardware used to implement the system. The system comprises a software system that employs an application programming interface comprising component functions and a service provider interface comprising driver functions. A system programmer writes an application that calls the component functions. Code associated with the component functions relates these functions to the driver functions. A hardware designer writes driver code that implements the driver functions on a given motion control hardware product. The driver functions are separated into core and extended driver functions. All software drivers implement the core driver functions, while the software drivers need not contain code for implementing the extended driver functions. If the software driver does not contain code to implement an extended driver function, the functionality of the extended driver function is obtained through a combination of core driver functions. The system programmer may also select one or more streams that allow the control commands to be communicated to, and response data to be communicated from, motion control hardware."/><meta property="og:title" content="Patent US6516236 - Motion control systems"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("SI3tU5LQNIHygwTalICACA"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407723702.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("GRC"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("SI3tU5LQNIHygwTalICACA"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407723702.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("GRC"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us6516236?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US6516236"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=tZdeBAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS6516236&amp;usg=AFQjCNFhmgc7HELCWj4C0sL6LXEoapJM0w" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US6516236.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US6516236.pdf"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US6516236" style="display:none"><span itemprop="description">A system for motion control in which an application is developed that is independent from the actual motion control hardware used to implement the system. The system comprises a software system that employs an application programming interface comprising component functions and a service provider interface...</span><span itemprop="url">http://www.google.com/patents/US6516236?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US6516236 - Motion control systems</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US6516236 - Motion control systems" title="Patent US6516236 - Motion control systems"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US6516236 B1</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 10/021,669</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Feb 4, 2003</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">Dec 10, 2001</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">May 30, 1995</td></tr><tr><td class="patent-bibdata-heading">Fee status<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The fee status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status or dates listed."></span></td><td class="single-patent-bibdata">Paid</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Also published as</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CA2222235A1">CA2222235A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/CA2222235C">CA2222235C</a>, </span><span class="patent-bibdata-value"><a href="/patents/CA2705404A1">CA2705404A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/DE69624237D1">DE69624237D1</a>, </span><span class="patent-bibdata-value"><a href="/patents/DE69624237T2">DE69624237T2</a>, </span><span class="patent-bibdata-value"><a href="/patents/DE69635094D1">DE69635094D1</a>, </span><span class="patent-bibdata-value"><a href="/patents/DE69635094T2">DE69635094T2</a>, </span><span class="patent-bibdata-value"><a href="/patents/DE69637633D1">DE69637633D1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP0829039A1">EP0829039A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP0829039A4">EP0829039A4</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP0829039B1">EP0829039B1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1260891A1">EP1260891A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1260891B1">EP1260891B1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1560093A1">EP1560093A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1560093B1">EP1560093B1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2081094A2">EP2081094A2</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2081094A3">EP2081094A3</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2302475A2">EP2302475A2</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2302475A3">EP2302475A3</a>, </span><span class="patent-bibdata-value"><a href="/patents/US5691897">US5691897</a>, </span><span class="patent-bibdata-value"><a href="/patents/US5867385">US5867385</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8073557">US8073557</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20080275576">US20080275576</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20080275577">US20080275577</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20090157199">US20090157199</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20090271007">US20090271007</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20120179275">US20120179275</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO1996038769A1">WO1996038769A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">021669, </span><span class="patent-bibdata-value">10021669, </span><span class="patent-bibdata-value">US 6516236 B1, </span><span class="patent-bibdata-value">US 6516236B1, </span><span class="patent-bibdata-value">US-B1-6516236, </span><span class="patent-bibdata-value">US6516236 B1, </span><span class="patent-bibdata-value">US6516236B1</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22David+W.+Brown%22">David W. Brown</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Jay+S.+Clark%22">Jay S. Clark</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Roy-G-Biv+Corporation%22">Roy-G-Biv Corporation</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US6516236.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US6516236.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US6516236.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (63),</span> <span class="patent-bibdata-value"><a href="#npl-citations">Non-Patent Citations</a> (36),</span> <span class="patent-bibdata-value"><a href="#forward-citations">Referenced by</a> (19),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (26),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (7)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/6516236&usg=AFQjCNE9ocgUx33pGB0WcEXqMo-PpvPvBQ">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D6516236&usg=AFQjCNFMIlaMEeRvfctGzT_GMDnSMTqi7Q">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D6516236B1%26KC%3DB1%26FT%3DD&usg=AFQjCNECSxD87NQqU8W9hkcR2mPHhB68mg">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT55054027" lang="EN" load-source="patent-office">Motion control systems</invention-title></span><br><span class="patent-number">US 6516236 B1</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA50445864" lang="EN" load-source="patent-office"> <div class="abstract">A system for motion control in which an application is developed that is independent from the actual motion control hardware used to implement the system. The system comprises a software system that employs an application programming interface comprising component functions and a service provider interface comprising driver functions. A system programmer writes an application that calls the component functions. Code associated with the component functions relates these functions to the driver functions. A hardware designer writes driver code that implements the driver functions on a given motion control hardware product. The driver functions are separated into core and extended driver functions. All software drivers implement the core driver functions, while the software drivers need not contain code for implementing the extended driver functions. If the software driver does not contain code to implement an extended driver function, the functionality of the extended driver function is obtained through a combination of core driver functions. The system programmer may also select one or more streams that allow the control commands to be communicated to, and response data to be communicated from, motion control hardware.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(65)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00000.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00000.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00001.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00001.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00002.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00002.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00003.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00003.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00004.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00004.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00005.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00005.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00006.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00006.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00007.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00007.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00008.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00008.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00009.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00009.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00010.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00010.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00011.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00011.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00012.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00012.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00013.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00013.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00014.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00014.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00015.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00015.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00016.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00016.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00017.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00017.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00018.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00018.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00019.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00019.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00020.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00020.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00021.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00021.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00022.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00022.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00023.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00023.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00024.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00024.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00025.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00025.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00026.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00026.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00027.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00027.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00028.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00028.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00029.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00029.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00030.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00030.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00031.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00031.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00032.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00032.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00033.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00033.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00034.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00034.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00035.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00035.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00036.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00036.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00037.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00037.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00038.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00038.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00039.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00039.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00040.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00040.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00041.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00041.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00042.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00042.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00043.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00043.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00044.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00044.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00045.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00045.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00046.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00046.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00047.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00047.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00048.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00048.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00049.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00049.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00050.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00050.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00051.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00051.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00052.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00052.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00053.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00053.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00054.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00054.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00055.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00055.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00056.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00056.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00057.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00057.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00058.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00058.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00059.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00059.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00060.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00060.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00061.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00061.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00062.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00062.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00063.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00063.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US6516236B1/US06516236-20030204-D00064.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US6516236B1/US06516236-20030204-D00064.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM8431550" lang="EN" load-source="patent-office" class="claims">
    <claim-statement>We claim: </claim-statement> <div class="claim"> <div num="1" id="US-6516236-B1-CLM-00001" class="claim">
      <div class="claim-text">1. A system for generating a sequence of control commands for controlling a selected motion control device selected from a group of supported motion control devices, comprising:</div>
      <div class="claim-text">a set of motion control operations, where each motion control operation is either a primitive operation the implementation of which is required to operate motion control devices and cannot be simulated using other motion control operations or a non-primitive operation that does not meet the definition of a primitive operation; </div>
      <div class="claim-text">a core set of core driver functions, where each core driver function is associated with one of the primitive operations; </div>
      <div class="claim-text">an extended set of extended driver functions, where each extended driver function is associated with one of the non-primitive operations; </div>
      <div class="claim-text">a set of component functions; </div>
      <div class="claim-text">component code associated with each of the component functions, where the component code associates at least some of the component functions with at least some of the driver functions; </div>
      <div class="claim-text">a set of software drivers, where </div>
      <div class="claim-text">each software driver is associated with one motion control device in the group of supported motion control devices, </div>
      <div class="claim-text">each software driver comprises driver code for implementing the motion control operations associated with at least some of the driver functions, and </div>
      <div class="claim-text">one of the software drivers in the set of software drivers is a selected software driver, where the selected software driver is the software driver associated with the selected motion control device; </div>
      <div class="claim-text">an application program comprising a series of component functions, where the application program defines the steps for operating motion control devices in a desired manner; and </div>
      <div class="claim-text">a motion control component for generating the sequence of control commands for controlling the selected motion control device based on the component functions of the application program, the component code associated with the component functions, and the driver code associated with the selected software driver. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" id="US-6516236-B1-CLM-00002" class="claim">
      <div class="claim-text">2. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00001">claim 1</claim-ref>, in which the software drivers comprise driver code for implementing all of the core driver functions.</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" id="US-6516236-B1-CLM-00003" class="claim">
      <div class="claim-text">3. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00002">claim 2</claim-ref>, in which the software drivers comprise driver code for implementing at least some of the extended driver functions.</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" id="US-6516236-B1-CLM-00004" class="claim">
      <div class="claim-text">4. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00003">claim 3</claim-ref>, in which:</div>
      <div class="claim-text">non-supported extended driver functions are extended driver functions having no driver code associated therewith; and </div>
      <div class="claim-text">the motion control component generates control commands based on the driver code associated with a combination of the core driver functions to emulate the motion control operations associated with at least some of the non-supported extended driver functions. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" id="US-6516236-B1-CLM-00005" class="claim">
      <div class="claim-text">5. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00004">claim 4</claim-ref>, further comprising:</div>
      <div class="claim-text">an extended function pointer table that maps the non-supported extended driver functions to the combination of core driver functions employed to emulate the non-supported extended functions; and </div>
      <div class="claim-text">the motion control component generates the control commands further based on the contents of the extended function pointer table. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" id="US-6516236-B1-CLM-00006" class="claim">
      <div class="claim-text">6. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00005">claim 5</claim-ref>, in which the extended function pointer table contains pointers for both supported and non-supported extended driver functions, where the pointers for the supported extended driver functions point to driver code for implementing the supported extended driver functions and the pointers for the non-supported extended driver functions point to the combination of core driver functions that emulate the non-supported extended functions.</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" id="US-6516236-B1-CLM-00007" class="claim">
      <div class="claim-text">7. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00001">claim 1</claim-ref>, further comprising:</div>
      <div class="claim-text">means for determining a driver unit system employed by the software drivers; and </div>
      <div class="claim-text">means for converting an application unit system employed by the application program into the driver unit system. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" id="US-6516236-B1-CLM-00008" class="claim">
      <div class="claim-text">8. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00001">claim 1</claim-ref>, further comprising:</div>
      <div class="claim-text">a plurality of destinations of control commands, with one of the plurality of destinations of control commands being a selected destination of control commands; </div>
      <div class="claim-text">a plurality of streams, where each stream contains transmit stream code that determines how the control commands are to be transferred to at least one of the plurality of destinations of control commands; and </div>
      <div class="claim-text">stream control means for communicating the control commands to the selected destination of control commands based on the transmit stream code contained by the stream associated with the selected destination of control commands. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" id="US-6516236-B1-CLM-00009" class="claim">
      <div class="claim-text">9. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00008">claim 8</claim-ref>, in which certain of the destinations of control commands generate response data, wherein:</div>
      <div class="claim-text">the streams associated with the destinations of control commands that generate response data are each associated with response stream code; and </div>
      <div class="claim-text">the stream control means processes the response data based on the response stream code. </div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" id="US-6516236-B1-CLM-00010" class="claim">
      <div class="claim-text">10. A system as recited in <claim-ref idref="US-6516236-B1-CLM-00001">claim 1</claim-ref>, further comprising a command format template and a response format template associated with each driver function, wherein: the motion control component further comprises:</div>
      <div class="claim-text">means for generating command data strings for controlling the selected motion control device based on the command format template and the application program; and </div>
      <div class="claim-text">means for parsing response data strings generated by the selected motion control device based on the response format template and the application program.</div>
    </div>
  </div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES53872337" lang="EN" load-source="patent-office" class="description">
    <heading>RELATED APPLICATIONS</heading> <p>This is a continuation of U.S. patent application Ser. No. 09/191,981 filed Nov. 13, 1998, which is a continuation of U.S. patent application Ser. No. 08/656,421 filed May 30, 1996 now U.S. Pat. No. 5,867,385, which is a continuation-in-part of U.S. patent application Ser. No. 08/454,736 filed May 30, 1995 now U.S. Pat. No. 5,691,897.</p>
    <heading>TECHNICAL FIELD</heading> <p>The present invention relates to motion control systems and, more particularly, to interface software that facilitates the creation of hardware independent motion control software.</p>
    <p>1. Background of the Invention</p>
    <p>The purpose of a motion control device is to move an object in a desired manner. The basic components of a motion control device are a controller and a mechanical system. The mechanical system translates signals generated by the controller into movement of an object.</p>
    <p>While the mechanical system commonly comprises a drive and an electrical motor, a number of other systems, such as hydraulic or vibrational systems, can be used to cause movement of an object based on a control signal. Additionally, it is possible for a motion control device to comprise a plurality of drives and motors to allow multi-axis control of the movement of the object.</p>
    <p>The present invention is of particular importance in the context of a mechanical system including at least one drive and electrical motor having a rotating shaft connected in some way to the object to be moved, and that application will be described in detail herein. But the principles of the present invention are generally applicable to any mechanical system that generates movement based on a control signal. The scope of the present invention should thus be determined based on the claims appended hereto and not the following detailed description.</p>
    <p>In a mechanical system comprising a controller, a drive, and an electrical motor, the motor is physically connected to the object to be moved such that rotation of the motor shaft is translated into movement of the object. The drive is an electronic power amplifier adapted to provide power to a motor to rotate the motor shaft in a controlled manner. Based on control commands, the controller controls the drive in a predictable manner such that the object is moved in the desired manner.</p>
    <p>These basic components are normally placed into a larger system to accomplish a specific task. For example, one controller may operate in conjunction with several drives and motors in a multi-axis system for moving a tool along a predetermined path relative to a workpiece.</p>
    <p>Additionally, the basic components described above are often used in conjunction with a host computer or programmable logic controller (PLC). The host computer or PLC allows the use of a high-level programming language to generate control commands that are passed to the controller. Software running on the host computer is thus designed to simplify the task of programming the controller.</p>
    <p>Companies that manufacture motion control devices are, traditionally, hardware oriented companies that manufacture software dedicated to the hardware that they manufacture. These software products may be referred to as low level programs. Low level programs usually work directly with the motion control command language specific to a given motion control device. While such low level programs offer the programmer substantially complete control over the hardware, these programs are highly hardware dependent.</p>
    <p>In contrast to low-level programs, high-level software programs, referred to sometimes as factory automation applications, allow a factory system designer to develop application programs that combine large numbers of input/output (I/O) devices, including motion control devices, into a complex system used to automate a factory floor environment. These factory automation applications allow any number of I/O devices to be used in a given system, as long as these devices are supported by the high-level program. Custom applications, developed by other software developers, cannot be developed to take advantage of the simple motion control functionality offered by the factory automation program.</p>
    <p>Additionally, these programs do not allow the programmer a great degree of control over the each motion control device in the system. Each program developed with a factory automation application must run within the context of that application.</p>
    <p>2. Prior Art</p>
    <p>In the following discussions, a number of documents are cited that are publicly available as of the filing date of the present invention. With many of these documents, the Applicant is not aware of exact publishing dates. The citation of these documents should thus not be considered an admission that they are prior art; the Applicant will take the steps necessary to establish whether these documents are prior art if necessary.</p>
    <p>As mentioned above, a number of software programs currently exist for programming individual motion control devices or for aiding in the development of systems containing a number of motion control devices.</p>
    <p>The following is a list of documents disclosing presently commercially available high-level software programs: (a) Software Products For Industrial Automation, iconics 1993; (b) The complete, computer-based automation tool (IGSS), Seven Technologies A/S; (c) OpenBatch Product Brief, PID, Inc.; (d) FIX Product Brochure, Intellution (1994); (e) Paragon TNT Product Brochure, Intec Controls Corp.; (f) WEB 3.0 Product Brochure, Trihedral Engineering Ltd. (1994); and (g) AIMAX-WIN Product Brochure, TA Engineering Co., Inc. The following documents disclose simulation software: (a) ExperTune PID Tuning Software, Gerry Engineering Software; and (b) XANALOG Model NL-SIM Product Brochure, XANALOG.</p>
    <p>The following list identifies documents related to low-level programs: (a) Compumotor Digiplan 1993-94 catalog, pages 10-11; (b) Aerotech Motion Control Product Guide, pages 233-34; (c) PMAC Product Catalog, page 43; (d) PC/DSP-Series Motion Controller C Programming Guide, pages 1-3; (e) Oregon Micro Systems Product Guide, page 17; (f) Precision Microcontrol Product Guide.</p>
    <p>The Applicants are also aware of a software model referred to as WOSA that has been defined by Microsoft for use in the Windows programming environment. The WOSA model is discussed in the book Inside Windows 95, on pages 348-351. WOSA is also discussed in the paper entitled WOSA Backgrounder: Delivering Enterprise Services to the Windows-based Desktop. The WOSA model isolates application programmers from the complexities of programming to different service providers by providing an API layer that is independent of an underlying hardware or service and an SPI layer that is hardware independent but service dependent. The WOSA model has no relation to motion control devices.</p>
    <p>The Applicants are also aware of the common programming practice in which drivers are provided for hardware such as printers or the like; an application program such as a word processor allows a user to select a driver associated with a given printer to allow the application program to print on that given printer.</p>
    <p>While this approach does isolates the application programmer from the complexities of programming to each hardware configuration in existence, this approach does not provide the application programmer with the ability to control the hardware in base incremental steps. In the printer example, an application programmer will not be able to control each stepper motor in the printer using the provided printer driver; instead, the printer driver will control a number of stepper motors in the printer in a predetermined sequence as necessary to implement a group of high level commands.</p>
    <p>The software driver model currently used for printers and the like is thus not applicable to the development of a sequence of control commands for motion control devices.</p>
    <heading>OBJECTS OF THE INVENTION</heading> <p>From the foregoing, it should be clear that one primary object of the invention is to provide improved methods and devices for moving objects.</p>
    <p>Another more specific object of the present invention is to obtain methods and apparatus for designing and deploying motion control devices in which these methods and apparatus exhibit a favorable mix of the following characteristics:</p>
    <p>(a) allow the creation of high-level motion control programs that are hardware independent, but offer programmability of base motion operations;</p>
    <p>(b) hide the complexities of programming for multiple hardware configurations from the high-level programmer;</p>
    <p>(c) can easily be extended to support additional hardware configurations; and</p>
    <p>(c) transparently supports industry standard high-level programming environments.</p>
    <heading>SUMMARY OF THE INVENTION</heading> <p>The present invention is, in one form, a method of moving an object comprising the steps of developing a high-level motion control application program comprising a sequence of component functions that describe a desired object path, correlating these component functions with driver functions, selecting a software driver for the specific hardware configuration being controlled, generating control commands from the driver functions and the software driver associated with the hardware configuration being controlled, and controlling a motion control device based on the control data to move the object along the desired object path.</p>
    <p>In another form, the present invention is a method of generating a sequence of control commands for controlling a motion control devices to move an object along a desired path. An application program comprising a series of component functions defines a sequence of motion steps that must be performed by the motion control device to move the object along the desired path. The component functions contain code that relates the component functions to driver functions. The driver functions are associated with, or contain, software drivers containing driver code for implementing the motion steps on a given motion control device. The control commands are generated based on the application program and the driver code associated with a given motion control device.</p>
    <p>The use of component functions that are separate from driver functions isolates the programmer from the complexities of programming to a specific motion control device. This arrangement also allows a given application program to be used without modification for any motion control device having a software driver associated therewith.</p>
    <p>The driver functions are grouped into core driver functions and extended driver functions. All software drivers must support the core driver functions; the software drivers may also support one or more of the extended driver functions, although this is not required.</p>
    <p>Where the software drivers do not support the extended driver functions, the functionality associated with the extended driver functions can normally be simulated using some combination of core driver functions. In this case, the method of the present invention comprises the steps of determining which of the extended driver functions are not supported by the software driver and, where possible, substituting a combination of core driver functions. In some cases, the functionality of an extended driver function cannot be emulated using core driver functions, and this functionality is simply unavailable to the programmer.</p>
    <p>The use of core driver functions to emulate extended driver functions provides functionality where none would otherwise exist, but the preferred approach is to provide a software driver that supports each of the extended driver functions. When an extended driver function is supported and not emulated, the task being performed will normally be accomplished more quickly and accurately.</p>
    <p>Additionally, to simplify the use of emulated extended driver functions, the method of the present invention further comprises the steps of determining which, if any, extended driver functions are not supported by the software driver for a given hardware configuration, developing a function pointer table of both unsupported extended driver functions and supported extended driver functions, and consulting the table each time an extended driver function is called to determine whether that extended driver function must be emulated. In this manner, the process of calling the sequence of core driver functions employed to emulate the unsupported extended driver functions is optimized.</p>
    <p>As the control commands are generated as described above, they may be used to control a motion control device in real time or they may be stored in a file for later use. Preferably, the method of the present invention comprises the step of providing a number of streams containing stream code. Each stream is associated with a destination of control commands, and the stream code of a given stream dictates how the control commands are to be transferred to the destination associated with that given stream. The user is thus provided the opportunity to select one or more streams that dictate the destination of the control commands.</p>
    <p>To help isolate the programmer from hardware specific complexities, the method of the present invention may comprise the additional administrative steps such as selecting a driver associated with a particular motion control device and/or translating units required to define the motion control system into the particular system of units employed by a given motion control device.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading> <p>FIG. 1 is a system interaction map of a motion control system constructed in accordance with, and embodying, the principles of the present invention;</p>
    <p>FIG. 2 is a module interaction map of a motion control component of the system shown in FIG. 1;</p>
    <p>FIG. 3 is an object interaction map of the component shown in FIG. 2;</p>
    <p>FIGS. 4 through 8 are scenario maps of the component shown in FIG. 2;</p>
    <p>FIG. 9 is an interface map of the component shown in FIG. 2;</p>
    <p>FIG. 10 is a data map showing one exemplary method of accessing the data necessary to emulate extended driver functions using core driver functions;</p>
    <p>FIG. 11 is a module interaction map of the driver portion of the system shown in FIG. 1;</p>
    <p>FIG. 12 is an object interaction map of the driver portion shown in FIG. 11;</p>
    <p>FIGS. 13 through 20 are scenario maps related to the driver shown in FIG. 11;</p>
    <p>FIG. 21 is an interface map for the driver shown in FIG. 11;</p>
    <p>FIG. 22 is a module interaction map of the streams used by the system shown in FIG. 1;</p>
    <p>FIG. 23 is an object interaction map of the streams shown in FIG. 22;</p>
    <p>FIGS. 24 through 32 are scenario maps of the streams shown in FIG. 22;</p>
    <p>FIG. 33 is an interface map of the objects comprising the stream shown in FIG. 22;</p>
    <p>FIG. 34 is a module interaction map of the driver stub portion of the system shown in FIG. 1;</p>
    <p>FIG. 35 is an object interaction map of the driver stub shown in FIG. 34;</p>
    <p>FIGS. 36 through 38 are scenario maps of the driver stub shown in FIG. 34;</p>
    <p>FIG. 39 is an interface map of the driver stub portion shown in FIG. 34;</p>
    <p>FIG. 40 is a module interaction map of the driver administrator portion of the system shown in FIG. 1;</p>
    <p>FIG. 41 is an object interaction map of the driver administrator shown in FIG. 40;</p>
    <p>FIGS. 42 through 49 are scenario maps relating to the driver administrator shown in FIG. 40;</p>
    <p>FIG. 50 is an interface map of the objects that comprise the driver administrator shown in FIG. 40;</p>
    <p>FIG. 51 is a module interaction map of the driver administrator CPL applet portion of the system shown in FIG. 1;</p>
    <p>FIG. 52 is an object interaction map of the driver administrator CPL applet shown in FIG. 51;</p>
    <p>FIGS. 53 through 57 are scenario maps related to the driver administrator CPL applet shown in FIG. 51;</p>
    <p>FIG. 58 depicts a Module Interaction-Map showing all binary modules that interact with the driver and how they interact with one another;</p>
    <p>FIG. 59 depicts an Object Interaction-Map which corresponds to the module interaction map of FIG. 58 expanded to display the internal C++ objects making up the language driver <b>44</b>, and how these objects interact with one another;</p>
    <p>FIGS. 60-65 depict a number of Scenario Maps that display the interactions taking place between the C++ objects involved during certain processes;</p>
    <p>FIG. 66 depicts an interface map that describes the interfaces exposed by the language driver component <b>44</b>, all data structures used, and the definitions of each C++ class used; and</p>
    <p>FIG. 67 depicts a table illustrating how a typical database employed by the language driver <b>44</b> may be constructed.</p>
    <heading>DETAILED DESCRIPTION OF THE INVENTION</heading> <p>Referring now to the drawing, depicted therein at <b>10</b> in FIG. 1 is a motion control system constructed in accordance with, and embodying, the principles of the present invention. This system <b>10</b> comprises a personal computer portion <b>12</b> having a hardware bus <b>14</b>, a plurality of motion control hardware controllers <b>16</b> <i>a, </i> <b>16</b> <i>b, </i>and <b>16</b> <i>c, </i>and mechanical systems <b>18</b> <i>a, </i> <b>18</b> <i>b, </i>and <b>18</b> <i>c </i>that interact with one or more objects (not shown) to be moved.</p>
    <p>The personal computer portion <b>12</b> of the system <b>10</b> can be any system capable of being programmed as described herein, but, in the preferred embodiment, is a system capable of running the Microsoft Windows environment. Such a system will normally comprise a serial port in addition to the hardware bus <b>14</b> shown in FIG. <b>1</b>.</p>
    <p>The hardware bus <b>14</b> provides the physical connections necessary for the computer <b>12</b> to communicate with the hardware controllers <b>16</b>. The hardware controllers <b>16</b> control the mechanical system <b>18</b> to move in a predictable manner. The mechanical system <b>18</b> comprises a motor or the like the output shaft of which is coupled to the object to be moved. The combination of the hardware controllers <b>16</b> <i>a, </i> <b>16</b> <i>b, </i>and <b>16</b> <i>c </i>and the mechanical systems <b>18</b> <i>a, </i> <b>18</b> <i>b, </i>and <b>18</b> <i>c </i>forms motion control devices <b>20</b> <i>a, </i> <b>20</b> <i>b, </i>and <b>20</b> <i>c, </i>respectively.</p>
    <p>The hardware bus <b>14</b>, hardware controllers <b>16</b>, and mechanical systems <b>18</b> are all well-known in the art and are discussed herein only to the extent necessary to provide a complete understanding of the present invention.</p>
    <p>The personal computer portion <b>12</b> contains a software system <b>22</b> that allows an application user <b>24</b> to create software applications <b>26</b> that control the motion control devices <b>20</b>.</p>
    <p>More particularly, based on data input by the user <b>24</b> and the contents of the application program <b>26</b>, the software system <b>22</b> generates control commands that are transmitted by one or more streams such as those indicated at <b>28</b> <i>a, </i> <b>28</b> <i>b, </i> <b>28</b> <i>c, </i>and <b>28</b> <i>d. </i>The streams <b>28</b> transmit control commands incorporating the hardware specific command language necessary to control a given motion control device to perform in a desired manner. As will be discussed in more detail below, the streams <b>28</b> implement the communication protocol that allows the control commands to reach the appropriate motion control device <b>28</b> via an appropriate channel (i.e., PC bus, serial port).</p>
    <p>Using the system <b>22</b>, the application program <b>26</b> is developed such that it contains no code that is specific to any one of the exemplary hardware controllers <b>16</b>. In the normal case, the application program <b>26</b>, and thus the user <b>24</b> that created the program <b>26</b>, is completely isolated from the motion control devices <b>20</b>. The user <b>24</b> thus need know nothing about the hardware specific command language or communication protocol associated with each of these devices <b>20</b>; it may even be possible that the command language of one or more of the hardware controllers <b>16</b> was not defined at the time the application program <b>26</b> was created.</p>
    <p>The software system <b>22</b> comprises a combination of elements that allow the application program <b>26</b> to be completely isolated from the hardware controllers <b>16</b>. In the following discussion, the framework of the software system <b>22</b> will be described in terms of a method of moving an object and/or a method of generating control commands. After this general discussion, each component of the system <b>22</b> will be described in detail in a specific operating environment.</p>
    <heading>I. Method of Generating Control Commands for Controlling a Motion Control Device to Move an Object</heading> <p>Initially, it should be noted that, in most situations, the method described in this section will normally but not necessarily involve the labors of at least two and perhaps three separate software programmers: a software system designer; a hardware designer familiar with the intricacies of the motion control device; and a motion control system designer. The application user <b>24</b> discussed above will normally be the motion control system designer, and the roles of the software system designer and hardware designer will become apparent from the following discussion.</p>
    <p>The software system designer develops the software system <b>22</b>. The software system designer initially defines a set of motion control operations that are used to perform motion control. The motion control operations are not specifically related to any particular motion control device hardware configuration, but are instead abstract operations that all motion control device hardware configurations must perform in order to function.</p>
    <p>Motion control operations may either be primitive operations or non-primitive operations. Primitive operations are operations that are necessary for motion control and cannot be simulated using a combination of other motion control operations. Examples of primitive operations include GET POSITION and MOVE RELATIVE, which are necessary for motion control and cannot be emulated using other motion control operations. Non-primitive operations are motion control operations that do not meet the definition of a primitive operations. Examples of non-primitive operations include CONTOUR MOVE, which may be emulated using a combination of primitive motion control operations.</p>
    <p>Given the set of motion control operations as defined above, the software system designer next defines a service provider interface (SPI) comprising a number of driver functions. Driver functions may be either core driver functions or extended driver functions. Core driver functions are associated with primitive operations, while extended driver functions are associated with non-primitive operations. As with motion control operations, driver functions are not related to a specific hardware configuration; basically, the driver functions define parameters necessary to implement motion control operations in a generic sense, but do not attach specific values or the like to these parameters. The SPI for the exemplary software system <b>22</b> is attached hereto as Appendix A.</p>
    <p>The software system designer next defines an application programming interface (API) comprising a set of component functions. For these component functions, the software system designer writes component code that associates at least some of the component functions with at least some of the driver functions. The relationship between component functions and driver functions need not be one to one: for example, certain component functions are provided for administrative purposes and do not have a corresponding driver function. However, most component functions will have an associated driver function. The API for the exemplary software system <b>22</b> is attached hereto as Appendix B.</p>
    <p>The overall software model implemented by the software program <b>22</b> thus contains an API comprising component functions and an SPI comprising driver functions, with the API being related to the SPI by component code associated with the component functions.</p>
    <p>In order for the system <b>22</b> to generate the control commands, at least two more components are needed: the application program <b>26</b> and at least one software driver such as the drivers indicated at <b>30</b> <i>a, </i> <b>30</b> <i>b, </i>and <b>30</b> <i>c </i>in FIG. <b>1</b>.</p>
    <p>The software drivers <b>30</b> are normally developed by a hardware designer and are each associated with a single motion control device. The hardware designer writes driver code that dictates how to generate control commands for controlling the motion control device associated therewith to perform the motion control operations associated with at least some of the driver functions.</p>
    <p>In the exemplary software system <b>22</b>, the software drivers <b>30</b> <i>a, </i> <b>30</b> <i>b, </i>and <b>30</b> <i>c </i>are associated with the motion control devices <b>20</b> <i>a, </i> <b>20</b> <i>b, </i>and <b>20</b> <i>c, </i>respectively. As a software driver exists for each of the motion control devices <b>20</b> <i>a, </i> <b>20</b> <i>b, </i>and <b>20</b> <i>c, </i>these devices <b>20</b> <i>a, </i> <b>20</b> <i>b, </i>and <b>20</b> <i>c </i>form a group of supported motion control devices.</p>
    <p>A careful review of the framework of the software system <b>22</b> as described above will illustrate that, of all the components of this system <b>22</b>, only the software drivers <b>30</b> are hardware dependent.</p>
    <p>The motion control system designer, normally also the user <b>24</b>, develops the application program <b>26</b>. The application program <b>26</b> comprises a sequence of component functions arranged to define the motion control operations necessary to control a motion control device to move an object in a desired manner. The application program <b>26</b> is any application that uses the system <b>22</b> by programming the motion control component <b>35</b>. Applications may program the system <b>22</b> either through OLE Automation or by using any of the custom OLE interfaces making up the API.</p>
    <p>As mentioned above, the component code associates many of the component functions with the driver functions, and the driver functions define the parameters necessary to carry out the motion control operations. Thus, with appropriately ordered component functions, the application program <b>26</b> contains the logic necessary to move the object in the desired manner.</p>
    <p>Once the application program <b>26</b> has been written and the software drivers <b>30</b> have been provided, the user <b>24</b> selects at least one motion control device from the group of supported motion control devices <b>20</b> <i>a, </i> <b>20</b> <i>b, </i>and <b>20</b> <i>c. </i>Using a driver administrator module <b>32</b>, the user <b>24</b> then selects the software driver associated with the selected motion control device. This driver administrator module <b>32</b> is used to install, uninstall, register, and setup each stream.</p>
    <p>As currently implemented, the driver administrator <b>32</b> allows only one software driver to be selected. In future versions of the software system <b>22</b>, the driver administrator will allow the user to select one or more software drivers.</p>
    <p>The software system <b>22</b> thus generates control commands based on the component functions contained in the application program <b>26</b>, the component code associated with the component functions, and the driver code associated with the selected software driver <b>28</b>.</p>
    <p>As the control commands are being generated as described above, they may be directly transmitted to a motion control device to control this device in real time or stored in an output file for later use. The software system <b>22</b> employs the streams <b>28</b> to handle the transmission of the control commands to a desired destination thereof.</p>
    <p>In the exemplary system <b>22</b>, the destinations of the control commands may be one or more of an output file <b>34</b> and/or the controllers <b>16</b>. Other possible destinations include a debug monitor or window or other custom output mechanism defined for a specific situation. The software system designer, or in some cases the hardware system designer, will write transmit stream code for each stream <b>28</b> that determines how the control commands are to be transferred to a given one of the control command destinations <b>16</b> and <b>34</b>. Using the driver administrator <b>32</b>, the user <b>24</b> selects one or more of the control command destinations <b>16</b> and <b>34</b>, and, later when run, the system <b>22</b> transfers the control commands to the selected control command destination <b>16</b> and/or <b>34</b> based on the transmit stream code in the stream <b>28</b> associated with the selected control command destination <b>16</b> and/or <b>34</b>.</p>
    <p>Many control command destinations such as <b>16</b> and <b>34</b> are capable of transmitting data back to the system <b>22</b>. Data transmitted from a control command destination back to the system <b>22</b> will be referred to as response data. The software system designer thus further writes data response stream code for each of the streams <b>28</b> <i>a, </i> <b>28</b> <i>b, </i>and <b>28</b> <i>c </i>that determines how response data is transmitted from the controllers <b>16</b> to the system <b>22</b>. The system <b>22</b> thus processes the response data sent by the controllers <b>16</b> based on the data response stream code contained in the streams <b>28</b>.</p>
    <p>Referring again to FIG. 1, this Figure shows that the system <b>22</b> further comprises a motion control component <b>35</b> and a driver stub module <b>36</b>. The motion control component module <b>35</b> is the portion of the software system <b>22</b> that relates the component functions to the driver functions. The motion control component module <b>35</b> thus contains the component code that makes the association between the component functions contained in the application program <b>26</b> and the driver functions.</p>
    <p>The driver stub module <b>36</b> is not required to implement the basic software model implemented by the system <b>22</b>, but provides the system <b>22</b> with significantly greater flexibility to accommodate diverse motion control hardware configurations with minimal effort.</p>
    <p>More particularly, when the driver stub module <b>36</b> is employed, the hardware designer need not develop driver code to implement all of the driver functions; to the contrary, the hardware designer must write driver code for implementing the core driver functions but need not write driver code to implement the extended driver functions. The software system designer provides the motion control driver stub <b>36</b> with stub code that identifies the combinations of core driver functions that are employed to emulate the functionality of extended driver functions.</p>
    <p>The motion control component <b>24</b> will determine for the selected software driver <b>30</b> which extended functions, if any, the selected driver <b>30</b> supports. For extended functions that are not supported, referred to herein as non-supported extended driver functions, the motion control component <b>35</b> refers to the driver stub module <b>36</b> to determine the appropriate combination of core driver functions to emulate the functionality of the non-supported extended driver functions. The system <b>22</b> thus generates the control commands necessary to implement the non-supported extended driver functions using the appropriate combination of core driver functions.</p>
    <p>The process of determining when extended driver functions need to be emulated can be optimized by providing the motion control component <b>35</b> with a function pointer table that contains a pointer to each of extended functions. When building the function pointer table, the motion control component <b>35</b> checks the selected driver module <b>30</b> to see if it supports each extended function. If the selected driver module <b>30</b> supports the extended function, the motion control component module <b>35</b> stores a pointer to the function, implemented by the selected driver module <b>30</b>, in the table location corresponding to the extended function. In the event that the selected driver module <b>30</b> does not support the extended function, the motion control component module <b>35</b> stores a pointer to the extended function implementation located in the driver stub module <b>36</b>. The driver stub module <b>36</b> implementation of the extended function contains calls to a plurality of core functions implemented by the selected driver module <b>30</b>.</p>
    <p>Therefore, the driver stub module <b>36</b> allows the motion control system designer to use, with minimal time and effort by the hardware designer, a working software driver <b>28</b> that contains driver code to implement only the core functions. The software driver <b>28</b> developed to implement the core driver functions can then be improved by developing driver code to implement extended driver functions as desired.</p>
    <p>The use of driver code specifically designed to implement extended driver functions is, in general, preferable to relying on the driver stub module <b>36</b> to emulate the extended driver functions; driver code specifically written to implement an extended driver function will almost always obtain a more optimized implementation of the driver function than the emulation of that driver function with a combination of core driver functions.</p>
    <p>Referring again for a moment to FIG. 1, this Figure illustrates that the system <b>22</b> additionally comprises a driver administrator CPL applet <b>38</b> and a DDE server <b>40</b>. The driver administration CPL applet <b>38</b> generates the user interface through which the user <b>24</b> communicates with the driver administrator module <b>32</b>. The DDE server <b>40</b> provides the software interface through which the application program <b>26</b> communicates with the motion control component module <b>35</b>.</p>
    <heading>II. Motion Control Component</heading> <p>The motion control component <b>35</b> will now be described in further detail with reference to FIGS. 2-10. The motion control component <b>35</b> is used by every application programming the system <b>22</b> to perform motion control operations. The major set of the API is implemented by this component. When operating, the motion control component <b>35</b> interacts with the driver administrator <b>32</b>, to get the current driver, and the driver <b>30</b> and driver stub <b>36</b>, to carry out motion control operations. Applications, using system <b>22</b>, only interact with the motion control component <b>35</b>.</p>
    <p>This section describes the design of the motion control component <b>35</b> in three main parts. First, all binary modules that affect the component <b>35</b> are described along with their interactions with the component <b>35</b>. Next, the module interaction-map is drawn in more detail to show the interactions between all C++ objects used to implement the motion control component <b>35</b>. Next, the object interaction-map is tested by displaying the specific interactions that take place during certain, key process that the component <b>35</b> is requested to perform.</p>
    <p>The module interaction-map shown in FIG. 2 displays all binary modules and their interactions with the motion control component <b>35</b>. As can be seen from the module interaction-map, applications only communicate with the motion control component <b>35</b>. From this point, the component <b>35</b> coordinates all interactions between the driver administrator <b>32</b>, driver <b>30</b>, and driver stub <b>36</b> components.</p>
    <p>Breaking the module interaction-map and adding the interactions taking place between all C++ objects used to implement the motion control component <b>35</b>, produces the object interaction-map shown in FIG. <b>3</b>.</p>
    <p>Each object in the diagram is described as follows. The CCmpntDisp object is the dispatch object used to dispatch exposed interface methods. During the dispatch process, all raw data is converted into the appropriate C++ form. For example, collections of data passed between OLE components is usually packaged in a raw block of memory. The CCmpntDisp object takes care of packing outgoing data and unpacking incoming data. Data packing involves converting the data between a raw and native C++ format.</p>
    <p>The CDriverAdmin object is used to communicate directly with the driver administrator component. All OLE related details are encapsulated within this class.</p>
    <p>The CDriverMgr object is used to control all unit mapping taking place before calling the appropriate Driver function. The CUnitMapper object is used to do the actual mapping between units.</p>
    <p>The CUnitMapper object is used to map units between the Part Coordinate System (PCS) and the Machine Coordinate System (MCS). Both directions of unit mapping are done by this object.</p>
    <p>The CDriver object is used to build the SPI table containing both core and extended Driver functions. Depending on the level of driver support, the extended functions in the SPI table may point to functions implemented in either the driver stub <b>36</b> or the driver <b>30</b>.</p>
    <p>The following discussion of FIGS. 4-8 describes all main scenarios, or operations, that occur on the motion control component <b>35</b>. Each scenario-map displays all objects involved, and the interactions that take place between them in the sequence that they occur.</p>
    <p>As shown in FIG. 4, before an application can use the motion control component <b>35</b>, it must create an instance of the object, using the CoCreatelnstance OLE function, and then initialize the instance calling the exposed Initialize custom interface method implemented by the component <b>35</b>. FIG. 4 displays the sequence of events that take place when the Initialize method is called.</p>
    <p>During initialization, the following steps occur. First the application must create an instance of the motion control component <b>35</b> by calling the standard OLE function CoCreatelnstance. Once loaded, the application must call the component <b>35</b>'s exposed Initialize method. When first loaded, the component <b>35</b> loads any registration data previously stored. Next, the component <b>35</b> directs the CCmpntDisp to initialize the system. The CCmpntDisp directs the CDriverAdmin to get the current driver(s) to use. The CDriverAdmin, first, loads the driver administrator <b>32</b> using the standard OLE CoCreatelnstance function. Next, it initializes the driver administrator. Then, it queries the driver administrator for the driver(s) to use and their SPI support information. Finally, the driver administrator returns the driver(s) and the support information to the component <b>35</b>, and releases all interfaces used from the driver administrator component <b>32</b>.</p>
    <p>Once receiving the active driver(s) <b>30</b> and their support information, the motion control component <b>35</b> passes the driver(s) <b>30</b> to the CDriverMgr and directs it to initialize the system. During its initialization, the CDriverMgr initializes the CUnitMapper. Also while initializing, the CDriverMgr initializes a CDriver for each driver used. After initializing each CDriver, the support information is used to build each SPI table inside each CDriver object. When building the SPI table, all core and supported extended SPI interfaces are queried from the driver. Also, when building the SPI table, the CDriver queries all interfaces, not supported by the driver <b>30</b>, from the driver stub <b>36</b>.</p>
    <p>Referring now to FIG. 5, once the motion control component <b>35</b> is initialized, the application <b>26</b> may perform operations on it. There are two types of operations that may take place on the component <b>35</b>: Operations that use core Driver functions, and operations that use extended Driver functions. Even though the difference between the two is completely invisible to the application using the component <b>35</b>, the internal interactions are different between the two. The following discussion outline these differences.</p>
    <p>The following interactions take place when the component <b>35</b> performs an operation that uses core Driver functions only. First the application must request the operation and pass all pertinent parameters to the component <b>35</b>. Next, the component <b>35</b> directs the CCmpntDisp to carry out the operation. The CCmpntDisp then directs the CDriverMgr to perform the operation and passes all pertinent parameters to it. Before carrying out the operation, the CDriverMgr uses the CUnitMapper to convert all units to the Machine Coordinate System (MCS). Next, the CDriverMgr directs the CDriver object to carry out the operation and passes the newly mapped parameters to it. The CDriver object uses its internal SPI table to communicate directly with the core Driver function implemented by the driver component.</p>
    <p>FIG. 6 shows the sequence of events that occurs when the component <b>35</b> is directed to carry out an operation that happens to use extended SPI not supported by the driver <b>30</b>. The following steps occur when the operation is requested.</p>
    <p>First the application must request the operation and pass all pertinent parameters to the component <b>35</b>. Next, the component <b>35</b> directs the CCmpntDisp to carry out the operation. The CCmpntDisp then directs the CDriverMgr to perform the operation and passes all pertinent parameters to it. Before carrying out the operation, the CDriverMgr uses the CUnitMapper to convert all units to the Machine Coordinate System (MCS). Next, the CDriverMgr directs the CDriver object to carry out the operation and passes the newly mapped parameters to it. The CDriver object uses its internal SPI table to communicate directly with the core Driver function implemented by the driver component.</p>
    <p>As briefly discussed above, when using the system <b>22</b>, there are several types of units and two different coordinate systems used. The process of unit mapping involves converting measurements between the Part and Machine coordinate systems. FIG. 7 illustrates this process, and the following steps occur when the operation is requested.</p>
    <p>First the application must request the operation and pass all parameters to the component <b>35</b>. Note, all parameters are in the PCS. Next, the component <b>35</b> directs the CCmpntDisp to carry out the operation. The CCmpntDisp directs the CDriverMgr to carry out the operation and passes the PCS parameters to it. The CDriverMgr takes all measurements and uses the CUnitMapper to convert them to the MCS. The newly mapped parameters are then passed to the Cdriver. The CDriver directs either the driver or the driver stub component to carry out the operation.</p>
    <p>When the application is finished using the motion control component <b>35</b> it directs the component <b>35</b> to free all of its resources by calling its exposed Release method. This process is depicted in FIG. <b>8</b>. During the clean-up process, the following steps occur.</p>
    <p>First the application must direct the component <b>35</b> to release all of its resources by calling its Release method. When invoked, the component <b>35</b> passes the call on to the CCmpntDisp object. The CCmpntDisp object directs the CDriverMgr to release any resources it is using. The CDriverMgr directs each CDriver object to release any of its resources, then deletes the CDriver objects. First, the CDriver object releases any interfaces it is using from the driver component. Then, the CDriver object releases any interfaces it is using from the driver stub component.</p>
    <p>FIG. 9 is an interface map related to the motion control component <b>35</b>. FIG. 10 is a data map showing how data relating to the whether extended driver functions need to be emulated is stored. Attached hereto as Appendix C is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the motion control component <b>35</b>.</p>
    <heading>III. Software Drivers</heading> <p>The driver <b>30</b> is used by both the driver administrator <b>32</b> and the component <b>35</b>. Its main purpose is to implement functionality that generates motion control commands for the specific hardware supported. For example, the AT6400 driver, used to control the Compumotor AT6400 motion control hardware, generates AT6400 command codes. During the initialization phase of the system <b>22</b>, the driver administrator <b>32</b> communicates with each driver <b>30</b>, allowing the user to add, remove, or change the configuration of the driver. When an application, using the system <b>22</b>, is run, the component <b>35</b> communicates with the driver <b>30</b> directing it to carry out the appropriate motion control operations.</p>
    <p>This section describes the complete design of a generic driver <b>30</b>. All drivers are designed from the base design described in this manual. This section is divided into three parts. First, a module interaction-map that describes all binary modules that interact with the driver <b>30</b> is discussed. Next, the module interaction-map is drawn as an object interaction-map, where all the internals of the driver are exposed. In this map, all C++ objects, making up the driver, and their interactions are shown. Next, several scenario-maps are drawn. Each scenario-map displays the interactions taking place between the C++ objects involved during a certain process. Finally, this section describes the interfaces exposed by the driver component, all data structures used, and the definitions of each C++ class used.</p>
    <p>Referring now to FIG. 11, the module interaction-map displays all binary modules and their interactions with the driver <b>30</b>. There are two modules that interact directly with the driver: the motion control component <b>35</b>, and the driver administrator <b>32</b>. The driver administrator <b>32</b> queries and changes the driver settings and the component <b>35</b> directs the driver to carry out motion control operations, such as moving to a certain location in the system. Shown at <b>42</b> in FIG. 11 is the standard Windows registration database, referred to herein as the registry.</p>
    <p>Breaking the module interaction-map down into more detail by including the interactions taking place between all C++ objects used to implement the driver, produces the object interaction-map. The object interaction-map for the driver <b>30</b> is shown in FIG. <b>12</b>.</p>
    <p>Each object in the diagram is described as follows.</p>
    <p>CDriverDisp is the dispatch object used to dispatch exposed interface methods. During the dispatch process, all raw data is converted into the appropriate C++ form. For example, collections of data passed between OLE components is usually packaged in a raw block of memory. The CDriverDisp object takes care of packing outgoing data and unpacking incoming data. Data packing involves converting the data between a raw and native C++ format.</p>
    <p>The CStreamMgr object is responsible for managing the set of streams registered with the driver. Streams, may be added, removed, and enabled. Only enabled streams are sent data. The CLSID and enabled status of each stream registered, is stored in the registration database. When communicating to streams, the CStreamMgr is used to send the command string to all enabled streams.</p>
    <p>The CCommandMgr object is used to build commands sent to the stream, and extracting responses received from the stream. The CCommandMgr is the controlling object that manages the CResponse, CCommandList, and CStream objects.</p>
    <p>The CCommandList object stores the complete list of commands making up the motion control command language. Such commands may be stored as text resources or in a text file.</p>
    <p>The CCommand object builds command strings that are then sent to the CStream. Each command built is a complete motion control command string.</p>
    <p>The CResponseList object builds CResponse objects that are initialized with the parsing format for the expected response.</p>
    <p>The CResponse object converts raw response strings, returned by the CStream, and converts them into C++ data types. For example, a response string containing position data may be converted into a set of double values.</p>
    <p>The CStream object is used to communicate directly with the underlying stream component.</p>
    <p>FIGS. 14-20 contain scenario maps that describe all main scenarios, or operations, that occur on the driver <b>30</b>. Each scenario-map displays all objects involved, and the interactions that take place between them in the sequence that they occur.</p>
    <p>There are two types of operations that occur on the driver <b>30</b>. First, the driver administrator <b>32</b> may initiate operations, such as adding streams or configuring the driver. Next, the motion control component <b>35</b> may initiate operations on the driver when an application is actually running. The following discussion describes each perspective, starting with the operations directed by the Driver Administrator; all operations made on the driver by the driver administrator are discussed in the order that they may occur when using the driver.</p>
    <p>Before a driver may be used, it must be registered in the OLE system. In order to register a driver the driver administrator first verifies that the module being registered is actually an driver <b>30</b>, then it calls the DLLRegisterServer exported function to register the driver. Each module of the system <b>22</b> exports a function called DLLGetModuleType. This function is used to verify that the module is an driver <b>30</b> component. FIG. 13 displays the interactions that take place when registering a driver.</p>
    <p>During the registration process shown in FIG. 13, the following steps occur. First, the driver administrator must load the DLL, containing the stream component, verify that the module is an driver <b>30</b>. To do so, the driver administrator calls the DLLGetModuleType function, exported by the driver. If the function returns a value that contains the value XMC_DRIVER_MT in the high byte, then the driver administrator proceeds and registers the driver by calling its exported function, DLLRegisterServer. When called, the implementation of the DLLRegisterServer writes all OLE 2.0 registration information to the Windows registration database.</p>
    <p>Referring now to FIG. 14, after the driver is registered, the driver administrator can load the component <b>35</b> using the OLE CoCreatelnstance function. During the initialization process, the driver loads all registration data and initializes both the CDriverDisp and CStreamMgr C++ objects.</p>
    <p>During initialization, the following steps occur.</p>
    <p>Before loading the driver component, the driver administrator must query the driver module for its CLSID. Calling the driver's exported function, DLLGetCLSID, returns the CLSID. Once it has the CLSID, the driver administrator may create an instance of the driver by calling the standard OLE function CoCreatelnstance. When first loaded, the driver loads any registration data previously stored. Next, the driver directs the CDriverDisp object to initialize the system. When notified, the CDriverDisp object initializes itself and then directs the CStreamMgr to initialize itself. During its initialization, the CStreamMgr loads all stream settings from the registration database. For example, the CLSID and enabled state of all streams previously registered with the driver, are loaded.</p>
    <p>After initializing the driver, the driver administrator may perform operations on it. For example, the driver administrator may request the driver to add or remove a stream. FIG. 15 displays the sequence of events occurring when the driver is requested to add a new stream. When adding a stream, the following steps occur.</p>
    <p>First the driver administrator directs the stream to add a new stream and passes CLSID of the stream, to be added, to the driver. The driver then passes the CLSID to the CDriverDisp object and directs it to add the stream. The CDriverDisp object passes the information on to the CStreamMgr and directs it to add the stream. In the final step, the CStreamMgr assumes that the module is a valid stream component <b>28</b> and adds the CLSID to the drivers set of information in the registration database.</p>
    <p>Another operation requested of the driver, after initialization, is that of querying it for its current settings. Before displaying information about the driver, like the name of the hardware it supports, the driver administrator must query the driver for the information. For example, FIG. 16 displays the process of querying the driver for an enumeration of the streams registered with it. When querying the driver for information, the following steps occur.</p>
    <p>First the driver administrator, calls the interface method used to query the driver's stream enumeration. Next, the driver directs the CDriverDisp to create the stream enumeration. The CDriverDisp object then directs the CStreamMgr to prepare the stream enumeration. The CStreamMgr checks the registration database and makes sure its internal state is in sync with the data stored in the registry. Next, it sets a lock that will cause all stream management operations, such as adding or removing streams, to fail. The CStreamMgr prepares the list of streams and loads them into memory using the CStream object. The CStream object loads the stream component using the OLE CoCreatelnstance API.</p>
    <p>After the driver administrator is done using the driver, it must release the driver by calling its exposed Release method. Calling this method, directs the driver to release all resources used. FIG. 17 displays the process of releasing the driver component. During the clean-up process, the following steps occur.</p>
    <p>First the driver administrator must direct the driver component to clean itself up by calling its Release method. When invoked, the driver component passes the call on to the CDriverDisp object. The CDriverDisp object then directs the CStreamMgr to save all data. The CStreamMgr saves all data, including the state of each stream, in the registration database. Finally, the driver saves all internal data in the registration database.</p>
    <p>After a driver is successfully installed into the system <b>22</b> and configured using the driver administrator, it is ready for use by the motion control component <b>35</b>. The component <b>35</b> uses the driver <b>30</b> when performing motion control operations requested from the application using the component <b>35</b>. The following discussion describes the component <b>35</b> directed operations that can take place on the driver.</p>
    <p>Before using the driver, it must be initialized by the component <b>35</b>. This operation is different from the driver initialization taking place on the driver when used by the driver administrator because the system must be prepared for sending and receiving commands. In order to prepare for the data communication, the stream must be initialized and then opened. FIG. 18 describes the initialization process. The following steps occur during the initialization process.</p>
    <p>First the component <b>35</b> must direct the driver to initialize itself. This is usually a two step process. In the first step, the component <b>35</b> creates and instance of the driver using the standard OLE CoCreatelnstance function. Next, the Initialize method, exposed by the driver, is called to prepare the driver for data transmissions. When the Initialize method is called, the driver first loads any internal data stored in the registration database <b>42</b>. Next, the driver directs the CDriverDisp to initialize the internal system. The CDriverDisp then directs the CStreamMgr to initialize the streams. Next, the CStreamMgr loads all data from the registration database, including the set of all CLSID's and enabled status' for all streams registered with the driver. Then the CStreamMgr loads each enabled stream by creating a new CStream object for each enabled stream. When creating each CStream object, the CLSID for the underlying stream is passed to the CStream object. When each CStream object is created and attached to a stream component it loads the component <b>35</b> by calling the standard OLE CoCreatelnstance function. Once the CStreamMgr is done, the CDriverDisp directs the CCommandMgr to initialize itself. During its initialization process, the CCommandMgr initializes and loads the CCommandList. Also, when the CCommandMgr is initializing, it loads the CResponseList corresponding to the CCommandList.</p>
    <p>Once the system is initialized, the motion control component <b>35</b> can direct the driver to carry out certain command operations. Command operations are standard motion control operations such as moving to a specific location in the system, or querying the system for the current position. FIG. 19 describes the process of commanding the driver to carry out a certain operation. When commanding the driver to perform a certain operation the following steps occur.</p>
    <p>First, the component <b>35</b> directs the driver to perform the operation, such as moving to a position or querying the system for the current position. Next, the driver directs the CDriverDisp object to perform the operation. The CDriverDisp object then directs the CCommandMgr to build the appropriate command. Any parameters related to the command are passed to the CCommandMgr. For example, when directing the driver to move to a certain position, the position information is passed to the CCommandMgr. Next, the CCommandMgr requests the CResponseList to create a CResponse object. The CResponseList looks up the response format and uses it to create a new CResponse object that is returned to the CCommandMgr. Then, the CCommandMgr directs the CCommandList to create the command. Any parameters related to the command are passed to the CCommandList. The CCommandList creates a new CCommand object, looks up the raw command string, and passes it and the command parameters to the CCommand object who then builds the command string.</p>
    <p>The CCommandMgr, then passes the CCommand object, returned by the CCommandList, and the previously created CResponse object to the CstreamMgr object. The CStreamMgr object is directed to process the objects. The CStreamMgr passes the CCommand and CResponse objects to all enabled CStream objects. The CStream object queries the CCommand object for the full command string in raw text form. The raw text command is passed to the stream component. Next, the CStream object waits for the response, then reads the raw text response into a buffer. The raw text response is then passed to the CResponse object. Next the CRETONNE object is returned to the CStreamMgr, who returns it to the CCommandMgr, who returns it to the CDriverDisp object. Eventually the CResponse returns to the CDriverDisp object, who then directs the CResponse to convert the response into a generic C++ type. The generic type is returned to the motion control component <b>35</b>.</p>
    <p>Once the component <b>35</b> is finished using the driver, the driver must be released by calling its Release method. Releasing the driver frees all resources used by the driver. FIG. 20 describes the process of releasing the driver. The following steps occur when cleaning up and freeing all resources used by the driver.</p>
    <p>First, the component <b>35</b> must call the driver's Release method. When called, the driver directs the CDriverDisp object to release any resources used. The CDriverDisp then directs the CStreamMgr to free any resources used. The CStreamMgr then frees all active CStream objects. Each CStream object releases all stream component interfaces used. Next the CDriverDisp directs the CCommandMgr to free all of its resources. During its clean-up, the CCommandMgr frees the CCommandList object. To complete its clean-up, the CCommandMgr frees the CResponseList object.</p>
    <p>Attached hereto as Appendix D is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the driver.</p>
    <heading>IV. Streams</heading> <p>This section describes the stream component <b>28</b> used as the data transport layer between the driver <b>30</b> component and the destination output location such as the motion control device <b>20</b> and/or the output file <b>34</b>. For example, when using motion control hardware that is connected to the PC Bus, the driver <b>30</b> Component will communicate with the PC Bus stream component <b>28</b>.</p>
    <p>The design of a stream component <b>28</b> will be discussed in three parts. First, a Module Interaction-Map describes the modules that are involved, with respect to the stream, and how they interact with one another. Next, the Object Interaction-Map breaks the Module Interaction-Map down into a more detailed view that not only displays the interactions occurring between modules, but also the interactions taking place between the C++ objects within the stream component <b>28</b>. Then, the Object Interaction-Map is “tested” by running it through several Scenario-Maps. Each Scenario-Map displays the object interactions taking place during a certain operation.</p>
    <p>The Module Interaction-Map shown in FIG. 22 displays all modules that interact with the stream component <b>28</b>. Interactions begin from two different perspectives. First, the driver administrator <b>32</b> interacts with the stream component <b>28</b> when installing, removing, and configuring the stream. Next, when used, each driver <b>30</b> interacts with the stream while sending and retrieving data to and from the destination. For example, when a driver writes data to a text file stream, the stream takes care of writing the data out to the file. Or, if the driver reads data from a PC Bus stream, the stream does the actual read from the hardware and passes the data back to the driver.</p>
    <p>Drivers only communicate with streams that have been specifically connected to the driver. Once connected, the stream is used to communicate with the destination object, like the PC Bus, serial I/O connection, text file, or debug monitor.</p>
    <p>The stream component <b>28</b> shown in FIG. 22 is the object that operates as the data transport layer for each driver. Each stream has a different target that defines the type of the stream. The following are the current stream targets.</p>
    <p>PC Bus/WinNT—This Windows NT stream uses a Windows NT .SYS device driver to communicate directly with the motion control hardware connected to the PC Bus.</p>
    <p>PC Bus/Win95—This Windows 95 stream uses a Windows 95 V×D to communicate directly with the motion control hardware connected to the PC Bus.</p>
    <p>PC Bus/Win 3.1—This Windows 3.1 stream communicates directly with the motion control hardware connected to the PC Bus.</p>
    <p>Serial—This stream uses the COMM API to communicate with the motion control hardware connected to the serial port.</p>
    <p>Text File—This stream is write-only and sends all data to a text file.</p>
    <p>Debug Monitor—This stream is write only and sends all data to the debug monitor.</p>
    <p>Custom—This is a custom stream that sends data to an unknown location.</p>
    <p>Similar to the Module Interaction-Map, the Object Interaction-Map isplays interactions between modules. In addition, this map, shows all interactions taking place between each C++ object within the stream component <b>28</b>. FIG. 23 is the Object Interaction-Map for the stream component <b>28</b>.</p>
    <p>Each object in the diagram is described as follows. The CStreamDisp object is the dispatch object used to dispatch exposed interface methods. During the dispatch process, all raw data is converted into the appropriate C++ form. For example, collections of data passed between OLE components is usually packaged in a raw block of memory. The CStreamDisp object takes care of packing outgoing data and unpacking incoming data. Data packing involves converting the data between a raw and native C++ format.</p>
    <p>The CRegistryMgr object takes care of managing all data stored in the registration database. Since many streams of the same type may exist at the same time, each stream is assigned a handle. The handle assigned, is used by the stream to look up the location it uses to load and store data in the registration database, much as an library index is used to locate a library book.</p>
    <p>All input and output is funnelled through the CIOMgr manager. Management of input and output operations consists of buffering data and controlling primitives used to transport data to and from the target location.</p>
    <p>The CIOHAL object is the input/output hardware abstraction layer. With in this object lay all hardware dependent code such as calls to inp and outp. Each different type of stream contains a different implementation of this object.</p>
    <p>Scenario-Maps are specialized Object Interaction-Maps that display how each module and the objects inside the stream component interact with one another during the operation described by the map. The Scenario-Maps in FIGS. 24-32 are broken into two different categories; those that are initiated by the driver administrator <b>32</b>, and those that are initiated by the driver <b>30</b>.</p>
    <p>Operations directed by the driver administrator are usually related to initializing, uninitializing, and configuring the stream. The following sections describe all operations, directed by the driver administrator, that take place on the stream.</p>
    <p>Before a stream component can be used by anyone, it must be registered in the Windows registration database. Registration is a standard OLE 2.0 operation required in order to use any OLE 2.0 component, such as the stream component. FIG. 24 describes this process. During the registration process, the following steps occur.</p>
    <p>First, the driver administrator must load the DLL, containing the stream component, verify that the module is an stream component <b>28</b>. To do so, the driver administrator calls the DLLGetModuleType function, exported by the stream. If the high byte in the return value contains the value XMC_STREAM_MT, then the driver administrator proceeds and registers the stream by calling its exported function, DLLRegisterServer. When called, the implementation of the DLLRegisterServer writes all OLE 2.0 registration information to the Windows registration database.</p>
    <p>After the stream component is successfully registered, it is ready for initialization. During initialization, the stream component not only initializes itself, but also initializes any device drivers used by registering the driver with the operating system. For example, the Windows NT stream component registers the Windows NT SYS driver with Windows NT and starts the service. FIG. 25 describes this process. During initialization, the following steps occur.</p>
    <p>First the driver administrator must direct the stream to initialize itself. When making this call, the name and location of the driver used, and the handle of the stream are passed into the method as arguments. Once directed to initialize itself, the stream component calls the CStreamDisp and directs it to initialize the system. The CStreamDisp object then directs the CRegistryMgr to load all pertinent data for the stream using the handle passed to it. The CRegistryMgr loads all data from the registration database. After all information is loaded from the registry, the CStreamDisp directs the CIOMgr to register the appropriate driver with the operating system. The CIOMgr directs the CIOHAL to register the driver, if appropriate. If running in Windows NT, the CIOHAL registers the SYS driver with the Windows NT operating system and starts the driver. If running in Windows 95, the V×D integrity is verified with a quick, dynamic, load and unload.</p>
    <p>After initializing the stream component, it may be queried for its current settings or directed to set new settings. Since both operations are very similar, only changing settings will be described. Stream settings include data such as: port addresses, IRQ levels, file names, etc. Any data needed to communicate with the output/input target are included in the stream settings. FIG. 26 describes the process of changing the streams settings. During the setup process, the following steps occur.</p>
    <p>First the driver administrator directs the stream to use the data passed to change its internal data. Once directed, the stream component passes the interface method invocation to the CStreamDisp object. The CStreamDisp object then directs the CRegistryMgr to store the new settings. The CRegistryMgr stores the new values in the registration database.</p>
    <p>When the driver administrator is done using a stream component, it must clean up the resources used. FIG. 27 describes this process. During the clean-up process, the following steps occur. First the driver administrator must direct the stream component to clean itself up by calling its Release method. When invoked, the stream component passes the call on to the CStreamDisp object. The CStreamDisp object then directs the CRegistryMgr to save all data. All persistent data is saved to the registration database by the CRegistryMgr.</p>
    <p>Driver directed operations occur when each driver <b>30</b> uses the stream component <b>28</b> connected to it. Remember, each stream component is used as the data transport layer. Each driver uses the stream to transfer the motion control command data, it generates, to the output target. Streams are also used to transfer data back to the driver when read operations occur. Only certain streams are readable.</p>
    <p>Before the driver can perform operations on the stream, the stream must be initialized. Initialization occurs in two steps. First the OLE stream component must be loaded, and then once it is, the stream must be explicitly initialized. FIG. 28 describes the second portion of the initialization process. The following steps occur during the initialization process.</p>
    <p>First the driver must invoke the Initialize methods exported by one of the stream interfaces. When calling Initialize, the driver passes to the stream, the stream handle. Next, the stream passes the directive on to the CStreamDisp object for dispatching. The CStreamDisp object first directs the CRegistryMgr to load all settings stored in the location defined by the stream handle. The CRegistryMgr reads in the data stored in the registry at the handle. After the data is loaded, the CStreamDisp, directs the CIOMgr to initialize itself. As part of its initialization, the CIOMgr initializes the CIOHAL object that it is using.</p>
    <p>Once a stream has been initialized, it must be opened. Opening a stream places the stream in a state where it can pass data between the driver and the target. FIG. 29 describes the process of opening a stream. When opening a stream, the following steps occur.</p>
    <p>First the driver directs the stream to open itself, by calling the Open exposed interface method. Once directed, the stream passes the call on to the CStreamDisp object. Next, the CStreamDisp object directs the CIOMgr to open the stream. At this time, the CIOMgr prepares any buffers that will later be used when transferring data through the stream. After the buffers are ready, the CIOMgr directs the CIOHAL object to interact with the target and open it. CIOHAL directly communicates with the target or with a device driver and opens the stream. When operating with hardware streams, the device driver, or Serial <b>10</b> directly communicates with the hardware and prepares it for operation.</p>
    <p>After opening a stream, it is ready to perform data transport operations. There are two main data transport operations available: Reading data, and writing data. FIG. 30 describes the process of writing data to the stream. When writing to the stream, the following steps occur. First the driver directs the stream to write data to the target and passes the data to the stream. Next, the stream passes the data to the CStreamDisp object. The CStreamDisp object passes the block of data to the CIOMgr and directs it to write it to the target. The CIOMgr object either passes the complete block of data to the CIOHAL object, or stores the block in an internal buffer and then passes pieces of the buffer to the CIOHAL object until the complete buffer is sent. The CIOHAL object takes the data passed to it and either sends it directly to the target, passes it to a device driver, or calls COMM API to send the data to the Serial <b>10</b> port. The device driver or COMM API sends the data directly to the hardware controlled.</p>
    <p>Certain streams, like the PC Bus and Serial <b>10</b> streams, return data after write operations occur on them. The data returned may be specific to a previous request for data, or status describing the success or failure of the previous write operation. FIG. 31 describes the process of reading data from the stream. It should be noted that not all streams are readable. Currently, the only readable streams are the PC Bus and Serial streams. During the operation of reading data from the target, the following steps occur.</p>
    <p>First the driver directs the stream to read data from the target. The stream passes the call on to the CStreamDisp object. The CStreamDisp object directs the CIOMgr to perform the read. Depending on how the stream is implemented, the CIOMgr may either make one call or multiple calls to the CIOHAL object. If multiple calls are made, all data read is stored in CIOMgr internal buffers. The CIOHAL object either directly communicates to the hardware, uses the COMM API, or a device driver to read the data. If a device driver or the COMM API are used, they directly communicate with the hardware to read the data.</p>
    <p>Once the driver is done using the stream, it must direct the stream to clean-up all resources used. To do so, the driver calls the standard Release method. FIG. 32 displays the sequence of events taking place after the Release method is called. The following steps occur when cleaning up and freeing all resources used by the stream.</p>
    <p>First the driver must call the stream's Release method. Next, the stream directs the CStreamDisp object to release all resources used. The CStreamDisp object then directs the CIOMgr to free any resources used in buffers, etc. Next, the CIOMgr directs the CIOHAL to free any resources used. During its clean-up and depending on the type of stream, the CIOHAL will delete text files used, close the debug monitor, shut-down the hardware, or direct any device drivers to shut-down the hardware. If device drivers or the COMM API are used, they direct the hardware to shut-down.</p>
    <p>FIG. 33 depicts an interface map for the stream <b>28</b>. Attached hereto in Appendix E is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the stream.</p>
    <heading>V. Driver Stub Module</heading> <p>The driver stub module <b>36</b> is used to fill in the extended Driver functions that the driver <b>30</b> is unable to support or implement. By simulating the extended SPI, applications are able to use a larger set of motion control functionality than would be available if the application directly programmed the motion control hardware. In order to implement the extended SPI, the driver stub uses software algorithms that call core SPI interface methods implemented by the driver <b>30</b>. During the initialization of the driver stub, the driver <b>30</b> to use is registered with the driver stub.</p>
    <p>This section describes all aspects of the driver stub <b>36</b> in three basic parts. The first part of this section describes all binary modules affecting the driver stub. Next, a more detailed view, that includes all C++ objects used inside the driver stub, is described. Then several processes that take place on the driver stub are described.</p>
    <p>The module interaction-map displays all binary modules and their interactions with the driver stub <b>36</b>. As can be seen from FIG. 34, the driver stub is used by the component <b>35</b>. More or less, the driver stub acts as a helper to the component <b>35</b> by filling in all extended Driver functionality possible.</p>
    <p>By taking the module interaction-map in FIG. <b>34</b> and displaying all interactions taking place with all C++ objects implementing the driver stub, we produce what is called the object interaction-map. FIG. 35 is the object interaction-map for the driver stub <b>36</b> component.</p>
    <p>Each object in the diagram is described as follows.</p>
    <p>The CDriverStubDisp object is the dispatch object used to dispatch exposed interface methods. During the dispatch process, all raw data is converted into the appropriate C++ form. For example, collections of data passed between OLE components is usually packaged in a raw block of memory. The CDriverStubDisp object takes care of packing outgoing data and unpacking incoming data. Data packing involves converting the data between a raw and native C++ format.</p>
    <p>The CSPIMgr object is responsible for managing all SPI issues such as managing the CSimpleDriver by directing it to connect to the appropriate SPI core interfaces exposed by the driver.</p>
    <p>The CSimpleDriver object is used to directly communicate with the driver implementing the SPI core interfaces. The CSimpleDriver only communicates with the core SPI interfaces implemented by the driver.</p>
    <p>The following discussion describes all main scenarios, or operations, that occur on the driver stub <b>36</b>. Each scenario-map displays all objects involved, and the interactions that take place between them in the sequence that they occur. All operations on the driver stub originate from the motion control component <b>35</b>. In addition to the motion control component <b>35</b>, the XMC Setup Component interacts with the driver stub when installing the system <b>22</b>. It should be noted that all scenarios below assume that the driver stub <b>36</b> has already been registered in the OLE system. Registering this component is the responsibility of the setup application and setup component.</p>
    <p>This discussion describes all operations made on the driver stub by the motion control component <b>35</b>. Each section is discussed in the order that they may occur when using the driver.</p>
    <p>As shown in FIG. 36, before using the driver stub <b>36</b>, the motion control component <b>35</b> must initialize it by creating an instance of the driver stub, and then initializing the instance created. Calling the standard OLE function CoCreatelnstance completes the first step. After an instance is created, the component <b>35</b> must call the driver stub exposed Initialize interface method. During initialization, the following steps occur.</p>
    <p>The component creates an instance of the driver stub by calling the standard OLE function CoCreatelnstance. Once loaded, the CLSID of the driver to use is passed to the driver stub when calling its Initialize exposed interface method. When first loaded, the driver loads any registration data previously stored. Next, the component <b>35</b> passes the CLSID, of the driver to use, to the CDriverStubDisp object and directs it to initialize the system. The CDriverStubDisp object then directs the CSPIMgr to initialize itself and passes the driver CLSID to it. The CSPIMgr passes the CLSID to the CSimpleDriver and directs it to only query the core SPI interfaces exposed by the driver. The CSimpleDriver loads an instance of the driver then queries all core interfaces exposed by the driver.</p>
    <p>Once the driver stub is initialized, it is ready to perform operations such as performing extended Driver functions. FIG. 37 describes the steps that occur when the component <b>35</b> directs the driver stub to perform an extended SPI operation. The following steps occur when the operation is requested.</p>
    <p>First the component <b>35</b> must request the operation and pass all pertinent parameters to the driver stub. Next, the driver stub directs the CDriverStubDisp to handle the operation. The CDriverStubDisp then directs the CSPIMgr to perform the SPI extended function and passes the appropriate XMC_EXT_SPI identifier as a parameter. The CSPIMgr calls the appropriate function corresponding to the XMC_EXT_SPI identifier. The function simulates the extended Driver function and calls the CSimpleDriver for core operations. When directed, the CSimpleDriver performs SPI core functions by directly calling the exposed interfaces implemented by the driver.</p>
    <p>When the motion control component <b>35</b> is finished using the driver stub <b>36</b>, it must release it by calling the exposed Release method. Calling the Release method causes the driver stub to free all the resources it uses. FIG. 38 displays this sequence of events. During the clean-up process, the following steps occur.</p>
    <p>First the component <b>35</b> must direct the driver stub to release all of its resources by calling its Release method. When invoked, the driver component passes the call on to the CDriverStubDisp object. The CDriverStubDisp object then directs the CSPIMgr to release any resources that it was using. The CSPIMgr releases all resources including the CSimpleDriver object used. When freed, the CSimpleDriver releases any interfaces used from the driver.</p>
    <p>FIG. 39 is an interface map of the driver stub module <b>36</b>. Attached hereto as Appendix F is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the driver.</p>
    <heading>VI. Driver Administrator Module</heading> <p>The driver administrator <b>32</b> is used from two different perspectives. When the driver administrator Control Panel Applet <b>38</b> is used to configure the system, the applet directs the driver administrator <b>32</b> to carry out the operations. The applet <b>38</b> simply provides the user-interface, and the component <b>35</b> does the real work of managing drivers and streams used with the system <b>22</b>. Using the driver administrator component with the control panel applet is the first perspective on using the component <b>35</b>.</p>
    <p>In the second perspective, the motion control component <b>35</b> uses the driver administrator component to query for the current set of enabled the driver <b>30</b>. It should be noted that, currently, only single driver operation is allowed. Clearly, the system <b>22</b> may support multiple drivers that are virtualized. For example, if two, four axis, drivers are installed, applications using the system could act as though they were using an eight axis system.</p>
    <p>This section describes the driver administrator <b>32</b> in three main parts. First, all modules interacting with the driver administrator component are described along with their interactions. Next, the module interaction-map is expanded to display all interactions taking place between the C++ objects used to implement the driver administrator <b>32</b> Component. This description is called the object interaction-map. Then, the object interaction-map is tested by running it through several scenarios, or scenario-maps. Each scenario-map displays the events and the order in which they occur in a certain process taking place on the driver administrator component.</p>
    <p>The module interaction-map shown in FIG. 40 displays all binary modules and their interactions with the driver administrator <b>32</b> Component. Both the driver administrator CPL <b>38</b> and the motion control component <b>35</b> are the main modules that interact with the driver administrator <b>32</b> Component.</p>
    <p>The driver administrator CPL module <b>38</b> provides the user-interface that allows the user to add, configure, and remove drivers and streams in the system <b>22</b>. The driver administrator <b>32</b> handles all driver and stream management. Even though the control panel applet provides the user-interface, this module <b>32</b> does the actual management work.</p>
    <p>In addition, the driver administrator is used by the component <b>35</b> to access the current driver(s) to use when carrying out motion control operations. For example, if the AT6400 driver is selected as the current driver when the component <b>35</b> queries the driver administrator, the driver administrator returns the CLSID of the AT6400 driver.</p>
    <p>Taking the driver administrator <b>32</b>, displayed in the module interaction-map, and displaying all interactions occurring between the C++ objects used to implement the administrator <b>34</b>, produces the object interaction-map therefor. The object interaction-map for the driver administrator <b>32</b> is shown in FIG. <b>41</b>.</p>
    <p>Each object in the diagram is described as follows.</p>
    <p>The CDriverAdminDisp object is the dispatch object used to dispatch exposed interface methods. During the dispatch process, all raw data is converted into the appropriate C++ form. For example, collections of data passed between OLE components is usually packaged in a raw block of memory. The CDriverAdminDisp object takes care of packing outgoing data and unpacking incoming data. Data packing involves converting the data between a raw and native C++ format.</p>
    <p>The CDriverInfoMap object is used to build the information used by the driver administrator CPL <b>38</b> when displaying information about each driver or stream.</p>
    <p>The CModuleMgr object is responsible for managing all stream and driver modules in the system. A list of all drivers registered are stored persistently in the registration database by the CModuleMgr. Each time a driver or stream is accessed the CModuleMgr is used to get the module.</p>
    <p>The CSimpleDriver object is used to directly communicate with the driver component. All OLE specific details are encapsulated within this object.</p>
    <p>The CSimpleStream object is used to directly communicate with the stream component. All OLE specific details are encapsulated within this object.</p>
    <p>FIGS. 42-49 describe all main scenarios, or operations, that occur on the driver administrator <b>32</b>. Each scenario-map displays all objects involved, and the interactions that take place between them in the sequence that they occur.</p>
    <p>Referring now to FIG. 42, before using the driver administrator component, it must be initialized. FIG. 42 describes the process of initializing the driver administrator component from either the driver administrator control panel applet or the motion control component. During initialization, the following steps occur.</p>
    <p>First, either the control panel applet or the motion control component must create an instance of the driver administrator component by calling the standard OLE function CoCreatelnstance. Next, the exposed Initialize interface method must be called. When the Initialize method is called, the driver administrator component directs the CDriverAdminDisp to initialize the system. Next, the CDriverAdminDisp directs the CModuleMgr to initialize itself and any modules that it is managing. The CModuleMgr, first, loads all information from the registration database. Then for each driver registered, the CModuleMgr creates an instance of the driver by calling the standard OLE function CoCreatelnstance. Next, the CModuleMgr calls each drivers Initialize method, passing to the method the CLSID of the driver component to attach. The CSimpleDriver attaches to the driver component by calling the standard OLE function CoCreatelnstance.</p>
    <p>The driver administrator <b>32</b> can register both drivers and streams. Registering drivers is very direct, since the driver administrator manages the drivers registered in the system. Registering streams, on the other hand, is more complex, since each stream must be registered with a driver and the driver manages the streams registered with it, not the driver administrator. The following discussion describes the process of registering both drivers and streams.</p>
    <p>Registering a driver entails verifying that the module is actually a driver, verifying that the driver can be loaded, and storing the driver information in a persistent location. FIG. 43 describes this process. When registering a driver, the following steps occur.</p>
    <p>First, the driver administrator CPL passes the name of the driver and directs the driver administrator component to register it. Next, the driver administrator component passes the driver name to the CDriverAdminDisp and directs it to register the module. The CDriverAdminDisp directs the CModuleMgr to register the new driver. The CModuleMgr creates a new CSimpleDriver and requests it to register the driver. First the CSimpleDriver verifies that the driver is valid by calling its DLLGetModuleType exported function. If the function returns XMC_DRIVER_MT the CSimpleDriver then calls the driver's exported function DLLRegisterServer to register the module in the OLE system. Next the CLSID is queried from the module by calling its exported DLLGetCLSID function. The CLSID returned is then used to load the driver by calling the standard OLE function CoCreatelnstance. If the CSimpleDriver is successful, the CModuleMgr stores the driver CLSID in the registration database.</p>
    <p>Registering a stream is similar to registering a driver, but a little more complex, since each stream must be registered with a specific driver. FIG. 44 displays the process of registering a stream. When registering a stream, the following steps occur.</p>
    <p>First, the driver administrator CPL passes the CLSID of the driver and the filename of the stream to register with the driver, to the driver administrator component. The driver administrator component directs the CDriverAdminDisp to register the stream. The CDriverAdminDisp object directs the CModuleMgr to register the stream and passes the CLSID of the driver and the name of the stream along to it. First, the CModuleMgr verifies that the CLSID of the driver one of the registered drivers. If it is not, the driver is registered as discussed above.</p>
    <p>Next, the CModuleMgr creates a new CSimpleStream object and directs it to verify and load the stream component. The CSimpleStream first verifies that the module is actually an stream component <b>28</b> by calling its exported DLLGetModuleType function. If the function returns XMC_STREAM_MT, the CSimpleStream continues and registers the stream component by calling its DLLRegisterServer exported function. Finally, the CSimpleStream object queries the new module for its CLSID by calling the module's exported DLLGetCLSID function. The new CLSID is used, by the CSimpleStream, to load the stream component using the standard OLE function CoCreateinstance. If the CSimpleStream succeeds, the CLSID of the stream is passed along to the CSimpleDriver who is directed to register the stream. The CSimpleDriver passes the CLSID to the driver component and directs it to register the stream.</p>
    <p>The following discussion describes setting information in either a driver or stream. When the user edits information in the driver administrator control panel applet <b>38</b>, the applet <b>38</b> directs the driver administrator <b>32</b> to edit the settings for the stream or driver being edited. The following discussion describes how this configuration process works.</p>
    <p>Editing the settings of a driver takes place when the user changes the driver settings displayed in the driver administrator CPL. Changing these settings causes the process described in FIG. 45 to occur within the driver administrator component. The following steps occur when setting the driver configuration.</p>
    <p>When driver settings are changed in the CPL <b>38</b>, the driver administrator CPL directs the driver administrator component to make the appropriate changes to the driver corresponding to the driver handle. A XMC_DRIVER_INFO structure is passed to the component <b>35</b>, describing the new values for the driver. The driver administrator component takes the XMC_DRIVER_INFO structure and the handle to the driver and passes the information to the CDriverAdminDisp object, directing it to change the settings in the driver. The CDriverAdminDisp object directs the CModuleMgr to edit the driver corresponding to the driver handle. The CModuleMgr locates the CSimpleDriver with the handle and directs it to change its settings to those stored in the XMC_DRIVER_INFO structure. The CSimpleDriver passes the XMC_DRIVER_INFO structure to the driver component and directs it to change its settings.</p>
    <p>As shown in FIG. 46, when the user edits stream settings in the driver administrator CPL <b>38</b>, the following steps occur.</p>
    <p>After the user changes settings for the stream in the CPL, the driver administrator CPL directs the driver administrator component to change the stream's settings and passes a handle to the driver containing the stream, a handle to the stream, and a XMC_STREAM_INFO structure describing the new values. The driver administrator component directs the CDriverAdminDisp object to change the streams settings. The CDriverAdminDisp object directs the CModuleMgr to change the settings of the stream corresponding to the handle.</p>
    <p>First, the CModuleMgr locates the driver corresponding to the driver handle. Next, it requests the CSimpleDriver to change the settings for the stream corresponding to the stream handle. The CSimpleDriver searches for the stream corresponding to the stream handle and directs it to change its settings to those stored in the XMC_STREAM_INFO structure. The CSimpleStream directly communicates with the stream component and directs it to change its settings to those in the XMC_STREAM_INFO structure.</p>
    <p>There are two different types of information that may be queried from the driver administrator <b>32</b>: the enumeration of all drivers registered, and the driver information map. The motion control component <b>35</b> uses the driver enumeration when selecting the set of drivers to use and control during motion control operations. The driver information map, on the other hand, is used by the driver administrator CPL <b>38</b> to update the user-interface display describing all drivers and streams registered in the system. The following discussion describes the process of querying for both the driver enumeration and the driver information map. Querying for the driver enumeration occurs during the initialization of the motion control component <b>35</b>. When initializing, the component <b>35</b> must know what drivers to use when performing motion control operations. The driver administrator <b>32</b> Component is used for that very purpose. Querying the driver enumeration just returns a pointer to the IXMC_EnumDriver interface exposed by the driver administrator <b>32</b> Component. FIG. 47 displays the events that occur when using the interface to get each driver in the enumeration. Using the interface causes, the following steps occur.</p>
    <p>First, the motion control component <b>35</b> queries the driver administrator <b>32</b> Component for the next driver. Next, the driver administrator <b>32</b> Component directs the CDriverAdminDisp to get the next driver supported. The CDriverAdminDisp directs the CModuleMgr to get the next driver. The CModuleMgr then directs the CSimpleDriver to either return the CLSID or a pointer to the IUnknown interface for the driver, depending on the parameters of the enumeration. If the CSimpleDriver is requested to return a pointer to the IUnknown interface, the interface is queried from the driver component.</p>
    <p>Another set of information that may be queried from the driver administrator <b>32</b> consists of the driver information map. This data is used by the driver administrator CPL <b>38</b> when displaying information describing the drivers and streams registered in the system. As shown in FIG. 48, when querying the system for the driver interface map, the following steps occur.</p>
    <p>First, the driver administrator CPL <b>38</b> queries the driver administrator <b>32</b> Component for the current driver information map. When queried, the driver administrator component directs the CDriverAdminDisp to create and load a CDriverInfoMap class. The CDriverAdminDisp creates the CDriverInfoMap. Next, the CDriverAdminDisp passes the CDriverInfoMap to the CModuleMgr and directs it to load the information map. The CModuleMgr queries each driver registered for its internal information. Each CSimpleDriver communicates directly with the driver component and queries it for all pertinent driver information. Next, the CModuleMgr queries each driver for a list of all streams registered with the driver. Using the stream enumeration, each CSimpleDriver creates an array of CSimpleStream objects and returns the array to the CModuleMgr. For each CSimpleStream object in each array, the CModuleMgr queries for all pertinent stream information. Each CSimpleStream communicates directly with the stream component and queries it for all information describing the stream.</p>
    <p>After the driver administrator CPL <b>38</b> or the motion control component <b>35</b> are finished using the driver administrator <b>32</b>, they must release the component <b>35</b> to free any resources it was using. FIG. 49 describes this process. When cleaning up after a call to the Release method, the following steps occur.</p>
    <p>First, either the driver administrator CPL <b>38</b> or the motion control component <b>35</b> must direct the driver administrator <b>32</b> Component to release itself by calling its Release method. Next, the driver administrator component directs the CDriverAdminDisp object to free all resources used in the system. The CDriverAdminDisp then directs the CModuleMgr to free any resources that it is using. First, the CModuleMgr traces through all CSimpleDriver objects, querying each for their CLSID and enabled state. Next, each CSimpleDriver is freed. Each CSimpleDriver object freed, frees all arrays of CSimpleStream objects registered with it. When freed, each CSimpleStream object releases all interfaces that it was using from the stream component. In its final clean-up, each CSimpleDriver releases all interfaces that it was using from the driver component. All CLSID and enabled state information is stored persistently in the registration database.</p>
    <p>FIG. 50 depicts an interface map for the driver administrator <b>32</b>. Also, attached hereto as Appendix G is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the driver administrator <b>32</b> component.</p>
    <heading>VII. Driver Administrator CPL Applet</heading> <p>This document describes the design of the driver administrator control panel applet <b>38</b> (CPL) that is used by the user to add, configure, and remove both drivers <b>30</b> and stream components <b>28</b> later used by the component <b>35</b> when directed to carry out motion control operations. With regard to design, there are three main types of “views” used to look at how the control panel applet works.</p>
    <p>First, a module interaction map shown in FIG. displays all main executable and user-interactable items, or modules, that the CPL uses and interacts with. For example, when a dialog is displayed by the CPL executable, both the dialog and the CPL modules are considered to interact with one another. Technically, the dialog is not a module since it is a figment displayed on the screen, but none the less, module interaction maps classify them as such since they are key destination points for user-input.</p>
    <p>Second, an object interaction map shown in FIG. 52 displays all main objects making up the modules described in the module interaction map. Objects consist of the actual instances of C++ classes defining each object. All interactions between the objects are drawn out in this interaction map.</p>
    <p>Finally, FIGS. 53-57 display a set of scenario maps are drawn out using the object interaction map as a basis. Scenario interaction-maps describe the interactions taking place during a specific operation. Initialization, Adding a driver to the system, and Viewing the support offered by a driver, are all examples of a scenario interaction-map.</p>
    <p>The design goals for the driver administrator <b>32</b> are the following:</p>
    <p>1. User-Interface separation—Implement all user-interface elements used to control the driver administrator <b>32</b> Component.</p>
    <p>2. Upgradable to OCX Client—Eventually each driver and stream may implement all UI elements with an OCX that then passes all input to the corresponding driver or stream. The driver administrator CPL <b>38</b> must be designed in a way that is easy to upgrade to become an OCX client.</p>
    <p>3. Provide Stream Independence—drivers <b>30</b> should not be required to use streams <b>28</b> in order to operate. The design of the driver administrator <b>32</b> must make amends to ensure that it is not dependent on stream component <b>28</b> operations to operate.</p>
    <p>4. Use Windows 95 UI—When ever possible, Windows 95 UI elements should be used. For example, TreeViews, ImageLists, Button Bars, Tab Dialogs and any other UI elements should be put to use to ensure a Windows 95 look-and-feel.</p>
    <p>The following discussion describes the module interaction map for the control panel applet <b>38</b>. A module is defined as either an executable binary, an external data file, or a main user-interface element used when interacting with the user. FIG. 51 is a drawing of all modules that interact with each other when running the driver administrator control panel applet.</p>
    <p>The driver administrator CPL <b>38</b> is a control panel applet. And, a control panel applet is a special DLL that exports several functions allowing the Windows Control Panel to communicate with the applet.</p>
    <p>The Driver Administrator Dialog is the main dialog that appears when selecting the control panel applet icon from the Windows Control Panel.</p>
    <p>The Browse Dialog is used to query the user for a filename. For example when adding a new stream or driver, the driver administrator uses this dialog to ask the user for the location of the new driver or stream to add.</p>
    <p>The View Support Dialog displays the support provided by the selected driver <b>30</b>. Each driver may support a different set of extended functionality. This dialog shows the user exactly how much support is provided by each driver allowing them to determine which functions within their application may not operate when using the driver.</p>
    <p>Unlike the Module Interaction-Map described above, the Object Interaction-Map shown in FIG. 52 describes how the actual instances of C++ objects interact with one another within each module.</p>
    <p>Other than showing that each dialog is managed by the object, whose name is displayed in the dialog, the main difference from the module IA-map are both the CComCPL and CDriverAdmin C++ objects. Both objects are described below.</p>
    <p>As the description of each dialog class is fairly straight forward and very similar to the dialog description above they will not be described in this section. This section will describe all other C++ objects.</p>
    <p>The CComCPL is a C++ object that is generated by the COMBuilder application from a template. It is used to handle all Windows messages sent from the Control Panel Application.</p>
    <p>The CDriverAdmin object is used to drive, control, and manage the use of the driver administrator <b>32</b> Component. For example, all OLE 2.0 interface management and data translation is handled by this object. Data translation involves translating data from a standard C++ format to a raw format that is handled easily with the OLE 2.0 data transfer mechanisms.</p>
    <p>Scenario Interaction-Maps are almost identical to object interaction-maps but they only display the objects and interactions taking part in a specific operation. Also, each interaction is numbered by the sequence in which they occur while the operation is running. The following discussion describes several key operations that occur while running the driver administrator CPL <b>38</b> Applet.</p>
    <p>Initialization occurs when the user first runs the CPL Applet. During this process all other objects are initialized and several modules are loaded. There are two steps that take place during the initialization process: First the application is initialized, and second the dialog is initialized with values queried from the driver administrator <b>32</b> Component. The following sections describe each.</p>
    <p>Initializing the application, which is shown in FIG. 53, occurs when the application is first run and the main dialog has not yet been displayed. When initializing the application, the following steps occur.</p>
    <p>Through a Windows message, Windows notifies the CComCPL object that the Control Panel Applet has just been loaded. CComCPL then loads the CDriverAdminDialog and tells it to do any dialog prepping before going modal. Next, CDriverAdminDialog loads any settings stored in the Registration Database. For example, the current window position and active tab may be stored in the database. CDriverAdminDialog then Loads the CDriverAdmin class and directs it to initialize itself. During initialization, CDriverAdminDialog creates an instance of the driver administrator <b>32</b> and queries all interfaces that will be used.</p>
    <p>Once the application is initialized, the default settings to be displayed in the dialog must be set. These values are set when the dialog is initialized, just before displaying it. FIG. 54 describes this process. During the process of initializing the dialog, the following steps occur.</p>
    <p>During the dialog preparation that occurs before the DoModal call, CDriverAdminDialog queries the CDriverAdmin object for the driver enumeration to be used when setting initial values to be displayed in the dialog box. CDriverAdmin uses the driver administrator <b>32</b> Component to query for the driver information map, which is then passed back to the CDriverAdminDialog. Once receiving the driver information map, the CDriverAdminDialog uses the information to update all user-interface items related to either drivers or streams.</p>
    <p>Adding a driver to the system <b>22</b> can be broken down into two steps. First, the module name must be added to the system. Next, the driver administrator <b>32</b> main dialog must update itself to reflect the new driver just added.</p>
    <p>Adding a driver occurs when the user presses the “Add . . . ” button on the driver administrator <b>32</b>'s main dialog. FIG. 55 describes this process. When adding a new driver, the following steps occur.</p>
    <p>When adding a driver, first the user must press the “Add . . . ” button. After pressing the button, CDriverAdminDialog opens up the common open file dialog. The user must enter in the filename of the driver to add and close the dialog. CDriverAdminDialog then passes the filename to the CDriverAdmin object and calls the RegisterDriver method passing in the name of the module to register as a driver. CDriverAdmin then passes the driver filename to the driver administrator <b>32</b> Component and directs it to register the driver in the system <b>22</b>.</p>
    <p>The process of updating the main dialog is identical to the process of initializing the dialog discussed above.</p>
    <p>Similar to the process of adding a new driver, removing a driver involves both removing the driver from the system and then updating the main dialog. Pressing the “Remove” button removes a driver from the XMC software system. FIG. 56 describes this process. The following steps occur when removing a driver.</p>
    <p>To remove a driver, the user must first select the “Remove” button. After pressing the button, the selected driver or parent driver to the selected stream will be removed. CDriverAdminDialog passes the XMC_HDRIVER of the driver to the CDriverAdmin and directs it to remove the driver by calling its UnRegister method. CDriverAdmin passes the XMC_HDRIVER to the driver administrator <b>32</b> Component and directs it to UnRegister the driver.</p>
    <p>The process of updating the main dialog is identical to the process of initializing the dialog discussed above.</p>
    <p>Viewing Support involves viewing the level of support implemented by the selected driver. FIG. 57 describes the process of providing this information to the user via the View Support Dialog. The following steps occur when viewing the support provided by the driver.</p>
    <p>First the user must select the “View Support” button on the driver administrator main dialog. When selected, CDriverAdminDialog queries CDriverAdmin for the driver support information. CDriverAdmin passes the query on to the driver administrator <b>32</b> component who actually fills out the information. Once the queried information is returned, the CDriverAdminDialog passes it on to CViewSupportDialog. CViewSupportDialog initializes itself using the driver support information.</p>
    <p>Attached hereto as Appendix H is a document that describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the driver administrator <b>32</b>.</p>
    <heading>VIII. Driver Administrator CPL Applet</heading> <p>This section contains a description of the driver administrator control panel applet <b>38</b>. When using the driver administrator <b>32</b> to configure the motion control system, there are two main items that the user will work with: drivers and streams. Each driver <b>30</b> generates the hardware specific, control codes that are then sent to the selected stream component <b>28</b>. Streams facilitate the data transport layer between the driver and the control-code destination.</p>
    <p>Depending on the current hardware setup, different streams may be used. For example, if the hardware is connected to the PC Bus, a PC Bus stream will be used to communicate to it. On the other hand, if the hardware is connected through a serial cable to a serial I/O Port, the serial stream will be used. Finally, all hardware configurations may use the file stream. When using the file stream, all control-codes are sent to the specified file that can be downloaded to the hardware at a later time.</p>
    <p>This section describes both drivers and streams, and how each is configured. This section initially describes the driver items and all property pages used to edit them. This section also contains a description of the streams and their property pages. Finally, this section describes the about box containing details on the Software.</p>
    <p>The main purpose of each driver is to generate the hardware-specific control-codes directing the hardware to carry out specific motion control actions. For example, such actions may include querying the hardware for the current position or directing the hardware to move to a predetermined location in the system. The following discussion describes the property pages used to configure each driver.</p>
    <p>There are two types of properties affecting each driver. First, a set of defaults may be set that are used by the motion control component <b>35</b> as recommended values. The scaling and units used are several example default values. In addition to setting default values, if the driver supports more advanced configuration, pressing the Advanced . . . button will display a dialog box used to set the driver configuration. For example, if a driver does not support streams, the advanced configuration dialog, provided by the driver, will allow the user to set the I/O Port and IRQ settings.</p>
    <p>The properties affecting drivers <b>30</b> are as follows.</p>
    <p>Scaling—Setting the scaling property affects the default scaling used on all axes within the motion control system. The range for scaling values is (0.0, 1.0]. Default setting may be overridden when programming XMC by using the IXMC_StaticState interface.</p>
    <p>Units—Setting the units property affects all coordinates used when programming the system <b>22</b>.</p>
    <p>The unit descriptions are as follows:</p>
    <p>MM_ENGLISH—Inches are used as the base unit for all coordinates</p>
    <p>MM_METRIC—Millimeters are used as the base unit for all coordinates.</p>
    <p>MM_NATIVE—The native coordinates defined by the hardware system are used. Coordinates used to program XMC are mapped <b>1</b>:<b>1</b> to the hardware coordinates.</p>
    <p>Advanced . . . —Pressing this button will display a dialog used to edit any advanced properties for the driver that may be edited by the user.</p>
    <p>In addition to allowing the user to set properties, each driver property page displays the full names of both the hardware supported and the hardware vendor who makes the hardware.</p>
    <p>The buttons along the bottom of the windows work with the selected driver or stream. The following discussion describes each button and what it does.</p>
    <p>Pressing the Make Default button selects the current driver to be the default. If a stream is selected, its parent driver becomes the default driver. The default driver is later used by the motion control component <b>35</b> </p>
    <p>Selecting the Add . . . button, displays the Add Module dialog. This dialog is used to add new drivers and streams to the system <b>22</b>. Once selected, the new driver or stream will be displayed in the Driver tree view. When adding a stream, the stream is added under the currently selected driver. To enable the stream, you must select the enable check box located in the streams property page.</p>
    <p>Selecting the Remove button, removes the current driver or stream selected. If a driver is removed all of its streams are also removed.</p>
    <p>Selecting the View Support. . . button displays a dialog used to view the level of XMC support implemented by the driver. For example, all API interfaces and subsequent methods are displayed. If a lack of implementation within the driver prohibits an API interface from operating, the driver stub <b>36</b> is used. If the lack of implementation within the driver <b>30</b> cannot be replaced by operations within the driver stub <b>36</b>, the interface or method is disabled.</p>
    <p>The following are descriptions of each graphic found in the XMC Support View Dialog.</p>
    <p>D—This graphic means that the interface or method is implemented by the driver <b>30</b>.</p>
    <p>S—This graphic means that the interface or method is implemented within the driver stub <b>36</b>.</p>
    <p>X—This graphic means that the interface or method is disabled because of a lack of implementation within the driver <b>30</b>.</p>
    <p>Like the properties page, a debug page is also provided to set all debugging settings for the driver. Each driver may specify that all API calls used to control the driver are logged. The logging settings only affect the current driver selected. The Output field allows you to select the output stream where all debug information is sent. When Streams is enabled, debug information is sent to the specified text file. When Debug Monitor is enabled, debug information is sent to the debug monitor if it is running. Using Enable to enable a stream turns it on causing all debug information generated to be sent to the stream. More than one stream may be enabled at one time.</p>
    <p>Stream Settings are available for each debug stream supported. Text File allows the name of the text file may be set. The Debug Monitor can only be enabled and disabled.</p>
    <p>A stream is the transport layer used by the driver to pass data to the destination location. The destination location may be the actual motion control hardware or even a text file. Usually the control language used by a hardware vendor is supported by several different flavors of their motion control hardware. For example, some vendors have both PC Bus based and Serial I/O based motion control hardware that understand the same control language. In such a case, the same driver would be used for each hardware setup but it would communicate with different streams depending on the specific hardware setup. Graphically, each stream is listed below each driver that uses the stream.</p>
    <p>This section describes the streams supported by the system <b>22</b> and how they are configured.</p>
    <p>The PC Bus stream sends all data directly to a PC Bus based motion control hardware system by writing to the specified I/O Ports and IRQ's defined by the hardware. This section describes both the properties and debug settings available for the PC Bus Stream.</p>
    <p>Stream properties only affect the currently selected stream. The user is required to select certain settings, such as the I/O Port and IRQ. Without setting these values, the PC Bus Stream will not be able to communicate with the hardware. The properties affecting PC Bus Streams are described below.</p>
    <p>The I/O Port is the base port used to communicate with the motion control hardware that the stream is to send data to.</p>
    <p>The IRQ is the interrupt request level used by the hardware.</p>
    <p>Pressing the Advanced . . . button will display a dialog allowing the user to edit more advanced stream options. For example, if the stream supports a Port I/O map that the user can edit, the port map would be displayed in this dialog. This button is only enabled for streams supporting advanced features that the user may edit.</p>
    <p>When debugging an application program it may be useful to see what codes are actually sent to the hardware. The Debug Settings page for streams allows the user to enable and disable both the Cmd and Bit Streams. The Cmd Stream is used to log all command-codes sent to the hardware. If this level of detail does not provide you with enough information, the Bit Stream may be used. When enabled, the Bit Stream logs all values sent through each hardware port. All values read from and written to each port used by the hardware are logged. Note, when enabled, both streams may significantly slow down the application programming the motion control system.</p>
    <p>Serial RS-232 Streams are used to send data from the driver to motion control hardware connected to the computer through the serial I/O port. Both property and debug settings only affect the selected Serial RS-232 Stream. The following discussion describes the available settings in each in detail.</p>
    <p>All Serial RS-232 property settings must be set by the user for they let the stream know what I/O port and communication protocol to use when communicating with the hardware. The properties affecting Serial RS-232 Streams are as described below.</p>
    <p>The Port is the serial port that the hardware is connected to. COM<b>1</b>-COM<b>4</b> are valid ports that can be used. The Baud Rate is the speed of data transmission supported by the hardware.</p>
    <p>When Hardware is selected a more efficient, but less compatible, communication protocol is used to communicate to the hardware. If errors occur when this protocol is selected, use the XON/XOFF communication rotocol.</p>
    <p>When the XON/XOFF communication protocol is selected a simple and more compatible communication protocol is used.</p>
    <p>Debug settings for the Serial RS-232 Stream are very similar to those supported by the PC Bus Stream. Serial RS-232 Streams only support command logging through the Cmd Stream and do not support bit logging.</p>
    <p>The Text File Stream is used to build control-code programs for later use. Using this stream facilitates running the XMC software in code-generation-mode. No motion control actions take place when running in this mode. Instead, control-code programs may be built and stored to file. Later, after programs are built and saved, they may be downloaded to the motion control hardware and run. The following discussion describes the property and debug settings for the Text File Stream.</p>
    <p>The main property set, when configuring a Text File Stream, is the actual name and location of the file to use. Once set, the stream is ready for use.</p>
    <p>The following properties may be configured for the Text File Stream:</p>
    <p>Filename is the filename and location of the file used to store all control-codes generated by the driver <b>30</b> selected. Pressing the Browse . . . button displays a dialog allowing you to graphically select the location and filename to use.</p>
    <p>No debug settings are available for the Text File Stream.</p>
    <heading>IX. Language Driver</heading> <p>FIG. 58 contains a module interaction map depicting a language driver <b>44</b> and illustrating how that language driver <b>44</b> interacts with the streams <b>28</b>, the driver administrator <b>32</b>, the motion control component <b>35</b>, and the registry <b>42</b>.</p>
    <p>As with the software drivers <b>30</b> described above, one language driver <b>44</b> is used for each of the motion control devices <b>20</b> of the group of supported motion control devices. The language drivers <b>44</b> perform the same basic function as the software drivers <b>30</b> described above with reference to FIGS. <b>1</b> and <b>12</b>-<b>21</b>. To the software system <b>22</b>, the language drivers <b>44</b> are accessed and respond in the same manner as the software drivers <b>30</b>; the differences between the language drivers <b>44</b> and the software drivers <b>30</b> are entirely internal.</p>
    <p>The primary difference between these drivers <b>30</b> and <b>44</b> is that the language drivers <b>44</b> use a database the key fields of which are an index field, a command format field, and a response format field. Each record or row in the database corresponds to a given Driver function.</p>
    <p>The purpose of the command and response format templates is to formalize and simplify the process of constructing command data strings and format data strings which contain commands and parameters to be transmitted to the motion control devices <b>20</b>. The format templates define how, for a given SPI command, the software system <b>22</b> communicates with a vendor specific hardware command language associated with a given motion control device <b>20</b> associated with a given language driver <b>44</b>. Accordingly, one database containing command format templates and response format templates will be created for each such language.</p>
    <p>The command format field contains a command format template, and the response format field contains a response format template. Each of these templates comprises a sequence of data type identifiers, macro identifiers, syntax characters, and/or ASCII characters.</p>
    <p>The index field contains a value unique to each Driver function that facilitates the process of looking up the command and response format templates associated with a given Driver function.</p>
    <p>The software system designer defines the data type identifiers, macro identifiers, and syntax characters discussed above. In general, the data type identifiers and syntax characters are common to both the command format template and the response format template.</p>
    <p>The macro identifiers will normally correspond to macros that are associated with either the command format templates or the response format templates. The ASCII characters are defined by the Driver function and the particular motion control device <b>20</b> with which a given language driver <b>44</b> is associated.</p>
    <p>An Excel spreadsheet may be used as an organizational tool that facilitates creation of the database used by the language driver <b>44</b>. An example of a Excel spreadsheet that may be used for this purpose is shown in FIG. <b>67</b>. The spreadsheet shown in FIG. 67 is saved as a tab-delimited file and then copied into the SPI database shown in FIG. <b>59</b>.</p>
    <p>The spreadsheet shown in FIG. 67 is simply an organizational tool and will not be described herein in detail. But it should be noted that the exemplary spreadsheet shown in FIG. 67 sets forth a list of typical command and response data type identifiers, along with descriptions thereof, and lists of command and response macros. These will be supplemented by an additional STRUCT data type that allows the programmer to define a data type that combines the other primitive data types as necessary for a given template.</p>
    <p>The language drivers thus operate generally as follows. As described above, the motion component <b>35</b> will call the driver function implemented by the language driver <b>44</b> and, in many cases, will pass parameters necessary to carry out that function. The language driver <b>44</b> will use the index for that driver function to look up the command format template and the response format template associated with the appropriate driver function.</p>
    <p>Using the command format template, the language driver <b>44</b> will construct a command data string containing ASCII characters. The command data string carries the commands and parameters necessary to implement the given driver function in a desired manner on the motion control device <b>20</b> associated with the language driver <b>44</b>.</p>
    <p>Similarly, the language driver <b>44</b> uses the response format template to parse a response data string sent by the particular motion control device <b>20</b> in response to the command data string. The response format template thus allows the language driver <b>44</b> to pass from the motion control device <b>20</b> to the motion control component <b>35</b> any commands and/or parameters necessary to enable the controlling application <b>26</b> to function as intended.</p>
    <p>The following sets forth examples of the process of generating a command data string and parsing a response data string given a set of command and response format templates associated with a single SPI.</p>
    <heading>EXAMPLE 1</heading> <p>The first example illustrates how the language driver <b>44</b> might deal with the Driver function IXMC_DrvExt_Test::Move.</p>
    <p>Cmd Format: D%d,+:@[snd]GO%b+:@[snd]</p>
    <p>Rsp Format: @[crlf]&gt;@[rcv]@[crlf]&gt;@[rcv]</p>
    <p>Driver function Call: pXMCDrvExtTest-&gt;Move(<b>20</b>.<b>0</b>, <b>30</b>.<b>0</b>)</p>
    <p>This function call directs the motion control device to move 20 units in the x direction and <b>30</b> units in the y direction. The driver communicates with the stream as follows:</p>
    <p>Step 1. Perform the operation in the command format template up to the first @ symbol. This builds a raw command string of “D20.0,30.0:”</p>
    <p>Step 2. After the first @ symbol is the send command, which sends the string that was built in step 1. The language driver has now reached the G in the command format template.</p>
    <p>Step 3. After the send command, the language driver reads a response from the stream to confirm that the command string was received and processed correctly. The response string received from the stream is as follows: “\r\n&gt;”.</p>
    <p>Step 4. The language driver next uses the response format template to parse the raw response string to verify operation and extract data. The language driver then picks up at the G in the command format template and constructs the next raw command string of “GO11”, leaving off at the last macro.</p>
    <p>Step 5. The language driver, picking up at last macro in the command format template, then sends the raw command string created in step 4 to the stream, completing the command format template.</p>
    <p>Step 6. Again, after the send command the language driver receives a response data string from the stream as follows: “\r\n&gt;”.</p>
    <p>Step 7. The language driver next parses the response data string received in step 6.</p>
    <heading>EXAMPLE 2</heading> <p>The second example illustrates how the language driver <b>44</b> might deal with the Driver function IXMC_DrvExt_Test::SetVelocity.</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="140pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Cmd Format:</td>
                <td class="description-td">V%lf,+:@[snd]</td>
              </tr> <tr class="description-tr"> <td class="description-td">Rsp Format:</td>
                <td class="description-td">@[crlf]&gt;@[rcv]</td>
              </tr> <tr class="description-tr"> <td class="description-td">Driver function Call:</td>
                <td class="description-td">pXMCDrvExtTest—&gt;SetVelocity( NOP, 22.0 )</td>
              </tr> <tr class="description-tr"> <td class="description-td">Explanation</td>
                <td class="description-td">Set the velocity of the y axis to 22.0.</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="91pt" align="left"> </colspec> <colspec colname="2" colwidth="126pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Raw Command String:</td>
                <td class="description-td">“V,22.0:”</td>
              </tr> <tr class="description-tr"> <td class="description-td">Raw Response String:</td>
                <td class="description-td">“\r\n&gt;” (expected)</td>
              </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <heading>EXAMPLE 3</heading> <p>The third example illustrates how the language driver <b>44</b> might deal with the Driver function</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" pgwide="1" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="259pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">IXMC_DrvExt_Test::GetVelocity.</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="84pt" align="left"> </colspec> <colspec colname="2" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Cmd Format:</td>
                <td class="description-td">GV%b+:@[snd]</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Rsp Format:</td>
                <td class="description-td">%d,+@[crlf]&gt;@[rcv]</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Driver function Call:</td>
                <td class="description-td">pXMCDrvExtTest—&gt;GetVelocity( NOP, %dfY_Vel )</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Explanation</td>
                <td class="description-td">Get the velocity set for the y axis.</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="98pt" align="left"> </colspec> <colspec colname="2" colwidth="161pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Raw Command String:</td>
                <td class="description-td">“GV01:”</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">Raw Response String:</td>
                <td class="description-td">“,44.0\r\n&gt;” (expected)</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="259pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">dfY_Vel = 44.0</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <heading>EXAMPLE 4</heading> <p>The fourth example illustrates how the language driver <b>44</b> might deal with the Driver function IXMC_DrvExt_Test::Reset.</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" pgwide="1" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="189pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Cmd Format:</td>
                <td class="description-td">!RESET:@[snd]MA0:MC0:LH0:@[snd]</td>
              </tr> <tr class="description-tr"> <td class="description-td">Rsp Format:</td>
                <td class="description-td">@[crlf]*VENDOR NAME — MODEL@[rcv]@[crlf]&gt;@[rcv]</td>
              </tr> <tr class="description-tr"> <td class="description-td">Driver function Call:</td>
                <td class="description-td">pXMCDrvExtTest—&gt;Reset()</td>
              </tr> <tr class="description-tr"> <td class="description-td">Explanation</td>
                <td class="description-td">Reset the hardware.</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="91pt" align="left"> </colspec> <colspec colname="2" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Raw Command String1:</td>
                <td class="description-td">“!RESET:”</td>
              </tr> <tr class="description-tr"> <td class="description-td">Raw Response String1:</td>
                <td class="description-td">“\r\n*VENDOR NAME — MODEL” (expected)</td>
              </tr> <tr class="description-tr"> <td class="description-td">Raw Command String2:</td>
                <td class="description-td">“MA0:MC0:LH0:”</td>
              </tr> <tr class="description-tr"> <td class="description-td">Raw Response String2:</td>
                <td class="description-td">“\r\n&gt;” (expected)</td>
              </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <p>While the language driver <b>44</b> is of particular importance in the context of the software system <b>22</b> described above, this technology may have broader application to any hardware in which ASCII strings are employed to transmit commands to and receive responses from hardware.</p>
    <p>The language driver <b>44</b> will now be described in more detail. The language driver <b>44</b> is used by both the driver administration <b>32</b> and the motion control component <b>35</b>. Its main purpose is to implement functionality that generates motion control commands for the specific hardware supported.</p>
    <p>For example, the AT6400 driver used to control the Compumotor AT6400 motion control hardware, generates AT6400 command codes. During the initialization phase of the system <b>22</b>, the driver administrator <b>32</b> communicates with each language driver <b>44</b>, allowing the user to add, remove, or change the configuration of the driver <b>44</b>. When an application using the system <b>22</b> is run, the component <b>35</b> communicates with the language driver <b>35</b> directing it to carry out the appropriate motion control operations.</p>
    <p>Unlike the driver <b>30</b> described above, which communicates with motion control devices <b>20</b> by directly sending binary codes, the language driver <b>44</b> sends ASCII text to the stream <b>28</b>, which then sends the information on to the motion control device <b>20</b>.</p>
    <p>This section makes reference to a number of drawings to describe the features implemented in the language driver <b>44</b>: (a) the Module Interaction-Map in FIG. 58 that displays all binary modules that interact with the driver and how they interact with one another; (b) an Object Interaction-Map (FIG. <b>59</b>), which corresponds to the module interaction map expanded to display the internal C++ objects making up the language driver <b>44</b>, and how these objects interact with one another; (c)a number of Scenario Maps (FIGS. 60-65) that display the interactions taking place between the C++ objects involved during a certain process; (d) an interface map that describes the interfaces exposed by the language driver component <b>44</b>, all data structures used, and the definitions of each C++ class used; and (b) a table illustrating how a typical database employed by the language driver <b>44</b> is constructed (FIG. <b>67</b>).</p>
    <p>The module interaction-map in FIG. 58 displays all binary modules and their interactions with the Language Driver <b>44</b>. There are two modules that interact directly with the driver <b>44</b>: the Motion Control Component <b>35</b>, and the Driver Administrator <b>32</b>. The driver administrator <b>32</b> queries and changes the drivers settings and the component <b>35</b> directs the driver <b>44</b> to carry out motion control operations, such as moving to a certain location in the system.</p>
    <p>Mores specifically, the module interaction-map shown in FIG. 58 contains the following modules:</p>
    <p>The Driver Administrator module <b>32</b> is used to install, uninstall, register, and setup each driver and stream module.</p>
    <p>The Motion Component is the motion control component <b>35</b> used by applications <b>26</b>. The component <b>35</b> communicates with the current driver <b>44</b> passed to it by the driver administrator <b>32</b> to carry out motion control operations requested by the application <b>26</b>.</p>
    <p>The Language Driver <b>44</b> generates the ASCII codes making up the hardware command language. A given language driver <b>44</b> only communicates with a stream <b>28</b> that has been specifically connected to that driver <b>44</b>. Once connected, the stream <b>28</b> is used to communicate with the destination object, such as the PC Bus, serial I/O connection, text file, or debug monitor.</p>
    <p>The Streams <b>28</b> are the actual objects that operate as the data transport layer for each driver <b>44</b>. Each stream <b>28</b> has a different target that defines the type of the stream.</p>
    <p>The Registry <b>42</b> is the standard Windows registration database.</p>
    <p>The object interaction-map in FIG. 59 breaks the module interaction-map shown in FIG. 58 down into more detail by including the interactions taking place between all C++ objects used to implement the driver <b>44</b>.</p>
    <p>Each object in the diagram is described as follows.</p>
    <p>CDriverObject This is the main C++ object that implements all OLE specific functionality including the function shells for all OLE interfaces exposed by the object.</p>
    <p>CDrvCoreDispThis is the C++ object used to dispatch all core SPI OLE interface functions to their respective internal implementations. In addition to the methods inherited from the CLangDrvCoreDisp object, this object dispatches driver specific SPI, such as the core XMCSPI OLE interface methods.</p>
    <p>CLangDrvCoreDisp All language driver core functionality is dispatched through this object to its internal implementation. For example, the generic language driver implementation for initialization is dispatched through this object to its implementation residing in the LANG_DRV basecode library.</p>
    <p>CDrvExtDisp This is the C++ object used to dispatch all extended SPI OLE interface functions to their respective internal implementations. In addition to the methods inherited from the CLangDrvExtDisp object, this object dispatches driver specific SPI, such as the extended XMCSPI OLE interface methods.</p>
    <p>CLangDrvExtDisp All language driver extended functionality is dispatched through this object to its internal implementation. For example, all stream handling is dispatched through this object to its implementation residing in the LANG_DRV basecode library.</p>
    <p>CCommandMgr This object is used to build commands sent to the stream, and extracting responses received from the stream. The CCommandMgr is the controlling object that manages the CCommand, CResponse, and CCommandDatabase objects.</p>
    <p>CCommand The CCommand object builds command strings that are then sent to the CSimpleStream. Each command built is a complete motion control command string.</p>
    <p>CResponse This object converts raw response strings, returned by the CSimpleStream, and converts them into C++ data types. For example, a response string containing position data may be converted into a set of double values.</p>
    <p>CCommandDatabase This object stores the complete database of commands making up the motion control command language. The database may be represented as an actual external database (such as a SQL database), a text file, or stored inside the driver as a custom resource. Currently, the language driver only supports databases stored as a custom resource within the driver module.</p>
    <p>CSPIInfo This object makes up one database entry stored within the CCommandDatabase object.</p>
    <p>CStreamMgr This object is responsible for managing the set of streams registered with the driver. Streams, may be added, removed, and enabled. Only enabled streams actually send data to their targets. For example, only an enabled PCBus stream will send data to the motion control card plugged into the PCBus.</p>
    <p>CSimpleStream This object is used to initialize, create, and communicate directly with the underlying stream component.</p>
    <p>CDriverInfoMgr This object is responsible for creating the CDriverInfo object.</p>
    <p>CDriverInfo This object contains the complete set of state data making up the Language driver <b>44</b>. All driver settings and a list of all XMC Streams used are stored within this object. Basic queries are routed directly to this object. More complex operations are handled by one of the various manager objects, who connect to this object, perform the operation, and then disconnect from it.</p>
    <p>CRegistryMgr This object is used to save and load the information, stored within the CDriverInfo object, to and from the registration database. In specific, contains the code called when the ICOM_PersistRegDB interface is invoked.</p>
    <p>CRegistry This object performs all registration database operations such as creating keys, saving values, and querying values.</p>
    <p>All main scenarios, or operations, that occur on the Language Driver <b>44</b> will now be described with reference to FIGS. 60-66. Each scenario-map contained in these figures displays all objects involved and the interactions that take place between them in the sequence that they occur.</p>
    <p>There are two types of operations that occur on the Language driver <b>44</b>. First, the Driver administrator <b>32</b> may initiate operations, such as adding streams or configuring the driver. And second, the Motion control component <b>35</b> may initiate operations on the driver when an application is actually running.</p>
    <p>Referring now to FIGS. 60-64, all operations made on the driver <b>44</b> by the driver administrator <b>32</b> will be described. Each figure is discussed in the order that it may occur when using the driver <b>44</b>.</p>
    <p>Before a driver may be used by the XMC Motion Component, it must be registered in the OLE system. As shown in FIG. 60, in order to register a driver the driver administrator, first verifies that the module being registered is actually an appropriate language driver, then it calls the DLLRegisterServer exported function to register the driver. Each module of the system <b>22</b> exports a function called DLLGetModuleType. This function is used to verify that the module is an appropriate driver component.</p>
    <p>Next, the driver administrator can load the component using the OLE CoCreatelnstance function. During the initialization process, the driver loads all registration data and initializes the CDriverInfo and all C++ manager objects.</p>
    <p>The following describes in detail each of the steps set forth in FIG. <b>60</b>.</p>
    <p>1. During initialization, the driver administrator must load the DLL, containing the stream component, verify that the module is an XMC Driver. To do so, the driver administrator calls the DLLGetModuleType function, exported by the driver. If the function returns a value that contains the value XMC_DRIVER_MT in the high byte, then the driver administrator proceeds and registers the driver by calling its exported function, DLLRegisterServer. When called, the implementation of the DLLRegisterServer writes all OLE 2.0 registration information, needed to register the OLE component, to the Windows registration database.</p>
    <p>2. Next, the driver administrator must query the driver module for its CLSID. Calling the driver's exported function, DLLGetCLSID, returns the CLSID. Once it has the CLSID, the driver administrator may create an instance of the driver by calling the standard OLE function CoCreateinstance.</p>
    <p>3. CoCreatelnstance automatically initializes the component by calling the ICOM_Base::Initialize method implemented by the CDriverObject.</p>
    <p>4. The implementation of ICOM_Base::Initialize directs both the CDrvCoreDisp to initialize itself.</p>
    <p>5. Within its initialization, the CDrvCoreDisp object initializes each of its manager objects, starting with the CcommandMgr.</p>
    <p>6. During its initialization, the CCommandMgr directs the CCommandDatabase to load itself.</p>
    <p>7. To load the database, the CCommandDatabase object reads in the database and builds the CSPIInfo list of database elements.</p>
    <p>8. After initializing the CCommandMgr, the CDrvCoreDisp object directs the CDriverInfoMgr object to create the CDriverInfo object, that will later store the internal state of the Language driver <b>44</b> component.</p>
    <p>9. The CDriverInfoMgr object creates the CDriverInfo object and passes it back to the dispatch object. The pointer to this object is later stored in the components state handle, when the CDriverObject calls ICOM_Base<b>2</b>::SetStateHandle.</p>
    <p>10. Next, the CDrvCoreDisp object initializes the CStreamMgr, that is used to perform all stream operations.</p>
    <p>11. Next, the CDrvCoreDisp object initializes the CRegistryMgr, that is used to perform all registration database operations.</p>
    <p>12. Finally, the CDriverObject initializes the CDrvExtDisp object.</p>
    <p>It should be noted that all initialization is initiated through the COM Auto-Init mechanism. Auto-init occurs when creating an object. When calling either CoCreatelnstance, or calling the IClassFactory::CreateInstance method, the internal COM implementation calls the ICOM_Base::Initialize method. This method triggers the complete initialization process described in this section.</p>
    <p>After initializing the driver, the driver administrator may perform operations on it. For example, the driver administrator may request the driver to add or remove a stream. FIG. 61 displays the sequence of events occurring when the driver is requested to add a new stream.</p>
    <p>When adding a stream, the following steps occur:</p>
    <p>1. The driver administrator directs the driver to add a new stream and passes the filename and CLSID of the stream, to be added, to the driver.</p>
    <p>2. The driver then passes the filename and CLSID to the CDriverObject object and directs it to add the stream by calling its CLNGStreamMgmt::AddStream embedded C++ class method.</p>
    <p>3. The embedded C++ object, that implements the OLE interface, directs the CDrvExtDisp object to add the stream, passing it a handle of the component state data.</p>
    <p>4. The CDrvExtDisp object first typecasts the component state data into a pointer to the CDriverInfo object.</p>
    <p>5. Next, the CStreamMgr, is connected to the CDriverInfo object pointer, and directed to add a new stream.</p>
    <p>6. In order to add the new stream, the CStreamMgr, uses a CSimpleStream to load and create the stream component.</p>
    <p>7. The CSimpleStream object first sets function pointers to the DIIGetCLSID, DIIGetModuleType and DIIRegisterServer functions exported by the component. Before loading the module, the CSimpleStream, first makes sure that the module is actually an XMC Stream by comparing its module type with the XMC_STREAM_MT module type. If it is, the component is registered in the registration database as a n OLE component.</p>
    <p>8. Using the DIlGetCLSID queried in the previous step, the CSimpleStream gets the components CLSID and calls CoCreatelnstance to load an instance of the OLE object.</p>
    <p>9. After the CSimpleStream completes, the CStreamMgr adds the stream to the CDriverInfo's stream array.</p>
    <p>Another operation requested from the driver, after initialization, is that of querying it for its current settings. Before displaying information about the driver, like the name of the hardware it supports, the driver administrator must query the driver for the information. FIG. 62 displays an exemplary process of querying the driver for its driver settings.</p>
    <p>When querying the driver for information, the following steps are performed.</p>
    <p>1. The driver administrator, calls the interface method used to query the driver's information and passes the call a pointer to the XMC_DRIVER_INFO structure.</p>
    <p>2. The call is handled by the implementation of the OLE interface method, implemented by on of the CDriverObject's embedded C++ classes.</p>
    <p>3. The embedded C++ object, used to handle the interface, directs either the CDrvCoreDisp or CDrvExtDisp object to carry out the operation, and passes the object th handle to the component state data.</p>
    <p>4. The dispatch object type casts the state handle to a CDriverInfo object pointer. Once converted, the CDriverInfo object is queried for the appropriate data.</p>
    <p>Upon request, the driver may either save or load its entire configuration to or from the registration database. This operation is used by the XMC Driver Administration component who stores all XMC configuration data in the registration database. FIG. 63 displays the sequence of events that take place when the XMC Driver Administration component directs the driver to load its information from the registry.</p>
    <p>During the registration process, the following steps occur.</p>
    <p>1. First, using the ICOM_PersistRegDB OLE interface, exposed by the driver, the driver administrator directs the component to load its configuration data.</p>
    <p>2. The CDriverObject's embedded object, used to handle all ICOM_PersistRegDB calls, is invoked and performs the operation.</p>
    <p>3. Once invoked, the embedded object directs the CDrvCoreDisp object to perform the load, and passes it a handle to the components state data.</p>
    <p>4. The CDrvCoreDisp object, first typecasts the state handle to a CDriverInfo object pointer.</p>
    <p>5. Next, the CRegistryMgr is connected to the CDriverInfo pointer, and directed to load its contents to or from the registration database.</p>
    <p>6. The CRegistryMgr loads all general driver information and fills out the drivers XMC_DRIVER_INFO data structure, stored in the CDriverInfo object.</p>
    <p>7. If the driver has any streams information stored, the CRegistryMgr loads the stream information and fills out an XMC_STREAM_INFO structure. The structure is then used to create a new CSimpleStream object.</p>
    <p>8. When creating the stream, the CSimpleStream object first queries and calls the DIIGetModuleType exported function and verifies that the module is in fact a stream component. If the module is, the CSimpleStream then queries and calls the DLLRegisterServer function exported by the component to register the component.</p>
    <p>9. After registering the component, the CSimpleStream object queries and calls the DIIGetCLSID exported function to get the components CLSID. Using the CLSID, CoCreatelnstance is called to create an instance of the OLE object.</p>
    <p>10. Once the CSimpleStream completes, the CRegistryMgr connects a temporary instance of the CStreamMgr to the CDriverInfo object pointer, and directs it to add the new stream.</p>
    <p>11. The CStreamMgr directly manipulates the CDriverInfo's stream array to add the new stream. When added, a new instance of the CSimpleStream object is created and attached to the CSimpleStream passed to the CStreamMgr.</p>
    <p>12. When attaching itself to the stream, the new CSimpleStream queries the IXMC_Streaminit interface, passed to it, for all interfaces used it bump up the reference counts for the component.</p>
    <p>After the driver administrator is done using the driver, it must release the driver by calling its exposed Release method. Calling this method, directs the driver to release all resources used. FIG. 64 displays the process of releasing the driver component.</p>
    <p>During the clean-up process, the following steps occur.</p>
    <p>1. First, either the XMC Driver Administrator, or the XMC Motion Component call the final IUnknown::Release.</p>
    <p>2. When invoked, the IUnknown::Release method implemented by the CDriverObject is called. After calling this method causes the internal OLE reference count to go to zero, driver calls its implementation of ICOM_Base::Uninitialize to clean up all resources used.</p>
    <p>3. First, ICOM_Base::Uninitialize directs the CDrvExtDisp to clean up any resources that it was using.</p>
    <p>4. Next, ICOM_Base::Uninitialize directs the CDrvCoreDisp object to clean up any resources that it was using.</p>
    <p>5. Since the CDrvCoreDisp object contains instances of all manager objects, it begins cleaning them up by first directing the CCommandMgr to destroy any resources that it was using. Internally, the CcommandMgr destroys the CCommandDatabase and all of its contents.</p>
    <p>6. Next, the CDrvCoreDisp object implicitly destroys all other manager objects by calling their destructors.</p>
    <p>7. And as a final step, the ICOM_Base::Uninitialize method deletes the state handle containing a pointer to the CDriverInfo object. When destroyed, the CDriverInfo object deletes each CSimpleStream object, which in turn release their instance of the XMC Stream component. Upon releasing the final instance of the XMC Stream component, the component dII is freed from memory.</p>
    <p>After a driver is successfully installed into the XMC system and configured using the driver administrator, it is ready for use by the XMC Motion Control Component. The component uses the driver when performing motion control operations requested from the application using the component. FIG. 65 describes the component directed operations that can take place on the driver.</p>
    <p>Before operating, the XMC Motion Component must query the Driver administrator <b>32</b> component for its driver enumeration. The enumeration returned is used to access all enabled drivers that are directed to perform XMC SPI operations by the XMC Motion Component.</p>
    <p>Once the driver enumeration is acquired, the Motion control component <b>35</b> can direct the enabled driver, or drivers, to carry out certain command operations. Command operations are standard motion control operations such as moving to a specific location in the system, or querying the system for the current position. FIG. 65 describes the process of commanding the driver to carry out a certain operation.</p>
    <p>When commanding the driver to perform a certain operation, the following steps occur.</p>
    <p>1. First, the motion component directs the driver to perform the operation, such as moving to a position or querying the system for the current position.</p>
    <p>2. The XMCSPI invocation is handled by the CDriverObject who implements all OLE interfaces exposed by the component.</p>
    <p>3. The CDriverObject directs either the CDrvCoreDisp, or CDrvExtDisp object to perform the operation, depending on whether the operation is a core or extended XMCSPI. The component state handle is passed to the dispatch object when called.</p>
    <p>4. The dispatch object then typecasts the state handle into a CDriverInfo object pointer.</p>
    <p>5. Next, the dispatch object connects the CCommandMgr to the CDriverInfo object pointer and directs it to carry out the operation corresponding to the database index sent. The database index corresponds to the XMCSPI called and is used to locate the language database entry for that SPI call.</p>
    <p>6. The CCommandMgr searches the CCommandDatabase for the index and builds a CCommand object corresponding to the XMCSPI operation.</p>
    <p>7. Next, the CCommandMgr directly accesses the CDriverInfo and passes the command string, built by the CCommand object, to all enabled streams.</p>
    <p>8. Each enabled stream sends the ASCII text to its target. For example, the PCBus steam sends its data to the motion control card located on the PCBus. The text file stream, on the other hand, sends its data to its associated text file.</p>
    <p>9. If directed, the CCommandMgr then queries the first readable stream for the results of the commands sent to it<sup>1</sup>.</p>
    <p>10. The CSimpleStream reads the raw response from the target and returns it to the CCommandMgr.</p>
    <p>11. Once receiving the raw response, the CCommandMgr uses the CResponse object to parse the raw response based on the response format corresponding to the XMCSPI database entry. All response parameters are returned back up the calling chain, and eventually end up in the hands of the original caller, the XMC Motion Component.</p>
    <p>The clean-up initiated by the XMC Motion Component by releasing the XMC Driver component is the same as that which occurs when the Driver administrator <b>32</b> object releases the component.</p>
    <p>The following discussion describes the actual OLE Interfaces exposed, the definitions of the data structures used when passing data around, and the definitions of each class used internally by the driver.</p>
    <p>The following diagram describes all interfaces exposed by the driver specific to driver-component interpretability. FIG. 66 graphically displays the interfaces exposed by the component.</p>
    <p>Other than the two standard interfaces exposed, such as IUnknown and IClassFactory, there are three categories of interfaces exposed by the component. The three categories are as follows.</p>
    <p>COM: All interface names with the COM_prefix, implement general COM functionality. For example, the ICOM_Base, ICOM_Base<b>2</b>, ICOM_Persist<b>2</b>, and ICOM_PersistRegDB interfaces all fall into this category.</p>
    <p>LNG: All interface names with the LNG_prefix, implement general language driver functionality. For example, the ILNG_DrvCore_Init, and the ILNG_DrvExt_StreamMgmt interfaces fall into this category.</p>
    <p>XMC: All interfaces name with the XMC_prefix, implement XMCSPI (driver) functionality.</p>
    <p>The following sections describe the interfaces falling into both the COM and LNG categories. All other interfaces are XMCSPI specific and are used for the sole purpose of performing motion control operations.</p>
    <p>The following exposed methods in the ICOM_Base interface are used when intializing and uninitializing the component. Each of these methods call the hidden initialize and uninitialize interface methods implemented by all of the component's interfaces.</p>
    <p>DECLARE_INTERFACE_(ICOM_Base, IUnknown)</p>
    <p>{</p>
    <p>STDMETHOD (Initialize)(THIS_LPVOID pInitInfo) PURE;</p>
    <p>STDMETHOD (Uninitialize)(THIS) PURE;</p>
    <p>};</p>
    <p>The ICOM_Base<b>2</b> interface inherits from the ICOM_Base interface and adds several methods used to manage the internal component state handle. In addition, a method allows the user to translate any HRESULT returned by the component into a human readable text string. The following is a description of the ICOM_Base<b>2</b> interface.</p>
    <p>DECLARE_INTERFACE_(ICOM_Base<b>2</b>, ICOM_Base)</p>
    <p>{</p>
    <p>STDMETHOD (SetStateData)(THIS_COM_STATEHANDLE hState) PURE;</p>
    <p>STDMETHOD (GetStateData)(THIS_LPCOM_STATEHANDLE phState) PURE;</p>
    <p>STDMETHOD (GetErrorString)(THIS_HRESULT hr, LPSTR pszErr, DWORD dwMax) PURE;</p>
    <p>};</p>
    <p>The ICOM_Persist<b>2</b> interface inherits from the Ipersist standard OLE interface and adds several methods used to query the CLSID and module type. The following is a description of the ICOM_Persist<b>2</b> interface.</p>
    <p>DECLARE_INTERFACE_(ICOM_Persist<b>2</b>, IPersist)</p>
    <p>{</p>
    <p>STDMETHOD (GetID)(THIS_LPDWORD pdwID) PURE;</p>
    <p>STDMETHOD (GetModuleType)(THIS_LPDWORD pdwMT)</p>
    <p>PURE;</p>
    <p>};</p>
    <p>The ICOM_PersistRegDB interface implements similar functionality to that provided by the IPersistFile standard OLE interface. Instead of saving and loading data to and from a file, the ICOM_PersistRegDB operates on the registration database. The following is a description of the ICOM_PersistRegDB interface.</p>
    <p>DECLARE_INTERFACE_(ICOM_PersistRegDB, IUnknown)</p>
    <p>{</p>
    <p>STDMETHOD (IsDirty)(THIS) PURE;</p>
    <p>STDMETHOD (Load)(THIS_HKEY hkey) PURE;</p>
    <p>STDMETHOD (Save)(THIS_HKEY hkey) PURE;</p>
    <p>STDMETHOD (Clear)(THIS_HKEY hKey) PURE;</p>
    <p>};</p>
    <p>The ILNG_DrvCore_Init interface is used to initialize the language driver component. The following is a description of the ILNG_DrvCore_Init interface.</p>
    <p>DECLARE_INTERFACE_(ILNG_DrvCore_Init, IUnknown)</p>
    <p>{</p>
    <p>STDMETHOD (Create)(THIS_LPLNG_DRIVER_INFO pDI) PURE;</p>
    <p>STDMETHOD (Destroy)(THIS) PURE;</p>
    <p>STDMETHOD (Setup)(THIS_LPLNG_DRIVER_INFO pDI) PURE;</p>
    <p>STDMETHOD (Stat)(THIS_LPLNG_DRIVER_INFO pDI) PURE;</p>
    <p>STDMETHOD (Register)(THIS) PURE;</p>
    <p>STDMETHOD (UnRegister)(THIS) PURE;</p>
    <p>STDMETHOD (IsRegistered)(THIS_LPBOOL pbRegistered) PURE;</p>
    <p>STDMETHOD (Enable)(THIS_BOOL fEnable) PURE;</p>
    <p>STDMETHOD (IsEnabled)(THIS_LPBOOL pbEnabled) PURE;</p>
    <p>};</p>
    <p>The ILNG_DrvExt_StreamMgmt interface is used to perform all stream operations. The following is a description of the LNG_DrvExt_StreamMgmt interface.</p>
    <p>DECLARE_INTERFACE_(ILNG_DrvExt_StreamMgmt, IUnknown)</p>
    <p>{</p>
    <p>STDMETHOD (GetStreamEnumeration)(THIS_LPENUMUNKNOWN FAR ppEnumStream)</p>
    <p>PURE;</p>
    <p>STDMETHOD (GetStreamCount)(THIS_LPDWORD pdwCount) PURE;</p>
    <p>STDMETHOD (GetStreaminit)(THIS_XMC_STREAMID idStream,</p>
    <p>LPXMCSTREAMINIT FAR *ppStreamInit) PURE;</p>
    <p>STDMETHOD (GetStreamInitAt)(THIS_DWORD dwIdx,</p>
    <p>LPXMCSTREAMINIT FAR *ppStreamlnit) PURE;</p>
    <p>STDMETHOD (AddStream)(THIS_LPXMCSTREAMINIT pStreaminit)</p>
    <p>PURE;</p>
    <p>STDMETHOD (RemoveStream)(THIS_LPXMCSTREAMINIT pStreamInit,</p>
    <p>BOOL bDestroy) PURE;</p>
    <p>STDMETHOD (RemoveStream)(THIS_XMC_STREAMID idStream, BOOL bDestroy)</p>
    <p>PURE;</p>
    <p>STDMETHOD (RemoveAllStreams)(THIS_BOOL bDestroy) PURE;</p>
    <p>STDMETHOD (EnabledStreamsOnly)(THIS_BOOL bEnabledOnly,</p>
    <p>LPBOOL pbOldEnabledOnly) PURE;</p>
    <p>};</p>
    <p>The following are the functions exported by the driver DLL.</p>
    <p>XMC_DRIVER_MODULETYPE DLLGetModuleType(void);</p>
    <p>LPCLSID DLLGetCLSID(void);</p>
    <p>BOOL DLLRegisterServer(void);</p>
    <p>BOOL DLLUnRegisterServer(void);</p>
    <p>The following discussion defines all structures, enumerations, and defines used by the driver.</p>
    <p>The XMC_DRIVER_MODULETYPE enumeration defines the type of drivers available. Each driver must return its type when the user calls the exported DLLGetModuleType function. enum XMC_DRIVER_MODULETYPE</p>
    <p>{</p>
    <p>XMC_DRIVER_MT=<b>0</b>x<b>4000</b>,</p>
    <p>XMC_DRIVER_MT_AT6400=<b>0</b>x<b>4001</b>,</p>
    <p>XMC_DRIVER_MT_DMC<b>1000</b>=<b>0</b>x<b>4002</b>,</p>
    <p>XMC_DRIVER_MT_DT<b>2000</b>=<b>0</b>x<b>4003</b>,</p>
    <p>XMC_DRIVER_MT_CUSTOM=<b>0</b>x<b>4004</b> </p>
    <p>};</p>
    <p>The XMC_DRVCORE_CMD enumeration defines an identifier for every command known to the XMC Driver. For example, every core Driver function has a corresponding XMC_DRVCORE_CMD identifier. This index is used to look up the string block for the command. The definition of the enumeration is as follows.</p>
    <p>enum XMC_DRVCORE_CMD</p>
    <p>{</p>
    <p>XMC_DCC_MOTION_MOVEABS,</p>
    <p>XMC_DCC_MOTION_KILL,</p>
    <p>:</p>
    <p>};</p>
    <p>The XMC_DRVEXT_CMD enumeration defines an identifier for every extended command known to the XMC Driver. Even though the identifiers exist, the driver may or may not implement the set of commands. For example, every extended Driver function has a corresponding XMC_DRVEXT_CMD identifier. This index is used to look up the string block for the command (if the driver implements the command). The definition of the enumeration is as follows.</p>
    <p>enum XMC_DRVEXT_CMD</p>
    <p>{</p>
    <p>XMC_DCE_MOTION_MOVEREL,</p>
    <p>:</p>
    <p>};</p>
    <p>The LNG_PARAM_DATATYPE enumeration defines all types of data blocks that may be parsed from response strings returned by stream targets. typedef enum_LNG_PARAM_DATATYPE</p>
    <p>{</p>
    <p>LNG_ADT_NOP,</p>
    <p>LNG_ADT_NOTYPE,</p>
    <p>LNG_ADT_NUMBER,</p>
    <p>LNG_ADT_STAT_STRING,</p>
    <p>LNG_ADT_MEM_STRING</p>
    <p>} LNG_PARAM_DATATYPE;</p>
    <p>The LNG_PARAM_DATA structure stores all types of data that describe a parameter either built into a command, or parsed from a response. struct LNG_PARAM_DATA</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="175pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">{</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="56pt" align="left"> </colspec> <colspec colname="1" colwidth="161pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">//---- Constructor &amp; Destructor ----</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_PARAM_DATA( void );</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">˜LNG_PARAM_DATA( void );</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">//--- Data ----</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_PARAM_DATATYPE adt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">union</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">{</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="70pt" align="left"> </colspec> <colspec colname="1" colwidth="147pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">double df;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LPTSTR psz;</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="56pt" align="left"> </colspec> <colspec colname="1" colwidth="161pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">};</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">};</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <p>The LNG_DRIVER_INFO structure is used when setting up and querying the state of the driver.</p>
    <p>typedef struct_LNG_DRIVER_INFO</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">{</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="112pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">DWORD</td>
                <td class="description-td">m_mt;</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="98pt" align="left"> </colspec> <colspec colname="2" colwidth="91pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_DRIVERID</td>
                <td class="description-td">m_ID;</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="112pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">TCHAR</td>
                <td class="description-td">m_szName[</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_DRIVER_NAME_LEN+1 ];</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="112pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">TCHAR</td>
                <td class="description-td">m_szDescription[</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_DRIVER_DESC_LEN+1 ];</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="112pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">TCHAR</td>
                <td class="description-td">m_szHWVendor[</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">LNG_DRIVER_NAME_LEN+1 ];</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">} LNG_DRIVER_INFO;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <p>Each XMC Driver is responsible for managing all streams used. In order to manage each stream over time in a persistent manner each driver and stream module implement the persistent functionality exposed through the ICOM_PersistRegDB interface. When the driver's implementation of ICOM_PersistRegDB::Save is called, the data is saved to the registry in the following order.</p>
    <p>
      <tables> <table frame="none" colsep="0" rowsep="0" pgwide="1" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="245pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">XMCDriverAdminObject.100</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="231pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|---- Drivers</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="217pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|---- dwCount = &lt;# of drivers&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|---- XMCDrv_0</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="14pt" align="left"> </colspec> <colspec colname="2" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- CLSID = {clsid}</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- dwFlags = &lt;driver flags&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- dwID = &lt;driver ID&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- dwModuleType = XMC_DRIVER_MT_xxx</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- szDescription = &lt;user desc of the driver&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- Streams</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="28pt" align="left"> </colspec> <colspec colname="2" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- Count = &lt;# of streams&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- XMCStrm_0</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="4"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="28pt" align="left"> </colspec> <colspec colname="2" colwidth="14pt" align="left"> </colspec> <colspec colname="3" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|</td>
                <td class="description-td">|---- CLSID = {clsid}</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|</td>
                <td class="description-td">|---- dwID = &lt;strm id&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|</td>
                <td class="description-td">|---- dwModuleType = XMC_STREAM_MT_xxx</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|</td>
                <td class="description-td">|---- &lt;stream specific values&gt;</td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="28pt" align="left"> </colspec> <colspec colname="2" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- XMCStrm_&lt;n&gt;</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="42pt" align="left"> </colspec> <colspec colname="2" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
                <td class="description-td">|---- <sub>—</sub> </td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="217pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|---- XMCDrv_&lt;n&gt;</td>
              </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="56pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
                <td class="description-td">|---- <sub>—</sub> </td>
              </tr> <tr class="description-tr"> <td class="description-td"> </td>
                <td namest="OFFSET" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
              </tr> </tbody> </tgroup> </table> </tables> </p>
    <p>It should be clear from the foregoing that the present invention may be embodied in other specific forms without departing from the essential characteristics thereof. The present embodiments are therefore to be considered in all respects as illustrative and not restrictive, the scope of the invention being indicated by the appended claims rather than by the foregoing description; all changes which come within the meaning and range of equivalency of the claims are therefore intended to be embraced therein.</p>
    </div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4159417">US4159417</a></td><td class="patent-data-table-td patent-date-value">Oct 28, 1977</td><td class="patent-data-table-td patent-date-value">Jun 26, 1979</td><td class="patent-data-table-td ">Rubincam David P</td><td class="patent-data-table-td ">Electronic book</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4418381">US4418381</a></td><td class="patent-data-table-td patent-date-value">Jan 23, 1981</td><td class="patent-data-table-td patent-date-value">Nov 29, 1983</td><td class="patent-data-table-td ">Bristol Babcock Inc.</td><td class="patent-data-table-td ">Single loop control system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4531182">US4531182</a></td><td class="patent-data-table-td patent-date-value">Mar 1, 1972</td><td class="patent-data-table-td patent-date-value">Jul 23, 1985</td><td class="patent-data-table-td ">Hyatt Gilbert P</td><td class="patent-data-table-td ">Machine control system operating from remote commands</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4713808">US4713808</a></td><td class="patent-data-table-td patent-date-value">Nov 27, 1985</td><td class="patent-data-table-td patent-date-value">Dec 15, 1987</td><td class="patent-data-table-td ">A T &amp; E Corporation</td><td class="patent-data-table-td ">Watch pager system and communication protocol</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4767334">US4767334</a></td><td class="patent-data-table-td patent-date-value">Nov 19, 1985</td><td class="patent-data-table-td patent-date-value">Aug 30, 1988</td><td class="patent-data-table-td ">Thorne Hugh C</td><td class="patent-data-table-td ">Educational and recreational toy vehicle</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4809335">US4809335</a></td><td class="patent-data-table-td patent-date-value">Oct 24, 1985</td><td class="patent-data-table-td patent-date-value">Feb 28, 1989</td><td class="patent-data-table-td ">Rumsey Daniel S</td><td class="patent-data-table-td ">Speech unit for dolls and other toys</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4840602">US4840602</a></td><td class="patent-data-table-td patent-date-value">Dec 2, 1987</td><td class="patent-data-table-td patent-date-value">Jun 20, 1989</td><td class="patent-data-table-td ">Coleco Industries, Inc.</td><td class="patent-data-table-td ">Talking doll responsive to external signal</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4846693">US4846693</a></td><td class="patent-data-table-td patent-date-value">Dec 1, 1988</td><td class="patent-data-table-td patent-date-value">Jul 11, 1989</td><td class="patent-data-table-td ">Smith Engineering</td><td class="patent-data-table-td ">Video based instructional and entertainment system using animated figure</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4855725">US4855725</a></td><td class="patent-data-table-td patent-date-value">Dec 28, 1988</td><td class="patent-data-table-td patent-date-value">Aug 8, 1989</td><td class="patent-data-table-td ">Fernandez Emilio A</td><td class="patent-data-table-td ">Microprocessor based simulated book</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4857030">US4857030</a></td><td class="patent-data-table-td patent-date-value">Feb 6, 1987</td><td class="patent-data-table-td patent-date-value">Aug 15, 1989</td><td class="patent-data-table-td ">Coleco Industries, Inc.</td><td class="patent-data-table-td ">Conversing dolls</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4887966">US4887966</a></td><td class="patent-data-table-td patent-date-value">Jun 30, 1988</td><td class="patent-data-table-td patent-date-value">Dec 19, 1989</td><td class="patent-data-table-td ">Gellerman Floyd R</td><td class="patent-data-table-td ">Flight simulation control apparatus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4897835">US4897835</a></td><td class="patent-data-table-td patent-date-value">May 12, 1989</td><td class="patent-data-table-td patent-date-value">Jan 30, 1990</td><td class="patent-data-table-td ">At&amp;E Corporation</td><td class="patent-data-table-td ">In a time division multiplexed communication method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4937737">US4937737</a></td><td class="patent-data-table-td patent-date-value">Aug 31, 1988</td><td class="patent-data-table-td patent-date-value">Jun 26, 1990</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Process transparent multi storage mode data transfer and buffer control</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5095445">US5095445</a></td><td class="patent-data-table-td patent-date-value">Aug 22, 1990</td><td class="patent-data-table-td patent-date-value">Mar 10, 1992</td><td class="patent-data-table-td ">Canon Kabushiki Kaisha</td><td class="patent-data-table-td ">Data communication system capable of communicating on-line with communication terminal equipment of a plurality of types</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5120065">US5120065</a></td><td class="patent-data-table-td patent-date-value">Feb 8, 1991</td><td class="patent-data-table-td patent-date-value">Jun 9, 1992</td><td class="patent-data-table-td ">Hasbro, Incorporated</td><td class="patent-data-table-td ">Electronic talking board game</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5126932">US5126932</a></td><td class="patent-data-table-td patent-date-value">Apr 5, 1990</td><td class="patent-data-table-td patent-date-value">Jun 30, 1992</td><td class="patent-data-table-td ">Siemens Corporate Research, Inc.</td><td class="patent-data-table-td ">Method and apparatus for executing a program in a heterogeneous multiple computer system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5168441">US5168441</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 30, 1990</td><td class="patent-data-table-td patent-date-value">Dec 1, 1992</td><td class="patent-data-table-td ">Allen-Bradley Company, Inc.</td><td class="patent-data-table-td ">Methods for set up and programming of machine and process controllers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5175817">US5175817</a></td><td class="patent-data-table-td patent-date-value">Nov 20, 1989</td><td class="patent-data-table-td patent-date-value">Dec 29, 1992</td><td class="patent-data-table-td ">Digital Equipment Corporation</td><td class="patent-data-table-td ">Data representation protocol for communications between different networks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5245703">US5245703</a></td><td class="patent-data-table-td patent-date-value">Jun 21, 1989</td><td class="patent-data-table-td patent-date-value">Sep 14, 1993</td><td class="patent-data-table-td ">Bull S.A.</td><td class="patent-data-table-td ">Data processing system with multiple communication buses and protocols</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5247650">US5247650</a></td><td class="patent-data-table-td patent-date-value">Aug 30, 1989</td><td class="patent-data-table-td patent-date-value">Sep 21, 1993</td><td class="patent-data-table-td ">Industrial Technology Institute</td><td class="patent-data-table-td ">System for combining originally software incompatible control, kinematic, and discrete event simulation systems into a single integrated simulation system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5377258">US5377258</a></td><td class="patent-data-table-td patent-date-value">Aug 30, 1993</td><td class="patent-data-table-td patent-date-value">Dec 27, 1994</td><td class="patent-data-table-td ">National Medical Research Council</td><td class="patent-data-table-td ">Method and apparatus for an automated and interactive behavioral guidance system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5390330">US5390330</a></td><td class="patent-data-table-td patent-date-value">Feb 11, 1993</td><td class="patent-data-table-td patent-date-value">Feb 14, 1995</td><td class="patent-data-table-td ">Talati; Kirit K.</td><td class="patent-data-table-td ">Control system and method for direct execution of software application information models without code generation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5392207">US5392207</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Aug 20, 1993</td><td class="patent-data-table-td patent-date-value">Feb 21, 1995</td><td class="patent-data-table-td ">Allen-Bradley Company, Inc.</td><td class="patent-data-table-td ">Programmable motion controller with graphical programming aid</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5402518">US5402518</a></td><td class="patent-data-table-td patent-date-value">Jul 22, 1992</td><td class="patent-data-table-td patent-date-value">Mar 28, 1995</td><td class="patent-data-table-td ">Pcvoice, Inc.</td><td class="patent-data-table-td ">Sound storage and sound retrieval system having peripheral with hand operable switches</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5412757">US5412757</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Nov 26, 1991</td><td class="patent-data-table-td patent-date-value">May 2, 1995</td><td class="patent-data-table-td ">Kabushiki Kaisha Toshiba</td><td class="patent-data-table-td ">Fuzzy control system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5450079">US5450079</a></td><td class="patent-data-table-td patent-date-value">Sep 7, 1994</td><td class="patent-data-table-td patent-date-value">Sep 12, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Multimodal remote control device having electrically alterable keypad designations</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5453933">US5453933</a></td><td class="patent-data-table-td patent-date-value">Sep 8, 1993</td><td class="patent-data-table-td patent-date-value">Sep 26, 1995</td><td class="patent-data-table-td ">Hurco Companies, Inc.</td><td class="patent-data-table-td ">CNC control system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5465215">US5465215</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jul 7, 1994</td><td class="patent-data-table-td patent-date-value">Nov 7, 1995</td><td class="patent-data-table-td ">Cincinnati Milacron Inc.</td><td class="patent-data-table-td ">Numerical control method and apparatus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5491813">US5491813</a></td><td class="patent-data-table-td patent-date-value">Nov 18, 1994</td><td class="patent-data-table-td patent-date-value">Feb 13, 1996</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Display subsystem architecture for binding device independent drivers together into a bound driver for controlling a particular display device</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5493281">US5493281</a></td><td class="patent-data-table-td patent-date-value">Jul 29, 1994</td><td class="patent-data-table-td patent-date-value">Feb 20, 1996</td><td class="patent-data-table-td ">The Walt Disney Company</td><td class="patent-data-table-td ">Method and apparatus for remote synchronization of audio, lighting, animation and special effects</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5596994">US5596994</a></td><td class="patent-data-table-td patent-date-value">May 2, 1994</td><td class="patent-data-table-td patent-date-value">Jan 28, 1997</td><td class="patent-data-table-td ">Bro; William L.</td><td class="patent-data-table-td ">Automated and interactive behavioral and medical guidance system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5604843">US5604843</a></td><td class="patent-data-table-td patent-date-value">Dec 23, 1992</td><td class="patent-data-table-td patent-date-value">Feb 18, 1997</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Method and system for interfacing with a computer output device</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5607336">US5607336</a></td><td class="patent-data-table-td patent-date-value">Jul 18, 1995</td><td class="patent-data-table-td patent-date-value">Mar 4, 1997</td><td class="patent-data-table-td ">Steven Lebensfeld</td><td class="patent-data-table-td ">Subject specific, word/phrase selectable message delivering doll or action figure</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5608894">US5608894</a></td><td class="patent-data-table-td patent-date-value">Oct 19, 1994</td><td class="patent-data-table-td patent-date-value">Mar 4, 1997</td><td class="patent-data-table-td ">Fujitsu Limited</td><td class="patent-data-table-td ">Execution control system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5617528">US5617528</a></td><td class="patent-data-table-td patent-date-value">Feb 6, 1995</td><td class="patent-data-table-td patent-date-value">Apr 1, 1997</td><td class="patent-data-table-td ">Datacard Corporation</td><td class="patent-data-table-td ">Method and apparatus for interactively creating a card which includes video and cardholder information</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5636994">US5636994</a></td><td class="patent-data-table-td patent-date-value">Nov 9, 1995</td><td class="patent-data-table-td patent-date-value">Jun 10, 1997</td><td class="patent-data-table-td ">Tong; Vincent M. K.</td><td class="patent-data-table-td ">Interactive computer controlled doll</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5652866">US5652866</a></td><td class="patent-data-table-td patent-date-value">Aug 26, 1994</td><td class="patent-data-table-td patent-date-value">Jul 29, 1997</td><td class="patent-data-table-td ">Ibm Corporation</td><td class="patent-data-table-td ">Collaborative working method and system for a telephone to interface with a collaborative working application</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5655945">US5655945</a></td><td class="patent-data-table-td patent-date-value">Sep 28, 1995</td><td class="patent-data-table-td patent-date-value">Aug 12, 1997</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Video and radio controlled moving and talking device</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5666161">US5666161</a></td><td class="patent-data-table-td patent-date-value">Apr 26, 1994</td><td class="patent-data-table-td patent-date-value">Sep 9, 1997</td><td class="patent-data-table-td ">Hitachi, Ltd.</td><td class="patent-data-table-td ">Method and apparatus for creating less amount of compressd image data from compressed still image data and system for transmitting compressed image data through transmission line</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5670992">US5670992</a></td><td class="patent-data-table-td patent-date-value">Sep 23, 1992</td><td class="patent-data-table-td patent-date-value">Sep 23, 1997</td><td class="patent-data-table-td ">Sony Corporation</td><td class="patent-data-table-td ">Portable graphic computer apparatus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5707289">US5707289</a></td><td class="patent-data-table-td patent-date-value">Oct 6, 1995</td><td class="patent-data-table-td patent-date-value">Jan 13, 1998</td><td class="patent-data-table-td ">Pioneer Electronic Corporation</td><td class="patent-data-table-td ">Video game system having terminal identification data</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5733131">US5733131</a></td><td class="patent-data-table-td patent-date-value">Jul 29, 1994</td><td class="patent-data-table-td patent-date-value">Mar 31, 1998</td><td class="patent-data-table-td ">Seiko Communications Holding N.V.</td><td class="patent-data-table-td ">Education and entertainment device with dynamic configuration and operation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5737523">US5737523</a></td><td class="patent-data-table-td patent-date-value">Mar 4, 1996</td><td class="patent-data-table-td patent-date-value">Apr 7, 1998</td><td class="patent-data-table-td ">Sun Microsystems, Inc.</td><td class="patent-data-table-td ">In a distributed file system computing environment</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5746602">US5746602</a></td><td class="patent-data-table-td patent-date-value">Feb 27, 1996</td><td class="patent-data-table-td patent-date-value">May 5, 1998</td><td class="patent-data-table-td ">Kikinis; Dan</td><td class="patent-data-table-td ">PC peripheral interactive doll</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5752880">US5752880</a></td><td class="patent-data-table-td patent-date-value">Nov 20, 1995</td><td class="patent-data-table-td patent-date-value">May 19, 1998</td><td class="patent-data-table-td ">Creator Ltd.</td><td class="patent-data-table-td ">Interactive doll</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5764155">US5764155</a></td><td class="patent-data-table-td patent-date-value">Apr 3, 1996</td><td class="patent-data-table-td patent-date-value">Jun 9, 1998</td><td class="patent-data-table-td ">General Electric Company</td><td class="patent-data-table-td ">Dynamic data exchange server</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5790178">US5790178</a></td><td class="patent-data-table-td patent-date-value">Jul 15, 1992</td><td class="patent-data-table-td patent-date-value">Aug 4, 1998</td><td class="patent-data-table-td ">Hitachi, Ltd.</td><td class="patent-data-table-td ">Picture codec for teleconference equipment, which forms and displays picture-in-frame including at least two of received motion picture, a received still picture and a self motion picture in an optional combination</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5800268">US5800268</a></td><td class="patent-data-table-td patent-date-value">Oct 20, 1995</td><td class="patent-data-table-td patent-date-value">Sep 1, 1998</td><td class="patent-data-table-td ">Molnick; Melvin</td><td class="patent-data-table-td ">Method of participating in a live casino game from a remote location</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5801946">US5801946</a></td><td class="patent-data-table-td patent-date-value">Oct 19, 1995</td><td class="patent-data-table-td patent-date-value">Sep 1, 1998</td><td class="patent-data-table-td ">Kawasaki Motors Mfg. Co.</td><td class="patent-data-table-td ">Assembly prompting system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5846132">US5846132</a></td><td class="patent-data-table-td patent-date-value">Apr 10, 1996</td><td class="patent-data-table-td patent-date-value">Dec 8, 1998</td><td class="patent-data-table-td ">William W. Junkin Trust</td><td class="patent-data-table-td ">Interactive system allowing simulated or real time participation in a league</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5867385">US5867385</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 30, 1996</td><td class="patent-data-table-td patent-date-value">Feb 2, 1999</td><td class="patent-data-table-td ">Roy-G-Biv Corporation</td><td class="patent-data-table-td ">Motion control systems</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5907704">US5907704</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 2, 1996</td><td class="patent-data-table-td patent-date-value">May 25, 1999</td><td class="patent-data-table-td ">Quark, Inc.</td><td class="patent-data-table-td ">Hierarchical encapsulation of instantiated objects in a multimedia authoring system including internet accessible objects</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5914876">US5914876</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 5, 1996</td><td class="patent-data-table-td patent-date-value">Jun 22, 1999</td><td class="patent-data-table-td ">Mitsubishi Denki Kabushiki Kaisha</td><td class="patent-data-table-td ">Numerical controller having expanded control word set</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0275826A1?cl=en">EP0275826A1</a></td><td class="patent-data-table-td patent-date-value">Dec 10, 1987</td><td class="patent-data-table-td patent-date-value">Jul 27, 1988</td><td class="patent-data-table-td ">Ciba-Geigy Ag</td><td class="patent-data-table-td ">Control system for a sample preparation system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0281427A2?cl=en">EP0281427A2</a></td><td class="patent-data-table-td patent-date-value">Mar 7, 1988</td><td class="patent-data-table-td patent-date-value">Sep 7, 1988</td><td class="patent-data-table-td ">Curtis M. Brubaker</td><td class="patent-data-table-td ">Radio controlled toy</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0442676A2?cl=en">EP0442676A2</a></td><td class="patent-data-table-td patent-date-value">Feb 11, 1991</td><td class="patent-data-table-td patent-date-value">Aug 21, 1991</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Computer display adaptor interfacing</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0508912A1?cl=en">EP0508912A1</a></td><td class="patent-data-table-td patent-date-value">Apr 7, 1992</td><td class="patent-data-table-td patent-date-value">Oct 14, 1992</td><td class="patent-data-table-td ">Info Telecom</td><td class="patent-data-table-td ">Method and means for materialising a virtual interaction between an objectand an information stand</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0583908A2?cl=en">EP0583908A2</a></td><td class="patent-data-table-td patent-date-value">Aug 2, 1993</td><td class="patent-data-table-td patent-date-value">Feb 23, 1994</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Image capture apparatus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="http://www.google.com/url?id=tZdeBAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DGB%26NR%3D2224896A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFw3sI2CAUtXqXi0QVMNgcLo1OjpA">GB2224896A</a></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">Title not available</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="http://www.google.com/url?id=tZdeBAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3DS59228473A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGaN0EFesSaI15WxLmTQhqr77uT0w">JPS59228473A</a></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">Title not available</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1992011731A2?cl=en">WO1992011731A2</a></td><td class="patent-data-table-td patent-date-value">Dec 19, 1991</td><td class="patent-data-table-td patent-date-value">Jul 9, 1992</td><td class="patent-data-table-td ">Eastman Kodak Co</td><td class="patent-data-table-td ">Memoryless electronic camera with direct hard copy output</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1993008654A1?cl=en">WO1993008654A1</a></td><td class="patent-data-table-td patent-date-value">Oct 16, 1992</td><td class="patent-data-table-td patent-date-value">Apr 29, 1993</td><td class="patent-data-table-td ">Forte Communications Inc</td><td class="patent-data-table-td ">Wireless transmitting and receiving device with selectable channel settings</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1995007504A1?cl=en">WO1995007504A1</a></td><td class="patent-data-table-td patent-date-value">Sep 7, 1994</td><td class="patent-data-table-td patent-date-value">Mar 16, 1995</td><td class="patent-data-table-td ">Michael A Dupont</td><td class="patent-data-table-td ">Cnc control system</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">Non-Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">Reference</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">"<a href='http://scholar.google.com/scholar?q="Requirements+of+Open+Modular+Architecture+Controllers+for+Applications+in+the+Automotive+Industry"'>Requirements of Open Modular Architecture Controllers for Applications in the Automotive Industry</a>"; pub. Dec. 13, 1994; pp. 1-13.</td></tr><tr><td class="patent-data-table-td ">2</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">"<a href='http://scholar.google.com/scholar?q="Technologies+Enabling+Agile+Manufacturing+%28TEAM%29+Intelligent+Closed+Loop+Processing"'>Technologies Enabling Agile Manufacturing (TEAM) Intelligent Closed Loop Processing</a>"; pub. Jan. 11, 1996; 30 pages.</td></tr><tr><td class="patent-data-table-td ">3</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Aerotech Motion Control Product Guide; pp. 233-234.</td></tr><tr><td class="patent-data-table-td ">4</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Aimax-Win Product Brochure, TA Engineering Co., Inc.; 8 pages.</td></tr><tr><td class="patent-data-table-td ">5</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Altintas et al.; "<a href='http://scholar.google.com/scholar?q="Design+and+Analysis+of+a+Modular+CNC+System"'>Design and Analysis of a Modular CNC System</a>"; pub. Mar. 4, 1990; pp. 305-316.</td></tr><tr><td class="patent-data-table-td ">6</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Chu and Wang; "<a href='http://scholar.google.com/scholar?q="Development+of+a+Practical+SFC+System+for+CNC+Machine+Shop"'>Development of a Practical SFC System for CNC Machine Shop</a>"; pub. 1994; pp. 362-367.</td></tr><tr><td class="patent-data-table-td ">7</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Compumotor Digiplan (1993-94) Catalog pp. 10-11.</td></tr><tr><td class="patent-data-table-td ">8</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">ExperTune PID Tuning Software, Gerry Engineering Software; 6 pages.</td></tr><tr><td class="patent-data-table-td ">9</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Fedrowitz; IRL-Based Expansion of the Commonly Used High-Level Language C for Robot Programming: pub. Oct. 1995; 5 pages.</td></tr><tr><td class="patent-data-table-td ">10</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">FIX Product Brochure, Intellution (1994); 6 pages.</td></tr><tr><td class="patent-data-table-td ">11</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Jackman; "<a href='http://scholar.google.com/scholar?q="Robotic+Control+Using+Sequential+Function+Charts"'>Robotic Control Using Sequential Function Charts</a>"; pub. 1996; pp. 120-128.</td></tr><tr><td class="patent-data-table-td ">12</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">McGraw et al.; "<a href='http://scholar.google.com/scholar?q="A+Friendly+Command%2C+Control%2C+and+Information+System+for+Astronomy"'>A Friendly Command, Control, and Information System for Astronomy</a>"; pub. 1996; pp. 356-367.</td></tr><tr><td class="patent-data-table-td ">13</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Microsoft; "<a href='http://scholar.google.com/scholar?q="Object+Linking+and+Embedding+2.0+Backgrounder"'>Object Linking and Embedding 2.0 Backgrounder</a>"; pub. Sep. 1993; pp. 1-15.</td></tr><tr><td class="patent-data-table-td ">14</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Microsoft; "<a href='http://scholar.google.com/scholar?q="Open+Systems%3A+Technology%2C+Leadership%2C+and+Collaboration"'>Open Systems: Technology, Leadership, and Collaboration</a>"; pub. Mar. 1994; pp. 1-15.</td></tr><tr><td class="patent-data-table-td ">15</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Microsoft; "<a href='http://scholar.google.com/scholar?q="The+Microsoft+Object+Technology+Strategy"'>The Microsoft Object Technology Strategy</a>"; pub. Mar. 1994; pp. 1-33.</td></tr><tr><td class="patent-data-table-td ">16</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Microsoft; Microsoft OLE Today and Tomorrow: Technology Overview; pub. Dec. 1993; pp. 1-9.</td></tr><tr><td class="patent-data-table-td ">17</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Open, Modular Architecture Controls at GM Powertrain; pub. May 14, 1996; pp. 1-33.</td></tr><tr><td class="patent-data-table-td ">18</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">OpenBatch Product Brief, PID, Inc.; 6 pages.</td></tr><tr><td class="patent-data-table-td ">19</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Oregon Micro Systems Product Guide: pp. 1-20.</td></tr><tr><td class="patent-data-table-td ">20</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Paragon TNT Product Brochure, Intec Controls Corp.; 6 pages.</td></tr><tr><td class="patent-data-table-td ">21</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">PC/DSP-Series Motion Controller C Programming Guide; pp. 1-54.</td></tr><tr><td class="patent-data-table-td ">22</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">PMAC Product Catalog, p. 43.</td></tr><tr><td class="patent-data-table-td ">23</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Precision Motion Controls Product Guide; p. 17.</td></tr><tr><td class="patent-data-table-td ">24</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Pritschow et al.; "<a href='http://scholar.google.com/scholar?q="Open+System+Controllers%3A+Challenge+for+the+Future+of+the+Machine+Tool+Industry"'>Open System Controllers: Challenge for the Future of the Machine Tool Industry</a>"; pub. Jan. 15, 1993; pp. 449-452.</td></tr><tr><td class="patent-data-table-td ">25</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Proctor et al.; "<a href='http://scholar.google.com/scholar?q="Validation+of+Standard+Interfaces+from+a+Machine+Control"'>Validation of Standard Interfaces from a Machine Control</a>"; pub. 1996; pp. 659-664.</td></tr><tr><td class="patent-data-table-td ">26</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Robert Anderson; "<a href='http://scholar.google.com/scholar?q="SMART%3A+A+Modular+Architecture+for+Robotics+and+Teleoperation"'>SMART: A Modular Architecture for Robotics and Teleoperation</a>"; pub. 1993; pp. 416-421.</td></tr><tr><td class="patent-data-table-td ">27</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Software Products for Industrial Automation, ICONICS; 6 pages.</td></tr><tr><td class="patent-data-table-td ">28</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Sperling et al.; "<a href='http://scholar.google.com/scholar?q="Enabling+Open+Control+Systems%3A+An+Introduction+to+the+OSACA+System+Platform"'>Enabling Open Control Systems: An Introduction to the OSACA System Platform</a>"; pub. May 1996; pp. 1-8.</td></tr><tr><td class="patent-data-table-td ">29</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Sue Chen, Jonathon Lin; "<a href='http://scholar.google.com/scholar?q="Computer+Numerical+Control%3A+Essentials+in+Programming+and+Networking"'>Computer Numerical Control: Essentials in Programming and Networking</a>"; Part 5, Chapter 27; pp. 824-848.</td></tr><tr><td class="patent-data-table-td ">30</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">The Complete, Computer-Based Automation Tool (IGSS) Seven Technologies A/S; 6 pages.</td></tr><tr><td class="patent-data-table-td ">31</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Web 3.0 Product Brochure, Trihedral Engineering Ltd. (1994); 6 pages.</td></tr><tr><td class="patent-data-table-td ">32</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">William E. Ford; "<a href='http://scholar.google.com/scholar?q="What+Is+an+Open+Architecture+Robot+Controller"'>What Is an Open Architecture Robot Controller</a>"pub. Aug. 16, 1994; pp. 27-32.</td></tr><tr><td class="patent-data-table-td ">33</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Wosa Backgrounder: Delivering Enterprise Services to the Windows-based Desktop, Jul. 1993, Microsoft Development Library; pp. 1-19.</td></tr><tr><td class="patent-data-table-td ">34</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Wosa Inside Windows 95; pp. 348-351.</td></tr><tr><td class="patent-data-table-td ">35</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Wright et al.; "<a href='http://scholar.google.com/scholar?q="Open+Architecture+Manufacturing%3A+The+Impact+of+Open-System+Computers+on+Self-sustaining+Machinery+and+the+Machine+Tool+Industry"'>Open Architecture Manufacturing: The Impact of Open-System Computers on Self-sustaining Machinery and the Machine Tool Industry</a>"; pp. 41-47.</td></tr><tr><td class="patent-data-table-td ">36</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Xanalog Model NL-SIM Product Brochure, Xanalog, 4 pages.</td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Referenced by</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Citing Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6889118">US6889118</a></td><td class="patent-data-table-td patent-date-value">Nov 27, 2002</td><td class="patent-data-table-td patent-date-value">May 3, 2005</td><td class="patent-data-table-td ">Evolution Robotics, Inc.</td><td class="patent-data-table-td ">Providing a plurality of resource drivers for the robot, detecting a hardware configuration for the robot; automatically detecting resources that are available on the robot based on the detected hardware configuration; receiving</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7076336">US7076336</a></td><td class="patent-data-table-td patent-date-value">Aug 23, 2004</td><td class="patent-data-table-td patent-date-value">Jul 11, 2006</td><td class="patent-data-table-td ">Evolution Robotics, Inc.</td><td class="patent-data-table-td ">Hardware abstraction layer (HAL) for a robot</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7137107">US7137107</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 29, 2004</td><td class="patent-data-table-td patent-date-value">Nov 14, 2006</td><td class="patent-data-table-td ">Roy-G-Biv Corporation</td><td class="patent-data-table-td ">Motion control systems and methods</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7137861">US7137861</a></td><td class="patent-data-table-td patent-date-value">Jul 16, 2003</td><td class="patent-data-table-td patent-date-value">Nov 21, 2006</td><td class="patent-data-table-td ">Carr Sandra L</td><td class="patent-data-table-td ">Interactive three-dimensional multimedia I/O device for a computer</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7211980">US7211980</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">May 1, 2007</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Robotic follow system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7302312">US7302312</a></td><td class="patent-data-table-td patent-date-value">Jul 11, 2006</td><td class="patent-data-table-td patent-date-value">Nov 27, 2007</td><td class="patent-data-table-td ">Evolution Robotics, Inc.</td><td class="patent-data-table-td ">Hardware abstraction layer (HAL) for a robot</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7584020">US7584020</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Sep 1, 2009</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Occupancy change detection system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7587260">US7587260</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Sep 8, 2009</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Autonomous navigation system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7620477">US7620477</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Nov 17, 2009</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Robotic intelligence kernel</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7668621">US7668621</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Feb 23, 2010</td><td class="patent-data-table-td ">The United States Of America As Represented By The United States Department Of Energy</td><td class="patent-data-table-td ">Robotic guarded motion system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7801644">US7801644</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Sep 21, 2010</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Generic robot architecture</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7925381">US7925381</a></td><td class="patent-data-table-td patent-date-value">Nov 27, 2007</td><td class="patent-data-table-td patent-date-value">Apr 12, 2011</td><td class="patent-data-table-td ">Evolution Robotics, Inc.</td><td class="patent-data-table-td ">Hardware abstraction layer (HAL) for a robot</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7974738">US7974738</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Jul 5, 2011</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Robotics virtual rail system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8073564">US8073564</a></td><td class="patent-data-table-td patent-date-value">Jul 5, 2006</td><td class="patent-data-table-td patent-date-value">Dec 6, 2011</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Multi-robot control interface</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8271132">US8271132</a></td><td class="patent-data-table-td patent-date-value">Mar 13, 2008</td><td class="patent-data-table-td patent-date-value">Sep 18, 2012</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">System and method for seamless task-directed autonomy for robots</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8355818">US8355818</a></td><td class="patent-data-table-td patent-date-value">Sep 3, 2009</td><td class="patent-data-table-td patent-date-value">Jan 15, 2013</td><td class="patent-data-table-td ">Battelle Energy Alliance, Llc</td><td class="patent-data-table-td ">Robots, systems, and methods for hazard evaluation and visualization</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8515583">US8515583</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 6, 2011</td><td class="patent-data-table-td patent-date-value">Aug 20, 2013</td><td class="patent-data-table-td ">Shenzhen Futaihong Precision Industry Co., Ltd.</td><td class="patent-data-table-td ">Machine motion control system for testing electronic components</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8688258">US8688258</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 11, 2008</td><td class="patent-data-table-td patent-date-value">Apr 1, 2014</td><td class="patent-data-table-td ">Rockwell Automation Technologies, Inc.</td><td class="patent-data-table-td ">Method of controlling a machine tool</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20120016498">US20120016498</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 6, 2011</td><td class="patent-data-table-td patent-date-value">Jan 19, 2012</td><td class="patent-data-table-td ">Fih (Hong Kong) Limited</td><td class="patent-data-table-td ">Machine motion control system</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc700/defs700.htm&usg=AFQjCNHrBgWJUqFreK-ZW80HFPO-10C3Kw#C700S056000">700/56</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc700/defs700.htm&usg=AFQjCNHrBgWJUqFreK-ZW80HFPO-10C3Kw#C700S087000">700/87</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0009445000">G06F9/445</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0019416000">G05B19/416</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0015020000">G05B15/02</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0019415500">G05B19/4155</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0019050000">G05B19/05</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0019180000">G05B19/18</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G05B0019414000">G05B19/414</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0009060000">G06F9/06</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/36036">G05B2219/36036</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/34263">G05B2219/34263</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/34208">G05B2219/34208</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/36035">G05B2219/36035</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/23262">G05B2219/23262</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/43167">G05B2219/43167</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B19/19">G05B19/19</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/36037">G05B2219/36037</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B19/416">G05B19/416</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/23265">G05B2219/23265</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/34216">G05B2219/34216</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=tZdeBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G05B2219/34287">G05B2219/34287</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">G05B19/19</span>, <span class="nested-value">B25J9/16C</span>, <span class="nested-value">G05B19/416</span>, <span class="nested-value">G05B19/042P</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">Jul 2, 2013</td><td class="patent-data-table-td ">IPR</td><td class="patent-data-table-td ">Aia trial proceeding filed before the patent and appeal board: inter partes review</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Opponent name: </span><span class="nested-value">ABB INC.</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20130517</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">TRIAL NO: IPR2013-00282</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jan 15, 2013</td><td class="patent-data-table-td ">IPR</td><td class="patent-data-table-td ">Aia trial proceeding filed before the patent and appeal board: inter partes review</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Opponent name: </span><span class="nested-value">ABB INC.</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">TRIAL NO: IPR2013-00062</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20121122</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jun 28, 2011</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">THE PATENTABILITY OF CLAIMS 1-10 IS CONFIRMED.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Feb 4, 2010</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">8</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Nov 4, 2008</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20080923</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jul 26, 2006</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">4</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Feb 11, 2002</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">ROY-G-BIV CORPORATION, WASHINGTON</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:BROWN, DAVID W.;CLARK, JAY S.;REEL/FRAME:012600/0710</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20011129</span></div><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">ROY-G-BIV CORPORATION 154 E. BINGEN POINT WAY SUIT</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:BROWN, DAVID W. /AR;REEL/FRAME:012600/0710</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_8a2b04e7bf975d5171d8e4c0b6365c7a.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U3JschZ9Qsq2l61rujTJFXRiCbzRQ\u0026id=tZdeBAABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U3pOOWXcoCkrdC6Nr3xi8JWHlzgSg\u0026id=tZdeBAABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U0FJgvSzbBeXeHJSEqrfFE1VE9fow","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/Motion_control_systems.pdf?id=tZdeBAABERAJ\u0026output=pdf\u0026sig=ACfU3U3NyHSLXwf1UPRGhc-cEDVyE_KjqQ"},"sample_url":"http://www.google.com/patents/reader?id=tZdeBAABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>