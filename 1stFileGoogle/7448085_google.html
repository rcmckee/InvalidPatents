<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US7448085 - Method and apparatus for detecting malicious content in protected archives - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_8a2b04e7bf975d5171d8e4c0b6365c7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_8a2b04e7bf975d5171d8e4c0b6365c7a__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Method and apparatus for detecting malicious content in protected archives"><meta name="DC.contributor" content="Crescencio F. Reyes" scheme="inventor"><meta name="DC.contributor" content="Ed Israel S. Malibiran" scheme="inventor"><meta name="DC.contributor" content="Ronald C. Bautista" scheme="inventor"><meta name="DC.contributor" content="Trend Micro Incorporated" scheme="assignee"><meta name="DC.date" content="2004-7-7" scheme="dateSubmitted"><meta name="DC.description" content="In one embodiment, a protected archive is checked for malicious content by checking a file size of the archive and/or examining the archive for notable characteristics indicative of malicious content. The notable characteristics may include values in a header of the archive. For example, the file name extension of a file contained in the archive and the compression method used to create the archive may be taken into account in determining whether the archive has malicious content, such as a worm or a virus. Embodiments of the present invention allow for detection of malicious content in the protected archive without necessarily having to extract files from the archive."><meta name="DC.date" content="2008-11-4" scheme="issued"><meta name="DC.relation" content="EP:1377892" scheme="references"><meta name="DC.relation" content="US:20040260636:A1" scheme="references"><meta name="DC.relation" content="US:20060053180:A1" scheme="references"><meta name="DC.relation" content="US:5442699" scheme="references"><meta name="DC.relation" content="US:5452442" scheme="references"><meta name="DC.relation" content="US:5907834" scheme="references"><meta name="DC.relation" content="US:6192512" scheme="references"><meta name="DC.relation" content="US:6279128" scheme="references"><meta name="DC.relation" content="US:6622134" scheme="references"><meta name="DC.relation" content="US:6711583" scheme="references"><meta name="DC.relation" content="US:6789200" scheme="references"><meta name="DC.relation" content="US:6813712" scheme="references"><meta name="DC.relation" content="US:7043634" scheme="references"><meta name="DC.relation" content="WO:2002084459:A1" scheme="references"><meta name="DC.relation" content="WO:2005047862:A2" scheme="references"><meta name="citation_reference" content="Mark W. Storer, Kevin Greenan, Ethan L. Miller, &quot;Long-term Threats to Secure Archives&quot;, Oct. 2006, StorageSS &#39;06: Proceedings of the second ACM workshop on Storage security and survivability, pp. 9-15."><meta name="citation_patent_number" content="US:7448085"><meta name="citation_patent_application_number" content="US:10/885,997"><link rel="canonical" href="http://www.google.com/patents/US7448085"/><meta property="og:url" content="http://www.google.com/patents/US7448085"/><meta name="title" content="Patent US7448085 - Method and apparatus for detecting malicious content in protected archives"/><meta name="description" content="In one embodiment, a protected archive is checked for malicious content by checking a file size of the archive and/or examining the archive for notable characteristics indicative of malicious content. The notable characteristics may include values in a header of the archive. For example, the file name extension of a file contained in the archive and the compression method used to create the archive may be taken into account in determining whether the archive has malicious content, such as a worm or a virus. Embodiments of the present invention allow for detection of malicious content in the protected archive without necessarily having to extract files from the archive."/><meta property="og:title" content="Patent US7448085 - Method and apparatus for detecting malicious content in protected archives"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("mYztU6GdM9OSgwSu6oCwCQ"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407723702.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("GRC"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("mYztU6GdM9OSgwSu6oCwCQ"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407723702.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("GRC"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us7448085?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US7448085"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=RJNmBQABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS7448085&amp;usg=AFQjCNGAdwlwjKLi9yO07l0AnK7hAnK_bA" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US7448085.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US7448085.pdf"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US7448085" style="display:none"><span itemprop="description">In one embodiment, a protected archive is checked for malicious content by checking a file size of the archive and/or examining the archive for notable characteristics indicative of malicious content. The notable characteristics may include values in a header of the archive. For example, the file name...</span><span itemprop="url">http://www.google.com/patents/US7448085?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US7448085 - Method and apparatus for detecting malicious content in protected archives</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US7448085 - Method and apparatus for detecting malicious content in protected archives" title="Patent US7448085 - Method and apparatus for detecting malicious content in protected archives"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US7448085 B1</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 10/885,997</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Nov 4, 2008</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">Jul 7, 2004</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">Jul 7, 2004</td></tr><tr><td class="patent-bibdata-heading">Fee status<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The fee status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status or dates listed."></span></td><td class="single-patent-bibdata">Lapsed</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">10885997, </span><span class="patent-bibdata-value">885997, </span><span class="patent-bibdata-value">US 7448085 B1, </span><span class="patent-bibdata-value">US 7448085B1, </span><span class="patent-bibdata-value">US-B1-7448085, </span><span class="patent-bibdata-value">US7448085 B1, </span><span class="patent-bibdata-value">US7448085B1</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Crescencio+F.+Reyes%22">Crescencio F. Reyes</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Ed+Israel+S.+Malibiran%22">Ed Israel S. Malibiran</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Ronald+C.+Bautista%22">Ronald C. Bautista</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Trend+Micro+Incorporated%22">Trend Micro Incorporated</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US7448085.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7448085.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7448085.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (15),</span> <span class="patent-bibdata-value"><a href="#npl-citations">Non-Patent Citations</a> (1),</span> <span class="patent-bibdata-value"><a href="#forward-citations">Referenced by</a> (6),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (14),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (7)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/7448085&usg=AFQjCNFk9RJKgr90xxi7Q-ce7MLEWW3Igw">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D7448085&usg=AFQjCNE7T2tZJ8-6sqJUNi3d5rsjMzFgpg">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D7448085B1%26KC%3DB1%26FT%3DD&usg=AFQjCNGRFnAFLlTwXcMLF_FGe_b5PZsC_Q">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT68384214" lang="EN" load-source="patent-office">Method and apparatus for detecting malicious content in protected archives</invention-title></span><br><span class="patent-number">US 7448085 B1</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA51379389" lang="EN" load-source="patent-office"> <div num="p-0001" class="abstract">In one embodiment, a protected archive is checked for malicious content by checking a file size of the archive and/or examining the archive for notable characteristics indicative of malicious content. The notable characteristics may include values in a header of the archive. For example, the file name extension of a file contained in the archive and the compression method used to create the archive may be taken into account in determining whether the archive has malicious content, such as a worm or a virus. Embodiments of the present invention allow for detection of malicious content in the protected archive without necessarily having to extract files from the archive.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(6)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00000.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00000.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00001.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00001.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00002.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00002.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00003.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00003.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00004.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00004.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7448085B1/US07448085-20081104-D00005.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7448085B1/US07448085-20081104-D00005.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(20)</span></span></div><div class="patent-text"><div mxw-id="PCLM9474667" lang="EN" load-source="patent-office" class="claims">
  <div class="claim"> <div id="CLM-00001" num="00001" class="claim">
    <div class="claim-text">1. A method to be performed by a server computer, the method comprising:
<div class="claim-text">receiving a protected archive in the server computer, the protected archive including an archived file, the protected archive being configured to prevent extraction of the archived file except manually by a user at a client computer; and</div>
<div class="claim-text">examining the protected archive for notable characteristics indicative of an archive that has been generated by a malicious program.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00002" num="00002" class="claim">
    <div class="claim-text">2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the protected archive comprises a zip file.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00003" num="00003" class="claim">
    <div class="claim-text">3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the protected archive is password protected.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00004" num="00004" class="claim">
    <div class="claim-text">4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the archived file comprises a worm or a virus.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00005" num="00005" class="claim">
    <div class="claim-text">5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the notable characteristics include the size of the protected archive.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00006" num="00006" class="claim">
    <div class="claim-text">6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the notable characteristics include a value in a header of the protected archive.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00007" num="00007" class="claim">
    <div class="claim-text">7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the notable characteristics include a file name extension of the archived file.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00008" num="00008" class="claim">
    <div class="claim-text">8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the notable characteristics include a value in a header of the protected archive.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00009" num="00009" class="claim">
    <div class="claim-text">9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the value is indicative of a compression method used to archive the archived file.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00010" num="00010" class="claim">
    <div class="claim-text">10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein examining the protected archive comprises:
<div class="claim-text">(a) checking a file size of the protected archive;</div>
<div class="claim-text">(b) checking for particular values in a header of the protected archive after step (a); and</div>
<div class="claim-text">(c) checking if the archived file is an executable file after step (b).</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00011" num="00011" class="claim">
    <div class="claim-text">11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the file size is a size of the entirety of the protected archive.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00012" num="00012" class="claim">
    <div class="claim-text">12. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the file size is a size of the archived file.</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00013" num="00013" class="claim">
    <div class="claim-text">13. A computer having a processor for executing computer-readable program code in a memory, the memory comprising:
<div class="claim-text">computer-readable program code for checking a file size of a protected archive containing an archived file, the protected archive being protected by a password;</div>
<div class="claim-text">computer-readable program code for checking a value in a header of the protected archive;</div>
<div class="claim-text">computer-readable program code for determining if the archived file comprises an executable file; and</div>
<div class="claim-text">computer-readable program code for determining if the protected archive includes a virus based on the file size of the protected archive, the value in the header of the protected archive, and whether the archived file comprises an executable file.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00014" num="00014" class="claim">
    <div class="claim-text">14. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the computer comprises a server computer.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00015" num="00015" class="claim">
    <div class="claim-text">15. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the computer further comprises a pattern file comprising information on notable characteristics of protected archives created by malicious programs.</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00016" num="00016" class="claim">
    <div class="claim-text">16. A method to be performed by a computer, the method comprising:
<div class="claim-text">receiving an e-mail in the computer, the e-mail including a protected archive;</div>
<div class="claim-text">checking a header of the archive to determine if the archive is likely to contain malicious content without extracting an archived file in the archive.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00017" num="00017" class="claim">
    <div class="claim-text">17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> further comprising:
<div class="claim-text">checking a file size of the archive to determine if the archive is likely to contain malicious content.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00018" num="00018" class="claim">
    <div class="claim-text">18. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> further comprising:
<div class="claim-text">checking for an executable file in the archive to determine if the archive is likely to contain malicious content.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00019" num="00019" class="claim">
    <div class="claim-text">19. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the computer comprises a server computer coupled to a client computer destined to receive the e-mail.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00020" num="00020" class="claim">
    <div class="claim-text">20. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the password is provided in the e-mail in graphical form. </div>
  </div>
</div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES16497211" lang="EN" load-source="patent-office" class="description">
<heading>BACKGROUND OF THE INVENTION</heading> <p num="p-0002">1. Field of the Invention</p>
  <p num="p-0003">The present invention relates generally to computer systems, and more particularly but not exclusively to techniques for detecting malicious content.</p>
  <p num="p-0004">2. Description of the Background Art</p>
  <p num="p-0005">Malicious programs, such as computer viruses, spy wares, worms, and Trojans, pose a significant threat to computer systems. For example, a computer virus can corrupt or delete important files, send e-mails without user authorization, render a computer inoperable, or cause other types of damage to a computer. Computers may incorporate antivirus programs as a protective measure against viruses. An antivirus program may open a file and then scan the file for malicious content.</p>
  <p num="p-0006">As a countermeasure against antivirus programs, a malicious program may be embedded in a password protected archive. An example of such a malicious program is the so-called “BAGLE” worm. The BAGLE worm propagates by mass-mailing copies of itself using SMTP (Simple Mail Transfer Protocol). The BAGLE worm also opens a backdoor that allows a hacker to upload and run programs on infected computers.</p>
  <p num="p-0007">The BAGLE worm arrives in a password protected archive, which is included as an attachment to an e-mail. The password required to extract files from the archive is included in the message body of the e-mail. The password is provided as a text file in the early versions of the worm. This allows an antivirus program to parse the message body to obtain the password, which in turn allows the antivirus program to extract files from the archive for scanning. However, later versions of the worm include the password as a graphical image. This prevents an antivirus program from obtaining the password needed to extract files from the archive.</p>
  <heading>SUMMARY</heading> <p num="p-0008">In one embodiment, a protected archive is checked for malicious content by checking a file size of the archive and/or examining the archive for notable characteristics indicative of malicious content. The notable characteristics may include values in a header of the archive. For example, the file name extension of a file contained in the archive and the compression method used to create the archive may be taken into account in determining whether the archive has malicious content, such as a worm or a virus. The archive may be inspected at a server computer prior to the archive being provided to a user at a client computer. The notable characteristics may be included in a pattern file of an antivirus program to facilitate updates when new notable characteristics of malicious programs are discovered. Embodiments of the present invention allow for detection of malicious content in the protected archive without necessarily having to extract files from the archive.</p>
  <p num="p-0009">These and other features of the present invention will be readily apparent to persons of ordinary skill in the art upon reading the entirety of this disclosure, which includes the accompanying drawings and claims.</p>
<description-of-drawings> <heading>DESCRIPTION OF THE DRAWINGS</heading> <p num="p-0010"> <figref idrefs="DRAWINGS">FIG. 1</figref> schematically illustrates a computing environment in accordance with an embodiment of the present invention.</p>
    <p num="p-0011"> <figref idrefs="DRAWINGS">FIG. 2</figref> shows a schematic diagram of an example computer that may be used in embodiments of the present invention.</p>
    <p num="p-0012"> <figref idrefs="DRAWINGS">FIG. 3A</figref> schematically shows an example e-mail containing an attached archive generated by a malicious program.</p>
    <p num="p-0013"> <figref idrefs="DRAWINGS">FIG. 3B</figref> shows a screenshot of an example e-mail generated by the so-called “BAGLE” worm.</p>
    <p num="p-0014"> <figref idrefs="DRAWINGS">FIG. 4</figref> shows a method of detecting malicious content in a protected archive, in accordance with an embodiment of the present invention.</p>
  </description-of-drawings> <p num="p-0015">The use of the same reference label in different drawings indicates the same or like components.</p>
  <heading>DETAILED DESCRIPTION</heading> <p num="p-0016">In the present disclosure, numerous specific details are provided, such as examples of apparatus, components, and methods, to provide a thorough understanding of embodiments of the invention. Persons of ordinary skill in the art will recognize, however, that the invention can be practiced without one or more of the specific details. In other instances, well-known details are not shown or described to avoid obscuring aspects of the invention.</p>
  <p num="p-0017">Being computer-related, it can be appreciated that the components disclosed herein may be implemented in hardware, software, or a combination of hardware and software (e.g., firmware). Software components may be in the form of computer-readable program code stored in a computer-readable storage medium, such as memory, mass storage device, or removable storage device. For example, a computer-readable storage medium may comprise computer-readable program code for performing the function of a particular component. Likewise, computer memory may be configured to include one or more components, which may then be executed by a processor. Components may be implemented separately in multiple modules or together in a single module.</p>
  <p num="p-0018">Embodiments of the invention are described herein using e-mails and archived files as examples. It should be understood, however, that the invention is not so limited and may be generally employed in applications requiring detection of malicious content in protected data.</p>
  <p num="p-0019"> <figref idrefs="DRAWINGS">FIG. 1</figref> schematically illustrates a computing environment <b>100</b> in accordance with an embodiment of the present invention. In the example of <figref idrefs="DRAWINGS">FIG. 1</figref>, computing environment <b>100</b> includes a client computer <b>130</b> located in a computer network along with a gateway computer <b>110</b>. The client computer <b>130</b> may communicate with other computers on the Internet by way of the gateway computer <b>110</b>. Other network nodes, such as routers, firewalls, e-mail servers, and other computers, are not shown for clarity of illustration. In the example of <figref idrefs="DRAWINGS">FIG. 1</figref>, client computer <b>130</b> sends and receives e-mails over the Internet.</p>
  <p num="p-0020">In one embodiment, an antivirus program <b>320</b> is installed and running in a server computer, such as the gateway computer <b>110</b>. This advantageously allows the antivirus program <b>320</b> to scan data for malicious content before the data is received in the client computer <b>130</b> or other computers in the network. Running the antivirus program <b>320</b> at a server computer also simplifies maintenance because the network administrator has only one (or a few) central location where antivirus program updates need to be performed.</p>
  <p num="p-0021">The antivirus program <b>320</b> may be configured to check an incoming e-mail <b>102</b> or outgoing e-mail <b>101</b> for malicious content. For example, the antivirus program <b>320</b> may be configured to check an incoming e-mail <b>102</b> at the gateway computer <b>110</b> before the incoming e-mail <b>102</b> is received by a user at the client computer <b>130</b>. In other embodiments, the antivirus program <b>320</b> is installed and running in the client computer <b>130</b>. In that embodiment, the antivirus program <b>320</b> checks an incoming e-mail <b>102</b> before e-mail <b>102</b> is presented to the user, or an outgoing e-mail <b>101</b> before e-mail <b>101</b> is transmitted out of client computer <b>130</b>.</p>
  <p num="p-0022">Referring now to <figref idrefs="DRAWINGS">FIG. 2</figref>, there is shown a schematic diagram of an example computer that may be used in embodiments of the present invention. Depending on its configuration, the computer shown in the example of <figref idrefs="DRAWINGS">FIG. 2</figref> may be employed as a gateway computer or a client computer. The computer of <figref idrefs="DRAWINGS">FIG. 2</figref> may have less or more components to meet the needs of a particular application. As shown in <figref idrefs="DRAWINGS">FIG. 2</figref>, the computer may include a processor <b>101</b>, such as those from the Intel Corporation or Advanced Micro Devices, for example. The computer may have one or more buses <b>103</b> coupling its various components. The computer may include one or more input devices <b>102</b> (e.g., keyboard, mouse), a computer-readable storage medium (CRSM) <b>105</b> (e.g., floppy disk, CD-ROM), a CRSM reader <b>104</b> (e.g., floppy drive, CD-ROM drive), a display monitor <b>109</b> (e.g., cathode ray tube, flat panel display), a communications interface <b>106</b> (e.g., network adapter, modem) for coupling to a network, one or more data storage devices <b>107</b> (e.g., hard disk drive, optical drive, FLASH memory), and a main memory <b>108</b> (e.g., RAM). Software embodiments may be stored in a computer-readable storage medium <b>105</b> for reading into a data storage device <b>107</b> or main memory <b>108</b>.</p>
  <p num="p-0023">In the example of <figref idrefs="DRAWINGS">FIG. 2</figref>, the computer is configured as a gateway computer <b>110</b> having an antivirus program <b>320</b> comprising a scanning engine <b>321</b> and a pattern file <b>322</b>. The pattern file <b>322</b> is depicted as being stored in a data storage device <b>107</b>, while the scanning engine <b>321</b> is depicted as being in the memory <b>108</b>. Note, however, that the scanning engine <b>321</b> may have a corresponding executable file in the data storage <b>107</b>. Similarly, the contents of the pattern file <b>322</b> may be read from the data storage <b>107</b> to the memory <b>108</b>. The scanning engine <b>321</b> may comprise computer-readable program code for detecting and removing malicious programs, such as computer viruses and worms, for example. The scanning engine <b>321</b> works in conjunction with the pattern file <b>322</b>, which may contain the patterns and notable characteristics of known malicious programs, and instructions or algorithms for dealing with them. The pattern file <b>322</b> may be updated to include information on newly discovered malicious programs. It is to be noted that the mechanics of scanning data for malicious programs and removing detected malicious programs, in general, is known in the art and not further described here.</p>
  <p num="p-0024"> <figref idrefs="DRAWINGS">FIG. 3A</figref> schematically shows an example e-mail <b>300</b> containing an attached archive generated by a malicious program. A malicious program-generated archive is also referred to herein as a “bad archive.” In the example of <figref idrefs="DRAWINGS">FIG. 2</figref>, the bad archive “gift4you.zip” is in the zip format. Note that a bad archive may also be in other archive formats, such as the so-called RAR format. An archive contains one or more archived files. An archive may be protected with a password to prevent the archived file from being extracted by other than the intended receiver. A password protected archive asks for the password before allowing extraction of files contained therein. In the example of <figref idrefs="DRAWINGS">FIG. 3A</figref>, the password for the attached bad archive is provided as a graphical image <b>302</b>. Although the password displayed by the graphical image <b>302</b> is human-readable, the password is otherwise unreadable to a computer program. More specifically, the antivirus program <b>320</b> cannot parse the graphical image <b>302</b> to get the password (which is “rug” in the example of <figref idrefs="DRAWINGS">FIG. 3A</figref>). This prevents the antivirus program <b>320</b> from extracting and scanning the file contained in the bad archive. Only the user can extract files from the archive by manually entering the password.</p>
  <p num="p-0025"> <figref idrefs="DRAWINGS">FIG. 3B</figref> shows a screenshot of an example e-mail <b>310</b> generated by the BAGLE worm. In the example of <figref idrefs="DRAWINGS">FIG. 3B</figref>, the password “45349” for opening the attached bad archive “text_document.zip” is in the “gif” format. Typical antivirus programs cannot read a gif image, and thus will not be able to extract files from the bad archive.</p>
  <p num="p-0026">In one embodiment, a signature based detection technique is used to determine if a protected archive contains malicious content. The signature based detection technique advantageously does not require file extraction, and may thus be used even if the archive cannot be opened by an antivirus program. The signature based detection technique may rely on notable characteristics of known bad archives. Antivirus researchers may observe the notable characteristics of bad archives, and incorporate those characteristics as filters in pattern files employed by antivirus programs. In one embodiment, the notable characteristics indicative of a bad archive include file size, and certain values in file headers, such as the compression method used, whether the archive is password protected, and name of files contained in the archive. Note that the header of a typical archive is readable without having to open the archive. In other words, the header of an archive is normally available for inspection even if the archive is protected.</p>
  <p num="p-0027"> <figref idrefs="DRAWINGS">FIG. 4</figref> shows a method <b>400</b> of detecting malicious content in a protected archive, in accordance with an embodiment of the present invention. In the example of <figref idrefs="DRAWINGS">FIG. 4</figref>, the malicious content is a virus or a worm. However, the malicious content may also be other unwanted content, such as spam (i.e., unsolicited e-mail) or unauthorized communication. The method <b>400</b> may be implemented as part of the antivirus program <b>320</b>. For example, the notable characteristics of bad archives may be included in the pattern file <b>322</b> (see <figref idrefs="DRAWINGS">FIG. 2</figref>). The scanning engine <b>321</b> may then consult the pattern file <b>322</b> to find out what to look for in determining whether an archive was generated by a malicious program. Including the notable characteristics of bad archives in a pattern file advantageously facilitates updating of notable characteristics as researchers learn more about the malicious program. The notable characteristics of bad archives may also be incorporated in a scanning engine or other components of an antivirus program. Depending on the application, the method <b>400</b> may also be implemented in hardware (e.g., ASIC).</p>
  <p num="p-0028">Beginning in step <b>402</b>, a protected archive is received in a computer. The computer may be a server computer or a client computer, for example. The archive may contain one or more files and be protected with a password. For example, the archive may be a password protected zip or RAR file. The protected archive may be configured to prevent extraction of archived files except manually by a user at a client computer, for example.</p>
  <p num="p-0029">In step <b>404</b>, the scanning engine <b>321</b> checks the size of the archive, individual files in the archive, or both. For example, the header of a zip archive contains a local file header for each archived file. The local file header may be examined to determine the compressed, uncompressed, or both sizes of an archived file. The size of the entire archive may also be taken into account.</p>
  <p num="p-0030">In step <b>406</b>, the scanning engine <b>321</b> compares the size of the archive, individual files in the archive, or both to those of known bad archives. The file sizes for known bad archives may be included in the pattern file <b>322</b>. If the size of the archive or any file in the archive is within range of those known to be associated with a malicious program, method <b>400</b> continues to step <b>410</b>. Otherwise, the archive may be assumed to be a good (i.e., not bad) archive, as indicated in step <b>408</b>.</p>
  <p num="p-0031">For example, assuming that an archived file in a BAGLE worm-generated archive is known to have a compressed size of 44 KB to 46. KB and the received archive has a single archived file having a compressed size of 50 KB, it may be assumed that the received archive was not generated by the BAGLE worm. Otherwise, additional filtering steps may be needed to minimize the number of false positives (i.e., false alarms).</p>
  <p num="p-0032">In step <b>410</b>, the scanning engine <b>321</b> examines the header of the received archive for notable characteristics. Such notable characteristics may include the compression method used and other values in the header of the archive. For example, in some bad archives using the zip format, the compression method (offset 0x8 in the local file header) used is 0x0, and the difference between the compressed size (offset 0x12 in the local file header) and the uncompressed size (offset 0x16 in the local file header) is 0xC. The just mentioned header values may be included in the pattern file <b>322</b> for use by the scanning engine <b>321</b> in determining whether a zip archive is likely to be a bad archive. Note that the header of a zip archive includes a central directory in addition to local file headers. Only the values in the local file headers may be examined and taken into account for performance reasons. Values in the central directory may also be examined and taken into account to minimize false positives.</p>
  <p num="p-0033">In the path from step <b>412</b> to step <b>408</b>, the received archive may be assumed to be a good archive if its header does not have a value matching that of known bad archives. Otherwise, method <b>400</b> continues in step <b>414</b>.</p>
  <p num="p-0034">In step <b>414</b>, the scanning engine <b>321</b> checks the received archive for executable files. Step <b>414</b> may be performed by examining the file name extensions of files in the archive. For example, in the Microsoft Windows™ operating system environment, files with file name extensions of “.exe”, “.scr”, and “.pif” are executable files and are likely to harm the computer if the received archive turns out to be a bad archive. In some archives (e.g., zip), the file name extensions of archived files may be determined by examining the header of the archive.</p>
  <p num="p-0035">In the path from step <b>416</b> to step <b>408</b>, the received archive may be assumed to be a good archive if it does not contain executable files. Otherwise, as indicated in step <b>418</b>, the received archive may be assumed to be a bad archive.</p>
  <p num="p-0036">In the example of <figref idrefs="DRAWINGS">FIG. 4</figref>, method <b>400</b> uses a series of filters that include file size (step <b>404</b>), header values (step <b>410</b>), and executable files in the archive (step <b>416</b>) in determining whether or not an archive is a bad archive, without having to extract files from the archive. These filters are designed to minimize the number of false positives without substantially impacting performance. In light of the present disclosure, those of ordinary skill in the art will appreciate that more or less filters may be employed to accommodate the requirement of particular applications.</p>
  <p num="p-0037">While specific embodiments of the present invention have been provided, it is to be understood that these embodiments are for illustration purposes and not limiting. Many additional embodiments will be apparent to persons of ordinary skill in the art reading this disclosure.</p>
</div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5442699">US5442699</a></td><td class="patent-data-table-td patent-date-value">Nov 21, 1994</td><td class="patent-data-table-td patent-date-value">Aug 15, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Searching for patterns in encrypted data</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5452442">US5452442</a></td><td class="patent-data-table-td patent-date-value">Apr 14, 1995</td><td class="patent-data-table-td patent-date-value">Sep 19, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Methods and apparatus for evaluating and extracting signatures of computer viruses and other undesirable software entities</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5907834">US5907834</a></td><td class="patent-data-table-td patent-date-value">Mar 18, 1996</td><td class="patent-data-table-td patent-date-value">May 25, 1999</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Method and apparatus for detecting a presence of a computer virus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6192512">US6192512</a></td><td class="patent-data-table-td patent-date-value">Sep 24, 1998</td><td class="patent-data-table-td patent-date-value">Feb 20, 2001</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Interpreter with virtualized interface</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6279128">US6279128</a></td><td class="patent-data-table-td patent-date-value">Dec 29, 1994</td><td class="patent-data-table-td patent-date-value">Aug 21, 2001</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Autonomous system for recognition of patterns formed by stored data during computer memory scrubbing</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6622134">US6622134</a></td><td class="patent-data-table-td patent-date-value">Jan 5, 1999</td><td class="patent-data-table-td patent-date-value">Sep 16, 2003</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Method of constructing data classifiers and classifiers constructed according to the method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6711583">US6711583</a></td><td class="patent-data-table-td patent-date-value">Sep 30, 1998</td><td class="patent-data-table-td patent-date-value">Mar 23, 2004</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">System and method for detecting and repairing document-infecting viruses using dynamic heuristics</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6789200">US6789200</a></td><td class="patent-data-table-td patent-date-value">May 18, 2000</td><td class="patent-data-table-td patent-date-value">Sep 7, 2004</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Method of automatically instituting secure, safe libraries and functions when exposing a system to potential system attacks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6813712">US6813712</a></td><td class="patent-data-table-td patent-date-value">Aug 17, 1999</td><td class="patent-data-table-td patent-date-value">Nov 2, 2004</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Viral replication detection using a counter virus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7043634">US7043634</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 15, 2001</td><td class="patent-data-table-td patent-date-value">May 9, 2006</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">Detecting malicious alteration of stored computer files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20040260636">US20040260636</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 14, 2004</td><td class="patent-data-table-td patent-date-value">Dec 23, 2004</td><td class="patent-data-table-td ">Integrated Data Control, Inc.</td><td class="patent-data-table-td ">Check image access system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20060053180">US20060053180</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 5, 2005</td><td class="patent-data-table-td patent-date-value">Mar 9, 2006</td><td class="patent-data-table-td ">Galit Alon</td><td class="patent-data-table-td ">Method for inspecting an archive</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP1377892B1?cl=en">EP1377892B1</a></td><td class="patent-data-table-td patent-date-value">Apr 9, 2002</td><td class="patent-data-table-td patent-date-value">Sep 29, 2004</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Detection of computer viruses on a network using a bait server</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2002084459A1?cl=en">WO2002084459A1</a></td><td class="patent-data-table-td patent-date-value">Apr 9, 2002</td><td class="patent-data-table-td patent-date-value">Oct 24, 2002</td><td class="patent-data-table-td ">Ibm</td><td class="patent-data-table-td ">Detection of computer viruses on a network using a bait server</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2005047862A2?cl=en">WO2005047862A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Nov 12, 2004</td><td class="patent-data-table-td patent-date-value">May 26, 2005</td><td class="patent-data-table-td ">Univ Columbia</td><td class="patent-data-table-td ">Apparatus method and medium for identifying files using n-gram distribution of data</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">Non-Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">Reference</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Mark W. Storer, Kevin Greenan, Ethan L. Miller, "<a href='http://scholar.google.com/scholar?q="Long-term+Threats+to+Secure+Archives"'>Long-term Threats to Secure Archives</a>", Oct. 2006, StorageSS '06: Proceedings of the second ACM workshop on Storage security and survivability, pp. 9-15.</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Referenced by</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Citing Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7730540">US7730540</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 8, 2004</td><td class="patent-data-table-td patent-date-value">Jun 1, 2010</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Method for scanning protected components of electronic messages</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8042184">US8042184</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 18, 2006</td><td class="patent-data-table-td patent-date-value">Oct 18, 2011</td><td class="patent-data-table-td ">Kaspersky Lab, Zao</td><td class="patent-data-table-td ">Rapid analysis of data stream for malware presence</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8074280">US8074280</a></td><td class="patent-data-table-td patent-date-value">Dec 15, 2009</td><td class="patent-data-table-td patent-date-value">Dec 6, 2011</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Detection of undesired computer files in archives</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8151355">US8151355</a></td><td class="patent-data-table-td patent-date-value">Sep 29, 2010</td><td class="patent-data-table-td patent-date-value">Apr 3, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Detection of undesired computer files in archives</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8166550">US8166550</a></td><td class="patent-data-table-td patent-date-value">Oct 6, 2010</td><td class="patent-data-table-td patent-date-value">Apr 24, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Detection of undesired computer files in damaged archives</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8327447">US8327447</a></td><td class="patent-data-table-td patent-date-value">Dec 6, 2011</td><td class="patent-data-table-td patent-date-value">Dec 4, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Detection of undesired computer files in archives</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc726/defs726.htm&usg=AFQjCNG_-XRx1vivcRvidgiM5InbyBytrA#C726S026000">726/26</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc726/defs726.htm&usg=AFQjCNG_-XRx1vivcRvidgiM5InbyBytrA#C726S022000">726/22</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc726/defs726.htm&usg=AFQjCNG_-XRx1vivcRvidgiM5InbyBytrA#C726S024000">726/24</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=H04L0029060000">H04L29/06</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=B65C0009140000">B65C9/14</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0011000000">G06F11/00</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0007040000">G06F7/04</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0001000000">G06F1/00</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06K0017000000">G06K17/00</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=B65C0009360000">B65C9/36</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/145">H04L63/145</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F21/56">G06F21/56</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=RJNmBQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/1416">H04L63/1416</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">G06F21/56</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">Dec 25, 2012</td><td class="patent-data-table-td ">FP</td><td class="patent-data-table-td ">Expired due to failure to pay maintenance fee</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20121104</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Nov 4, 2012</td><td class="patent-data-table-td ">LAPS</td><td class="patent-data-table-td ">Lapse for failure to pay maintenance fees</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">Jun 18, 2012</td><td class="patent-data-table-td ">REMI</td><td class="patent-data-table-td ">Maintenance fee reminder mailed</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">Jun 7, 2011</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CLAIMS 1, 5, 10, 13 AND 16-18 ARE DETERMINED TO BE PATENTABLE AS AMENDED. CLAIMS 2-4, 6-9, 11-12, 14-15 AND 19-20, DEPENDENT ON AN AMENDED CLAIM, ARE DETERMINED TO BE PATENTABLE. NEW CLAIMS 21-35 ARE ADDED AND DETERMINED TO BE PATENTABLE.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">May 11, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100304</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Apr 27, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100213</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jul 7, 2004</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">TREND MICRO INCORPORATED, JAPAN</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:REYES, CRESCENCIO F.;MALIBIRAN, ED ISRAEL S.;BAUTISTA, RONALD C.;REEL/FRAME:015560/0329;SIGNING DATES FROM 20040605 TO 20040705</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_8a2b04e7bf975d5171d8e4c0b6365c7a.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U3p0MD-T7SOky4fwEhRQiRbm9M1PA\u0026id=RJNmBQABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U1hXSqhbT_apAHGfB8g8WxKVawj8Q\u0026id=RJNmBQABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U2BDTosHTAQk1if_ZfO_v0NLASxqA","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/Method_and_apparatus_for_detecting_malic.pdf?id=RJNmBQABERAJ\u0026output=pdf\u0026sig=ACfU3U3nNuWJeVPfSe_sI4a9hsQklLXLRA"},"sample_url":"http://www.google.com/patents/reader?id=RJNmBQABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>