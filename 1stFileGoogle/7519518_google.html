<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak ... - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_8a2b04e7bf975d5171d8e4c0b6365c7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_8a2b04e7bf975d5171d8e4c0b6365c7a__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings"><meta name="DC.contributor" content="Lars Langemyr" scheme="inventor"><meta name="DC.contributor" content="Daniel Bertilsson" scheme="inventor"><meta name="DC.contributor" content="Arne Nordmark" scheme="inventor"><meta name="DC.contributor" content="Per-Olof Persson" scheme="inventor"><meta name="DC.contributor" content="Jerome Long" scheme="inventor"><meta name="DC.contributor" content="Comsol Ab" scheme="assignee"><meta name="DC.date" content="2001-11-27" scheme="dateSubmitted"><meta name="DC.description" content="Disclosed are techniques for representing and modeling one or more systems in which each system corresponds to an application mode. This may be done for one or more geometries using local and/or non-local couplings. For each application mode, physical quantities are modeled and may be defined using a graphical user interface. Physical properties may be used to model the physical quantities of each system. The physical properties may be defined in terms of numerical values or constants, and mathematical expressions that may include numerical values, space coordinates, time coordinates, and actual physical quantities. Physical quantities and any associated variables may apply to some or all of a geometric domain, and may also be disabled in other parts of a geometrical domain. Partial differential equations describe the physical quantities. One or more application modes may be combined using an automated technique into a combined system of partial differential equations as a multiphysics model. A portion of the physical quantities and variables associated with the combined system may be selectively solved for. The partial differential equations may be displayed and may in turn solve for the system of partial differential equations in accordance with a general form or a coefficient form. An automated technique provides for automatic derivation of the combined partial differential equations and boundary conditions. This technique automatically merges the equations from a plurality of application modes, and in some instances, performs symbolic differentiation of the equations, producing a single system of partial differential equations. A subset of physical quantities and associated variables not solved for may be used as initial values to the system of partial differential equations."><meta name="DC.date" content="2009-4-14" scheme="issued"><meta name="DC.relation" content="US:5408638" scheme="references"><meta name="DC.relation" content="US:6349272" scheme="references"><meta name="DC.relation" content="US:6810370" scheme="references"><meta name="citation_reference" content="16th American Society of Civil Engineers (ASCE) Engineering Mechanics Conference, Jul. 16-18, 2003. Printed Jan. 10, 2007. http://www.ce.washington.edu/em03/proceedings/authorindex.htm."><meta name="citation_reference" content="Anderson, D.G. &quot;Iterative Procedures for Nonlinear Integral Equations.&quot; Journal of the ACM. vol. 12, Issue 4. Oct. 1965."><meta name="citation_reference" content="Brenner et al., &quot;The Mathematical Theory of Finite Element Methods,&quot; Springer-Verlag 1-12 (1994) The Finite Element Method: 1-12."><meta name="citation_reference" content="C. Johnson, &quot;Numerical Solution of Partial Differential Equations by the Finite Element Method,&quot; Studentlitteratur 14-18 (1987) Test Function 14-18."><meta name="citation_reference" content="Canova, A. and M. Repetto. &quot;Integral Solution of Nonlinear Magnetostatic Field Problems&quot;, IEEE Transactions on Magnetics, vol. 37, No. 3, pp. 1070-1077, May 2001."><meta name="citation_reference" content="Dahlquist, et al., &quot;Numerical Methods,&quot; Prentice Hall 284-355 (1974) Interpolation: 284-285; Linear Solver: 146-172; Time-Dependent Solver: 347-355; Eigenvalue Solver: 208-211; Damped Newton Method: 248-253."><meta name="citation_reference" content="Davenport et al., &quot;Computer Algebra Systems and Algorithms for Algebraic Computation,&quot; Academic Press 28-32 (1993) Symbolic Differentiation: 28-32."><meta name="citation_reference" content="Femlab 2.2: New Features. (C) 2001. Printed from http://www.technion.ac.il/~leonidb/BursteinSite/Femlb22About.htm."><meta name="citation_reference" content="Femlab(R) Installation and New Features Guide, Version 2.3. Nov. 2002."><meta name="citation_reference" content="Femlab(R) Reference Manual, Version 1.0. Jul. 1998."><meta name="citation_reference" content="Femlab, &quot;Chemical Engineering Module,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Electromagnetics Module,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Installation Guide,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Model Library,&quot; For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Model Library,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Reference Manual,&quot; For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Reference Manual,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;Structural Mechanics Engineering Module,&quot; For Use With Femlab (Copyright 1994-1998)."><meta name="citation_reference" content="Femlab, &quot;User&#39;s Guide and Instruction,&quot; For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB)."><meta name="citation_reference" content="Femlab, &quot;User&#39;s Guide and Introduction,&quot; For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB)."><meta name="citation_reference" content="Frey et al., &quot;Mesh Generation, Application to Finite Elements,&quot; Hermes, Paris 88-90 (2000) Mesh Search: 88-90."><meta name="citation_reference" content="George et al., &quot;Delaunay Triangulation and Meshing,&quot; Hermes, Paris 33-238 (1998) Delaunay triangulation: 33-46, 50-59; Constrained triangulation: 73-99; Parametric surface meshing: 161-173; Optimizations: 215-238."><meta name="citation_reference" content="Mathworks, Inc., &quot;Partial Differential Equation Toolbox: User&#39;s Guide&quot; For Use with Matlab (C) (Copyright 1984-1997 The Mathworks, Inc.)."><meta name="citation_reference" content="Persson, P. &quot;Implementation of Finite Element-Based Navier-Stokes Solver 2.094-Project&quot;, Apr. 25, 2002. http://www.mit.edu/ persson/nsfem-report.pdf."><meta name="citation_reference" content="Rao, P. &quot;An Efficient Scalable Finite Element Model for Simulating Large Scale Hydrodynamic Flows&quot;, 16th ASCE Engineering Mechanics Conf., Jul. 16-18, 2003."><meta name="citation_reference" content="Ribeiro, P. &quot;Non-linear Forced Vibrations of Thin/Thick Beams and Plates by the Finite Element and Shooting Methods&quot;, Computers and Structures, vol. 82, pp. 1413-1423, May 2004."><meta name="citation_reference" content="Saitz, J. &quot;Newton-Raphson Method and Fixed-Point Technique in Finite Element Computation of Magnetic Field Problems in Media with Hysteresis&quot;, IEEE Transactions on Magnetic, vol. 35, No. 3, pp. 1398-1401, May 1999."><meta name="citation_reference" content="Wilks, &quot;Primer on Object-Oriented Programming,&quot; http://www.eimc.brad.ac.uk/java/tutorial/Project1/ooprim.htm (1996)."><meta name="citation_reference" content="Zienkiewicz et al., &quot;The Finite Element Method,&quot; McGraw-Hill 1:23-177 (1989) Basis Function: 23-26; Quadrature Formulas, Gauss Points, Weights: 175-177."><meta name="citation_patent_number" content="US:7519518"><meta name="citation_patent_application_number" content="US:09/995,222"><link rel="canonical" href="http://www.google.com/patents/US7519518"/><meta property="og:url" content="http://www.google.com/patents/US7519518"/><meta name="title" content="Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings"/><meta name="description" content="Disclosed are techniques for representing and modeling one or more systems in which each system corresponds to an application mode. This may be done for one or more geometries using local and/or non-local couplings. For each application mode, physical quantities are modeled and may be defined using a graphical user interface. Physical properties may be used to model the physical quantities of each system. The physical properties may be defined in terms of numerical values or constants, and mathematical expressions that may include numerical values, space coordinates, time coordinates, and actual physical quantities. Physical quantities and any associated variables may apply to some or all of a geometric domain, and may also be disabled in other parts of a geometrical domain. Partial differential equations describe the physical quantities. One or more application modes may be combined using an automated technique into a combined system of partial differential equations as a multiphysics model. A portion of the physical quantities and variables associated with the combined system may be selectively solved for. The partial differential equations may be displayed and may in turn solve for the system of partial differential equations in accordance with a general form or a coefficient form. An automated technique provides for automatic derivation of the combined partial differential equations and boundary conditions. This technique automatically merges the equations from a plurality of application modes, and in some instances, performs symbolic differentiation of the equations, producing a single system of partial differential equations. A subset of physical quantities and associated variables not solved for may be used as initial values to the system of partial differential equations."/><meta property="og:title" content="Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("p1PsU_3cNYO-sATw54LICw"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407723702.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("CZE"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("p1PsU_3cNYO-sATw54LICw"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407723702.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("CZE"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us7519518?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US7519518"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=FNq0BQABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS7519518&amp;usg=AFQjCNEtEO6KVZqErTvSEPaa5l1nz9nuAQ" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US7519518.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US7519518.pdf"></a><a class="appbar-application-grant-link" data-label="Application" href="/patents/US20030105614"></a><a class="appbar-application-grant-link" data-selected="true" data-label="Grant" href="/patents/US7519518"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US7519518" style="display:none"><span itemprop="description">Disclosed are techniques for representing and modeling one or more systems in which each system corresponds to an application mode. This may be done for one or more geometries using local and/or non-local couplings. For each application mode, physical quantities are modeled and may be defined using a...</span><span itemprop="url">http://www.google.com/patents/US7519518?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings" title="Patent US7519518 - Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US7519518 B2</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 09/995,222</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Apr 14, 2009</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">Nov 27, 2001</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">Aug 2, 2000</td></tr><tr><td class="patent-bibdata-heading">Fee status<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The fee status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status or dates listed."></span></td><td class="single-patent-bibdata">Paid</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Also published as</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US20030105614">US20030105614</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">09995222, </span><span class="patent-bibdata-value">995222, </span><span class="patent-bibdata-value">US 7519518 B2, </span><span class="patent-bibdata-value">US 7519518B2, </span><span class="patent-bibdata-value">US-B2-7519518, </span><span class="patent-bibdata-value">US7519518 B2, </span><span class="patent-bibdata-value">US7519518B2</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Lars+Langemyr%22">Lars Langemyr</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Daniel+Bertilsson%22">Daniel Bertilsson</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Arne+Nordmark%22">Arne Nordmark</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Per-Olof+Persson%22">Per-Olof Persson</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Jerome+Long%22">Jerome Long</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Comsol+Ab%22">Comsol Ab</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US7519518.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7519518.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7519518.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (3),</span> <span class="patent-bibdata-value"><a href="#npl-citations">Non-Patent Citations</a> (29),</span> <span class="patent-bibdata-value"><a href="#forward-citations">Referenced by</a> (5),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (11),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/7519518&usg=AFQjCNER1QfY7HNvpQj618p_kGrXXjgdYw">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D7519518&usg=AFQjCNHjgrODY8yY4ElDpG7LPINP1A-pKw">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D7519518B2%26KC%3DB2%26FT%3DD&usg=AFQjCNG1qrJnChfrS_MaDTXzohpm6nMTlw">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT71671293" lang="EN" load-source="patent-office">Method for assembling the finite element discretization of arbitrary weak equations, involving local or non-local multiphysics couplings</invention-title></span><br><span class="patent-number">US 7519518 B2</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA53225937" lang="EN" load-source="patent-office"> <div num="p-0001" class="abstract">Disclosed are techniques for representing and modeling one or more systems in which each system corresponds to an application mode. This may be done for one or more geometries using local and/or non-local couplings. For each application mode, physical quantities are modeled and may be defined using a graphical user interface. Physical properties may be used to model the physical quantities of each system. The physical properties may be defined in terms of numerical values or constants, and mathematical expressions that may include numerical values, space coordinates, time coordinates, and actual physical quantities. Physical quantities and any associated variables may apply to some or all of a geometric domain, and may also be disabled in other parts of a geometrical domain. Partial differential equations describe the physical quantities. One or more application modes may be combined using an automated technique into a combined system of partial differential equations as a multiphysics model. A portion of the physical quantities and variables associated with the combined system may be selectively solved for. The partial differential equations may be displayed and may in turn solve for the system of partial differential equations in accordance with a general form or a coefficient form. An automated technique provides for automatic derivation of the combined partial differential equations and boundary conditions. This technique automatically merges the equations from a plurality of application modes, and in some instances, performs symbolic differentiation of the equations, producing a single system of partial differential equations. A subset of physical quantities and associated variables not solved for may be used as initial values to the system of partial differential equations.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(67)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00000.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00000.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00001.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00001.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00002.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00002.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00003.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00003.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00004.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00004.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00005.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00005.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00006.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00006.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00007.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00007.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00008.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00008.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00009.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00009.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00010.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00010.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00011.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00011.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00012.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00012.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00013.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00013.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00014.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00014.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00015.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00015.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00016.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00016.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00017.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00017.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00018.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00018.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00019.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00019.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00020.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00020.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00021.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00021.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00022.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00022.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00023.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00023.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00024.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00024.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00025.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00025.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00026.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00026.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00027.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00027.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00028.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00028.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00029.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00029.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00030.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00030.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00031.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00031.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00032.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00032.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00033.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00033.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00034.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00034.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00035.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00035.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00036.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00036.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00037.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00037.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00038.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00038.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00039.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00039.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00040.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00040.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00041.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00041.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00042.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00042.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00043.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00043.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00044.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00044.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00045.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00045.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00046.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00046.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00047.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00047.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00048.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00048.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00049.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00049.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00050.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00050.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00051.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00051.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00052.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00052.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00053.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00053.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00054.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00054.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00055.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00055.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00056.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00056.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00057.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00057.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00058.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00058.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00059.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00059.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00060.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00060.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00061.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00061.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00062.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00062.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00063.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00063.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00064.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00064.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00065.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00065.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US7519518B2/US07519518-20090414-D00066.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US7519518B2/US07519518-20090414-D00066.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(44)</span></span></div><div class="patent-text"><div mxw-id="PCLM13126544" lang="EN" load-source="patent-office" class="claims">
  <div class="claim"> <div id="CLM-00001" num="00001" class="claim">
    <div class="claim-text">1. An apparatus for producing a model of a combined system having physical quantities by representing physical quantities of the combined system in terms of partial differential equations, the apparatus comprising:
<div class="claim-text">means for selecting an application mode modeling in up to three space dimensions the physical quantities for one or more of a plurality of systems, wherein the plurality of systems comprise at least one of a structural system, a fluids system, and an electromagnetic system;</div>
<div class="claim-text">means for receiving an input of one or more physical properties for each of the application modes;</div>
<div class="claim-text">means for determining a representation of a set of one or more partial differential equations for each application mode corresponding to one of the plurality of systems using at least one non-local coupling and the one or more input physical properties, the at least one non-local coupling defining a value from a first portion of a first domain to another portion of a second domain; and</div>
<div class="claim-text">means for producing the model of the combined system by forming a combined set of one or more partial differential equations using the determined sets of partial differential equations associated with the plurality of systems, whereby the model represents a mathematical expression of the physical quantities of the combined physical system.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00002" num="00002" class="claim">
    <div class="claim-text">2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at least one of the determined sets of partial differential equation uses at least one local coupling.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00003" num="00003" class="claim">
    <div class="claim-text">3. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first and second domain are the same.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00004" num="00004" class="claim">
    <div class="claim-text">4. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first and second domain are different.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00005" num="00005" class="claim">
    <div class="claim-text">5. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling wherein a value of a quantity on a boundary of the first domain are referenced in defining parallel lines extending into the domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00006" num="00006" class="claim">
    <div class="claim-text">6. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling in which a boundary condition associated with the first domain is defined using a value of an integral over a portion of one of the first domain and the second domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00007" num="00007" class="claim">
    <div class="claim-text">7. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling using at least one of a mapped variable and an integrated variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00008" num="00008" class="claim">
    <div class="claim-text">8. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<div class="claim-text">means for defining the local coupling using at least one of a basic variable, an expression variable, and a glued variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00009" num="00009" class="claim">
    <div class="claim-text">9. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<div class="claim-text">means for defining the non-local coupling variable using at least one of an extrusion variable, a projection variable and a scalar variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00010" num="00010" class="claim">
    <div class="claim-text">10. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">means for determining a stiffness matrix by determining a Jacobian of each variable in accordance with each type of variable wherein the combined set of partial differential equations is in weak form, the stiffness matrix being a Jacobian matrix formed from a residual vector with respect to a number of degrees of freedom; and</div>
<div class="claim-text">means for determining the residual vector by determining a Jacobian of each variable in accordance with each type of variable wherein the combined set of partial differential equations is in weak form.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00011" num="00011" class="claim">
    <div class="claim-text">11. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:
<div class="claim-text">means for converting the combined set of partial differential equations from general form to weak form.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00012" num="00012" class="claim">
    <div class="claim-text">12. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the means for determining the stiffness matrix further comprises:
<div class="claim-text">means for determining values of a Jacobian of variables in accordance with points included in a quadrature formula and with other points in accordance with coupling variables.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00013" num="00013" class="claim">
    <div class="claim-text">13. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the means for determining the residual vector further comprises means for determining values of variables and a Jacobian of the variables for node points and for other points in accordance with coupling variables.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00014" num="00014" class="claim">
    <div class="claim-text">14. The apparatus as set forth in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the means for receiving an input further comprises means for receiving an input of one or more boundary conditions for each of the application modes, wherein the means for determining a representation of a set of one or more partial equations for each application mode corresponding to one of the plurality of systems also uses the one or more input boundary conditions.</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00015" num="00015" class="claim">
    <div class="claim-text">15. A computer system for producing a model of a combined system having physical quantities by representing physical quantities of the combined system in terms of partial differential equations, the model to be displayed on a display, comprising:
<div class="claim-text">means for selecting an application mode modeling physical quantities for one or more of a plurality of systems;</div>
<div class="claim-text">means for receiving an input of one or more physical properties for each of the selected application modes;</div>
<div class="claim-text">means for determining a representation of a set of one or more partial differential equations for each application mode corresponding to one of the plurality of systems using at least one non-local coupling and the one or more input physical properties, the at least one non-local coupling defining a value from a first portion of a first domain to another portion of a second domain;</div>
<div class="claim-text">means for producing the model of the combined system by forming a combined set of one or more partial differential equations using the determined sets of partial differential equations associated with the plurality of systems, whereby the model represents a mathematical expression of the physical quantities of the combined physical system;</div>
<div class="claim-text">means for storing the model in a computer readable memory or in a computer readable data storage system connected to the computer system; and</div>
<div class="claim-text">means for outputting the model to a display connected to the computer system.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00016" num="00016" class="claim">
    <div class="claim-text">16. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein at least one of the determined sets of partial differential equation uses at least one local coupling.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00017" num="00017" class="claim">
    <div class="claim-text">17. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the first and second domain are the same.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00018" num="00018" class="claim">
    <div class="claim-text">18. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the first and second domain are different.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00019" num="00019" class="claim">
    <div class="claim-text">19. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling wherein a value of a quantity on a boundary of the first domain is referenced in defining parallel lines extending into the second domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00020" num="00020" class="claim">
    <div class="claim-text">20. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling in which a boundary condition associated with the first domain is defined using a value of an integral over a portion of one of the first domain and the second domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00021" num="00021" class="claim">
    <div class="claim-text">21. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling using at least one of a mapped variable and an integrated variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00022" num="00022" class="claim">
    <div class="claim-text">22. The computer system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, further comprising:
<div class="claim-text">means for defining a local coupling using at least one of a basic variable, an expression variable, and a glued variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00023" num="00023" class="claim">
    <div class="claim-text">23. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">means for defining a non-local coupling using at least one of an extrusion variable, a projection variable, and a scalar variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00024" num="00024" class="claim">
    <div class="claim-text">24. The computer system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<div class="claim-text">means for determining a stiffness matrix by determining a Jacobian of each variable in accordance with each type of variable wherein the combined set of partial differential equations is in weak form, the stiffness matrix being a Jacobian matrix formed from a residual vector with respect to a number of degrees of freedom; and</div>
<div class="claim-text">means for determining the residual vector by determining a Jacobian of each variable in accordance with each type of variable wherein the combined set of partial differential equations is in weak form.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00025" num="00025" class="claim">
    <div class="claim-text">25. The computer system of <claim-ref idref="CLM-00024">claim 24</claim-ref>, further comprising:
<div class="claim-text">means for converting the combined set of partial differential equations from general form to weak form.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00026" num="00026" class="claim">
    <div class="claim-text">26. The computer system of <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the means for determining the stiffness matrix further comprises:
<div class="claim-text">means for determining values of a Jacobian of variables in accordance with points included in a quadrature formula and with other points in accordance with coupling variables.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00027" num="00027" class="claim">
    <div class="claim-text">27. The computer system of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the determining the residual vector further comprises:
<div class="claim-text">means for determining values of variables and a Jacobian of the variables for node points and for other points in accordance with coupling variables.</div>
</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00028" num="00028" class="claim">
    <div class="claim-text">28. An apparatus for producing a model of a combined system having physical quantities by representing physical quantities of the combined system in terms of partial differential equations, the apparatus comprising:
<div class="claim-text">a computer comprising a processor, a user input device, a display device, and a memory device, the memory device containing executable instructions for producing a model of a combined system having physical quantities by representing physical quantities of the combined system in terms of partial differential equations, the executable instructions causing the processor to perform, upon execution, acts comprising
<div class="claim-text">selecting an application mode modeling in up to three space dimensions the physical quantities for one or more of a plurality of systems, wherein the systems include at least one of a structural system, a fluids system, and an electromagnetic system;</div>
<div class="claim-text">receiving an input of one or more physical properties for each of the application modes;</div>
<div class="claim-text">determining a representation of a set of one or more partial differential equations for each application mode corresponding to one of the plurality of systems using at least one non-local coupling and the one or more input physical properties, the at least one non-local coupling defining a value from a first portion of a first domain to another portion of a second domain;</div>
<div class="claim-text">producing the model of the combined system by forming a combined set of one or more partial differential equations using the determined sets of partial differential equations associated with the plurality of systems, whereby the model represents a mathematical expression of the physical quantities of the combined physical system; and</div>
<div class="claim-text">outputting the model to the display device.</div>
</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00029" num="00029" class="claim">
    <div class="claim-text">29. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the executable instructions comprise a constraint for the producing of the model of the combined system, the constraint requiring that at least one of the determined sets of partial differential equation uses at least one local coupling.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00030" num="00030" class="claim">
    <div class="claim-text">30. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the executable instructions comprise a constraint for the producing of the model of the combined system, the constraint requiring that the first and second domain are the same.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00031" num="00031" class="claim">
    <div class="claim-text">31. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the executable instructions comprise a constraint for the producing of the model of the combined system, the constraint requiring that the first and second domain are different.</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00032" num="00032" class="claim">
    <div class="claim-text">32. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, further comprising:
<div class="claim-text">a definition system stored in the memory device or in another memory device in communication with the computer, the definition system comprising at least one of executable instructions and data defining a non-local coupling, wherein a value of a quantity on a boundary of the first domain is referenced in defining parallel lines extending into the second domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00033" num="00033" class="claim">
    <div class="claim-text">33. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, further comprising:
<div class="claim-text">a definition system stored in the memory device or in another memory device in communication with the computer, the definition system comprising at least one of executable instructions and data defining a non-local coupling in which a boundary condition associated with the first domain is defined using a value of an integral over a portion of one of the first domain or the second domain.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00034" num="00034" class="claim">
    <div class="claim-text">34. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, further comprising:
<div class="claim-text">a definition system stored in the memory device or in another memory device in communication with the computer, the definition system comprising at least one of executable instructions and data defining a non-local coupling using at least one of a mapped variable and an integrated variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00035" num="00035" class="claim">
    <div class="claim-text">35. The apparatus of <claim-ref idref="CLM-00029">claim 29</claim-ref>, further comprising:
<div class="claim-text">a definition system stored in the memory device or in another memory device in communication with the computer, the definition system comprising at least one of executable instructions and data defining a local coupling using at least one of a basic variable, an expression variable, and a glued variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00036" num="00036" class="claim">
    <div class="claim-text">36. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, further comprising:
<div class="claim-text">a definition system stored in the memory device or in another memory device in communication with the computer, the definition system comprising at least one of executable instructions and data defining a non-local coupling using at least one of an extrusion variable, a projection variable, and a scalar variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00037" num="00037" class="claim">
    <div class="claim-text">37. The apparatus of <claim-ref idref="CLM-00036">claim 36</claim-ref>, the memory device containing executable instructions for producing the model of the combined system, the executable instructions causing the processor to perform, upon execution, acts comprising:
<div class="claim-text">determining a stiffness matrix by performing acts comprising determining a Jacobian of each variable in accordance with each type of variable.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00038" num="00038" class="claim">
    <div class="claim-text">38. The apparatus of <claim-ref idref="CLM-00037">claim 37</claim-ref>, the memory device containing executable instructions for producing the model of the combined system, the executable instructions causing the processor to perform, upon execution, acts further comprising:
<div class="claim-text">converting the combined set of partial differential equations from general form to weak form.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00039" num="00039" class="claim">
    <div class="claim-text">39. The apparatus of <claim-ref idref="CLM-00038">claim 38</claim-ref>, the memory device containing executable instructions for producing the model of the combined system, the executable instructions causing the processor to perform, upon execution, acts further comprising:
<div class="claim-text">determining values of a Jacobian of variables in accordance with points included in a quadrature formula and with other points in accordance with coupling variables.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00040" num="00040" class="claim">
    <div class="claim-text">40. The apparatus of <claim-ref idref="CLM-00039">claim 39</claim-ref>, the memory device containing executable instructions for producing the model of the combined system, the executable instructions causing the processor to perform, upon execution, acts further comprising:
<div class="claim-text">determining values of variables and a Jacobian of the variables for node points and for other points in accordance with coupling variables.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00041" num="00041" class="claim">
    <div class="claim-text">41. The apparatus of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the memory device containing executable instructions for producing the model of the combined system, the executable instructions causing the processor to perform, upon execution, acts further comprising:
<div class="claim-text">storing the model in the memory device or in a computer readable data storage system.</div>
</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00042" num="00042" class="claim">
    <div class="claim-text">42. A method executed in a computer system with at least one processor for producing a model of a combined physical system and a solution to the model, the method comprising:
<div class="claim-text">representing a combined physical system by a geometry described by a mesh and a set of physical properties, the mesh including a plurality of elements, each of the elements being characterized by a shape;</div>
<div class="claim-text">providing a plurality of application modes;</div>
<div class="claim-text">selecting at least a first application mode from the plurality of application modes;</div>
<div class="claim-text">using the processor to generate a plurality of partial differential equations based on the first application mode, each of the partial differential equations representing a behavior of at least one physical quantity of the model in response to the set of physical properties;</div>
<div class="claim-text">non-locally coupling one or more of the plurality of partial differential equations, the step of non-locally coupling including providing a value from a portion of a first domain to another portion of a second domain;</div>
<div class="claim-text">using the processor and the plurality of partial differential equations to determine a solution comprising numerical values for the physical quantities on the node points in the mesh; and</div>
<div class="claim-text">storing in a computer readable memory or in a computer readable data storage system the solution to the model.</div>
</div>
  </div>
  </div> <div class="claim-dependent"> <div id="CLM-00043" num="00043" class="claim">
    <div class="claim-text">43. A method executed in a computer system with at least one processor for producing a model of a combined physical system and a solution to the model in accord with <claim-ref idref="CLM-00042">claim 42</claim-ref>, the method comprising:
<div class="claim-text">producing a physical component corresponding to the mesh and the set of physical properties.</div>
</div>
  </div>
  </div> <div class="claim"> <div id="CLM-00044" num="00044" class="claim">
    <div class="claim-text">44. An apparatus for producing a model of a combined system with physical quantities by representing said physical quantities of said combined system by partial differential equations, the apparatus comprising:
<div class="claim-text">a computer comprising a processor, a user input device, a display device, and a memory device, the memory device containing executable instructions for producing a model of a combined system having physical quantities by representing physical quantities of the combined system in terms of partial differential equations, the executable instructions causing the processor to perform, upon execution, acts comprising
<div class="claim-text">representing a combined physical system by a geometry described by a mesh and a set of physical properties, the mesh including a plurality of elements, each of the elements being characterized by a shape;</div>
<div class="claim-text">providing a plurality of application modes;</div>
<div class="claim-text">selecting at least a first application mode from the plurality of application modes;</div>
<div class="claim-text">using the processor to generate a plurality of partial differential equations based on the first application mode, each of the partial differential equations representing a behavior of at least one physical quantity of the model in response to the set of physical properties;</div>
<div class="claim-text">non-locally coupling one or more of the plurality of partial differential equations, the step of non-locally coupling including providing a value from a portion of a first domain to another portion of a second domain;</div>
<div class="claim-text">using the processor and the plurality of partial differential equations to determine a solution comprising numerical values for the physical quantities on the node points in the mesh; and</div>
<div class="claim-text">storing in a computer readable memory or in a computer readable data storage system the solution to the model. </div>
</div>
</div>
  </div>
</div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES18513582" lang="EN" load-source="patent-office" class="description">
<heading>CROSS REFERENCE TO RELATED APPLICATIONS</heading> <p num="p-0002">This application claims priority to U.S. Provisional Patent Application Ser. No. 60/253,154, filed on Nov. 27, 2000, which is herein incorporated by reference in its entirety, and is a continuation in part of U.S. patent application Ser. No. 09/675,778, filed Sep. 29, 2000 (pending), which is based on U.S. Provisional Patent Application No. 60/222,394, filed on Aug. 2, 2000, which are both herein incorporated by reference in their entirety.</p>
<heading>BACKGROUND</heading> <p num="p-0003">1. Technical Field</p>
  <p num="p-0004">This application relates to computer systems, and more particularly to techniques for modeling, simulation, and problem solving using a computer system.</p>
  <p num="p-0005">2. Description of Related Art</p>
  <p num="p-0006">Computer systems may be used for performing any one of a variety of different tasks. One way in which computer systems may be utilized is by executing one or more computer programs that include instructions which, when executed, perform one or more tasks. In particular, a computer system may execute machine instructions, as may be generated, for example, in connection with translation of source code to machine executable code, to perform modeling, simulation, and problem solving tasks. One technique which may be used in connection with modeling a particular system is to represent various physical aspects of the system in terms of equations or other type of quantifications. In turn, these equations may be solved using a computer system for one or more variables.</p>
  <p num="p-0007">Use of the computer in modeling may provide many advantages in accordance with the functionality included in a particular modeling or simulation package. At times, a user may wish to combine one or more systems that are each represented by different models.</p>
  <p num="p-0008">It may be desirous to provide an automatic technique for combining these one or more systems such that the combination of the systems together maybe modeled and accordingly represented in terms of combined physical quantities and equations.</p>
  <p num="p-0009">It may also be desirous and advantageous for this automatic technique to provide for selectively solving for one or more variables associated with either the combined system, or with variables included in one or more of the individual systems.</p>
  <p num="p-0010">Additionally, it may be useful and advantageous to provide for different representations of equations that model the physical quantities of a particular system. The different types of representations of the equations may allow for different techniques to be utilized in connection with solving for the system of equations in a singular or combined system. It may be advantageous, for example, in that different forms of equations may proved to be more expedient and efficient for such types of equations such as linear or non-linear equations.</p>
  <heading>SUMMARY OF THE INVENTION</heading> <p num="p-0011">In accordance with one aspect of the present invention, a method is set forth that computes the finite element discretization. The computation of the finite element discretization includes computing a stiffness matrix, residual vector, constraint matrix, and constraint residual vector for weak equations and constraints of a multiphysics problem that include local and non-local couplings.</p>
  <p num="p-0012">In accordance with another aspect of the present invention, the method is used for assembling the finite element discretization of arbitrary weak equations, involving local and non-local couplings. The weak equations are defined in terms of basic variables, auxiliary variables, glued variables, mapped variables, and integrated variables. The basic variables, auxiliary variables, and glued variables represent local multiphysics couplings, and the mapped variables and the integrated variables represent non-local multiphysics couplings.</p>
  <p num="p-0013">Additionally, the method of the present invention includes a plurality of sub-methods that are employed to evaluate each variable type. The evaluation can be performed on both structured and unstructured data, and the method of the present invention can switch between these representations during recursive expression evaluation.</p>
  <p num="p-0014">Furthermore, each variable type can include sub-methods that are employed to compute the Jacobian of a variable with respect to the degrees of freedom. In one aspect, the method includes a format to represent the Jacobian of a variable with respect to the degrees of freedoms. The computing of the Jacobian can be performed on both structured and unstructured data, and the method can switch between these representations during the recursive expression evaluation of the Jacobian computation.</p>
  <p num="p-0015">In another aspect, a method is set forth that computes the residual vector in the finite element discretization of the weak equation of the multiphysics problem. The method uses the sub-method for the evaluation of a variable and the sub-method for the computation of the Jacobian of a variable.</p>
  <p num="p-0016">In another aspect, a method is set forth that computes the stiffness matrix in the finite element discretization of the weak equation of the multiphysics problem. The method uses the sub-method for the computation of the Jacobian of a variable.</p>
  <p num="p-0017">In another aspect, methods are set forth that compute the constraint matrix and the constraint residual vector in the finite element discretization of the constraints in a multiphysics problem. The methods use the sub-methods for the computation of the values and the Jacobian of a variable.</p>
<description-of-drawings> <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading> <p num="p-0018">Features and advantages of the present invention will become more apparent from the following detailed description of exemplary embodiments thereof taken in conjunction with the accompanying drawings in which:</p>
    <p num="p-0019"> <figref idrefs="DRAWINGS">FIG. 1</figref> is an example of an embodiment of a computer system;</p>
    <p num="p-0020"> <figref idrefs="DRAWINGS">FIG. 2</figref> is an example of an embodiment of software that may reside and be executed in one of the hosts of <figref idrefs="DRAWINGS">FIG. 1</figref>;</p>
    <p num="p-0021"> <figref idrefs="DRAWINGS">FIG. 3</figref> is an example of an embodiment of a graphical user interface for selecting the application modes;</p>
    <p num="p-0022"> <figref idrefs="DRAWINGS">FIG. 4</figref> is an example of an embodiment of a graphical user interface for selecting the physical properties on subdomains for a heat transfer application mode;</p>
    <p num="p-0023"> <figref idrefs="DRAWINGS">FIG. 5</figref> is an example of an embodiment of a graphical user interface for specifying physical properties on boundaries for a heat transfer application mode;</p>
    <p num="p-0024"> <figref idrefs="DRAWINGS">FIG. 6</figref> is an example of an embodiment of a graphical user interface for modifying the partial differential equations in coefficient view;</p>
    <p num="p-0025"> <figref idrefs="DRAWINGS">FIG. 6A</figref> is an example of an embodiment of a data structure that may be used in connection with data for each application mode selected and also in connection with storing data for the combined partial differential equation system of application modes;</p>
    <p num="p-0026"> <figref idrefs="DRAWINGS">FIG. 7</figref> is an example of an embodiment of a graphical user interface for specifying the ability to solve for any subset of the physical quantities;</p>
    <p num="p-0027"> <figref idrefs="DRAWINGS">FIG. 8</figref> is an example of an embodiment of a coefficient form partial differential equation format;</p>
    <p num="p-0028"> <figref idrefs="DRAWINGS">FIG. 9</figref> is an example of a general form partial differential equation format;</p>
    <p num="p-0029"> <figref idrefs="DRAWINGS">FIG. 10</figref> is an example of formulae that may be used in an embodiment in solving for non-linear systems of equations in connection with performing substitutions for linearization;</p>
    <p num="p-0030"> <figref idrefs="DRAWINGS">FIG. 11</figref> is an example of formulae that may be used when performing a conversion from coefficient to general form;</p>
    <p num="p-0031"> <figref idrefs="DRAWINGS">FIGS. 12 and 13</figref> are example of formulae that may be used in solving for equations in coefficient and general form;</p>
    <p num="p-0032"> <figref idrefs="DRAWINGS">FIG. 14</figref> is an example of formulae that may be used when approximating the solution with a function from a finite-dimensional function space;</p>
    <p num="p-0033"> <figref idrefs="DRAWINGS">FIGS. 15 and 16</figref> are examples of formulae that may be used in connection with solving systems of equations in coefficient form;</p>
    <p num="p-0034"> <figref idrefs="DRAWINGS">FIG. 17</figref> is an example of an embodiment of formulae that may be used in connection with solving equations in the general form;</p>
    <p num="p-0035"> <figref idrefs="DRAWINGS">FIG. 18</figref> is an example of the representation of finite element discretization in accordance with conditions of formulae of <figref idrefs="DRAWINGS">FIGS. 15 and 16</figref>;</p>
    <p num="p-0036"> <figref idrefs="DRAWINGS">FIG. 19</figref> is an example of formulae that may be used in connection with solving equations in the coefficient form;</p>
    <p num="p-0037"> <figref idrefs="DRAWINGS">FIG. 20</figref> is an example of formulae that may be used in connection with solving equations in the general form;</p>
    <p num="p-0038"> <figref idrefs="DRAWINGS">FIG. 21</figref> is an example of an iteration formula that may be used in connection with solving equations in general form;</p>
    <p num="p-0039"> <figref idrefs="DRAWINGS">FIG. 22</figref> and <figref idrefs="DRAWINGS">FIG. 23</figref> form a flowchart of method steps of one embodiment for specifying one or more systems of partial differential equations, representing them in a combined form, and solving a combined system of partial differential equations;</p>
    <p num="p-0040"> <figref idrefs="DRAWINGS">FIG. 24</figref> is an example of a representation of a class hierarchy that may be included in an embodiment in connection with predefined and user defined application modes;</p>
    <p num="p-0041"> <figref idrefs="DRAWINGS">FIG. 25</figref> is an example of one dimensional predefined application modes that may be included in an embodiment;</p>
    <p num="p-0042"> <figref idrefs="DRAWINGS">FIG. 26</figref> is an example of two dimensional predefined application modes that may be included in an embodiment;</p>
    <p num="p-0043"> <figref idrefs="DRAWINGS">FIG. 27</figref> is an example of properties of an application mode;</p>
    <p num="p-0044"> <figref idrefs="DRAWINGS">FIG. 28</figref> is an example of a class constructor that may be used to create a user defined application or application mode;</p>
    <p num="p-0045"> <figref idrefs="DRAWINGS">FIG. 29</figref> is an example of methods that may be included in an embodiment for an object class;</p>
    <p num="p-0046"> <figref idrefs="DRAWINGS">FIG. 30</figref> is an example of a GUI that may be displayed in connection with a user-defined application;</p>
    <p num="p-0047"> <figref idrefs="DRAWINGS">FIG. 31</figref> is an example of formulae that may be used in connection with the user-defined application of <figref idrefs="DRAWINGS">FIG. 30</figref>;</p>
    <p num="p-0048"> <figref idrefs="DRAWINGS">FIG. 32</figref> is an example of a constructor used in creating the user-defined application of <figref idrefs="DRAWINGS">FIG. 30</figref>;</p>
    <p num="p-0049"> <figref idrefs="DRAWINGS">FIG. 33</figref> and <figref idrefs="DRAWINGS">FIG. 34</figref> are examples of fields that may be included in a user-defined portion of a data structure used in connection with the user-defined application of <figref idrefs="DRAWINGS">FIG. 30</figref>; and</p>
    <p num="p-0050"> <figref idrefs="DRAWINGS">FIG. 35</figref> includes examples of fields that may be included in a data structure used to define a geometric object used in connection with the user-defined application mode of <figref idrefs="DRAWINGS">FIG. 30</figref>;</p>
    <p num="p-0051"> <figref idrefs="DRAWINGS">FIG. 36</figref> is an example of another embodiment of a user interface that may be used in connection with specifying local and non-local couplings of multiphysics systems;</p>
    <p num="p-0052"> <figref idrefs="DRAWINGS">FIG. 37</figref> is an example of a Boundary settings dialog box;</p>
    <p num="p-0053"> <figref idrefs="DRAWINGS">FIG. 38</figref> is an example of a Subdomain Settings dialog box;</p>
    <p num="p-0054"> <figref idrefs="DRAWINGS">FIG. 39</figref> is another example of a Subdomain Settings dialog box;</p>
    <p num="p-0055"> <figref idrefs="DRAWINGS">FIG. 40</figref> is an example of a representation of the data structure that may be included in an embodiment in connection with storing data in connection with the PDEs selected and combined;</p>
    <p num="p-0056"> <figref idrefs="DRAWINGS">FIG. 41</figref> is an example of a weak formulation;</p>
    <p num="p-0057"> <figref idrefs="DRAWINGS">FIG. 42</figref> is an example of a conversion from general form to weak form;</p>
    <p num="p-0058"> <figref idrefs="DRAWINGS">FIG. 43</figref> is an example of a Point Settings dialog box;</p>
    <p num="p-0059"> <figref idrefs="DRAWINGS">FIG. 44</figref> is an example of an Edge Settings dialog box;</p>
    <p num="p-0060"> <figref idrefs="DRAWINGS">FIGS. 45A-C</figref> shows various pages of a Coupling Variable Settings dialog box, respectively showing a Variables page, Source page and Destination page;</p>
    <p num="p-0061"> <figref idrefs="DRAWINGS">FIGS. 46 and 47</figref> respectively shows examples of a Variables page and a Definition page of an Expression Variable Settings dialog box;</p>
    <p num="p-0062"> <figref idrefs="DRAWINGS">FIGS. 48-50</figref> are flowcharts of processing steps in one embodiment for forming and solving a system of partial differential equations of a combined system;</p>
    <p num="p-0063"> <figref idrefs="DRAWINGS">FIG. 51</figref> is a screen shot of a graphical user interface for a coupling variables settings dialog box;</p>
    <p num="p-0064"> <figref idrefs="DRAWINGS">FIG. 52</figref> is a graph of an example of Poisson's equation on a single rectangular domain;</p>
    <p num="p-0065"> <figref idrefs="DRAWINGS">FIGS. 53A-53B</figref> are graphs of examples of scalar couplings;</p>
    <p num="p-0066"> <figref idrefs="DRAWINGS">FIG. 54</figref> is a graph of another example of Poisson's equation on a single rectangular domain;</p>
    <p num="p-0067"> <figref idrefs="DRAWINGS">FIGS. 55A-55C</figref> are graphs of examples of extrusion couplings;</p>
    <p num="p-0068"> <figref idrefs="DRAWINGS">FIGS. 56A-56C</figref> are graphs of examples of projection couplings;</p>
    <p num="p-0069"> <figref idrefs="DRAWINGS">FIG. 57</figref> is a diagram of a packed bed in a reactor;</p>
    <p num="p-0070"> <figref idrefs="DRAWINGS">FIG. 58</figref> is another screen shot of a graphical user interface for the coupling variables settings dialog box;</p>
    <p num="p-0071"> <figref idrefs="DRAWINGS">FIG. 59</figref> is a screen shot of a graphical user interface for a concentration plot;</p>
    <p num="p-0072"> <figref idrefs="DRAWINGS">FIG. 60</figref> is a graph of a three-dimensional plot;</p>
    <p num="p-0073"> <figref idrefs="DRAWINGS">FIG. 61</figref> is a perspective view of a magnetic brake;</p>
    <p num="p-0074"> <figref idrefs="DRAWINGS">FIG. 62</figref> is a screen shot of a graphical user interface for a draw mode;</p>
    <p num="p-0075"> <figref idrefs="DRAWINGS">FIG. 63</figref> is a screen shot of a graphical user interface for an expressions variable settings;</p>
    <p num="p-0076"> <figref idrefs="DRAWINGS">FIG. 64</figref> is a screen shot of a graphical user interface for an expressions variable settings;</p>
    <p num="p-0077"> <figref idrefs="DRAWINGS">FIG. 65</figref> is a screen shot of a graphical user interface for mesh parameters;</p>
    <p num="p-0078"> <figref idrefs="DRAWINGS">FIG. 66</figref> is a screen shot of a graphical user interface for a solution to the entered parameters in <figref idrefs="DRAWINGS">FIG. 65</figref>;</p>
    <p num="p-0079"> <figref idrefs="DRAWINGS">FIGS. 67-70</figref> are screen shots of graphical user interfaces for the coupling variables settings;</p>
    <p num="p-0080"> <figref idrefs="DRAWINGS">FIG. 71</figref> is a screen shot of a graphical user interface for cross-section plot parameters; and</p>
    <p num="p-0081"> <figref idrefs="DRAWINGS">FIGS. 72A-72B</figref> are graphs of plots for  and d/d.</p>
  </description-of-drawings> <heading>DESCRIPTION OF PREFERRED EMBODIMENT(S)</heading> <p num="p-0082">Referring now to <figref idrefs="DRAWINGS">FIG. 1</figref>, shown is an example of an embodiment of a computer system according to the present invention. The computer system <b>10</b> includes a data storage system <b>12</b> connected to host systems <b>14</b> <i>a</i>-<b>14</b> <i>n </i>through communication medium <b>18</b>. In this embodiment of the computer system <b>10</b>, the N hosts <b>14</b> <i>a</i>-<b>14</b> <i>n </i>may access the data storage system <b>12</b>, for example, in performing input/output (I/O) operations. The communication medium <b>18</b> may be any one of a variety of networks or other type of communication connections as known to those skilled in the art. For example, the communication medium <b>18</b> may be the Internet, an intranet, or other network connection by which the host systems <b>14</b> <i>a</i>-<b>14</b> <i>n </i>may access and communicate with the data storage system <b>12</b>, and may also communicate with others included in the computer system <b>10</b>.</p>
  <p num="p-0083">Each of the host systems <b>14</b> <i>a</i>-<b>14</b> <i>n </i>and the data storage system <b>12</b> included in the computer system <b>10</b> may be connected to the communication medium <b>18</b> by any one of a variety of connections as may be provided and supported in accordance with the type of communication medium <b>18</b>. The processors included in the host computer systems <b>14</b> <i>a</i>-<b>14</b> <i>n </i>and the data manager system <b>16</b> may be any one of a variety of commercially available single or multi-processor system, such as an Intel-based processor, IBM mainframe or other type of commercially available processor able to support incoming traffic in accordance with each particular embodiment and application.</p>
  <p num="p-0084">It should be noted that the particulars of the hardware and software included in each of the host systems <b>14</b> <i>a</i>-<b>14</b> <i>n</i>, as well as those components that may be included in the data storage system <b>12</b> are described herein in more detail, and may vary with each particular embodiment. Each of the host computers <b>14</b> <i>a</i>-<b>14</b> <i>n</i>, as well as the data storage system <b>12</b>, may all be located at the same physical site, or, alternatively, may also be located in different physical locations. Examples of the communication medium that may be used to provide the different types of connections between the host computer systems, the data manager system, and the data storage system of the computer system <b>10</b> may use a variety of different communication protocols such as SCSI, ESCON, or Fiber Channel. Some or all of the connections by which the hosts, data manager system <b>16</b> and data storage system <b>12</b> may be connected to the communication medium <b>18</b> may pass through other communication devices, such as a Connectrix or other switching equipment that may exist such as a phone line, a repeater, a multiplexer or even a satellite.</p>
  <p num="p-0085">Each of the host computer systems may perform different types of data operations, such as storing and retrieving data files used in connection with an application executing on one or more of the host computer systems. For example, a computer program may be executing on the host computer <b>14</b> <i>a </i>and store and retrieve data from the data storage system <b>12</b>. The data storage system <b>12</b> may include any number of a variety of different data storage devices, such as disks, tapes, and the like in accordance with each implementation. As will be described in following paragraphs, software may reside and be executing on any one of the host computer systems <b>14</b> <i>a</i>-<b>14</b> <i>n</i>. Data may be stored locally on the host system executing software, as well as remotely in the data storage system <b>12</b> or on another host computer system. Similarly, depending on the configuration of each computer system <b>10</b>, software as described herein may be stored and executed on one of the host computer systems and accessed remotely by a user on another computer system using local data. A variety of different system configurations and variations are possible then as will be described in connection with the embodiment of the computer system <b>10</b> of <figref idrefs="DRAWINGS">FIG. 1</figref> and should not be construed as a limitation of the techniques described elsewhere herein.</p>
  <p num="p-0086">Referring now to <figref idrefs="DRAWINGS">FIG. 2</figref>, shown is an example of an embodiment of the software <b>19</b> that may reside in one of the host computer systems such as whose computer system <b>14</b> <i>a</i>-<b>14</b> <i>n</i>. Included in the software of computer system <b>14</b> <i>a </i>of <figref idrefs="DRAWINGS">FIG. 2</figref> is a User Interface module <b>20</b> that communicates with the Modeling and Simulation module <b>22</b>. The software further includes a Data Storage and Retrieval module <b>24</b> which communicates with the Modeling and Simulation module <b>22</b> for performing tasks in connection with data storage and retrieval. The Data Storage and Retrieval module <b>24</b> may retrieve data files, for example, that may be stored in Libraries <b>26</b> as well as perform data operations in connection with User Data Files <b>28</b>.</p>
  <p num="p-0087">It should be noted that other embodiments may include other software components other than what is described and functionally represented in the software modules <b>19</b> of <figref idrefs="DRAWINGS">FIG. 2</figref>. In the embodiment shown in <figref idrefs="DRAWINGS">FIG. 2</figref>, both the Libraries and the User Data Files are shown as being stored locally within the host computer system. It should also be noted that the Libraries and/or User Data Files, as well as copies of these, may be stored in another host computer system as well as in the Data Storage System <b>12</b> of the computer system <b>10</b>. However, for simplicity and explanation in paragraphs that follow, it is assumed that the software may reside on a single host computer system such as <b>14</b> <i>a </i>with additional backups, for example, of the User Data Files and Libraries, in the Data Storage System <b>12</b>.</p>
  <p num="p-0088">In one embodiment, portions of the software <b>19</b>, such as the user interface <b>20</b>, the Modeling and Simulation module <b>22</b>, Data Storage and Retrieval module, and Libraries <b>26</b> may be included in combination in a commercially available software package. These components may operate on one of the host systems <b>14</b> <i>a</i>-<b>14</b> <i>n </i>running Matlab V5.0, as well as one of Windows 95 or 98, Windows NT, Unix, or Linux operating system. One embodiment of the software <b>19</b> may be implemented using MATLAB5.3 running on one of Windows 95, Windows NT, Unix or Linux operating systems.</p>
  <p num="p-0089">The User Interface module <b>20</b> as will be described in more paragraphs that follow, may display user interface screens in connection with obtaining data used in performing modeling, simulation, and/or other problem solving for one or more systems under consideration. These one or more systems may be modeled and/or simulated by the Modeling and Simulation module <b>22</b>. Data gathered such as in connection with the User Interface <b>20</b> and used by the Modeling and Simulation module <b>22</b> may be forwarded to the Data Storage and Retrieval module <b>24</b> where user-entered data, for example, may be stored in User Data Files <b>28</b>. Additionally, other data and information may be obtained from the Libraries <b>26</b> as needed by the Modeling and Simulation module or in connection with the User Interface <b>20</b>. In this particular example, the software in the modules may be written in any one of a variety of computer programming languages such as C, C++, Java or any combination of these or other commercially available programming languages. For example, one embodiment includes software written in MATLAB 5.3 and C. C routines may be invoked using the external function interface of MATLAB.</p>
  <p num="p-0090">Additionally, various data files such as User Data Files <b>28</b> and the Libraries <b>26</b> may be stored in any one of a variety of data file formats in connection with a file system that may be used in the host computer system, for example, or in the Data Storage System <b>12</b>. An embodiment may use any one of a variety of database packages in connection with the storage and retrieval of data. The User Data files <b>28</b> may also be used in connection with other software simulation and modeling packages. For example, the User Data files <b>28</b> may be stored in a format that may also be used directly or indirectly as an input to any one of a variety of other modeling packages, such as Matlab. In particular, an embodiment may provide for importing and exporting data between this system and another system, such as Matlab, for example. The precise format of the data may vary in accordance with each particular embodiment as well as the additional functionalities included therein.</p>
  <p num="p-0091">As will be described in more detail in connection with following figures, paragraphs that follow describe a technique that may be used in combining application modes modeling different systems. Properties of these application modes represented by partial differential equations (PDEs) may be automatically combined to form PDEs describing these quantities in a combined system or representation. The combined PDEs when displayed, for example, in a coefficient view may be modified and further used as input to a finite element solver. It should be noted that the differential equations may be provided to the finite element solver either independently, describing a single system, or as a combined system of PDEs.</p>
  <p num="p-0092">The software <b>19</b> provides the ability to combine application modes that model physical properties through one or more graphical user interfaces (GUIs) in which the user selects one or more application modes from a list. When a plurality of application modes are combined, this may be referred to as a multiphysics model. In addition to the application mode names, the variable names for the physical quantities may be selected through a GUI. Application modes may have different meanings depending on a submode setting. This is described in more detail elsewhere herein.</p>
  <p num="p-0093">The physical properties that are used to model the physical quantities in a system under examination in connection with the software <b>19</b> may be defined using a GUI in which the physical properties may be described as numerical values. These physical properties may also be defined as mathematical expressions including one or more numerical values, space coordinates, time coordinates and the actual physical quantities. The physical properties may apply to some parts of a geometrical domain, and the physical quantity itself can also be disabled in the other parts of the geometrical domain. A geometrical domain or domain may be partitioned into disjoint subdomains. The mathematical union of these subdomains forms the geometrical domain or domain. The complete boundary of a domain may also be divided into sections referred to as boundaries. Adjacent subdomains may have common boundaries referred to as borders. The complete boundary is the mathematical union of all the boundaries including, for example, subdomain borders. For example, in one embodiment, the geometrical domain may be one-dimensional, two-dimensional or three dimensional in the GUI. However, as described in more detail elsewhere herein, the PDE solution solvers may be able to handle any space dimension. Through the use of GUIs in one implementation, the physical properties on the boundary of the domain maybe specified and used to derive the boundary conditions of the PDEs.</p>
  <p num="p-0094">Additional function included in the software <b>19</b>, such as in the Modeling and Simulation module, may provide for automatically deriving the combined PDEs and boundary conditions of the multiphysics system. This technique merges the PDEs of the plurality of systems, and may perform symbolic differentiation of the PDEs, and produce a single system of combined PDEs.</p>
  <p num="p-0095">The combined PDEs may be modified before producing a solution. In this embodiment, this may be performed using a dialog box included in a GUI displaying the combined PDEs in a coefficient view. When the derived PDEs are modified in this way, the edit fields for the corresponding physical properties become locked. The properties may subsequently be unlocked in this embodiment by an explicit user action.</p>
  <p num="p-0096">It should be noted that an embodiment may include functionality for modeling any one or more of many engineering and scientific disciplines. These may include, for example, acoustics, chemical reactions, diffusion, electromagnetics, fluid dynamics, general physics, geophysics, heat transfer, porous media flow, quantum mechanics, semiconductor devices, structural mechanics, wave propagation, and the like. Some models may involve more than one of the foregoing systems and rather may require representing or modeling a combination of the foregoing. The techniques that are described herein may be used in connection with one or more systems of PDEs. In one embodiment described herein, these PDEs may be represented in general and/or coefficient form. The coefficient form may be more suitable in connection with linear or almost linear problems, while the general form may be better suited for use in connection with non-linear problems. The system(s) being modeled may have an associated submode, for example, such as stationary or time dependent, linear or non-linear, scalar or multi-component. An embodiment may also include the option of performing, for example, eigenvalue or eigenfrequency analysis. In the embodiment described herein, a Finite Element Method (FEM) may be used to solve for the PDEs together with, for example, adaptive meshing and a choice of a one or more different numerical solvers.</p>
  <p num="p-0097">In one embodiment, a finite element mesh may include simplices forming a representation of the geometrical domain. Each simplex belongs to a unique subdomain, and the union of the simplices forms an approximation of the geometrical domain. The boundary of the domain may also be represented by simplices of the dimensions 0, 1, and 2, for geometrical dimensions 1, 2, and 3, respectively. The finite element mesh may be formed by using a Delanunay technique, for example, as described in Delanunay Triangulation and Meshing, by P.-L. George, and H. Bourouchaki, Hermes, Paris, 1998. Generally, this technique may be used to divide the geometrical domain into small partitions. For example, for a 1-dimensional domain, the partitions may be intervals along the x-axis. For a 2-dimensional square domain, the domain may be partitioned into triangles or quadrilaterals. For a 3-dimensional domain, the domain may be partitioned into tetrahedrons, blocks or other shapes.</p>
  <p num="p-0098">It should be noted that a mesh representing a geometry may also be created by an outside or external application and may subsequently be imported for use into this system in this embodiment.</p>
  <p num="p-0099">The initial value of the solution process may be given as numerical values, or expressions that may include numerical values, space coordinates, time coordinates and the actual physical quantities. The initial value(s) may also include physical quantities previously determined.</p>
  <p num="p-0100">The solution of the PDEs may be determined for any subset of the physical properties and their related quantities. Further, any subset not solved for may be treated as initial values to the system of PDEs.</p>
  <p num="p-0101">Referring now to <figref idrefs="DRAWINGS">FIG. 3</figref>, shown is an example of an embodiment of a user interface or GUI <b>30</b> that may be used in connection with specifying a multiphysics system of more than one system to be combined. In this example, each system to be combined may correspond to an application mode. Through the use of the GUI <b>30</b>, the application modes that are to be used in this combined multiphysics system may be specified. Each application mode models physical quantities in terms of PDEs. The physical quantities may be represented either directly as the dependent variables in the PDE, or by a relation between the dependent variable and the variable representing the physical quantity. The PDEs in this embodiment may be generally hidden from the user through the use of the GUIs. When several application modes are combined into one single model or system, it may be referred to as a multiphysics model.</p>
  <p num="p-0102">The list of application modes <b>32</b> is the list of possible application modes from which a user may select in accordance with the user choice of space dimension indicated the buttons <b>56</b> in the left-hand top of the GUI <b>30</b>. To add application modes to a multiphysics model, the user selects application modes from the left-most list box <b>32</b> and may specify that these application modes are to be included in a multiphysics model, for example, selecting the button <b>33</b> <i>a</i>. After selection, this application mode is added to the list <b>58</b> on the right hand side of the GUI <b>30</b>. Application modes may also be removed from the list by selecting button <b>33</b> <i>b</i>. Before adding an application mode, the user may edit its name <b>36</b> and names of the variables <b>38</b> representing the physical quantities that may be solved for, for example, resulting in the new name <b>44</b> and new name of the variable <b>46</b>.</p>
  <p num="p-0103">Each application mode in the multiphysics model is given a unique name that may be used to identify the origin of the variables in the multiphysics model. The example shown in the GUI <b>30</b> is for an application mode Heat Transfer in the list <b>32</b>. When selected using button <b>33</b> <i>a</i>, the application mode appears on list <b>58</b>. The user may edit the application mode name, for example, changing it from that included in display <b>36</b> to the corresponding name of display item <b>44</b>. Similarly, the dependent variable name may be modified from that shown in item <b>38</b> to the item <b>46</b>. In this example, only one variable is associated with the Heat Transfer application mode. For an application mode including more than one physical quantity, the user may enter all the names of the physical quantities as space-separated entries in the Dependent variables edit field <b>46</b>.</p>
  <p num="p-0104">There are also application modes that directly correspond to PDEs. In these modes, the quantities are represented by the dependent variables. Each of these application modes may have more than one dependent variable. The number of dependent variables and the dimension of system of PDEs may be determined by entering one or more corresponding space-separated variable names.</p>
  <p num="p-0105">On the right-hand side of the multiphysics GUI <b>30</b>, a solver type and solution form may be selected. The solver type may be specified in the item <b>40</b>, for example, as one of stationary, time-dependent, and the like. Similarly, the solution form may be specified in item <b>42</b>, for example as coefficient or general form. These refer to the form of the PDE for which the solution is derived and are described in more detail elsewhere herein. The solver types and solution forms may vary in accordance with the application modes of the multiphysics model. In the list box <b>58</b>, all the application modes that have been added to the model appear. A user may select any of the model's application modes and change its submode <b>48</b>. Generally, a submode may relate to the manner in which equations are derived or differentiated, for example, with respect to what variables differentiation may be performed.</p>
  <p num="p-0106">In this example, shown is the standard submode as being specified in item <b>48</b>. Additionally, an application mode may include other associated submodes, for example, such as, a wave-extension submode that extends a standard time-dependent equation to a wave equation using the second derivative of the standard equation with respect to time. Selecting OK using button <b>31</b> <i>a </i>saves the updated multiphysics model with all the added application modes and closes the GUI <b>30</b>. In contrast, selecting Cancel using button <b>31</b> <i>b </i>closes the GUI and discards any changes. Referring to <figref idrefs="DRAWINGS">FIG. 2</figref>, when the OK button <b>31</b> <i>a </i>is selected, the data may be communicated from the GUI <b>20</b> to the Modeling and Simulation Module <b>22</b> and subsequently to the Data Storage and Retrieval Module <b>24</b> for storage in the User Data Files <b>28</b>.</p>
  <p num="p-0107">The foregoing screen display, such as GUI <b>30</b>, may be displayed by and included as a portion of the software of the User Interface Module <b>20</b> of the software <b>19</b>. It should be noted that an embodiment may include different types of application modes. In one embodiment, application modes may be classified as one of user defined or predefined. A predefined application mode may be one for which functionality is included in the libraries <b>26</b> as may be available from a software vendor. In other words, a software vendor may supply libraries including defined systems of PDEs, GUIs and the like for a particular type of system, such as heat transfer. Additionally, an embodiment may include support to provide for user-defined models or application modes for which a user may specify the PDEs, the quantities being modeled, and the like. Subsequently, a user-defined model may be saved in a user defined library, for example, included in the user defined data files <b>28</b>. Definitions and other data files associated with a user-defined model may be stored in any one of a variety of data formats, for example, similar to those of the libraries <b>26</b> that may be included in an implementation by a software vendor. The format and function may vary in accordance with each embodiment.</p>
  <p num="p-0108">In one embodiment, a user may define and add a user-defined application mode by adding functions in MATLAB format for transforming the physical properties on subdomains, boundaries, and initial conditions. The user may specify a first function, equ_compute, for transforming physical quantities to PDE coefficients, a second function, bnd_compute, for transforming the physical properties on the boundaries to boundary conditions, and a third function, init_compute, for transforming the physical properties in the initial condition. More detail on user defined application modes is described elsewhere herein.</p>
  <p num="p-0109">Referring now to <figref idrefs="DRAWINGS">FIG. 4</figref>, shown is an example of an screen display of the physical property specification GUI <b>60</b> for the heat transfer application mode. In this embodiment, each application mode may have a specifically designed GUI display in which the physical properties associated with that application mode may be specified. The list <b>62</b> in the left of the GUI <b>60</b> includes one or more geometrical domains to which the physical properties may apply. These may also be referred to as subdomains. The user may select one or several subdomains from the list <b>62</b>, for example, using a mouse, keyboard or other selection device. If a single subdomain is selected, entering a new name in the edit field Name <b>62</b> <i>a </i>may change the name. If the user selects multiple subdomains, the properties that are specified apply to all the selected subdomains. The on-top check box <b>64</b> <i>a </i>makes the boundary condition GUI float on top of the view of the geometrical domain also. In other words, the corresponding dialogue box floats on top of other items that may be displayed on the screen in connection with the GUI.</p>
  <p num="p-0110">In this embodiment, if the properties of the currently selected subdomains differ, the edit fields for the properties may be locked for no editing. One may unlock the subdomains by explicitly checking the Unlock check box <b>64</b> <i>a</i>. The properties from the first selected subdomain may be copied to all the selected subdomains.</p>
  <p num="p-0111">It should be noted that in one embodiment, selecting several subdomains with different physical properties may also cause locking. Checking unlocking may then result in the properties in the first selected subdomain being copied to the other subdomains.</p>
  <p num="p-0112">The physical properties of the subdomains are specified in the list <b>64</b>. As previously described, these properties may be specified as numerical values, or also as symbolic expressions in terms of the space coordinates, the physical quantities and their space derivatives, and the time. Additionally, a name of a procedure to compute a value of the property may also be specified by entering the name and any parameters that may be included in the procedure. In one embodiment, the procedure may be written, for example, in C, Fortran, or Matlab. The particular language of implementation may vary in accordance with each particular embodiment and the calling standards and conventions included therein.</p>
  <p num="p-0113">A user may also disable the physical quantities of an application mode in a subdomain entirely by un-checking the Active in this Subdomain checkbox <b>66</b>. This removes the properties in <b>64</b> from the application in the selected subdomain(s). Also the physical quantities in this application mode are disabled in the selected subdomain(s).</p>
  <p num="p-0114">Referring now to <figref idrefs="DRAWINGS">FIG. 5</figref>, shown is an example of a screen display of a GUI <b>70</b> which is a physical property boundary specification GUI for the heat transfer application mode. The list <b>72</b> in the left portion of the GUI <b>70</b> includes geometrical boundaries where the physical properties may apply. Only the boundaries that form the outer boundary with respect to the active subdomains are included in the list. As described elsewhere herein, those subdomains that are active may be specified in the GUI <b>60</b> for physical properties.</p>
  <p num="p-0115">Boundaries that are entirely inside the subdomain or between two subdomains are also not shown unless the Enable borders check box <b>72</b> <i>a </i>is selected. A user may select one or several boundaries from the list <b>72</b>. If the user selects a single boundary, the user can change its name by entering a new name in the Name edit field <b>72</b> <i>b</i>. If the user selects multiple boundaries, the properties that the user specifies, as in list <b>74</b>, apply to all the selected boundaries. If the properties on the currently selected boundaries differ, the edit field <b>72</b> <i>b </i>for the properties is locked. One may unlock the subdomains by explicitly checking the Unlock check box <b>74</b> <i>a</i>. The properties from the first selected boundary are then copied to all the selected boundaries.</p>
  <p num="p-0116">In one embodiment, selecting several boundaries with different physical properties may also cause locking. Checking unlock may then result in the properties in the first selected boundary being copied to the other boundaries.</p>
  <p num="p-0117">The physical properties of the geometrical boundaries are specified in the list <b>74</b> in the right hand portion of the GUI <b>70</b>. These properties have values that may be specified as numerical values, or symbolic expressions in terms of the space coordinates, the physical quantities and their space derivatives from any application modes added by using the previous section, and the time. Additionally, the name of a procedure to determine the value of the property may also be specified in a manner similar to as described elsewhere herein.</p>
  <p num="p-0118">It should be noted that a portion of the different GUIs displayed may be similar, for example, such as the on top check box <b>74</b> <i>b </i>that is similar in function to <b>64</b> <i>a </i>as described elsewhere herein.</p>
  <p num="p-0119">Referring now to <figref idrefs="DRAWINGS">FIG. 6</figref>, shown is an example of an embodiment of a screen display that may be used in connection with modifying the PDEs in a coefficient view. Using this interface <b>80</b> of <figref idrefs="DRAWINGS">FIG. 6</figref>, this may be used in connection with modifying the boundary conditions in coefficient view as associated with the combined system of PDEs. It should be noted that other embodiments may also include a similar screen display and interface to allow for modification of PDEs of each individual application mode or system being modeled. Additionally, an embodiment may also include a similar screen display for modifying a system in general form rather than coefficient form as shown in the display <b>80</b> of <figref idrefs="DRAWINGS">FIG. 6</figref>.</p>
  <p num="p-0120">The GUI <b>80</b> may be displayed in connection with modifying the boundary conditions associated with a coefficient. For example, in the GUI <b>80</b>, the boundaries 1 and 3 have been selected as associated with the coefficient tab q <b>82</b> <i>a </i>corresponding to the coefficient appearing in the PDE at position <b>84</b> <i>a</i>. The list <b>90</b> on the right hand side of the GUI <b>80</b> includes the boundary conditions associated with the active q coefficient. A user may modify the conditions associated with the currently active coefficient, such as q. Any one of the tabbed coefficients, such as <b>82</b> <i>a</i>-<b>82</b> <i>d </i>may be made active, for example, by selecting the tab, such as with a mouse or other selection device. This causes the right hand portion <b>90</b> of the GUI <b>80</b> to be updated with corresponding values for the currently active coefficient. The values may be modified by editing the fields of <b>90</b> and selecting the OK button <b>92</b> <i>a</i>, or the apply button <b>92</b> <i>c</i>. The modification may be cancelled, as by selecting the cancel operation button <b>92</b> <i>b</i>. A boundary number that is selected on list <b>88</b> may be changed to have a symbolic name, as may be specified in field <b>96</b>. The values indicated in <b>90</b> are set accordingly for the selected boundaries <b>88</b>. The on-top check box <b>94</b>, and other features of GUI <b>80</b>, are similar to those appearing in other GUIs and described in more detail elsewhere herein.</p>
  <p num="p-0121">It should be noted that the PDE coefficient and boundary conditions associated with the combined system of PDEs for the various application modes selected may be stored in a data structure that is described in more detail elsewhere herein. Subsequently, if these coefficient and boundary conditions are modified, for example, using the GUI <b>80</b> of <figref idrefs="DRAWINGS">FIG. 6</figref>, the corresponding data structure field(s) may be updated accordingly. As will be described in connection with other figures, the combined system of PDEs and associated boundary condition fields may be updated.</p>
  <p num="p-0122">It should also be noted that the dialog for modifying the boundary conditions in coefficient view of a system of three variables may be viewed in the example GUI <b>80</b> of <figref idrefs="DRAWINGS">FIG. 6</figref>. If the system to be solved is in general form, the coefficient view dialog box may also include symbolic derivatives of the general form coefficients with respect to the physical quantities or solution components and their derivatives according to <figref idrefs="DRAWINGS">FIG. 10</figref>. As described in more detail elsewhere herein, the derivatives may be used for the solution of nonlinear stationary and time-dependent problems.</p>
  <p num="p-0123">In one embodiment, when the coefficients in coefficient view are changed for a subdomain or a boundary, the Unlock check-box in the corresponding application modes for that subdomain or boundary dialog box is enabled, as previously described in connection with GUI <b>70</b> of <figref idrefs="DRAWINGS">FIG. 5</figref>. In one embodiment, in order to disable the change in coefficient view, a user may remove the checkmark as may be displayed in the Unlock check box on the subdomain or boundary in the application mode, for example, as described in connection, respectively, with GUIs <b>60</b> and <b>70</b>.</p>
  <p num="p-0124">Using the GUIs <b>60</b> and <b>70</b> for, respectively, physical properties for subdomains and boundaries, as well as possible modifications specified as with GUI <b>80</b>, the Modeling and Simulation Module <b>22</b> may create, initialize, and possibly modify the data structure <b>250</b> of <figref idrefs="DRAWINGS">FIG. 6A</figref>.</p>
  <p num="p-0125">Referring now to <figref idrefs="DRAWINGS">FIG. 6A</figref>, shown is an example of a representation of the data structure that may be included in an embodiment in connection with storing data in connection with the PDEs selected and combined. The data in the data structure <b>250</b> may include data used in connection with the multiphysics model.</p>
  <p num="p-0126">The data structure <b>250</b> includes the following fields:</p>
  <p num="p-0127">
    <tables id="TABLE-US-00001" num="00001"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="126pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">Data field</td>
              <td class="description-td">Description</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.mesh</td>
              <td class="description-td">Finite element mesh</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}</td>
              <td class="description-td">Application mode I</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.dim</td>
              <td class="description-td">Dependent variable name</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.equ</td>
              <td class="description-td">Domain physical data</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.bnd</td>
              <td class="description-td">Boundary physical data</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.submode</td>
              <td class="description-td">Text string containing submode setting</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.border</td>
              <td class="description-td">Border on or off</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.appl{i}.usage</td>
              <td class="description-td">Matrix of subdomain usage</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.dim</td>
              <td class="description-td">Multiphysics dependent variable names</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ</td>
              <td class="description-td">PDE coefficients</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.bnd</td>
              <td class="description-td">Boundary conditions</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.border</td>
              <td class="description-td">Vector of border on or off</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.usage</td>
              <td class="description-td">Multiphysics subdomain usage matrix</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.init</td>
              <td class="description-td">Initial value</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.sol</td>
              <td class="description-td">Finite element solution</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0128">The field fem.mesh <b>252</b> includes the finite element discretization. The mesh partitions the geometrical domain into subdomains and boundaries. Data stored in this field may be created from an analyzed geometry. A mesh structure representing a geometry may also be created by an outside or external application and may subsequently be imported to use in this system in this embodiment. To obtain good numerical results in the solution to a particular multiphysics problem, the mesh may have certain specific characteristics available in connection with an externally provided mesh, such as by a MATLAB routine. In instances such as these, a mesh may be imported from a compatible external source. Support may vary with embodiment as to what external interfaces are supported and what external formats of meshes may be compatible for use with a particular implementation. For example, a mesh structure may be compatible for use with an embodiment such as a mesh structure produced by the product TetMesh by Simulog, and HyperMesh by Altair Engineering.</p>
  <p num="p-0129">In one embodiment a geometry is used in generating a mesh structure. In other words, in an embodiment that includes functionality to define and create a mesh as an alternative to obtaining a mesh, for example, from an external compatible software product, a geometry definition may be used in generating a mesh structure. What will now be described is a function that may be included in an embodiment. An embodiment may include any one or more of a variety of alternatives to represent a geometry of a PDE problem to be solved. One technique includes defining a geometry in accordance with a predefined file format, predefined formatted object, and the like. It should be noted that an embodiment may include the option of importing a predefined file format or specifying a function for describing the geometry.</p>
  <p num="p-0130">It should be noted that the predefined file format may include differences in accordance with the varying dimensions that may be supported by an embodiment.</p>
  <p num="p-0131">An embodiment may include a function or routine definition for returning information about a geometry represented in accordance with a predefined file format. This routine may be included in an implementation, or, may also be defined by a user. In other words, an implementation may include support allowing a user to provide an interface function in accordance with a predefined template or API, such as particular input and output parameters and function return values. Such a routine may be used as an interface function, for example, to obtain geometry information in which a geometry may be represented in any one of a variety of predefined file formats, data structure formats, and the like.</p>
  <p num="p-0132">The fem.mesh structure may represent a finite element mesh that is partitioning a geometrical domain into simplices. In one embodiment, minimal regions may be divided into elements and boundaries may also be broken up into boundary elements. In one embodiment of the mesh structure, the mesh may be represented by fields of data, two of which are optional. The five fields are: the node point matrix (p), the boundary element matrix (e), the element matrix (t), the vertex matrix (v) and the equivalence matrix (equiv), in which v and equiv may be optional. The matrix p includes the node point coordinates of the mesh. The matrix e may include information to assemble boundary conditions on , such as node points of boundary elements, parameter values on boundary elements, geometry boundary numbers, and left and right subdomain numbers. The matrix t includes information needed to assemble the PDE on the domain . It includes the node points of the finite element mesh, and the subdomain number of each element. The matrix v includes information to recreate geometric vertices. The equiv matrix includes information on equivalent boundary elements on equivalent boundaries. It should be noted that contents and of the data structure may vary with dimension of the domain being represented. For example, in connection with a 2-dimensional domain, the node point matrix p may include x and y coordinates as the first and second rows of the matrix. The boundary element matrix e may include first and second rows that include indices of the starting and ending point, third and fourth rows including the starting and ending parameter values, a fifth row including the boundary segment number, and sixth and seventh rows including left and right hand side subdomain numbers. The element matrix t may include in the first three rows indices of the corner points, given in counterclockwise order, and a fourth row including a subdomain number. The vertex matrix v may have a first row including indices into p for vertices. For isolated vertices, the second row may also include the number of the subdomain that includes the vertex. For other vertices, the second row may be padded. The field v may not be used during assembly, but rather have another use when the mesh structure, for example, may be used in connection with other operations or data representations. The equivalence matrix equiv may include first and second rows of indices into the columns in e for equivalent boundary elements. The third and fourth row may include a 1 and 2, or a 2 and 1 depending on the permutation of the boundaries relative to each other.</p>
  <p num="p-0133">As another example of the mesh structure, consider one that may be used in connection with a 1-dimensional structure being represented. The node matrix p may include x coordinates of the node points in the mesh in the first row. In the boundary element matrix e, the first row may include indicates of the boundary point, the second row may include the boundary segment number, and the third and fourth rows may include left and right hand side subdomain numbers. In the element matrix e, the first two rows include indices to the corner points, given from left to right, and the third row includes the subdomain number. In a 1-dimensional domain, there is no vertex matrix since vertices are exactly equivalent to the boundaries. In the equivalence matrix equiv, the first and second rows include indices into the columns in e for equivalent boundaries. The third row is padded with ones.</p>
  <p num="p-0134">In one embodiment, the fem structure may additionally include a fem.equiv field indicating boundaries that should be equivalent with respect to elements and node points, e.g., for periodic boundary conditions. One implementation of fem.equiv includes a first row with master boundary indices and a second row with slave boundary indices. The mesh has the same number of node points for the boundaries listed in the same column. The points are placed at equal arc-length from the starting point of the equivalent boundaries. If a negative number is used in row two, the slave boundary may be generated by following the master boundary from end point to start point. A master boundary may not be a slave boundary in another column.</p>
  <p num="p-0135">Following is a summary of the Delaunay triangulation method in connection with forming a 2-dimensional mesh structure:</p>
  <p num="p-0136">1. Enclose geometry in a bounding box</p>
  <p num="p-0137">2. Put node points on the boundaries following HMAX</p>
  <p num="p-0138">3. Perform Delaunay triangulation of the node points on the boundaries and the vertices of the box. Use the properties MINIT/ON and BOX/ON to see the output of this step.</p>
  <p num="p-0139">4. Insert node points into center of circumscribed circles of large elements and update Delaunay triangulation until HMAX is achieved.</p>
  <p num="p-0140">5. Check that the Delaunay triangulation respects the boundaries and enforce respected boundaries.</p>
  <p num="p-0141">6. Remove bounding box.</p>
  <p num="p-0142">7. Improve mesh quality.</p>
  <p num="h-0006">in which HMAX refers to the maximum element size; BOX and MINIT and other properties that may be used in one embodiment are summarized below:</p>
  <p num="p-0143">
    <tables id="TABLE-US-00002" num="00002"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="6"> <colspec colname="1" colwidth="35pt" align="left"> </colspec> <colspec colname="2" colwidth="21pt" align="center"> </colspec> <colspec colname="3" colwidth="21pt" align="center"> </colspec> <colspec colname="4" colwidth="35pt" align="left"> </colspec> <colspec colname="5" colwidth="28pt" align="left"> </colspec> <colspec colname="6" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="6" align="center" rowsep="1" class="description-td" colspan="6"> </td>
            </tr> <tr class="description-tr"> <td class="description-td">Property</td>
              <td class="description-td">1-D</td>
              <td class="description-td">2-D</td>
              <td class="description-td">Value</td>
              <td class="description-td">Default</td>
              <td class="description-td">Description</td>
            </tr> <tr class="description-tr"> <td namest="1" nameend="6" align="center" rowsep="1" class="description-td" colspan="6"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">Box</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">on/off</td>
              <td class="description-td">off</td>
              <td class="description-td">preserve bounding box</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hcurve</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">numeric</td>
              <td class="description-td">1/3</td>
              <td class="description-td">curvature mesh size</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hexr</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">string</td>
              <td class="description-td"> </td>
              <td class="description-td">maximum mesh size</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hgrad</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">numeric</td>
              <td class="description-td">1.3</td>
              <td class="description-td">element growth rate</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hmax</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">numeric or</td>
              <td class="description-td">estimate</td>
              <td class="description-td">maximum element size</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">cell array</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hmesh</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">numeric</td>
              <td class="description-td"> </td>
              <td class="description-td">maximum element size</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">given per point or</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">element on an input mesh</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hnum</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">numeric,</td>
              <td class="description-td"> </td>
              <td class="description-td">number of elements</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">cell array</td>
            </tr> <tr class="description-tr"> <td class="description-td">Hpnt</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">numeric,</td>
              <td class="description-td"> </td>
              <td class="description-td">number of resolution</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">cell array</td>
              <td class="description-td"> </td>
              <td class="description-td">points</td>
            </tr> <tr class="description-tr"> <td class="description-td">Minit</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">on/off</td>
              <td class="description-td">off</td>
              <td class="description-td">boundary triangulation</td>
            </tr> <tr class="description-tr"> <td class="description-td">jiggle</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">off/mean</td>
              <td class="description-td">mean</td>
              <td class="description-td">call mesh smoothing</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td"> </td>
              <td class="description-td">min/on</td>
              <td class="description-td"> </td>
              <td class="description-td">routine</td>
            </tr> <tr class="description-tr"> <td class="description-td">Jiggleiter</td>
              <td class="description-td"> </td>
              <td class="description-td">X</td>
              <td class="description-td">numeric</td>
              <td class="description-td">10</td>
              <td class="description-td">maximum iterations</td>
            </tr> <tr class="description-tr"> <td class="description-td">out</td>
              <td class="description-td">X</td>
              <td class="description-td">X</td>
              <td class="description-td">values</td>
              <td class="description-td">mesh</td>
              <td class="description-td">output variables</td>
            </tr> <tr class="description-tr"> <td namest="1" nameend="6" align="center" rowsep="1" class="description-td" colspan="6"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0144">The foregoing properties may be used in connection with forming a mesh structure. The Box and Minit properties are related to the way the mesh method works. By turning the box property on, one may obtain an estimate of how the mesh generation technique may work within the bounding box. By turning on minit, the initial triangulation of the boundaries may be viewed, for example, in connection with step 3 above.</p>
  <p num="p-0145">Hcurve is a scalar numeric value relating the mesh size to the curvature of the geometry or mesh boundaries. The radius of the curvature is multiplied by the hcurve factor to obtain the mesh size along the boundary. Hexpr is a string including an expression of x and y giving the size of the elements at different coordinates using the mesh structure. Hmax controls the size of the elements in the mesh. Hmax may either be a global value, or a cell array. The syntax of the cell array varies in accordance with 1-D and 2-D. For 2-D, the first entry in the cell includes a global Hmax, the second entry is a matrix with two rows where the first row includes point indices and the second row includes Hmax and corresponding points. The third entry includes indices to edge segments and corresponding Hmax, and the fourth entry includes indices to subdomains and corresponding Hmax. For a 1-D the first entry in the cell includes a global Hmax, the second entry is a matrix with two rows where the first row includes point indices, and the second row includes Hmax in the corresponding points. The third entry includes indices to the subdomains and corresponding Hmax.</p>
  <p num="p-0146">Hmesh is a vector with one entry for every node or element in the mesh given in the mesh structure. Hnum controls the approximate number of elements in the mesh. Depending on other properties, the number of elements specified by Hnum may be exceeded, but at least as many elements specified are generated. Hnum may be either a global numeric value or a cell array. Syntax of the cell array varies with 1-D or 2-D. For 2-D, the first entry in the cell includes a global Hnum, the second entry is a matrix with two rows where the first row include edge indices and the second row includes Hnum on the corresponding edges. For 1-D, the first entry in the cell includes a global Hnum, the second entry is a matrix with two rows where the first row includes subdomain indices and the second row includes Hnum on the corresponding subdomain.</p>
  <p num="p-0147">The Hpnt property controls the number of points placed on each edge to resolve the mesh. Additional points may be placed as needed in accordance with the curvature and distances. It is either a number for all edges, or a cell. If it is a cell array, the first entry applies to all edges and the second entry is a matrix with two rows where the first row includes edge indices and the second row includes Hpnt on that edge.</p>
  <p num="p-0148">The Jiggle property may be used to control whether jiggling of the mesh may be attempted, for example, in using a smoothing technique. This may be performed until the minimum or mean of the quality of elements decreases by setting jiggle accordingly to min or mean. Jiggleiter may be used to specify a maximum number of iterations.</p>
  <p num="p-0149">It should be noted that the foregoing properties may be included as parameters to an API for forming a mesh structure, for example, using the Delaunay triangulation method. Other techniques may also be used and the exact parameters in an embodiment using an API may also vary. Additionally, other embodiments may also include other representations of the mesh structure that may vary in accordance with dimension of the geometry.</p>
  <p num="p-0150">Referring back to other fields of the fern structure in one embodiment, each application mode has a separate fem.appl{i} field <b>254</b>, referred to as appl{i}. The index i in the appl vector runs over the set of application modes that have been selected, for example, in connection with <figref idrefs="DRAWINGS">FIG. 3</figref>. In this embodiment, corresponding to each appl{i} for each selected application mode are five subfields denoted <b>254</b> <i>a</i>-<b>254</b> <i>e</i>. The appl{i).dim field <b>254</b> <i>a </i>includes the names of the dependent variables or physical quantities in application mode i. The appl{i}.equ field <b>254</b> <i>b </i>includes the physical properties associated with subdomain data, for example as described in connection with <figref idrefs="DRAWINGS">FIG. 4</figref>. The field appl{i}.bnd <b>254</b> <i>c </i>includes data describing the physical properties associated with boundary data, for example as described in connection with <figref idrefs="DRAWINGS">FIG. 5</figref>, for application mode i. The field border <b>254</b> <i>d </i>is a flag that controls if boundary conditions on inner boundaries are to be considered, and, for example, corresponds to the Enable Borders check box as described in connection with the GUI of <figref idrefs="DRAWINGS">FIG. 5</figref>. There is one border flag for each application mode. The field usage <b>254</b> <i>e </i>corresponds to the Activate in this Subdomain check box as described in connection with the GUI of <figref idrefs="DRAWINGS">FIG. 4</figref>. In one embodiment, this may be implemented as a boolean vector, with one column for each geometrical subdomain. A logical value of 1 or true in an entry indicates that application mode is active in the subdomain corresponding to that column. Fem.appl{i}.submode represents a corresponding submode setting, such as <b>48</b> of <figref idrefs="DRAWINGS">FIG. 3</figref>.</p>
  <p num="p-0151">In one embodiment, the remaining fields in the data structure <b>250</b> may be associated with the combined application modes. The field fem.dim <b>256</b> includes the names of the dependent variables or physical quantities in all application modes. The fields fem.equ <b>258</b> and fem.bnd <b>260</b> correspond to the derived equations and boundary conditions for all the application modes. These fields may be used in connection with data from dialog boxes for PDE and Boundary conditions in coefficient view, such as those GUIs described in connection with <figref idrefs="DRAWINGS">FIG. 6</figref>. Similarly the field fem.border <b>262</b> may be implemented as a vector specifying borders for each variable of the variables in appl{i}.dim separately. The field fem.usage <b>254</b> <i>e </i>includes data associated with the activation of dependent variables in each geometrical subdomain. The variables in fem.dim <b>256</b> correspond to the rows of the fem.usage field <b>264</b>, and the columns correspond to the geometrical subdomains. The field fem.init <b>266</b> includes the initial value for nonlinear and time dependent solvers, for example, as may be used in connection with solving for the PDEs. The field fem.sol <b>268</b> may include the solution to the combined system of PDEs using a solution or PDE solving technique, for example, as may be selected in accordance with the GUI of <figref idrefs="DRAWINGS">FIG. 7</figref>, other parameters included in the structure <b>250</b>, and the type of PDE system being solved, such as whether the PDEs correspond to a linear or non-linear system, are in coefficient or general form, and the like. The field <b>270</b> indicates that other fields may be included in an embodiment in accordance with each implementation.</p>
  <p num="p-0152">The equ fields <b>254</b> <i>b </i>may include several application mode dependent subfields with one list per physical property. Each list entries correspond to the subdomains of the problem. Each subfield may include a list of expression values representing the physical properties involved. For example, the heat transfer application mode includes the list: rho, C, k, Q, htrans, Text, Camb, Tambtrans, corresponding, respectively, to the density, heat capacity, coefficient of heat conduction, heat source, convective heat transfer coefficient, external temperature, user-defined constant, and transversal ambient temperature. This may be interpreted as a heat source of Q+htrans*(TextT)+Camb*(Tambtrans^4T^4) on a subdomain.</p>
  <p num="p-0153">The usage fields <b>254</b> <i>e </i>and <b>264</b> describe the setting of the Active in this subdomain setting for each physical property (or dependent variable). The bnd fields <b>254</b> <i>c </i>include several application mode dependent subfields with one list per physical property. The list entries correspond to the boundaries of the subdomain. Each subfield contains a list of expression values for the physical quantities involved, e.g., the heat transfer application mode contains the list: q, h, Tinf, C, Tamb, and T, corresponding to the heat flux and heat transfer coefficient, external temperature, user-defined constant, ambient temperature, and temperature, respectively. An additional subfield, type, controls the basic type of the boundary condition and what physical properties are used on the boundary. For example, referring to the heat transfer application mode, the type may be one of T0, T, q, or q0. T0 indicates a zero temperature; T indicates that the temperature is specified in the field T; and q0 indicates a zero heat flux through that boundary, and q indicates a heat flux of q+h*(TinfT)+C*(TambA4T^4) through that boundary.</p>
  <p num="p-0154">The border fields <b>254</b> <i>d </i>and <b>262</b> indicate if the internal boundaries between subdomains are to be considered during the solution of the model. In one embodiment, the outer boundaries with respect to the active in this subdomain setting may be ignored. The equ fields <b>254</b> <i>b </i>and <b>258</b>, and the bnd fields <b>254</b> <i>c </i>and <b>260</b> may further include an ind subfield. Each of the ind subfields may be implemented as a vector with length equal to the number of subdomains or boundaries. For each subdomain, the corresponding ind vector entry may indicate a domain group, or 0 for no group. For boundaries, each of the subfields bnd.ind may have the corresponding meaning for boundaries. When the ind field is not given, each subdomain or boundary forms a separate group.</p>
  <p num="p-0155">Referring back to <figref idrefs="DRAWINGS">FIG. 6</figref> in connection with GUI <b>80</b>, fields in fem.equ <b>258</b> and fem.bnd <b>260</b> may be modified if they are specified as being applied to the combined PDE system and subsequently modified, for example, using the GUI <b>80</b>.</p>
  <p num="p-0156">Referring now to <figref idrefs="DRAWINGS">FIG. 7</figref>, shown is an example of an embodiment of a screen display that may be used in connection with solving the PDEs for any subset of physical quantities from any one or more application modes, or of the combined PDE system. The GUI <b>110</b> includes a left hand portion <b>114</b> displaying the one or more application modes selected with the current combined or multiphysics mode. The show variables box <b>114</b> <i>a</i>, if checked or activated, may modify the content displayed in area <b>114</b> to further include dependent variables in each of the associated application modes. In this instance, the physical quantities may be selected as well as a particular application mode with regard to solving for the combined system of PDEs in which the combined system includes those systems corresponding to the application modes in the area <b>114</b>. The area <b>116</b> includes one or more various options that may be associated with solving for the PDEs. In this embodiment, the reference to u as included in the area <b>116</b> refers to all physical quantities for all application modes. Activating the field <b>116</b> <i>b </i>causes the updating of the appropriate data structure fields upon solving for the system of PDEs. Activating field <b>116</b> <i>c </i>uses interpolation in solving for the PDEs. This is described in more detail elsewhere herein.</p>
  <p num="p-0157">The GUI <b>110</b> may be used in selecting what physical quantities to solve for in the system of PDEs. Selecting all application modes, such as by selection an highlighting application modes of area <b>114</b>, solves for all physical quantities in the system of PDEs. Selecting a subset of the application modes solves for all the variables in these application modes. In one embodiment, checking the checkbox <b>114</b> <i>a </i>Show variables shows the actual variable names instead of the names of the application mode, and enables selection of these. The Update u button <b>116</b> <i>a </i>inserts the current solution (in fem.sol) into the initial conditions (in fem.init). The check-box update u automatically makes u automatically update the data structure fields fem.init with fem.sol each time a solution is computed, and the check-box use interpolation <b>116</b> <i>c </i>allows interpolation to be used when the current solution and the current discretization mesh are different. In one embodiment, the solution may be interpolated to the current discretization and inserted into fem.init. The use of interpolation, for example, is set forth in Numerical Methods, G. Dahlquist, . Bjork, Prentice Hall, 1974, ISBN 0-13-627315. The Use solution number pop-up menu <b>116</b> <i>d </i>controls which solution to update fem.init with, for example, if there are several columns in fem.sol as may be for a time-dependent problem.</p>
  <p num="p-0158">The values in the physical property fields of the application mode appl structure, for each of the i selected application modes, may be converted into PDEs. The formats of the PDEs formed for each specified application mode may be represented as in <figref idrefs="DRAWINGS">FIGS. 8 and 9</figref>.</p>
  <p num="p-0159">Referring now to <figref idrefs="DRAWINGS">FIG. 8</figref>, shown is an example of an embodiment of formulae <b>140</b> describing a system of PDEs in coefficient form. , formula <b>142</b>, is for a bounded domain. The formulae <b>146</b>, including <b>146</b> <i>a</i>-<b>146</b> <i>b </i>, correspond to the boundary of the domain <b>142</b>. n<sub>j </sub>corresponds to the components of an outward unit normal.</p>
  <p num="p-0160">The first equation <b>142</b> is satisfied inside the domain, and the second and third equations of <b>146</b> are both satisfied on the boundary of the domain. The second equation <b>146</b> <i>a </i>may be referred to as a generalized Neumann boundary condition, and the third equation <b>146</b> <i>b </i>may be referred to as a Dirichlet boundary condition.</p>
  <p num="p-0161">The unknown solutions, such as those corresponding to the physical quantities, may be denoted by u<sub></sub> in the formulae of <b>140</b>. The unknown solutions may include one or more components. N denotes the number of solution components, or physical quantities. The solution is allowed to take complex values. <sub>m </sub>is an unknown Lagrange multiplier. n<sub>j </sub>is a component of the gradient of the solution. The coefficients included in the formulae <b>140</b> d<sub>a,l,k</sub>, c<sub>l,k,j,i</sub>, a<sub>l,kj</sub>, <sub>j</sub>, <sub>l,k,i</sub>, a<sub>l,k</sub>, f<sub>l</sub>,q<sub>l,k</sub>, g<sub>l</sub>, h<sub>m,l</sub>, and <i>r</i> <sub>m </sub>may be complex-valued functions of the space, time, and the solution. The coefficients d<sub>a</sub>, c, , g, , a, and f may be functions of the gradient of u.</p>
  <p num="p-0162">For a stationary system in coefficient form, for example as may be specified in <figref idrefs="DRAWINGS">FIG. 3</figref>, item <b>40</b>, d<sub>a</sub>=0. With respect to solution components, the coefficients d<sub>a</sub>, c, , , a, and q are N-by-N matrices, and , f, and g are N vectors. The coefficient h is an M-by-N matrix, and r is an M vector, where 0&lt;=M&lt;=N and M is the number of constraints. With respect to space dimension, n, (or independent variables) the c coefficient is an n-by-n matrix, and the a, , and b coefficients are n vectors. The remaining coefficients may be scalars.</p>
  <p num="p-0163">Referring to the indices of the formulae <b>140</b>, i and j are space indices and k and l are component indices. Using the standard summation convention, i.e., there is an implicit summation over each index pair, i and j, and k and l, the formulae of <figref idrefs="DRAWINGS">FIG. 8</figref> where the indices i and j run from 1 to n, the indices k and l run from 1 to N, and where the index m runs from 1 M. n<sub>j </sub>is the jth component of the outward normal vector.</p>
  <p num="p-0164">Referring now to <figref idrefs="DRAWINGS">FIG. 9</figref>, shown is an example of an embodiment of a representation of formulae <b>150</b> describing a system of PDEs in general form. Here  <b>152</b> is a bounded domain, each , <b>154</b> <i>a </i>and <b>154</b> <i>b </i>of <b>154</b>, is a boundary of the domain, and n<sub>j </sub>is the outward unit normal. The unknown solution is denoted by u<sub>k </sub>and may include one or more components. N denotes the number of physical quantities. The solution is allowed to take complex values. <sub>m </sub>is an unknown Lagrange multiplier. The generalized Neumann condition, for example as expressed by <b>154</b> <i>a</i>, includes a source where the Lagrange multipliers <sub>m </sub>are computed such that the Dirichlet conditions become satisfied. The coefficients <sub>lj</sub>, F<sub>l</sub>, G<sub>lj</sub>, and R<sub>m</sub>, may be complex-valued functions of the space, time, the solution and its gradient. With respect to solution components the coefficients F, F and G are N vectors. The coefficient R is an M vector, where 0MN, and N is the number of constraints. The F coefficient is an n vector with respect to space dimension n. The rest of the coefficients are scalars with respect to space. Using j as a space index, and k and l as component indices in conjunction with implied standard summation convention, the general form <b>150</b> of <figref idrefs="DRAWINGS">FIG. 9</figref> may be expressed where the index j runs from 1 to n, the indices k and l run from 1 to N, where the index m runs from 1 to M, and n<sub>j </sub>is the jth component of the outward normal vector.</p>
  <p num="p-0165">The application mode physical properties, for example, as described in connection with each selected application mode corresponding to an entry in the appl{i} structure, may be converted to the representation of PDEs in coefficient and/or general form. The combined PDEs may be represented in fields of the data structure <b>250</b>, such as in the equ <b>258</b> and bnd <b>260</b> fields.</p>
  <p num="p-0166">As described in more detail elsewhere herein, in one embodiment, the same syntactic rules may be used in determining coefficients for both PDEs, as may be represented in the equ field <b>258</b>, and boundary conditions, as may be represented in the field <b>260</b>. In other words, as summarized here and described further in more detail elsewhere herein are syntactic rules that may be used in forming coefficients for the PDEs. These rules may be used in forming coefficients for each system of PDEs associated with each application mode. These rules may also be used in connection with forming coefficients for the combined PDE or multiphysics system. The coefficients may be stored in nested lists. Each nested level of the lists may correspond to a nesting index position. For example, level 1 may corresponds to subdomain/boundary, level 2 may correspond to a solution component or physical quantity, and level 3 may correspond to the space coordinate. Level 4 may be a value level, where the actual expressions are stored. In connection with forming coefficients for each application mode selected, input data, as may be obtained in connection with previously described GUIs, may be converted to PDE format. Coefficients may be formed as part of this process. Data for each application mode may be stored in fields of the appl{i} data structure subfields dim, form, equ, bnd, and init.</p>
  <p num="p-0167">For the combined or multiphysics, referring back to fields of the data structure <b>250</b> described in more detail elsewhere herein, the following list provides the position in the data structure <b>250</b> for the combined system of PDEs and boundary conditions with regard to those elements referenced, for example, in <figref idrefs="DRAWINGS">FIG. 8</figref>: d<sub>a</sub>: equ.da, c: equ.c, : equ.al, . equ.ga, . equ.be, a: equ.a, f: equ.f, q: bnd.q, g: bnd.g, h: bnd.h, r: bnd.r.</p>
  <p num="p-0168">The general form coefficients, for example as described in connection with <figref idrefs="DRAWINGS">FIG. 9</figref> and <figref idrefs="DRAWINGS">FIG. 11</figref> in more detail elsewhere herein, , F, G are R may be stored in the equ.ga, equ.f, bnd.q, and bnd.r fields, respectively. A uniform format may be used for each of these coefficients. Subdomains and boundaries may be merged into groups where the expressions for the PDEs and boundary conditions are the same.</p>
  <p num="p-0169">A subfield equ.ind of field <b>258</b> may be a vector with length equal to the number of subdomains. For each subdomain, the corresponding entry designates a subdomain group or 0 for no group. Similarly the field bnd.ind has the corresponding meaning for boundaries. When the ind field is not given, each subdomain or boundary form a separate group.</p>
  <p num="p-0170">The data structure field fem.border <b>262</b> controls if assembly of boundary conditions are performed on borders. In one embodiment, this may be implemented as one or more boolean conditions each representing two states: on and off. Setting fem.border <b>262</b> to off (default) turns off assembly on borders, and setting fem.border to on turns on assembly on borders. An embodiment may implement fem.border <b>262</b> as an array of text strings with either on or off conditions specified, or a vector of logical values. The length of the array or the vector may be equal to the number of dependent variables. A border for a given dependent variable has that variable activated by fem.usage on each side.</p>
  <p num="p-0171">What will now be described are formal rules of one embodiment for determining coefficients at varying levels. Given a PDE or boundary coefficient P1 with L subdomains/boundary groups and N solution components, n space coordinates, with a varying number of levels, such as 1-4 having corresponding coefficient leveling notation P1-P4, respectively, the formal rules for coding the coefficients at varying levels in one embodiment may be represented as:</p>
  <p num="p-0172">Level 1 (subdomain/boundary level): If PI is a cell array then each element of P1 is a P2, otherwise P1 is a single P2. The number of P2s in P1 is either 1 or L.</p>
  <p num="p-0173">Level 2 (solution component level): If P2 is a cell array then each element of P2 is a P3, otherwise P2 is a single P3. If P2 is a d<sub>a</sub>, c, , , a, or q coefficient the number of P3s in P2 is 1, N, N(N+1)/2, or N<sup>2</sup>. If P2 is a , f or g coefficient the number of P3s in P2 is 1 or N. If P2 is an h coefficient the number of P3s in P2 is 1 or MN, where M is an integer between 0 and N, representing the number of constraints. If P2 is an r coefficient the number of P3s in P2 is M.</p>
  <p num="p-0174">Level 3 (space-coordinate level): If P3 is a cell array then each element of P3 is a P4, otherwise P3 is a single P4. If P3 is a c coefficient, then the number of P4s in P3 is 1, n, n(n+1)/2, or n<sup>2</sup>. If P3 is an a, f, q, g, h, r, or da coefficient, there is one P4. If P3 is an , (, or  coefficient, there are n P4s.</p>
  <p num="p-0175">Level 4 (value level): A single item including a symbolic text expression for computing PDE coefficient values. The expression may be evaluated where the variables xi, sd, ui, uixj, and h correspond, respectively, to representing the ith coordinate, subdomain label, ith solution component, jth derivative of the ith solution, and the local element size. ui and xj may refer to the variable names defined by fem.dim <b>256</b> and fem.sdim (independent variable names or space coordinate names), respectively. It should be noted that fem.sdim may be an additional field included in the portion <b>270</b> of data structure <b>250</b> in an embodiment.</p>
  <p num="p-0176">What will now be described is one embodiment of a method for converting application mode physical properties on subdomains and boundaries into a PDE form, either general or coefficient. In other words, once data is input and stored in the structure <b>250</b>, this data may be expanded or transformed into another form used in subsequent processing steps. In other words, the following may be used in connection with converting GUI data into PDE format for each application mode.</p>
  <p num="p-0177">It should be noted that in the following example, the GUI or input data is stored in a temporary or tmp structure for each application mode. The combined system of PDEs may be formed using as input each of the tmp structure for each application mode. An embodiment may store a representation of the combined PDE system in the fem structure as described in more detail elsewhere herein.</p>
  <p num="p-0178">The application mode properties in the fields equ and bnd in the-appl{i} structure are rewritten as symbolic expressions by using an application mode dependent set of transformation rules, e.g., for heat transfer:</p>
  <p num="h-0007">tmp{i}.equ.c{j}=appl{i}.equ,k{j};</p>
  <p num="h-0008">tmp{i}.equ.a{j}=appl{i}.equ.htrans{j};</p>
  <p num="h-0009">tmp{i}.equ.f{j}=appl{i}.equ.Q+appl{i}.equ.Text{j}+</p>
  <p num="p-0179">appl{i}.equ.Camb{j}*(appl{i}.equ.Tambtrans{j}^4appl{i}.dim^4)</p>
  <p num="h-0010">tmp{i}.equ.da{j}=appl{i}.equ.rho*appl{i}.equ.C{j}</p>
  <p num="h-0011">by looping over the subdomain index j. The field appl {i} .dim is the physical quantity, the temperature. Similarly the boundary subdomain properties are rewritten by the rules:</p>
  <p num="h-0012">tmp{i}.bnd.q{j}=appl{i}.bnd.h{j};</p>
  <p num="h-0013">tmp{i}.bnd.g{j}=appl{i}.bnd.q{j}+appl{i}.bnd.h{j}*appl{i}.bnd.Tinf{j}+</p>
  <p num="p-0180">appl{i}.bnd.Const{j}*(appl{i}.bnd.Tamb{j}^4appl{i}.dim.^4);</p>
  <p num="h-0014">when the type is QG and as</p>
  <p num="h-0015">tmp{i}.bnd.h{j}=1;</p>
  <p num="h-0016">tmp {i}.bnd.r{j}=appl{i}.bnd.T{j};</p>
  <p num="h-0017">when type is T. The remaining type cases, QG0 and T0, are simple cases of the above cases, where all left hand side terms are zero, except the bnd {i} *h term.</p>
  <p num="p-0181">It should be noted that the foregoing rules to produce symbolic expression may vary with application mode. For example, the foregoing rules may be used in connection with forming coefficients for heat transfer application mode. As known to those of ordinary skill in the art, the techniques may be applied to forming coefficients for other application modes. It should be noted that functionality associated with the above description is included in one embodiment as a function appl2fem as described in the FEMLAB V1.1 Reference Manual from Comsol AB, 1999.</p>
  <p num="p-0182">The foregoing maybe performed for each of the application modes, i, to expand or transform data into PDE form data included in the application mode structure tmp {i}. This structure tmp {i} includes a representation of the physical properties as instances of the PDE formulae of <figref idrefs="DRAWINGS">FIG. 8</figref> or <figref idrefs="DRAWINGS">FIG. 9</figref>.</p>
  <p num="p-0183">The fields usage and border for the tmp data structure may be copied from the corresponding fields in the data structure <b>250</b>. The field dim <b>256</b> may be updated with another variable name, and introduce a relation between the physical quantity and the dependent variables, and introducing this relation when the equ and bnd fields are transformed into the tmp structure.</p>
  <p num="p-0184">The submode setting described elsewhere herein in more detail, for example, in connection with <figref idrefs="DRAWINGS">FIG. 3</figref>, may be used in determining the number of variables. The submode setting may be used to distinguish between a stationary and time-dependent problem. In certain application modes, such as structural mechanics, the number of dependent variables in the application mode may vary in accordance with a submode setting or selection. For example, PDE formulation as described in connection with <figref idrefs="DRAWINGS">FIG. 8</figref> does not provide for a second order time derivative. Thus, for example, in application modes related to structural mechanics, where the displacements are the dependent variables, it may be desirous to add the velocities of the displacements as dependent variables in addition to the displacements. Thus the application mode describing the system may include twice the number of variables for the time-dependent subdomain than for the stationary.</p>
  <p num="p-0185">What has just been described are processing steps that may be included in an embodiment in connection with expanding or converting input data, as using the GUIs, into a PDE form, such as general or coefficient.</p>
  <p num="p-0186">An embodiment may continue by merging the formulae associated with a plurality of application modes and PDEs into a single system of combined PDEs. Appending the subsystems in the order they are specified in each of the fem.appl <b>254</b> creates the composite system. In one embodiment, the affected fields in the data structure <b>250</b> structure may include dim <b>256</b>, form (additional field in area <b>270</b> indicating problem form as general or coefficient in this example), equ <b>258</b>, bnd <b>260</b>, border <b>262</b>, and usage <b>264</b>.</p>
  <p num="p-0187">The dim field <b>256</b> of the composite system may be obtained by concatenating the dim field lists from each of the application modes appl {i} <b>254</b>. The default form of the composite system is the most general faun of the subsystems, where general is the most general form, and coefficient is the least general form.</p>
  <p num="p-0188">The conversion of a PDE in coefficient form to general form is described elsewhere herein. The output form may be forced to general form by forcing the conversion also if none of the appl{i} application modes are specified in general form. A value may be stored in an additional field that may be included in an embodiment of the data structure <b>250</b>, such as an additional field in the area <b>270</b>, indicating the type of problem form, for example, as one of general or coefficient in this embodiment.</p>
  <p num="p-0189">The equ <b>258</b> and bnd <b>260</b> fields in the data structure <b>250</b> may be determined using corresponding fields appl{i) in the application modes, after each application structure has been converted to the representation of the PDEs, and the desired output form, according to <figref idrefs="DRAWINGS">FIG. 11</figref>. The coefficients in the second row may be deemed weakly coupled in the sense that the corresponding coefficients in the composite system are block diagonal. This may limit the coupling between the subsystems. By using general form, however, there are no limitations on the composite system. In this embodiment, the border field <b>262</b> in the data structure <b>250</b> may indicate a list of on/off, one for each solution component. The usage field <b>264</b> may be determined using the usage matrices, such as <b>254</b> <i>e </i>of each subsystems, by concatenating usage lists as rows in a matrix.</p>
  <p num="p-0190">Thus, one technique for combining PDEs may be represented by the following pseudocode-like description:</p>
  <p num="p-0191">
    <tables id="TABLE-US-00003" num="00003"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">Gpos=0;</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">for i=1 to Nappl</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">j=Ndim(i);</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">for k=1 to Nsub</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.da{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.equ.da{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.c{k}(gpos+(1:j),gpos+(1:j))tmp{i}.equ.c{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.al{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.equ.al{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.ga{k}(gpos+(1:j))=tmp{i}.equ.ga{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.be{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.equ.be{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.a{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.equ.a{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.equ.f{k}(gpos+(1:j))=tmp{i}.equ.f{k};</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">end</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="203pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">for k=1 to Nbnd</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.bnd.q{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.bnd.q{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.bnd.g{k}(gpos+(1:j))=tmp{i}.bnd.g{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.bnd.h{k}(gpos+(1:j),gpos+(1:j))=tmp{i}.bnd.h{k};</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.bnd.r{k}(gpos+(1:j))=tmp{i}.bnd.r{k};</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">end</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="175pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.border(gpos+(1:j))=tmp.border(1:j);</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">fem.usage(gpos+(1:j)=tmp.usage(gpos+(1:j));</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">gpos=gpos+j;</td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="189pt" align="left"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">end</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="1" align="center" rowsep="1" class="description-td" colspan="2"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0192">In the above description, the Nsub denotes the number of subdomains in the geometry, Nappl denotes the number of application modes, and Nbnd denotes the number of boundaries. Ndim(i) is the number of dependent variables of the application mode.</p>
  <p num="p-0193">The result of performing the foregoing is the data representation of the system of PDEs corresponding to the full multiphysics system of the combined PDEs for the selected application modes. In an embodiment, the above procedure is documented as function multiphysics in the FEMLAB V1.1 Reference Manual.</p>
  <p num="p-0194">It should be noted that if the systems represented in the structure tmp{i} are converted to general form, the foregoing pseudocode description may be applied to the coefficients, for example, as represented by ga (corresponding to gamma), f, g, r.</p>
  <p num="p-0195">An embodiment may include storing the data for the PDEs and boundary conditions for each application mode in a more compact format using, for example, the ind field in appl{i).equ and appl{i}.bnd. In one embodiment, as also described elsewhere herein, the ind fields may be implemented each as a vector with length equal to the number of subdomains or boundaries. For each subdomain, the corresponding entry designates a domain group or 0 for no group. Similarly the field bnd.ind has the corresponding meaning for boundaries. When the ind field is not given, each subdomain or boundary forms a separate group. It should be noted that when using this compact format representation feature and the appl{i}.equ.ind or appl{i}.bnd.ind fields are different for the selected application modes, the ind fields may also be merged or combined into the ind fields in fem.equ.ind (subfield of <b>258</b>) and fem.bnd.ind (subfield of <b>260</b>). These fields may have a minimal common set of subdomain or boundary groups. This may be determined, for example, by jointly sorting the groups in the application modes and removing duplicates.</p>
  <p num="p-0196">In one embodiment, the solution procedure uses the Finite Element Method (FEM) to solve the system of PDEs in coefficient and general form, for example, as represented in <figref idrefs="DRAWINGS">FIGS. 8 and 9</figref>. This is described, for example, in The Mathematical Theory of Finite Element Methods, S. C. Brenner, L. R. Scott, Springer-Verlag, ISBN 3-540-94193-2. This is a well-known procedure, but has been adapted to specifically fit a particular context of one embodiment. In this embodiment, the first equation in <figref idrefs="DRAWINGS">FIG. 8</figref>, element <b>142</b>, and the first equation in <figref idrefs="DRAWINGS">FIG. 9</figref>, element <b>152</b>, may be multiplied with an arbitrary test function , and integrated over the domain , such as integrated by parts, for example, using Green's formula. The boundary integral may be replaced using the Neumann boundary condition. Furthermore, the Dirichlet boundary condition may be multiplied by an arbitrary test function  and integrated on the boundary, and obtain the variational formulation of the full problem: Find u<sub>k </sub>and <sub>m </sub>such that for all , m, l=1, . . . , N, and m=1, . . . , M the equations in <figref idrefs="DRAWINGS">FIG. 12</figref> and <figref idrefs="DRAWINGS">FIG. 13</figref> hold, for coefficient and general form, respectively.</p>
  <p num="p-0197">As described in connection with one embodiment, the PDE system to be solved may be passed to a solver algorithm for PDEs that uses the finite element method. In addition to the data structure <b>250</b> that may include the representation of the PDEs, two sets of constraint matrices may be used and are referred to and described in more detail elsewhere herein in connection with particular features that may be included in an embodiment.</p>
  <p num="p-0198">The finite-dimensional function space is the set of piecewise linear functions on a triangulation  of the domain . u and  may be approximated, for example, using the formulae <b>304</b> of <figref idrefs="DRAWINGS">FIG. 14</figref>, where <sub>l</sub>, is linear on each element, continuous, and 0 on all node points in the triangulation except the node point I. <sub>K,L </sub>is a delta function at a vertex L on a boundary element K.</p>
  <p num="p-0199">By using the test functions <sub>J </sub>and <sub>K,L </sub>on the weak form of the PDE in coefficient form, it may be determined that the formulae <b>306</b> of <figref idrefs="DRAWINGS">FIG. 15</figref> applies for all J and l, and that the formula <b>308</b> of <figref idrefs="DRAWINGS">FIG. 16</figref> apply for all K, L, and m. The finite element discretization represented by <b>310</b> of <figref idrefs="DRAWINGS">FIG. 18</figref> may be determined. It should be noted that the integrals as included in the formulae <b>310</b> of <figref idrefs="DRAWINGS">FIG. 18</figref> may be computed using a Gauss quadrature within each element. The formula corresponding to those of <b>306</b> of <figref idrefs="DRAWINGS">FIG. 15 and 308</figref> of <figref idrefs="DRAWINGS">FIG. 16</figref> for general form may be represented as in formulae <b>312</b> of <figref idrefs="DRAWINGS">FIG. 17</figref>.</p>
  <p num="p-0200">With reference to the data structure <b>250</b> described elsewhere herein, when the integrals in <b>310</b> of <figref idrefs="DRAWINGS">FIG. 18</figref> are computed, the initial value in fem.init <b>266</b> may be used as values for the solution when it occurs in the expressions in the PDE coefficients and boundary conditions.</p>
  <p num="p-0201">By numerically computing the matrices according to the foregoing formulae, the systems of equations represented in <figref idrefs="DRAWINGS">FIG. 19</figref> and <figref idrefs="DRAWINGS">FIG. 20</figref> may be determined. In particular, referring to <figref idrefs="DRAWINGS">FIG. 19</figref>, shown are formulae <b>320</b> in coefficient form, and referring to <figref idrefs="DRAWINGS">FIG. 20</figref>, shown are formulae <b>322</b> in general form, in which C, AL, BE, A, and Q are N<sub>P</sub>N-by-N<sub>P</sub>N matrices, and F, GA, and G are N<sub>P</sub>N vectors. H is a N<sub>e</sub>nM-by-N<sub>P</sub>N matrix and R is a N<sub>e</sub>nM vector. The DA matrix is used in time-dependent and eigenvalue problems. When these matrices are produced, the first index in the index list in <figref idrefs="DRAWINGS">FIG. 18</figref> is expanded first.</p>
  <p num="p-0202">Linear solvers, nonlinear solvers, time-dependent solvers and eigenvalue solvers may be used in solving systems of PDEs of <figref idrefs="DRAWINGS">FIG. 19</figref> in coefficient form, and PDEs of <figref idrefs="DRAWINGS">FIG. 20</figref> in general form. Such solvers, or solving techniques, are generally known in the numeric literature, for example, such as in Numerical Methods, G. Dahlquist,  Bjrk, Prentice Hall, 1974, ISBN 0-13-627315. In one embodiment, a technique may be used to generate the Jacobian for nonlinear solvers and for solvers of time-dependent problems. This technique may be used in systems in general form, or PDE systems that have been converted from coefficient form to general form, for example as described in connection with the formulae <b>240</b> of <figref idrefs="DRAWINGS">FIG. 11</figref>.</p>
  <p num="p-0203">It should be noted that use of PDEs in general form may be used to more efficiently provide PDE solutions in solving for non-linear systems of equations. One technique, as described elsewhere herein in more detail, may utilize the general form to derive a Jacobian. This may be more efficient than using the coefficient form for solving for non-linear systems. Using this general form to derive the Jacobian, the Newton method may then be used. <figref idrefs="DRAWINGS">FIG. 10</figref> shows an iteration of using the Newton method.</p>
  <p num="p-0204">For the combined system or multiphysics, the solution may be stored in the field fem.sol <b>268</b> of the data structure <b>250</b>. In one embodiment, the solution field <b>268</b> may represent the solution to a PDE system as a vector having the same number of elements as the corresponding U. Similarly fem.init <b>266</b> may include the initial value for the nonlinear and time-dependent solvers. For time-dependent solutions, there may be several columns in fem.sol <b>268</b>, one for each point in time.</p>
  <p num="p-0205">In one embodiment, nonlinear equations in general form may be solved by Newton iterations.</p>
  <p num="p-0206">Referring now to <figref idrefs="DRAWINGS">FIG. 11</figref>, shown is an example of the formulae that may be used in an embodiment in converting from coefficient to general form of the PDEs. The conversion from coefficient to general form may be performed on the app{i} structure for each application mode separately in accordance with the form desired, for example, as may vary in accordance with equation or system type. For example, if a system being solved is in coefficient form and it is a non-linear system, it may be desired to convert from the coefficient form to general form using the formulae <b>240</b> of <figref idrefs="DRAWINGS">FIG. 11</figref> in conjunction with the other formulae <b>140</b> for coefficient form to produce a system of PDEs of the general form, such as those represented by the formulae <b>150</b> of <figref idrefs="DRAWINGS">FIG. 9</figref>. This conversion may also be performed in accordance with a user selected or specified mode, for example, as may be included in an embodiment. Other embodiments may perform this conversion from coefficient to general form in connection with other function that may be included and vary with implementation.</p>
  <p num="p-0207">The formulae <b>240</b> of <figref idrefs="DRAWINGS">FIG. 11</figref> may be used to derive , F, G, and R from d<sub>a</sub>, c, a, ,  a, f q, g, h, and r as included in the formulae <b>140</b> of <figref idrefs="DRAWINGS">FIG. 8</figref>. This may be performed, for example, as by symbolic manipulation of the mathematical expressions.</p>
  <p num="p-0208">The discretization by the finite element method, given a nonlinear system of equations in as in the general form of <figref idrefs="DRAWINGS">FIG. 20</figref>, may be viewed as the problem p(U)=0, where U is the vector of unknown coefficients of the finite element solution to the PDE problem. In this instance, DA=0 since this problem is stationary. The LaGrange multipliers, , may be considered auxiliary values =(U) which may be assumed to be eliminated. For the solution of the discretized system, an affine invariant form of the dampened Newton method may be applied: Given an initial guess, U<sup>(O)</sup>; a sequence of iterates U<sup>(k) </sup>is computed by the iteration formula <b>326</b> in <figref idrefs="DRAWINGS">FIG. 21</figref>, where J(U)=p(U)/U, and <sub>k</sub>(0; 1] denotes a damping factor.</p>
  <p num="p-0209">Subsequently solving for U<sup>(k) </sup>above may utilize the solution of a linear system of equations. If J(U) is chosen as the exact Jacobian, the iteration formula above may be interpreted as the finite element discretization of a linearized equations in coefficient form by applying the settings in <b>324</b> of <figref idrefs="DRAWINGS">FIG. 10</figref>. The coefficients in the coefficient form PDE may be formed as symbolic derivatives of the coefficients in the general form PDE with respect to the solution, and its gradient.</p>
  <p num="p-0210">It should be noted that the Active in this subdomain feature for selective inclusion or variation of a variable in a system, may be implemented in one embodiment by adding a constraint to the H and R matrices to not-a-number in IEEE arithmetic. One row containing the constraint may be added to H and R for each node point in the deactivated subdomains and dependent variables.</p>
  <p num="p-0211">It should also be noted that when the system of PDEs is assembled, for example, according to <figref idrefs="DRAWINGS">FIG. 18</figref>, the variables not to solved for may be used in the expressions for PDE coefficients and boundary conditions. In one embodiment, the solve for variable feature may be implemented by adding a constraint to the H and R matrices that constrains the solution in the node points the value of the previous solution in the same point, one row containing the constraint is added to H and R for each node point and dependent variable.</p>
  <p num="p-0212">The foregoing description may be used in forming a multiphysics model and solving for selected variables. Steps of one embodiment may be summarized in the form of a flowchart and accompanying description.</p>
  <p num="p-0213">Referring now to <figref idrefs="DRAWINGS">FIG. 22</figref> and <figref idrefs="DRAWINGS">FIG. 23</figref>, shown is an example of an embodiment of a flowchart of steps of one method for automatically specifying one or more systems of PDEs, representing them in a single combined form, and solving a system of PDEs. At step <b>210</b>, a first application mode is selected. It should be noted that each application mode corresponds to a particular system being modeled. The selection of one or more application modes may be performed, for example, in one embodiment using the GUI <b>30</b> of the previously described <figref idrefs="DRAWINGS">FIG. 3</figref>. At step <b>212</b>, a determination is made as to whether the processing steps formed by the loop at the top of step <b>212</b> are complete for all application modes. If a determination is made at step <b>212</b> that processing of all the applications modes selected at step <b>210</b>, control proceeds to flow point A. Otherwise, control proceeds to step <b>214</b>, where the physical properties associated as active with the current application mode are determined. The physical properties associated with an application mode may be selected, for example, in connection with GUI <b>60</b> of <figref idrefs="DRAWINGS">FIG. 4</figref>. Control proceeds to step <b>216</b>, where the boundary condition for the current application mode is determined. The boundary conditions may be determined, for example, using the GUI <b>70</b> of the previously described <figref idrefs="DRAWINGS">FIG. 5</figref>.</p>
  <p num="p-0214">Control proceeds to step <b>218</b>, where data structures are created and initialized using the physical properties and boundary conditions specified for the current application mode in connection with the processing, for example, of steps <b>214</b> and <b>216</b>. At step <b>220</b>, the coefficient PDEs may be formed using physical property and boundary data obtained in connection with steps <b>214</b> and <b>216</b>, and accordingly stored in the data structure created and initialized at step <b>218</b>. Recall, as previously described, that the PDE in coefficient view, or form, may be represented as described in connection with the formulae <b>140</b> of <figref idrefs="DRAWINGS">FIG. 8</figref>. Additionally, recall that a temporary data structure may also be used when forming the coefficients for each application mode. At step <b>222</b>, the general form of the PDE may also be formed. Accordingly, the data structure initially created at step <b>218</b> may be updated to include the information about the general form for the PDE system. It should be noted that the general PDE formed at step <b>222</b> may be as represented by the formulae <b>150</b> previously described in connection with <figref idrefs="DRAWINGS">FIG. 9</figref>. A temporary data structure may also be used in storing data for the coefficients formed in connection with processing of step <b>222</b>, similar to that as may be used in connection with step <b>220</b>.</p>
  <p num="p-0215">An embodiment may provide an option to allow for data entry, display and modification in coefficient form, general form, or both of these forms. If more than one is included in an embodiment, there may be a default, or a user selection option. Thus, processing associated with steps <b>220</b> and <b>222</b> may be optionally performed in accordance with what may be included in an embodiment, and may additionally be in accordance with a user selection. One embodiment provides for data entry, modification, and PDE solving associated with an application mode in either coefficient view or general form. Coefficient view may be selected for data entry and modification with the additional user input selection of producing general form, and solving PDEs using either form. If general form is selected for data entry without coefficient view, PDE solving may be performed, by default, using a system of equation in general form. As known to those of ordinary skill in the art, in accordance with the PDE system being solved, solving using the general form may be more efficient and desired over use of coefficient form. For example, in solving PDE systems for non-linear systems, use of the general form may be more efficient.</p>
  <p num="p-0216">At Step <b>224</b>, an embodiment may include, optionally, functionality to modify the boundary conditions and/or PDEs of the current application mode. It should be noted that if an embodiment includes the function of modifying a PDE for each application mode, the previously described locking mechanism may operate differently since PDEs may change per application mode.</p>
  <p num="p-0217">At step <b>226</b>, a next application mode may be selected. Control proceeds to step <b>212</b> where a determination is again made as to whether processing all the application modes is complete.</p>
  <p num="p-0218">When all the application modes are selected and done being processed in connection with the processing steps formed by the loop beginning with a decision at step <b>212</b>, control proceeds to flow point A, step <b>230</b>, where PDEs for all the previously entered application modes are combined, forming a combined PDE system. In other words, the result is a single PDE system representing the combination of all the previously described systems in connection with all the previously specified application modes. It should be noted that in one embodiment described in more detail elsewhere herein, data associated with the PDE of each application mode may be stored in a temporary structure for each application mode. At step <b>230</b>, in this instance, the temporary data structures may be used as input for producing the combined PDE system or multiphysics system of PDEs. At step <b>231</b>, an embodiment may optionally provide for modifying the combined PDE system, or other systems. Control proceeds to step <b>232</b>, where the PDEs, or variables associated with PDEs, may be solved. An embodiment may provide variations as to what variables or PDEs may be solved for in the processing of step <b>232</b>. One embodiment may allow the user to select solving for one of the PDEs associated with individual application modes, the combined PDE system, or variables from different PDEs. Control proceeds to step <b>234</b> where the processing of the flowchart <b>200</b> stops.</p>
  <p num="p-0219">What has just been described is the general processing of the overall system for automatically forming one or more sets of PDEs associated with one or more application modes or systems. These systems may be combined into a single, combined PDEs system. A programming module, such as the finite element solver that may be included in the Modeling and Simulation Module <b>222</b>, may solve a system of PDEs. The finite element solver, for example, may solve a single system of PDE corresponding to a single application mode, may solve for the combined PDE system, for example, as computed or determined in connection with the processing step <b>230</b>. An embodiment may also solve for one or more variables associated with one or more application mode using any one a variety of known solving techniques.</p>
  <p num="p-0220">What will now be described in more detail is how user defined application modes and user defined applications may be used in the foregoing system and with the techniques described herein. Generally, a user defined application mode in one embodiment may be an equivalent to a predefined application mode, such as heat transfer, described elsewhere herein. An application mode is distinguishable from an application. In this embodiment, an application may be associated with a user defined subclass from a class, for example, that may be associated with an application mode. An application may be defined by a user, for example, when it may be useful to create a specialized or narrower definition of an existing class corresponding to an application mode. In this way, routines and code common in more than an application may be shared since, fore example, in this embodiment, functionality of one or more applications (subclasses) may be inherited from an application mode.</p>
  <p num="p-0221">Alternatively, a user-defined application mode rather than a user defined application may be more appropriate, for example, when such functionality is not common or bears little or no relationship in functionality to an existing application mode.</p>
  <p num="p-0222">In one embodiment, an application mode may be predefined, such as Diffusion or Heat Transfer included in one embodiment of the software <b>19</b>, or user-defined. User-defined application modes may be created using an Application Program Interface (API), such as those described in the FEMLAB V1.1 Application Program Interface manual. In contrast to the user defined application mode is the user-defined application. A difference between the user-defined application mode and user-defined application is that a user-defined application may be much more specialized, for example, regarding the geometry, modeling, meshing and the GUI appearance. Use of the API allows users to add new functionality to FEMLAB or remove functionality in order to tailor software of an existing application mode to better fit a particular use as may be associated with a particular user-defined application.</p>
  <p num="p-0223">In one embodiment, a user may create and define a user-defined application mode and application. These may be created using classes and subclasses in connection with an object oriented approach in which use of objects and classes allows for the addition of new data types and operations, for example, as may be implemented using MATLAB. The operations and functions that operate on class objects are known as methods collected together in a class directory. The class directory includes a constructor for that class. Generally, a predefined application mode, such as one for heat transfer, may be created as a class. A user defined application may be defined as a subclass of one of these classes. In this manner, the functionality of an existing application mode may be inherited by a new user defined application with additionally having some or all of its functionality overloaded by a subclass allowing for a user to create an application with desired behavior. An application mode may also be defined a the same level as the predefined application modes, such as heat transfer. These user defined application modes may have the same status and use as the predefined application modes. In particular, both predefined and user defined application modes may be used as one of the application modes, for example, when forming a combined multiphysics system as described in more detail elsewhere herein.</p>
  <p num="p-0224">An application mode may be created as a class. These classes may be represented in a hierarchical structure. There are a set of base classes at the top of a hierarchy containing the main functionality. The application modes may inherit from base classes, sometimes through convenient intermediate classes that may include methods defining functionality common to several application modes. An example of the class hierarchy may be found in <figref idrefs="DRAWINGS">FIG. 24</figref>, element <b>500</b>, as described in more detail elsewhere herein. An application mode may be created by defining parameters on the boundary and the inner domain that will define the equations to be solved, and how to specify these parameters in the GUI. For more streamlined design of the application modes, the available solvers and the initial conditions, post processing expressions, and name of dependent and independent variables may also be modified.</p>
  <p num="p-0225">An application mode has a constructor, for example, such as in connection with <figref idrefs="DRAWINGS">FIG. 28</figref> described in more detail elsewhere herein. The information for an application mode may be stored in the application mode object and in the fem.appl-structure also described elsewhere herein. Table <b>510</b> of <figref idrefs="DRAWINGS">FIG. 27</figref> includes properties that may be included in one embodiment of an application mode object. These properties are either inherited from the parent objects, or may also be set explicitly. Table <b>514</b> of <figref idrefs="DRAWINGS">FIG. 29</figref> includes a listing of the methods that may exist either directly in the application mode class, or in any of the parent classes. The column to the right in this table <b>514</b> describes what the methods do.</p>
  <p num="p-0226">Additionally, a set of methods may be used by the GUI to set up solvers and dialog boxes as well as submodes for the application modes. In one embodiment, these methods are:</p>
  <p num="p-0227"> <tables id="TABLE-US-00004" num="00004"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="42pt" align="left"> </colspec> <colspec colname="2" colwidth="175pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">bndinfo</td> <td class="description-td">sets up boundary conditions dialog box</td> </tr> <tr class="description-tr"> <td class="description-td">equinfo</td> <td class="description-td">sets up PDE coefficients dialog box</td> </tr> <tr class="description-tr"> <td class="description-td">pdeinfo</td> <td class="description-td">contains info about available solvers, solution forms, and</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">submodes</td> </tr> <tr class="description-tr"> <td class="description-td">sub_conv</td> <td class="description-td">gives the relation between old and new variables when</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">changing submode</td> </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Other important methods are the set and get methods that allows for setting and getting of the application mode object properties.
</p>
  <p num="p-0228">In one embodiment, to define a user-defined application mode, a minimum set of definitions and routines or methods are defined. These include the constructor, appspec, bnd_compute, and equ_compute. appspec is a routine for defining the parameters used in the interior and on the boundaries. Routines equ_compute and bnd_compute define how to set up the equations based on this information from appspec.</p>
  <p num="p-0229">In order to use the application mode from the GUI the equinfo and bndinfo methods may be implemented in the application mode class. These methods define how to set up the dialog 10 boxes in the GUI for specifying the parameters. In contrast to a user-defined application mode is a user-defined application. In the user-defined application, for example, overloading may be performed of some or all of the above methods, in addition to the methods for setting up the GUI, for example, such as fldrawmode, flboundmode, flpdemode, flmeshmode, flsolvemode, flplotmode in connection with set up some of the menus and toolbars for draw, boundary, PDE, mesh, solve and plotmode, respectively.</p>
  <p num="p-0230">Referring now to <figref idrefs="DRAWINGS">FIG. 24</figref>, shown is an example of a class structure that may be included in an embodiment in which a user may define application modes. At the base of the class structure is the class flbase to facilitate overloading of generally provided functionality that may be included in an embodiment. The application mode object structure may divide the application mode objects in accordance with two particular criteria: geometry dimension and application modes. For geometry dimension, there are two geometry dimension dependent base classes fld<b>1</b> and fld<b>2</b> in which methods may implement dimension dependent functionality, such as draw mode menus, toolbars, mesh drawings, and the like. For application modes, there are three application module base classes of: flpde, which is the parent of all application modes, flsme and flcem which are other classes that may be defined in accordance with other modules and associated functionalities. In flpde, all functionality may reside that is common to all application modes and that is also not dependent on geometry dimension. All application modes may be implemented as subclasses to this class. Additional application-dependent classes may be added to support new applications. They may, for example, be implemented as subclasses of flpde or another application mode. In these class directories, methods that implement application dependent functionality, such as specific dialogue box information, and the like may reside. Referring to the structure of the hierarchy illustrated in <b>500</b>, the application dependent classes take precedence over the geometry dimension classes which also take precedence over the application module class so that, for example, a mesh drawing method in the flpde class may be overridden by the generic 2-D mesh drawing method. Note that the structure <b>500</b> may be only a portion of the entire class structure included in an embodiment.</p>
  <p num="p-0231">Together with methods, the application objects may define specific properties and behaviors that define an application in the GUI. Referring to <figref idrefs="DRAWINGS">FIG. 25</figref>, shown are sample 1-D (one-dimensional) application modes <b>502</b> and <b>503</b>. In combination, these two tables may define all predefined application modes included in one embodiment. All 1-D application objects inherit from the application module base class flpde and the geometry class fl<b>1</b> <i>d. </i> </p>
  <p num="p-0232">Referring now to <figref idrefs="DRAWINGS">FIG. 26</figref>, shown are 2-D (two dimensional) application modes that may be defined in an embodiment. The application modes defined in <b>506</b> and <b>508</b> may include all application modes for 2-D application mode objects. All 2-D application mode objects may inherit from the application module base class flpde and the geometry base class fl<b>2</b> <i>d</i>. All of these classes are subclasses of fl<b>2</b> <i>d </i>and an application mode class. The application mode classes, in turn, are subclasses of flpdec or flpdeg that represent the coefficient and general PDE form, respectively. Note that the PDE mode classes flpdec<b>1</b>, flpdeg<b>1</b> <i>d</i>, flpdec<b>2</b> <i>d </i>and flpdeg<b>2</b> <i>g </i>all accept the number of dependent variables as an input argument thus enabling the creation of PDE modes with an arbitrary number of dependent variables. Calling the constructor function without a dimension argument results in a scalar application mode object.</p>
  <p num="p-0233">Referring now to <figref idrefs="DRAWINGS">FIG. 27</figref>, shown is an example of properties of one embodiment of an application object. Table <b>510</b> describes various properties of application objects. Parent is string containing the name of the object class parent. The dim, name and parent properties are initialized explicitly using the application class constructor. Other fields may be inherited by the parent class but may also be initialized using the constructor.</p>
  <p num="p-0234">In one embodiment, the application being defined by a user may be a subclass to one of the application mode classes. In one example, suppose a user wants to define a new application, myapp, based on the 2-D heat transfer mode flpdeht<b>2</b> <i>d</i>. A subdirectory may be created in a MATLAB path called @myapp. An example of a constructor may look as in the code snippet <b>512</b> of <figref idrefs="DRAWINGS">FIG. 28</figref>. In this example, the settings for submode, form, tdiff and sdim are from the parent class flpdeht<b>2</b> <i>d</i>. The dim property is explicitly set to be default as may be defined by the method default_dim.</p>
  <p num="p-0235">In this embodiment that may use MATLAB, the behavior of MATLAB operators and functions for object arguments may be changed by overloading the relevant functions. This may be accomplished by defining a replacement method with the appropriate name residing in the new class directory at the application level. A user may minimize the number of overloaded methods in an application class being defined by a user by choosing the most appropriate application mode as its parent class. By using the overloading functionality, parts of an existing application may be modified to create application dependent functionality. For example, portions of a GUI, including menus, toolbars, and the like, may be modified to better fit an application as well as methods for overloading the equation definitions.</p>
  <p num="p-0236">One embodiment may include a set of methods to provide a portion of the functionality. Referring now to <figref idrefs="DRAWINGS">FIG. 29</figref>, shown is an example of an embodiment of a portion of functions that may be included in one embodiment. The functions <b>514</b> may determine the variables and equations defining a problem. As described in more detail elsewhere herein, it should be noted that the appl field of the fem structure includes application dependent data. Appl is a cell array that contains more than one application mode for multiphysics problems. The foregoing methods may work in connection with a GUI and from the command line. The conversion from the application mode structure in the appl field(s) may be performed by invoking a function called the multiphysics function, which in turn uses another function to compute the equ, bnd, init, dim, usage, border, var, and form fields.</p>
  <p num="p-0237">API functions may be included in an embodiment, for example, to allow for adding menus and toolbars to the existing GUI. Additionally, overloading methods may be used, for example, to disable certain functionality associated with a method or provide for an alternative.</p>
  <p num="p-0238">Referring now to <figref idrefs="DRAWINGS">FIG. 30</figref>, shown is an example of a GUI that may be used in connection with adding an application to the existing GUI. Using the New tab in the GUI <b>520</b>, a user may browse through the applications. The procedure of adding a new user-defined application may be performed using an API function, for example, fladdappl. Using such an API, an application may be added to the application tree and, optionally, associated text and figure. The description and figure may be displayed when the user defined application is selected. For example, the GUI <b>520</b> has a user defined application of IN-PLANE WAVE GUIDE selected in <b>522</b>. Accordingly, an associated image is displayed in <b>524</b> and text in <b>526</b>.</p>
  <p num="p-0239">What will now be described is another example of a user-defined application for modeling transmission signals with frequencies in the microwave range, for example, as may be used in the telecom industry. The waves are transmitted through a waveguide with a rectangular cross section. If the wave is bent, the elbow may cause scattering effects preventing the wave from being transmitted through the waveguide. In the following model, a TE wave is modeled in which there is no electric field in the direction of propagation. The dimension of the waveguide and frequency are chosen so that the only mode that can propagate is the TE10 mode, that is where the electric field has only one non-zero component that is sinusoidal and vanishes at the walls of the waveguide.</p>
  <p num="p-0240">A waveguide may be designed to transmit only frequencies in a narrow band. This band-pass effect may be achieved using a resonance cavity formed by putting conducting posts protruding into the waveguide. The posts may be, for example, metal screws or tuning screws. Equations used to calculate effects may be derived from the wave equation. Time may be eliminated assuming a harmonic planar wave resulting in Helmholtz equation for non-zero electric field component as represented by equation <b>530</b> in <figref idrefs="DRAWINGS">FIG. 31</figref> in which k is the wave number in the propagating direction. The relation between the wave number k and the frequency f and wavelength <b>8</b> is represented by equation <b>532</b> in which c denotes the speed of light.</p>
  <p num="p-0241">In this instance, there are three kinds of boundary conditions in the model. At the entrance boundary in which there is a vertical line at x=0, there is an absorbing condition with an incoming sinusoidal wave as in equation <b>534</b>. The right hand side of <b>534</b> is the driving force of the incoming wave. d is the width of the waveguide and yo is the y coordinate of the lower left corner of the waveguide. The wave number depends on the wave number in the direction of propagation ky as in <b>536</b>. <b>536</b> may be derived from solving analytically for a straight waveguide the wave number in the transversal direction may be defined by twice the width of the waveguide. This results in the final expression for the wave number in the propagating direction as a function of the incoming wavelength and width of the waveguide according to <b>538</b>. At the exit boundary there is an absorbing condition represented as <b>540</b> and the walls are assumed to be perfect conductors so that the tangential component of E vanished as in <b>542</b>. The velocity of light may be calculated from the material parameters and the wavelength is calculated from the frequency and velocity. The cut-off frequency may be calculated from the analytical solution of a straight waveguide as in <b>544</b>. No waves below this frequency are transmitted through the waveguide.</p>
  <p num="p-0242">Using the foregoing waveguide and techniques disclosed herein, the foregoing complexity may be hidden using a GUI. A feature called frequency analysis may be implemented in connection with the waveguide application. What will now be described is an overview of how this may be implemented in one embodiment.</p>
  <p num="p-0243">The draw mode for this feature may be implemented using overloading to implement an alternative draw menu and corresponding toolbar buttons. Toolbar icons may be stored in the application class directory as bitmaps. In this example, the draw menu is an alternate menu that includes 5 items: draw mode, straight waveguide, elbow waveguide, geometry parameters and the standard draw menu item Properties. The draw toolbar contains the toolbar buttons straight waveguide, elbow waveguide and geometry parameters. In connection with each of the waveguides, a corresponding figure or image may appear in the GUI. Parameters may be varied in accordance with each of the waveguides by overloading existing methods, for example, by overloading an existing method objdlg in which the geometry is parameterized and the parameters may be stored in a user defined portion of the fem structure on creation. It should be noted that this is a portion of memory allocated for use by the user and not used in this example by the existing methods. Additionally, other functionality may be disabled using overloading, such as to disable importing geometries and cut and paste functionality.</p>
  <p num="p-0244">Boundary conditions are hardwired according to the equations depending on parameters, for example, as may be defined in the PDE specification GUI. The Boundary menu and related mode buttons may be completely removed using overloading of existing methods. Existing methods are used to define the boundary conditions. Some of the standard PDE mode menu items are removed by overloading the existing method(s). The mesh mode remains the same. Similarly, other modes that are defined and there GUIs, toolbars and the like, may be used and techniques, such as overloading, may be used to implement these as may be desired in accordance with this example and others.</p>
  <p num="p-0245">In connection with the waveguide, due to the conversion of time-dependent PDE to a harmonic wave equation, the existing application mode AC Power Electromagnetics mode may be used. The new waveguide application being defined may be implemented, for example, as a subclass to its class, @flpdeac. the waveguide class, named @flwaveguide, may be created on the same directory level as the parent class @flpdeac. An example class constructor is included in <b>550</b> of <figref idrefs="DRAWINGS">FIG. 32</figref>.</p>
  <p num="p-0246">Parameters of the waveguide may be specified as in <b>552</b> of <figref idrefs="DRAWINGS">FIG. 33 and 554</figref> of <figref idrefs="DRAWINGS">FIG. 34</figref>. The entrybnd and exitbnd fields may be used by a bnd_compute method to set the appropriate boundary conditions. The startpt field may be used to define the incoming sine wave on the entry boundary. The freqs field includes the frequency vector that may be used by the frequency analysis feature.</p>
  <p num="p-0247">The geomparam structure is a 2 element structure array including geometry parameters for straight and elbow waveguides that may include fields as in <b>556</b> of <figref idrefs="DRAWINGS">FIG. 35</figref>. The geometry boundaries may be formed by a set of existing objects using the parameters entrylength, exitlength, width and radius. These existing objects may be combined into a single new geometry object using, for example, an API that forms a single object that is a cell array containing the existing objects.</p>
  <p num="p-0248">If the resonance cavity is operative, such as by checking a resonance cavity checkbox on one of the GUIs, the protruding posts are subtracted from the geometry. In this instance, the posts may be creates as a set of solid rectangular objects using the specified cavity parameters. The resulting mapping matrices representing this subtraction result may relate the curve and point indices in the input geometries, respectively, to their new indices in the new geometry object. Knowing the order in which the basic object were created to make the new geometry, the index corresponding to each of these basic objects in the final geometry may be calculated and stored in the user structure.</p>
  <p num="p-0249">Of the existing methods previously described in connection with <b>514</b> of <figref idrefs="DRAWINGS">FIG. 29</figref>, 6 may be overloaded. These may include, for example: default equ, equ_compute, default_bnd, bnd_compute, default_var, and posttable. Equ compute returns the PDE coefficients computed from parameters defined in the appl.equ structure. The ind field includes 1 since there is only one subdomain. Default_bnd method defined default boundary conditions. Bnd_compute computes boundary conditions from the material parameters and the frequency defined in appl.equ. The entrybnd, exitbnd, and startpt fields in the fem.user structure are used to place the correct boundary conditions on the correct boundaries. Default_var returns an empty cell array disabling default scalar variables. It should be noted that this method may have been used to define the incoming frequency as a scalar subdomain-independent variable instead of as part of the appl.equ structure. In this instance, the frequency may be specified in connection with a different dialogue box, such as Application Scalar Variables rather than in connection with the PDE specification dialogue box. In posttable, the post processing data is defined. The output variables, descriptions an evaluation expressions may be defined.</p>
  <p num="p-0250">Following is an overview of the overloaded GUI methods in the Waveguide application. It should be noted that the following GUI methods may be included in one embodiment. Other embodiments may include other methods or variations of these. Method appspec may be used to define the variable names in the bnd and equ structures of the fem appl field. appspect for the waveguide may return a structure including fields defining the PDE variables to be scalars and the boundary variables to be boundary coefficients of problem dimension. This information may be used by the appl2fem routine, for example, as described in the FEMLAB V1.1 Reference Manual, FEMLAB V1.1 User's Guide, and FEMLAB V1.1 Model Library, by Computer Solutions (COMSOL) Europe AB. Parts of other functionality described herein may also be fund in the foregoing documentation. This information may also be used by the PDE specification dialogue box. The method pdeinfo is used to define the default abbreviation for an application. Only the standard submode, coefficient form and stationary linear solver are available. The equinfo method returns equations, descriptions and parameter names to be displayed in connection with the PDE specification dialog box. The returned cell array of equations in this instance includes one equation due to the stationary linear solver being the only solver. The flboundmode method removes the standard Boundary menu from the GUI and the corresponding boundary mode toolbar is removed from the flviewtbg method. The importing of geometry objects may be disabled by the flimpmenu method returning an empty structure. Flmphmenu removes the multiphysics menu from the GUI by also returning an empty structure of menu handles. The flpdemode method returns a PDE menu structure including only 2 items, PDE mode and PDE specification. flsolvemode method returns a Solve menu structure includes the items solvemode, solveproblem, frequency analysis, and parameters. flmeshcolvtbg replaces the standard restart button with a frequency analysis button in which a corresponding icon is stored as a bitmap in a directory. Similarly, methods in connection with the geometry parameters, initial conditions and the like are modified and/or disabled in accordance with the desired GUIs and functionalities for the waveguide mode. Finally, the waveguide application may be added to the model navigator, such as in connection with the GUI displayed in <figref idrefs="DRAWINGS">FIG. 3</figref>, by invoking a function. In one embodiment, the following is an example invocation:</p>
  <p num="p-0251">fladdappl(flwaveguide, In-plane Waveguide)</p>
  <p num="h-0018">in which a bitmap flwaveguide.bmp may reside in a class directory. The bitmap may be displayed to the right of the Model Navigator as previously illustrating in connection with GUI <b>520</b> of <figref idrefs="DRAWINGS">FIG. 30</figref>.</p>
  <p num="p-0252">In another embodiment, a method is set forth that may be used in connection with specifying non-local couplings of multiphysics systems. This method may also be used in connection with local couplings, as described previously. The method includes a scheme for defining a plurality of variables, as discussed in detail below.</p>
  <p num="p-0253">Furthermore, the method can include an analysis of a multitude of geometries. The data structures used previously can be extended to multiple geometries by storing the previous data structure in a list xfem.fem in the extended data structure xfem. Thus, for geometry number g, the field x in the extended data structure occurs as xfem.fem{g}.x in the extended data structure for multiple geometries. The field xfem.xmesh contains the extended mesh data structure, described below. When using the multiple geometry data structure, the field xfem.sol contains the solution, and solutions are no longer stored in fem.sol for each geometry. The coupling variables are stored in a list in the field xfem.elemcpl. The extended mesh structure xfem.xmesh is used to store the following data: 1) Coordinates for all node points; 2) A table which translates local degrees of freedom to global degrees of freedom; 3) A table of all variables, which contains information regarding their type and domain of definition.</p>
  <p num="p-0254">Assume that there area number of Euclidean spaces, each equipped with a collection of manifolds (also called domains), i.e., volumes, surfaces, curves, or points. The manifolds may be approximately subdivided into mesh elements, constituting a mesh in the standard way. Commonly used mesh elements are tetrahedrons, triangles, and line segments. On each mesh element, local (barycentric) coordinates may be defined in the typical manner.</p>
  <p num="p-0255">An embodiment may introduce variables, which are functions on the manifolds. The method begins with defining basic variables, and then includes defining different types of new variables in terms of the already defined variables. The auxiliary variables and the glued variables, which are discussed in detail below, implement local couplings between the old variables and new variables. On the other hand, the mapped variables and the integrated variables, which are also discussed in detail below, may be used to define non-local couplings between the old and new variables. In accordance with the method of this embodiment, it is possible to model most physical quantities using local and non-local couplings.</p>
  <p num="p-0256">In an embodiment, a basic variable V may be defined in terms of a number of basis functions Fi (i is an index) in the standard way. Each basic function is a function defined on some of the manifolds. Its restriction to each mesh element is a smooth function (often a polynomial in the local coordinates), and it is nonzero only on a few mesh elements. To each basis function there is associated a parameter Ui, which is called the degree of freedom (DOF). The variable V is defined as the sum of Ui*Fi over all indices i.</p>
  <p num="p-0257">In the data structures of this embodiment, the basic variable names and their associated types of basis functions are stored in the fields xfem.fem{g}.shape, where g is the geometry number. This field is a list of shape function objects. Each shape function object defines a number of basic variables, and the basis functions that are used for these variables. A number of methods may be applied on the shape function objects. For example, there is a method that may compute values of the basis functions. The domains of definitions for the basic variables are determined by the fields xfem.fem{g}.***.shape, where *** is equ, bnd, edg, or pnt. For each domain group (also called ind group), it is specified which shape function objects are active on that domain group.</p>
  <p num="p-0258">Auxiliary variables of an embodiment may be defined by letting V1, V2, . . . , Vn be a number of variables, which are all defined on some domain. The auxiliary variables can be further defined by letting E(V1, V2, . . . , Vn) be a function of these variables (an expression). Then an auxiliary variable W can be defined in the following way: W=E(V1, V2, . . . , Vn).</p>
  <p num="p-0259">An embodiment may define glued variables using a number of disjoint domains that are numbered 1, 2, . . . , n. The glued variables can be further defined by letting V1, V2, . . . , Vn be a number of variables, where Vk is defined on domain number k. Then a glued variable W can be defined on the union of the domains in the following way: W=Vk on domain k, for all k.</p>
  <p num="p-0260">An embodiment may define the mapped variables by letting F be a mapping from a destination domain to a source domain. The mapped variables can be further defined letting V be a variable defined on the source domain. Then a mapped variable W can be defined on the destination domain by W=V(F).</p>
  <p num="p-0261">An embodiment of the integrated variables can be defined by letting V be a variable defined on a d-dimensional manifold M in some d-dimensional Euclidean space. The integrated variables can be further defined by letting b&lt;d, and letting P be the projection onto a b-dimensional Euclidean space defined by P(p,y)=p, where p and y are b-tuples and (d-b)-tuples of real numbers, respectively. Here we consider (p,y) as a point in the b-dimensional space. Further assume that the projection of M, P(M), is a manifold. Then an integrated variable W can be defined on P(M) in the following way: for each point p in P(M), the value W(p) is defined as the integral of V over the subset of M that is projected onto p by P.</p>
  <p num="p-0262">The plurality of variables, as described above, can be combined into a plurality of permutations to form other variables. For example, integration along curved manifolds can be implemented by combining mapped variables and integrated variables. However, it may be clearer if the steps are separated, as described above. In an embodiment, some examples of these combinations of the above variables types, can include, Expression variables, Scalar coupling variables, Extrusion coupling variables and Projection coupling variables, which are each described in detail below.</p>
  <p num="p-0263">An embodiment may define Expression variables using a number of disjoint domains that are numbered 1, 2, . . . , n. Let E1, E2, . . . , En be a number of expressions, where Ek is defined on domain number k. Then an expression variable W can be defined on the union of the domains in the following way: W=Ek on domain k, for all k. In this instance, the expression variable can be represented as a glued variable, where the variables that are glued together are auxiliary variables. This is done by introducing names V1, . . . , Vn for the expressions E1, . . . , En. The expression variables are defined in the fields xfem.fem{g}.***.expr, where *** is equ, bnd, edg, or pnt, and g is the geometry number. The expr field is a list of alternating variable names and defining expressions. A defining expression can be substituted with a list of expressions, where the nth expression applies to the nth domain group.</p>
  <p num="p-0264">An embodiment may define Scalar coupling variables by defining new variables as expressions of variables, which are evaluated somewhere else. The variable is defined as the integral of an expression over some domains. Such a variable can be defined by the following data:</p>
  <p num="p-0265">c.elem=elcplscalar;</p>
  <p num="p-0266">c.src.g= . . . ;</p>
  <p num="p-0267">c.src.equ.var= . . . ;</p>
  <p num="p-0268">c.src.equ.ind= . . . ;</p>
  <p num="p-0269">c.src.bnd.var= . . . ;</p>
  <p num="p-0270">c.src.bnd.ind= . . . ;</p>
  <p num="p-0271">c.src.edg.var= . . . ;</p>
  <p num="p-0272">c.src.edg.ind= . . . ;</p>
  <p num="p-0273">c.src.pnt.var= . . . ;</p>
  <p num="p-0274">c.src.pnt.ind= . . . ;</p>
  <p num="p-0275">c.dst.g= . . . ;</p>
  <p num="p-0276">c.dst.equ.ind= . . . ;</p>
  <p num="p-0277">c.dst.bnd.ind= . . . ;</p>
  <p num="p-0278">c.dst.edg.ind= . . . ;</p>
  <p num="p-0279">c.dst.pnt.ind= . . . ;</p>
  <p num="p-0280">xfem.elemcpl{ie1}=c;</p>
  <p num="p-0281">The above described data creates a scalar coupling variable element structure c with index ie1. The src field defines the new scalar variables in terms of integrals of expressions over geometry src.g (which defaults to 1). Src.equ.var defines variables in terms of integrals over subdomains. Further, src.equ.var is a cell vector with alternating variable names and expressions. The expressions can be numeric constants, strings or cell vector of such. If the expression is a cell vector, then its nth component applies to the nth subdomain group. The subdomain groups are defined by the src.equ.ind field. The default subdomain grouping is that all subdomains are in one group. The variable is defined to have the value obtained by integrating the expression over the subdomain groups. If required, a field src.gporder or src.equ.gporder can be given to specify the order of the quadrature formula to use in numerical integration. The variable should be a positive integer, and the default is 2.</p>
  <p num="p-0282">Similarly, src.bnd, src.edg, and src.pnt define scalar variables as integrals over boundaries, edges, and vertices, respectively an integral over a vertex is just the value of the integrand at the vertex).</p>
  <p num="p-0283">By default, the variables defined in src can be used everywhere in a geometry under analysis. The optional field dst can be used to specify the domains of definition for the variables in detail. Dst.g specifies the geometry number on which the variables are defined (defaults to 1). The dst.***.ind fields specify on which domains the variables are defined.</p>
  <p num="p-0284">A variable defined, as described above, is defined as a scalar coupling variable. Such a variable can be seen as a combination of an expression variable, an integrated variable and a mapped variable, as follows. The expressions in src.***.var define an expression variable. The expression variable may be integrated over its domain of definition, producing an integrated variable that is defined on a zero-dimensional space. The integrated variable may be further mapped to the destination domain using the mapping F that sends all points to the point in the zero-dimensional space.</p>
  <p num="p-0285">An embodiment may define Extrusion coupling variables by defining new variables as expressions of variables evaluated somewhere else. The Extrusion coupling variables are defined in a source domain and used in a destination domain. The value of the variable at an evaluation point in the destination domain is found by evaluating an expression at a point in the source domain, where the choice of point in the source domain is dependent on the position of the evaluation point in the destination domain.</p>
  <p num="p-0286">An extrusion coupling variable can be defined by the following data:</p>
  <p num="p-0287">c.elem=elcplextr;</p>
  <p num="p-0288">c.src.g= . . . ;</p>
  <p num="p-0289">c.src.equ.var= . . . ;</p>
  <p num="p-0290">c.src.equ.ind= . . . ;</p>
  <p num="p-0291">c.src.bnd.var= . . . ;</p>
  <p num="p-0292">c.src.bnd.ind= . . . ;</p>
  <p num="p-0293">c.src.edg.var= . . . ;</p>
  <p num="p-0294">c.src.edg.ind= . . . ;</p>
  <p num="p-0295">c.src.pnt.var= . . . ;</p>
  <p num="p-0296">c.src.pnt.ind= . . . ;</p>
  <p num="p-0297">c.src.meshp= . . . ;</p>
  <p num="p-0298">c.dst.g= . . . ;</p>
  <p num="p-0299">c.dst.equ.ind= . . . ;</p>
  <p num="p-0300">c.dst.bnd.ind= . . . ;</p>
  <p num="p-0301">c.dst.edg.ind= . . . ;</p>
  <p num="p-0302">c.dst.pnt.ind= . . . ;</p>
  <p num="p-0303">c.dst.ep= . . . ;</p>
  <p num="p-0304">xfem.elemcpl{ie1}=c;</p>
  <p num="p-0305">The above described data creates an extrusion coupling variable element structure c with index ie1. The extrusion coupling variables are similar to scalar coupling variables in that the basic fields in dst and src of the element structure are the same. That is to say, that dst defines the geometry and domains, where the variables are available, and src defines the variable names and associated expressions, and the geometry and domains from which they are defined. For extrusion coupling variables, the main difference is that src has a new field meshp, and dst has a new field ep. These describe the way in which an evaluation point in the destination domain is associated with a point in the source domain.</p>
  <p num="p-0306">The src field defines the new variables in terms of expressions on geometry src.g (which defaults to 1). Src.equ.var defines variables in terms of expressions on subdomains. Further, src.equ.var is a cell vector with alternating variable names and expressions. The expressions can be numeric constants, strings or cell vector of such. If it is a cell vector, then its nth component applies to the nth subdomain group. The subdomain groups are defined by the src.equ.ind field, and it has the usual syntax. The default subdomain grouping is that all subdomains are in one group. Similarly, src.bnd, src.edg, and src.pnt define variables in terms of expressions on boundaries, edges, and vertices, respectively. In addition, the term dst.g specifies the geometry number on which the variables are defined (defaults to 1). The dst.***.ind fields specify on which domains the variables are defined.</p>
  <p num="p-0307">The definition of a variable v1 can be expressed in terms of an expression e1. For example, the variable v1 is defined from a domain in the source geometry. The nodes in the domain are transformed using the expressions in the field meshp to create a temporary mesh. The number of expressions in meshp should be equal to the dimensionality of the domain in question (e.g. 2 for a face in 3-D/1 for a subdomain in 1-D/etc.). The expressions are functions of the space coordinates or the parameters s1s1/s2 for boundaries and edges. The transformation defined by these expressions should be one-to-one. Meshp can be given everywhere in the source geometry as a single set of expressions in src.meshp, or if it should be different in different places, it can be placed in src.***.meshp and it should then be based on src.***.ind. In the latter case, care should be taken that all the parts should make a well-defined whole mesh.</p>
  <p num="p-0308">When the variable is used in a destination domain, it is evaluated at evaluation points. The coordinates of these evaluation points are transformed in a way similar to that described above, by giving expressions in the field dst.ep or dst.***.ep, but here there is no restriction that the result should make a well-defined mesh. The number of expressions in ep, however, must be the same as the number in meshp. Thus points, EP are defined.</p>
  <p num="p-0309">The expression e1 is then evaluated by interpolation at the points EP in the mesh MESH, giving the values of the variable v1 at the evaluation points in the destination domain. The variable v1 defined in this way is called an extrusion coupling variable. Such a variable can be seen as a combination of expression variables and mapped variables, as follows. The expressions in src.***.var defines an expression variable in the source domain. The expression variable is then mapped to the destination domain using a mapping F which is given by the mapping defined by dst.ep followed by the inverse of the mapping defined by src.meshp. The inverse of the mapping src.meshp can be computed by search in the mesh MESH and linear interpolation.</p>
  <p num="p-0310">In an embodiment, Projection coupling variables may be defined as line integrals of expressions evaluated somewhere else. The variables are defined in a source domain and used in a destination domain. The value of the variable at an evaluation point in the destination domain is found by evaluating a line integral of an expression at in the source domain, where the choice of line (curve) in the source domain is dependent on the position of the evaluation point in the destination domain.</p>
  <p num="p-0311">A projection coupling variable can be defined as follows:</p>
  <p num="p-0312">c.elem=elcplproj;</p>
  <p num="p-0313">c.src.g= . . . ;</p>
  <p num="p-0314">c.src.equ.var= . . . ;</p>
  <p num="p-0315">c.src.equ.ind= . . . ;</p>
  <p num="p-0316">c.src.bnd.var= . . . ;</p>
  <p num="p-0317">c.src.bnd.ind= . . . ;</p>
  <p num="p-0318">c.src.meshp= . . . ;</p>
  <p num="p-0319">c.dst.g= . . . ;</p>
  <p num="p-0320">c.dst.equ.ind= . . . ;</p>
  <p num="p-0321">c.dst.bnd.ind= . . . ;</p>
  <p num="p-0322">c.dst.edg.ind= . . . ;</p>
  <p num="p-0323">c.dst.pnt.ind= . . . ;</p>
  <p num="p-0324">c.dst.ep= . . . ;</p>
  <p num="p-0325">xfem.elemcpl{ie1}=c;</p>
  <p num="p-0326">The above described data defines a projection coupling variable element structure c with index ie1. Projection coupling variables are similar to elcplscalar in that the basic field in dst and src of the element structure are the same. In other words, dst defines the geometry and domains where the variables are available, and src defines the variable names and associated expressions, and the geometry and domains from which they are defined. For projection coupling variables, the main difference is that src has a new field meshp, and dst has a new field ep. These describe the way in which an evaluation point in the destination domain is associated with points in the source domain. The fields meshp, and ep are similar to elcplextr, with a few small changes.</p>
  <p num="p-0327">The src field defines the new variables in terms of expressions on geometry src.g (which defaults to 1). Src.equ.var defines variables in terms of expressions on subdomains. It is a cell vector with alternating variable names and expressions. The expressions can be numeric constants, strings or cell vector of such. If it is a cell vector, then its nth component applies to the nth subdomain group. The subdomain groups are defined by the src.equ.ind field, and it has the usual syntax. The default subdomain grouping is that all subdomains are in one group. Similarly, src.bnd, src.edg, and src.pnt define variables in terms of expressions on boundaries, edges, and vertices, respectively. In addition, the term dst.g specifies the geometry number on which the variables are defined (defaults to 1). The dst.***.ind fields specify on which domains the variables are defined.</p>
  <p num="p-0328">The definition of a variable v1 can be expressed in terms of an expression e1. For example, the variable e1 is defined from a domain in the source geometry. The nodes in the domain are transformed using the expressions in the field meshp to create a temporary mesh. The number of expressions in meshp should be equal to the dimensionality of the domain in question (e.g. 2 for a face in 3-D/1 for a subdomain in 1-D/etc.). The expressions are functions of the space coordinates or the parameters s/s1/s2 for boundaries and edges. The transformation defined by these expressions should be one-to-one. Meshp can be given everywhere in the source geometry as a single set of expressions in src.meshp, or if it should be different in different places, it can be placed in src.***.meshp and it should then be based on src.***.ind. In the latter case, care should be taken that all the parts should make a well-defined whole mesh.</p>
  <p num="p-0329">When the variable is used in a destination domain, it is evaluated at evaluation points. The coordinates of these evaluation points are transformed in a way similar to that described above, by giving expressions in the field dst.ep or dst.***.ep, but here there is no restriction that the result should make a well-defined mesh. The number of expressions in ep, however, must be the same as the number in meshp. Thus point, EP are defined.</p>
  <p num="p-0330">The expression e1 is then evaluated by interpolation at the points EP in the mesh MESH, giving the values of the variable v1 at the evaluation points in the destination domain. The variable v1 defined in this way is called an extrusion coupling variable. Such a variable can be seen as a combination of expression variables and mapped variables, as follows. The expressions in src.***.var defines an expression variable in the source domain. The expression variable is then mapped to the destination domain using a mapping F which is given by the mapping defined by dst.ep followed by the inverse of the mapping defined by src.meshp. The inverse of the mapping src.meshp can be computed by search in the mesh MESH and linear interpolation.</p>
  <p num="p-0331">In an embodiment, Projection coupling variables may be defined as line integrals of expressions evaluated somewhere else. The variables are defined in a source domain and used in a destination domain. The value of the variable at an evaluation point in the destination domain is found by evaluating a line integral of an expression at in the source domain, where the choice of line (curve) in the source domain is dependent on the position of the evaluation point in the destination domain.</p>
  <p num="p-0332">A projection coupling variable can be defined as follows:</p>
  <p num="p-0333">c.elem=elcplproj;</p>
  <p num="p-0334">c.src.g= . . . ;</p>
  <p num="p-0335">c.src.equ.var= . . . ;</p>
  <p num="p-0336">c.src.equ.ind= . . . ;</p>
  <p num="p-0337">c.src.bnd.var= . . . ;</p>
  <p num="p-0338">c.src.bnd.ind= . . . ;</p>
  <p num="p-0339">c.src.meshp= . . . ;</p>
  <p num="p-0340">c.dst.g= . . . ;</p>
  <p num="p-0341">c.dst.equ.ind= . . . ;</p>
  <p num="p-0342">c.dst.bnd.ind= . . . ;</p>
  <p num="p-0343">c.dst.edg.ind= . . . ;</p>
  <p num="p-0344">c.dst.pnt.ind= . . . ;</p>
  <p num="p-0345">c.dst.ep= . . . ;</p>
  <p num="p-0346">xfem.elemcpl{ie1}=c;</p>
  <p num="p-0347">The above described data defines a projection coupling variable element structure c with index ie1. Projection coupling variables are similar to elcplscalar in that the basic field in dst and src of the element structure are the same. In other words, dst defines the geometry and domains where the variables are available, and src defines the variable names and associated expressions, and the geometry and domains from which they are defined. For projection coupling variables, the main difference is that src has a new field meshp, and dst has a new field ep. These describe the way in which an evaluation point in the destination domain is associated with points in the source domain. The fields meshp, and ep are similar to elcplextr, with a few small changes.</p>
  <p num="p-0348">The src field defines the new variables in terms of expressions on geometry src.g (which defaults to 1). Src.equ.var defines variables in terms of expressions on subdomains. It is a cell vector with alternating variable names and expressions. The expressions can be numeric constants, strings or cell vector of such. If it is a cell vector, then its nth component applies to the nth subdomain group. The subdomain groups are defined by the src.equ.ind field, and it has the usual syntax. The default subdomain grouping is that all subdomains are in one group. Similarly, src.bnd, src.edg, and src.pnt define variables in terms of expressions on boundaries, edges, and vertices, respectively.</p>
  <p num="p-0349">Dst.g specifies the geometry number on which the variables are defined (defaults to 1). The dst.***.ind fields specify on which domains the variables are defined. They have the usual syntax.</p>
  <p num="p-0350">The definition of a variable v1 can be expressed in terms of an expression e1. For example, the variable e1 is evaluated on a domain in the source geometry. The domain should have a dimension of at least 2. The nodes in the domain are transformed using the expressions in the field meshp in the same way as for extrusion coupling variables.</p>
  <p num="p-0351">When the variable is used in a destination domain, it is evaluated at evaluation points. The coordinates of these evaluation points are transformed in a similar way to 1 above, by giving expressions in the field dst.ep or dst.***.ep, in the same way as for elcplextr, but the number of expressions in ep should be one less than the number in meshp so that points, EP are defined.</p>
  <p num="p-0352">The expression e1 is then integrated over lines in MESH. The lines in MESH are defined as follows: EP fixes the first coordinate(s) in MESH, and the lines are defined by extending over the last space dimension in MESH. Thus, a line in MESH is associated to each evaluation point in the destination domain, and the line integral of e1 over that line gives the value of v1 at that evaluation point.</p>
  <p num="p-0353">The variable v1 defined in this way is called a projection coupling variable. The projection coupling variable can be seen as a combination of an extrusion coupling variable, an integrated variable, and a mapped variable, as follows. The expressions in src.***.var and the mapping given by src.meshp defines an extrusion coupling variable on the mesh MESH. The extrusion coupling variable may be integrated along lines, giving an integrated variable. The integrated variable may be mapped to the destination domain using the mapping given by dst.ep.</p>
  <p num="p-0354">An embodiment of the method may further include a scheme for generating a numerical computation of the values of a variable. For example, assume that a user wants to compute the values of the variable W in the points p1, p2, . . . , pm, given values Ui for the DOFs. The points pj are specified by giving the values of the local coordinates, and the mesh elements in which they reside. The result can be represented as a row vector, where the jth component is W(pj). Depending on what type of variable W is, there are five possible cases, e.g., W is a basic variable, W is an auxiliary variable, W is a glued variable, W is a mapped variable and W is an integrated variable, which are described in detail below. If W is a basic variable, its values can be computed directly. If W is any of the other types of variables, the values of the variables occurring in the definition of W should first be computed. Thus, a recursive scheme is set forth for computation of the values.</p>
  <p num="p-0355">In the case where W is a basic variable, as described above, W is the sum of Ui*Fi over all indices I, as described elsewhere herein. Values are given by W(pj)=sum of Ui*Fi(pj) over all i. Since pj is given in local coordinates, and Fi is a polynomial, it is easy and well known how to evaluate Fi(pj).</p>
  <p num="p-0356">In the case where W is an auxiliary variable, W=E(V1, V2, . . . ,Vn), as described elsewhere herein. First compute values of the variables V1, V2, . . . , Vn in the points pj. Now the values of W can be computed as W(pj)=E(V1(pj), V2(pj), . . . , Vn(pj)), by evaluating this expression. Note: if the expressions are parsed on the fly, it is wise to carry out the evaluation on a large set of points in parallel, in order to save computation time.</p>
  <p num="p-0357">In the case where W is a glued variable, W(pj)=Vk(pj) for those points pj, which are in domain k, as described elsewhere herein. For each k, let the vector Ik contain the indices j of the points pj that lie in domain k. First compute the values of the variables V1, V2, . . . , Vn. More precisely, compute the values of the variable Vk in the points pj, where j is in Ik. Then put W(pj)=Vk(pj) for j in Ik.</p>
  <p num="p-0358">In the case where W is a mapped variable, W(pj)=V(qj), where qj are the points qj=F(pj), as described elsewhere herein. These points are computed in the following way: First, the global coordinates for the points pj are computed, and the global coordinates for the points qj are computed by the formula qj=F(pj). Then, a search algorithm is used to find the mesh elements in which the points qj reside in, and the corresponding local coordinates. Now compute the variable V in the points qj. The result is identical with the requested values, namely the values of W in the points pj.</p>
  <p num="p-0359">In the case where W is an integrated variable, W(pj) is the integral of V(pj,y) over all y such that (pj,y) lies in the domain of V, as described elsewhere herein. This integral is approximated with a quadrature formula in the standard way, i.e., W(pj) is approximated with the sum of V(pj,yjk)*wjk over some indices k (the index set can depend on j). The numbers wjk are called the weights. Let q1, q2, . . . be the points (pj,yjk) in some order, and let w1, w2, . . . be the corresponding ordering of the weights wjk. Create the index vector J in the following way: J(1) is the index j for which q1=(pj,yjk) (for some k). Thus J maps from indices of the points q1, q2, . . . to indices of the projected points pj. Now compute the values of the variable V in the points q1, q2, . . . . The result is represented by a row vector R. The values for the variable W can be now be computed as follows. W(pj)=sum of R(1)*w(1), where the sum is taken over all 1 such that J(1)=j.</p>
  <p num="p-0360">An embodiment may also include a format for numerical representation of the Jacobian of a variable. For example, the Jacobian of a variable V is the vector consisting of the first partial derivatives of V with respect to the DOFs. The partial derivative of V with respect to Ui is denoted DiV. Assume that we want to evaluate the Jacobian of V in a number of points p1, p2, . . . , pm. The Jacobian of V in these points can be represented by a number of contributions J1, J2, . . . Each contribution Jk consists of three things: A matrix Jk.VAL, a matrix Jk.DOF, and a row vector Jk.EP. For a fixed index k, the matrices Jk.VAL and Jk.DOF have the same size, and they have the same number of columns as Jk.EP. The DOF matrix contains degree of freedom indices, and the VAL matrix contains the corresponding contributions to the value of the partial derivative, The EP vector contains evaluation point indices. More precisely, this means that the partial derivative DiV(pj) is equal to the sum of Jk.VAL(r,c), where the sum is taken over all k, r, and c such that Jk.DOF(r,c)=i and Jk.EP(c)=j. Often, the vector Jk.EP is [1 2 . . . m]. In order to conserve memory space, the EP vector can be omitted in this case.</p>
  <p num="p-0361">The points p1, p2, . . . , pm may be uniformly distributed in the mesh elements. In other words, the first b points lie in the first mesh element, the next b points lie in the second mesh element, etc. In this case, the coordinates may also be the same in all mesh elements. The local point data may be referred to as structured point data, and the general case is called unstructured point data. For a basic variable, structured point data means that the matrices Jk.DOF can be compressed. Namely, the first b columns of Jk.DOF are identical, the next b columns of Jk.DOF are identical, etc. A more compact format can be realized by keeping only every bth column of Jk.DOF. This compact format can be preserved as long as basic variables, auxiliary variables, and glued variables are used.</p>
  <p num="p-0362">Additionally, an embodiment may also include a scheme for a numerical computation of the Jacobian of a variable. For example, assume that it is desired to compute the Jacobian of a variable W in the points p1, p2, . . . , pm, given values for the DOFs Ui. The points pj are specified by giving the values of the local coordinates, and the mesh elements in which they reside. The result can be represented in the format described above. Depending on what type of variable W is, there are five possible cases, e.g. W is a basic variable, W is an auxiliary variable, W is a glued variable, W is a mapped variable or W is an integrated variable, which are discussed in detail below. If W is a basic variable, the Jacobian can be computed directly. If W is any of the other types of variables, the Jacobians of the variables occurring in the definition of W must first be computed. Thus, a recursive scheme is set forth for computation of the Jacobian.</p>
  <p num="p-0363">In the case where W is a basic variable, recall that W is the sum of Ui*Fi over all indices i. Thus, the partial derivatives are DiV(pj)-Fi(pj). The Jacobian can represented with just one contribution J1. The vector J1.EP is just the vector [1 2 3 . . . m]. Consider the mesh element in which the point pj lies. Only a few basis functions are nonzero on this mesh element. The indices i of these basis functions constitute the jth column of the matrix J1.DOF. The corresponding values Fi(pj) make up the jth column of the matrix J1.VAL. Since pj is given in local coordinates, and Fi is a polynomial, it is easy and well known how to evaluate Fi(pj).</p>
  <p num="p-0364">In the case where W is an auxiliary variable, recall that W=E(V 1, V2, . . . , Vn). By the chain rule,</p>
  <p num="p-0365"> <maths id="MATH-US-00001" num="00001"> <math overflow="scroll"> <mrow> <mrow> <msub> <mi>D</mi> <mi>i</mi> </msub> <mo></mo> <mrow> <mi>W</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>p</mi> <mi>j</mi> </msub> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <mo></mo> <mi>k</mi> </munder> <mo></mo> <mrow> <mfrac> <mrow> <mo></mo> <mi>E</mi> </mrow> <mrow> <mo></mo> <msub> <mi>V</mi> <mi>k</mi> </msub> </mrow> </mfrac> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>p</mi> <mi>j</mi> </msub> <mo>)</mo> </mrow> <mo></mo> <msub> <mi>D</mi> <mi>i</mi> </msub> <mo></mo> <mrow> <mrow> <msub> <mi>V</mi> <mi>k</mi> </msub> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>p</mi> <mi>j</mi> </msub> <mo>)</mo> </mrow> </mrow> <mo>.</mo> </mrow> </mrow> </mrow> </mrow> </math> </maths> <br>
First compute the Jacobians of the variables Vk, k=1, 2, . . . , n. These are represented by the contributions Jk1 (where the index 1 can run over different sets for the different k). Compute the partial derivatives of E symbolically, and evaluate them in the points pj, using the algorithm described above. Store the result in the vectors Ck:
</p>
  <p num="p-0366">
    <maths id="MATH-US-00002" num="00002"> <math overflow="scroll"> <mrow> <mrow> <msub> <mi>C</mi> <mi>k</mi> </msub> <mo></mo> <mrow> <mo>(</mo> <mi>j</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mfrac> <mrow> <mo></mo> <mi>E</mi> </mrow> <mrow> <mo></mo> <msub> <mi>V</mi> <mi>k</mi> </msub> </mrow> </mfrac> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>p</mi> <mi>j</mi> </msub> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0367">Now the Jacobian of W can be represented by the contributions Kk1, which are computed as follows. The EP and DOF matrices are the same as for the variables Vk: KkI.EP=Jk1.EP and Kk1.DOF=JkI.DOF. The VAL matrices are computed as follows: Kk1.VAL(r,c) Ck(Jk1.EP(c))*Jk1.VAL(r,c). The calculated contributions Kk1 should then be reindexed in terms of just one index.</p>
  <p num="p-0368">In the case where W is a glued variable, recall that W(pj)=Vk(pj) for those points pj which are in domain k. For each k, let the vector Ik contain the indices j of the points pj that lie in domain k. First compute the Jacobians of the variables V1, V2, . . . , Vn. More precisely, compute the Jacobian of the variable Vk in the points pj, where j is in Ik. This Jacobian is represented by the contributions Jk1 (where the index 1 can run over different sets for the different k). Now the Jacobian of W can be represented by the contributions Kk1, which are computed as follows. The VAL and DOF matrices are unchanged: Kk1.VAL=Jk1.VAL and Kk1.DOF=Jk1.DOF. Kk1.EP is obtained from Jk1.EP by Kk1.EP Ik(Jk1.EP). The calculated contributions Kk1 should then be reindexed in terms of just one index.</p>
  <p num="p-0369">In the case where W is a mapped variable, recall that W(pj)=V(F(pj)). Thus, the partial derivatives are DiW(pj)=DiV(gj), where qj are the points qj=F(pj). These points are computed in the following way: first, the global coordinates for the points pj are computed, and the global coordinates for the points qj are computed by the formula qj F(pj). Then, a search algorithm is used to find the mesh elements in which the points qj reside in, and the corresponding local coordinates. Now the Jacobian of the variable V can be computed in the points qj. The result is identical with the requested Jacobian, namely the Jacobian of W in the points pj.</p>
  <p num="p-0370">In the case where W is an integrated variable, recall that W(pj) is the integral of V(pj,y) over all y such that (pj,y) lies in the domain of V. This integral is approximated with a quadrature formula in the standard way, i.e., we approximate W(pj) with the sum of V(pj,yjk)*wjk over some indices k (the index set can depend on j). Thus, the partial derivative DiW(pj) can be obtained as the sum of DiV(pj,yjk)*wjk over k. Let q1, q2, be the points (pj,yjk) in some order, and let w1, w2, . . . be the corresponding ordering of the weights wjk. Create the index vector J in the following way: J(1) is the index j for which q1=(pj,yjk) (for some k). Thus, J maps from indexes of the points q1, q2, . . . to indices of the projected points pj. Now the Jacobian for the variable V can be computed in the points q1, q2, . . . . The result is represented by the contributions Jk. The Jacobian for the variable W can be represented by the contributions Kk, which are computed as follows. The DOF matrices are unchanged, Kk.DOF=Jk.DOF. The VAL matrices are transformed according to Kk.VAL(r,c)=Jk.VAL(r,c)*wc. The new EP vectors are constructed by Kk.EP(c)=J(Jk.EP(c)).</p>
  <p num="p-0371">An embodiment may also provide an optimization using a cache data structure, for example, when using the above recursive algorithms for computing values and Jacobians of variables, it often happens that one computes the same variable several times at different levels of the recursion tree. To save computing time, the results of the evaluations may be stored in the cache data structure for later use. In the cache, each result is stored together with a key, which identifies which variable was evaluated, and whether it was values or the Jacobian that was computed. To search among the keys, hashing can be used. It is important also to keep track of the evaluation points. Each time one switches from one set of evaluation points to another set, one must make sure that either the cache is cleared, or, that the cache is pushed. In the latter case the cache works as a stack where each level corresponds to a set of evaluation points. When a user is done with one set of evaluation points, the user can return to the previous set by popping the cache.</p>
  <p num="p-0372">An embodiment may further include assembling the residual vector of a weak equation. For example, consider a weak term, that is, an expression of the type V_test*W, where V and W are variables. The residual vector L corresponding to the weak term is column vector defined by L(r)=integral of DrV*W over some domain, where we have assumed some given values of the DOFs Ui. To compute the residual vector numerically, we approximate this integral with a quadrature formula: L(r)=sum of DrV(pj)*W(pj)*wj over certain indices j=1, 2, . . . , m. Thus, the method may begin by computing the Jacobian of V and the values of W in the point pj using the above methods. Assume that the Jacobian of V in the points pj is represented by the contributions Jk. For simplicity, assume that the variable V is constructed from basic variables, only using auxiliary variables. Thus, the contributions Jk all have Jk.EP=[1 2 . . . m]. Compute the row vector C as C(j)=W(pj)*wj. Now the residual vector L can be computed as follows: start with L as the zero vector. Loop over all k, then over all columns j of Jk.DOF, and then over all rows r of Jk.DOF, and add Jk.VAL(r,j)*C(j) to L(Jk.DOF(r,j)).</p>
  <p num="p-0373">It should be noted that a weak term can in general have the form V_test*E(V1, V2, . . . , Vn). To simplify the presentation, a name W can be introduced for the expression E(V1, V2, . . . , Vn), which is possible by using an auxiliary variable.</p>
  <p num="p-0374">A weak expression may be defined as a sum of weak terms. A weak equation is obtained by summing a number of integrals of weak expressions, and putting the result equal to zero. <figref idrefs="DRAWINGS">FIG. 41</figref> shows the weak formulation. The integrals can be taken over different domains. Partial differential equations can be reformulated as weak equations. <figref idrefs="DRAWINGS">FIG. 42</figref> describes the conversion from a general form problem to a weak form. A weak equation is the starting point for the finite element method. Therefore, it is important to be able to compute the residual vector corresponding to a weak equation. The residual vector can be obtained as the sum of the residual vectors of the underlying weak terms. The stiffness matrix corresponding to a weak equation is the Jacobian of its residual vector. Therefore, the stiffness matrix can be computed as the sum of the stiffness matrices of the underlying weak terms. Computation of the stiffness matrix is discussed in further detail below.</p>
  <p num="p-0375">An embodiment may further include assembling the stiffness matrix of a weak equation. For example, consider a weak term, that is, an expression of the type V_test*W, where V and W are variables. The stiffness matrix S corresponding to the weak term is defined by S(r,c)=integral of DrV*DcW over some domain. To compute the stiffness matrix numerically, an approximation is made of this integral with a quadrature formula: S(r,c)=sum of DrV(pj)*DcW(pj)*w(j) over certain indices j=1, 2, . . . , m. Thus, the method of assembling the stiffness matrix of a weak equation is commenced by computing the Jacobians of V and W using the above method. Assume that these Jacobians are represented by the contributions J1 and Kk, respectively. For simplicity, assume that the variable V is constructed from basic variables, only using auxiliary variables. Thus, the contributions J1 all have JI.EP=[1 2 . . . m]. Now form the matrices COLk, ROWIk, and the three-dimensional arrays VAL1k as follows. Put COLk=Kk.DOF and ROWIk(r,c)=JI.DOF(r,Jk.EP(c)). The array VAL1k is defined by VAL1k(r,c,s)=J1.VAL(r,Jk.EP(s))*Kk.VAL(c,s)* w(Jk.EP(s)). Now the arrays COLk, ROW1k, and VAL1k constitute a kind of sparse matrix representation of S. More precisely, S(r,c)=sum of VAL1k(i,j,s), where the sum is taken over all 1, k, s, i, and j such that r=ROW1k(i,s) and c=COLk(j,s).</p>
  <p num="p-0376">An embodiment may further include assembling the constraints of a weak equation. For example, consider a constraint W=0 on some manifold, where W is a variable. The constraint is discretized by requiring that W=0 holds in a finite number of points pj, j=1, 2, . . . , m. Often, the points pj are uniformly distributed in each mesh element on the manifold. The constraint residual vector M is defined as the column vector with the components Mj=W(pj). This vector can obviously be computed with the method for evaluating the variable W described above.</p>
  <p num="p-0377">The constraint matrix C is the Jacobian of M with respect to the degrees of freedom, namely, Cji=DiMj=DiW(pj). The constraint matrix C can be computed by computing the Jacobian of W in the points pj using the method described above. The result is a list of contributions Jk. Now the partial derivative DiW(pj) can be computed as the sum of Jk.VAL(r,c), where the sum is taken over all k, r, and c such that Jk.DOF(r,e)=i and Jk.EP(c)=j.</p>
  <p num="p-0378">In understanding the assembly and solution process, it is helpful to understand how the discretization of a stationary PDE problem is formed. The starting point is the weak formulation of the problem in <figref idrefs="DRAWINGS">FIG. 41</figref> and then with the discretization of the constraints:</p>
  <p num="p-0379">
    <maths id="MATH-US-00003" num="00003"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <msup> <mi>R</mi> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi></mi> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00003-2" num="00003.2"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <msup> <mi>R</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>B</mi> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00003-3" num="00003.3"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <msup> <mi>R</mi> <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>P</mi> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0380">The constraints on subdomains, boundaries, and vertices are stored in the sub-fields equ.constr, bnd.constr, and pnt.constr, respectively, ofxfem.fem{g}, and starting with the constraints on boundaries B. For each mesh element in B (i.e., mesh edge in B), consider the Lagrange points of some order k (i.e., the points whose local coordinates are a multiple of 1/k). Denote them by x(1)mj, where m is the index of the mesh element. Then the discretization of the constraint is
<br>0<i>=R</i> <sup>(1)</sup>(<i>x</i> <sup>(1)</sup> <sub>mj</sub>)<br>
that is, the constraints are required to hold point-wise, at the Lagrange points. The Lagrange point order k can be chosen different for different components of the constraint vector R<sup>(1)</sup>, and it can also vary in space (this is determined by the field xfem.fem{g}.bnd.cporder). The k is denoted by cporder in FEMLAB's data structures. The constraints on subdomains W and points P are discretized similarly (nothing needs to be done with the points P). We can collect all these point-wise constraints in one equation 0=M, where M is the vector consisting of all the right-hand sides.
</p>
  <p num="p-0381">The dependent variables are approximated with functions in the chosen finite element space(s). This means that the dependent variables are expressed in terms of the degrees of freedom as</p>
  <p num="p-0382">
    <maths id="MATH-US-00004" num="00004"> <math overflow="scroll"> <mrow> <msub> <mi>u</mi> <mn>1</mn> </msub> <mo>=</mo> <mrow> <munder> <mo></mo> <mi>i</mi> </munder> <mo></mo> <mrow> <msub> <mi>U</mi> <mi>i</mi> </msub> <mo></mo> <msubsup> <mi></mi> <mi>i</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0383">where phi<sub>i</sub> <sup>(1) </sup>are the basis functions for variable u<sub>1</sub>. Let U be the vector with the degrees of freedoms U<sub>i </sub>as the components. This vector is called the solution vector, since it is what we want to compute. Now M only depends on U, so the constraints can be written 0=M(U). Now consider the weak equation:</p>
  <p num="p-0384">
    <maths id="MATH-US-00005" num="00005"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <mrow> <munder> <mo></mo> <mi></mi> </munder> <mo></mo> <mrow> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>A</mi> </mrow> </mrow> </mrow> <mo>+</mo> <mrow> <munder> <mo></mo> <mi>B</mi> </munder> <mo></mo> <mrow> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>s</mi> </mrow> </mrow> </mrow> <mo>+</mo> <mrow> <munder> <mo></mo> <mi>P</mi> </munder> <mo></mo> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow> </msup> </mrow> <mo>-</mo> <mrow> <munder> <mo></mo> <mi></mi> </munder> <mo></mo> <mrow> <mrow> <mi>v</mi> <mo></mo> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> </mrow> <mo></mo> <msup> <mi></mi> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>A</mi> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <munder> <mo></mo> <mi>B</mi> </munder> <mo></mo> <mrow> <mrow> <mi>v</mi> <mo></mo> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> </mrow> <mo></mo> <msup> <mi></mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>s</mi> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <munder> <mo></mo> <mi>P</mi> </munder> <mo></mo> <mrow> <mrow> <mi>v</mi> <mo></mo> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> </mrow> <mo></mo> <msup> <mi></mi> <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow> </msup> </mrow> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0385">The integrands W(2), W(1), and W(0) are stored in the subfields equ.weak, bnd.weak, and pnt.weak, respectively, ofxfem.fem{g}. The integrands W(2), W(1), and W(0) are weak expressions. To discretize this equation, we express the dependent variables in terms of the DOFs as above. Similarly, the test functions are approximated with the same finite elements (this is the Galerkin method):</p>
  <p num="p-0386">
    <maths id="MATH-US-00006" num="00006"> <math overflow="scroll"> <mrow> <msub> <mi>v</mi> <mi>l</mi> </msub> <mo>=</mo> <mrow> <munder> <mo></mo> <mi>i</mi> </munder> <mo></mo> <mrow> <msub> <mi>V</mi> <mi>i</mi> </msub> <mo></mo> <msubsup> <mi></mi> <mi>i</mi> <mrow> <mo>(</mo> <mi>l</mi> <mo>)</mo> </mrow> </msubsup> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0387">Since the test functions occur linearly in the integrands of the weak equation, it is enough to require that the weak equation holds when we choose the test functions as basis functions:
<br><sub>l</sub>=<sub>i</sub> <sup>(1) </sup> </p>
  <p num="p-0388">When substituted into the weak equation, this gives one equation for each i. Now the Lagrange multipliers have to be discretized. Let</p>
  <p num="p-0389"> <maths id="MATH-US-00007" num="00007"> <math overflow="scroll"> <mrow> <msubsup> <mi></mi> <mi>mj</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msubsup> <mo>=</mo> <mrow> <mrow> <msup> <mi></mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> <mo></mo> <msubsup> <mi>w</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msubsup> </mrow> </mrow> </math> </maths> <br>
where x(d)mj are the Lagrange points define above, and w(d)mj are certain weights, see below. The term
</p>
  <p num="p-0390">
    <maths id="MATH-US-00008" num="00008"> <math overflow="scroll"> <mrow> <munder> <mo></mo> <mi>B</mi> </munder> <mo></mo> <mrow> <mrow> <msub> <mi></mi> <mi>i</mi> </msub> <mo></mo> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> </mrow> <mo></mo> <msup> <mi></mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>s</mi> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0391">is approximated as a sum over all mesh elements in B. The contribution from mesh element number m to this sum is approximated with the Riemann sum</p>
  <p num="p-0392">
    <maths id="MATH-US-00009" num="00009"> <math overflow="scroll"> <mrow> <mrow> <munder> <mo></mo> <mi>j</mi> </munder> <mo></mo> <mrow> <mrow> <mrow> <msub> <mi></mi> <mi>i</mi> </msub> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> <mrow> <msup> <mi></mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> <mo></mo> <msubsup> <mi>w</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <mo></mo> <mi>j</mi> </munder> <mo></mo> <mrow> <mrow> <mrow> <msub> <mi></mi> <mi>i</mi> </msub> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <msup> <mi>h</mi> <msup> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> <mi></mi> </msup> </msup> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> <msubsup> <mi></mi> <mi>mj</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msubsup> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0393">where w(1)mj is the length (or integral of ds) over the appropriate part of the mesh element. The integral over W and the sum over P is approximated similarly.</p>
  <p num="p-0394">All this means that the discretization of the weak equation can be written
<br>0<i>=LN</i> <sup>T</sup> <i>A </i> </p>
  <p num="p-0395">L is the vector whose ith component is</p>
  <p num="p-0396"> <maths id="MATH-US-00010" num="00010"> <math overflow="scroll"> <mrow> <mrow> <munder> <mo></mo> <mi></mi> </munder> <mo></mo> <mrow> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>A</mi> </mrow> </mrow> </mrow> <mo>+</mo> <mrow> <munder> <mo></mo> <mi>B</mi> </munder> <mo></mo> <mrow> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>1</mn> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo></mo> <mi>s</mi> </mrow> </mrow> </mrow> <mo>+</mo> <mrow> <munder> <mo></mo> <mi>P</mi> </munder> <mo></mo> <msup> <mi>W</mi> <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow> </msup> </mrow> </mrow> </math> </maths> <br>
evaluated for v1=phi(1)i. LAMBDA is the vector containing all the discretized Lagrange multipliers LAMBDA(d)mj. N is a matrix whose ith column is a concatenation of the vectors
</p>
  <p num="p-0397">
    <maths id="MATH-US-00011" num="00011"> <math overflow="scroll"> <mrow> <mrow> <msup> <mi>h</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msup> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mrow> <msub> <mi></mi> <mi>i</mi> </msub> <mo></mo> <mrow> <mo>(</mo> <msubsup> <mi>x</mi> <mi>mj</mi> <mrow> <mo>(</mo> <mi>d</mi> <mo>)</mo> </mrow> </msubsup> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0398">To sum up, the discretization of the stationary problem is</p>
  <p num="p-0399">
    <maths id="MATH-US-00012" num="00012"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <mrow> <mi>L</mi> <mo></mo> <mrow> <mo>(</mo> <mi>U</mi> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msup> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <mi>U</mi> <mo>)</mo> </mrow> </mrow> <mi>T</mi> </msup> <mo></mo> <mi></mi> </mrow> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00012-2" num="00012.2"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <mi>M</mi> <mo></mo> <mrow> <mo>(</mo> <mi>U</mi> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0400">The objective is to solve this system for the solution vector U and the Lagrange multiplier vector LAMBDA. L is called the residual vector, M is the constraint residual vector and C=N is the constraint matrix. Note that M is redundant in the sense that some pointwise constraints occur several times. Similarly, L is redundant. This redundancy is removed by the solvers. The solution of the discrete system is obtained by using Newton's iterative method, i.e. by solving a number of linearized problems (see below).</p>
  <p num="p-0401">The integrals occurring in the components of the residual vector L (as well as the stiffness matrix S) are computed approximately using a quadrature formula. Such a formula computes the integral over a mesh element by taking a weighted sum of the integrand evaluated in a finite number of points in the mesh element, The order of a quadrature formula is the maximum number k such that it integrates all polynomials of degree k exactly. Thus, the accuracy of the quadrature increases with the order. On the other hand, the number of evaluation points also increases with the order. As a rule of thumb one can take the order to be twice the order of the finite element that is used. The order of the quadrature formula is denoted by gp order in the data structures (gp stands for Gauss points).</p>
  <p num="p-0402">In time-dependent problems, the discretization of a time-dependent problem is similar to the stationary problem:</p>
  <p num="p-0403"> <maths id="MATH-US-00013" num="00013"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mi>D</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>,</mo> <mi>t</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mfrac> <mrow> <mo></mo> <mi>U</mi> </mrow> <mrow> <mo></mo> <mi>t</mi> </mrow> </mfrac> </mrow> <mo>=</mo> <mrow> <mrow> <mi>L</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>,</mo> <mi>t</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msup> <mrow> <mo>(</mo> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>,</mo> <mi>t</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> <mi></mi> </msup> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mi></mi> </mrow> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00013-2" num="00013.2"> <math overflow="scroll"> <mrow> <mn>0</mn> <mo>=</mo> <mrow> <mi>M</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>,</mo> <mi>t</mi> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> <br>
where now U and LAMBDA depend on time t. The matrix D is called the mass matrix. This matrix is assembled in a similar way as the stiffness matrix, but from data in the fields xfem.fem{g}.***.dweak instead of xfem.fem{g}.***.weak. It is assumed that the constraint is linear, i.e., M depends linearly on U. The solution of the above system of differential-algebraic equations can be obtained by using standard DAE-solvers.
</p>
  <p num="p-0404">In considering a linearized stationary problem, the linearization point corresponds to a solution vector U<sub>0</sub>. The discretization of the linearized problem is</p>
  <p num="p-0405"> <maths id="MATH-US-00014" num="00014"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mrow> <mi>K</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>-</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msup> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mi>T</mi> </msup> <mo></mo> <mi></mi> </mrow> </mrow> <mo>=</mo> <mrow> <mi>L</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00014-2" num="00014.2"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>U</mi> <mo>-</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mi>M</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> </mrow> </math> </maths> <br>
where S=K is called the stiffness matrix. The solution of this linear system can be obtained by 15 standard direct or iterative methods.
</p>
  <p num="p-0406">In Eigenvalue problems, the discretization of the eigenvalue problem is</p>
  <p num="p-0407"> <maths id="MATH-US-00015" num="00015"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mrow> <mo>-</mo> <mi></mi> </mrow> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mrow> <mi>D</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mo></mo> <mi>U</mi> </mrow> <mo>+</mo> <mrow> <mrow> <mi>K</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mo></mo> <mi>U</mi> </mrow> <mo>+</mo> <mrow> <msup> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mi>T</mi> </msup> <mo></mo> <mi></mi> </mrow> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </math> </maths> <maths id="MATH-US-00015-2" num="00015.2"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mi>N</mi> <mo></mo> <mrow> <mo>(</mo> <msub> <mi>U</mi> <mn>0</mn> </msub> <mo>)</mo> </mrow> </mrow> <mo></mo> <mi>U</mi> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </math> </maths> <br>
where U<sub>0 </sub>is the solution vector corresponding to the linearization point. The solution to this eigenproblem can be obtained by standard methods.
</p>
  <p num="p-0408">Referring now to <figref idrefs="DRAWINGS">FIG. 36</figref>, shown is an example of another embodiment of a user interface or GUI <b>600</b> that may be used in connection with specifying local and non-local couplings of multiphysics systems. The GUI <b>600</b> is similar in features and operation as the GUI <b>30</b> of <figref idrefs="DRAWINGS">FIG. 3</figref> and further includes an option to add geometries, which is discussed in detail below. On the GUI <b>600</b>, a user can start a multiphysics model that consists of several application modes and several different geometries. The user can start in the top left part of the GUI <b>600</b> by specifying space dimension (1-D, 2-D, or 3-D) and the user can elect to edit the names of the independent variables in the Independent variables dialog box <b>602</b>. The user can also select application modes from the left-most list box <b>604</b> and add them to the model by pressing the &gt;&gt; button <b>606</b> or by double-clicking them. Application modes can be removed from the list by pressing &lt;&lt; button <b>608</b> or double-clicking on them. When the last application mode is removed from a geometry, the geometry is still left in the right list box <b>610</b>. This corresponds to a geometry only model where you can draw a geometry and then add application modes later on. The user can also press the &lt;&lt; button <b>608</b> once more to remove the geometry. There is always one geometry available in the right list box <b>610</b>. A user can add additional geometries to the model by pressing the &gt;&gt; button <b>612</b> <i>a </i>after selecting from the Geometry name drop-down list box <b>614</b> (the Add button <b>612</b> changes to a &gt;&gt; button <b>612</b> <i>a </i>after clicking it, and thus adds geometry to the Geometry name drop-down list box <b>614</b>). Each geometry can also have a different space dimension.</p>
  <p num="p-0409">Prior to the user adding an application mode, as described above, the user can edit the name of the application mode. Additionally, the user can also edit the name of the application mode's dependent variables and the element type used for modeling. Each application mode in the model is given a unique name, which is used to identify the origin of the variables in the multiphysics model. The user can edit the dependent variables' names, but the names are required to be valid variable names (e.g., they are required to start with a letter), If the application mode contains more than one dependent variable, the user can enter all of the variable names as space-separated entries in the Dependent variables edit field <b>616</b>. In the PDE modes, where more than one dependent variable is possible, the user can determine the number of equations in the model by entering one or more space-separated variable names.</p>
  <p num="p-0410">In the Element drop-down list box <b>618</b>, the type of element used for the modeling is selected. Each application mode has a set of predefined elements. The element selection of the Element drop-down list box <b>618</b> can also be changed during the modeling process using the Element page <b>802</b> in the Subdomain Settings dialog box <b>800</b> (<figref idrefs="DRAWINGS">FIG. 38</figref>).</p>
  <p num="p-0411">On the right-hand side of the GUI <b>600</b> of <figref idrefs="DRAWINGS">FIG. 36</figref>, a user can set the solver type (stationary, time-dependent, etc.) and solution form (coefficient, general, or weak form) for the multiphysics model by respectively selecting a solver type from the solver type of drop-down list <b>620</b> and selecting a solution from the Solution form drop-down list <b>622</b>. In the list box <b>610</b> located below the solution form drop-down list <b>622</b>, all the application modes that have been added to the model appear. The name and the dependent variables for the selected application mode are displayed below the list box <b>610</b>. A user can select any of the model's application modes and change its submode by selecting from the elements listed in the Submode drop down list <b>624</b>. In addition to the Standard submode displayed in the Submode drop-down list <b>624</b> of the GUI <b>600</b>, for example, there is also a Wave-Extension submode (not shown) for some application modes. The Wave-Extension submode extends the standard time-dependent equation to a wave equation (using a second derivative with respect to time). Pressing OK <b>626</b> starts a new multiphysics model with all the added application modes, as described above. The application mode that is selected in the right list box <b>610</b> becomes the active application mode when the user continues the modeling.</p>
  <p num="p-0412">Referring to <figref idrefs="DRAWINGS">FIG. 37</figref>, shown is an example Boundary settings dialog box <b>700</b> that provides a user the ability to access the weak form. In the Boundary settings dialog box <b>700</b>, a user can enter weak, dweak, and constr coefficient information in the respective weak <b>702</b>, dweak <b>704</b>, and constr <b>706</b> fields corresponding to the fields xfem.fem {g}.bnd.weak, xfem.fem {g}.bnd.dweak, and xfem.fem {g}.bnd.constr, respectively, in the data structure. The dialog box also sets the domain grouping xfem.fem{g).bnd.ind. The Boundary settings dialog box <b>700</b> further includes a Domain selection list <b>708</b> that permits a user to select domain related infotiiiation associated with the weak solution form. The Boundary settings dialog box <b>700</b> can also be made available in coefficient view, and also directly in the application mode, for PDE oriented application modes.</p>
  <p num="p-0413">Referring to <figref idrefs="DRAWINGS">FIG. 38</figref>, shown is an example of a Subdomain Settings dialog box <b>800</b>, which enables a user thereof to set shape function object, integration order, and constraint order, corresponding to the fields xfem.fem{g}.equ.shape, xfem.fem{g}.equ.gporder, and xfem.fem{g}.equ.cporder, respectively, in the data structure. The dialog box also sets the domain grouping xfem.fem{g}.equ.ind. The shape function object, integration order, and constraint order data structures are defined below. In a typical application mode, the element type is only set on a subdomain level, but can be modified in coefficient view, boundary level, edge level, and point level. It is possible that an application mode has no subdomain extent, and thus is defined only on a boundary level and/or below. Then, in one implementation, for example, the application mode can set element types on a boundary level and allow modification of coefficient on edge level and point level.</p>
  <p num="p-0414">Referring to <figref idrefs="DRAWINGS">FIG. 39</figref>, shown is another example Subdomain Settings dialog box <b>900</b>, which permits a user to enter weak, dweak, and constr coefficient information the respective weak <b>902</b>, dweak <b>904</b>, and constr <b>906</b> fields of dialog box <b>900</b>. The dialog box can be made available in coefficient view, and also directly in the application mode, for PDE oriented application modes.</p>
  <p num="p-0415">Referring to <figref idrefs="DRAWINGS">FIG. 40</figref>, shown is an example of a representation of the data structure <b>1000</b> that may be included in an embodiment in connection with storing data in connection with the PDEs selected and combined. The data in the data structure <b>1000</b> may include data used in connection with the mutliphysics model, which is associated with local and/or non-local coupling variables.</p>
  <p num="p-0416">The data structure <b>1000</b> can include the following fields:</p>
  <p num="p-0417">
    <tables id="TABLE-US-00005" num="00005"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="2"> <colspec colname="1" colwidth="70pt" align="left"> </colspec> <colspec colname="2" colwidth="147pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
            </tr> <tr class="description-tr"> <td class="description-td">Data field</td>
              <td class="description-td">Description</td>
            </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td">fem.mesh</td>
              <td class="description-td">Finite element mesh</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}</td>
              <td class="description-td">Application mode I</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.dim</td>
              <td class="description-td">Dependent variable name</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.equ</td>
              <td class="description-td">Domain physical data</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.bnd</td>
              <td class="description-td">Boundary physical data</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.submode</td>
              <td class="description-td">Text string containing submode setting</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.border</td>
              <td class="description-td">Border on or off</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.appl{i}.usage</td>
              <td class="description-td">Matrix of subdomain usage</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.dim</td>
              <td class="description-td">Multiphysics dependent variable names</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.equ</td>
              <td class="description-td">PDE coefficients</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.bnd</td>
              <td class="description-td">Boundary conditions</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.border</td>
              <td class="description-td">Vector of border on or off</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.init</td>
              <td class="description-td">Initial value</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.sol</td>
              <td class="description-td">Finite element solution</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.sshape</td>
              <td class="description-td">Geometry approximation order</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.shape</td>
              <td class="description-td">Shape functions</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.expr</td>
              <td class="description-td">Definition of variables as expressions</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.equ</td>
              <td class="description-td">Variables, equations, constraints, and initial</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">values on subdomains</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.bnd</td>
              <td class="description-td">Variables, equations, constraints, and initial</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">values on boundaries</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.edg</td>
              <td class="description-td">Variables, equations, constraints, and initial</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">values on edges</td>
            </tr> <tr class="description-tr"> <td class="description-td">fem.pnt</td>
              <td class="description-td">Variables, equations, constraints, and initial</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">values on vertices</td>
            </tr> <tr class="description-tr"> <td namest="1" nameend="2" align="center" rowsep="1" class="description-td" colspan="2"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0418">As previously described, the data structure <b>1000</b> above can be extended for use with multiple geometries by storing the above data structure for geometry g in a list entry xfem.fem{g}.equ.ind.</p>
  <p num="p-0419">The data structure <b>1000</b> is similarly constructed and arranged as the data structure <b>250</b>, as described above, and further includes the additional fields: fem.sshape <b>280</b>, fem.shape <b>282</b>, fem.expr <b>284</b>, fem.equ <b>286</b>, fem.bnd <b>288</b>, fem.edg <b>290</b> and fem.pnt <b>292</b>, as described above. The global coordinates are polynomials in the local element coordinates of a certain degree k. This degree k can be specified in the field fem.sshape <b>280</b>. For instance, fem.sshape=2; uses quadratic shape functions for the global space coordinates. This makes it possible for the mesh elements at the boundary to be curved, and thus come closer to the true geometric boundary. The default k is equal to the maximum order of the shape function objects in fem.shape <b>282</b>, where k is called the geometry shape order. The field fem.shape <b>282</b> is a cell vector with shape function objects. For example, femshape={shlag(1,u) shlag(2,u) shvec(A)); defines three shape function objects. A user can choose on which domains these objects will be active, by using the fields fem.equ.shape, fem.bnd.shape, fem.edg,shape, fem.pnt.shape, as discussed in detail below.</p>
  <p num="p-0420">In addition, the fields correspond to the data structure fields xfem.fem {g}.equ.weak, xfem.fern{g}.equ.dweak, and xfem.fem{g}.equ.constr, respectively, in the data structure, as described above. The dialog box also sets the domain grouping xfem.fem{g}.equ.ind.</p>
  <p num="p-0421">In the fields fem.equ.shape, fem.bnd.shape, fem.edg.shape, and fem.pnt.shape, a user can specify where the shape function objects in fem.shape are to be used. For example, fem.shape=f shlag(1,u) shlag(2,u) sharg<sub></sub>2<sub></sub>5(v)}; fem.equ.shape={[1 3] [2 3] [ ] 3}; means that on the first subdomain group, only the first and third shape function objects (shlag(1,u) and sharg<sub></sub>2<sub></sub>5(v)) are active. On the second subdomain group, the second and third shape function objects are active. On the third subdomain group, no shape function objects are defined, while on the fourth subdomain group only sharg<sub></sub>2<sub></sub>5(v) is active. Thus, the variable u will be defined on subdomain groups 1 and 2, having linear elements in subdomain group 1, and quadratic elements in subdomain group 2. If these subdomains groups are adjacent, this will cause problems since hanging nodes can appear. Thus, the user should not mix elements for the same variable in adjacent subdomains. If the field fem.equ.shape is not given, then all shape function objects in fem.shape <b>282</b> apply in all subdomain groups.</p>
  <p num="p-0422">Similarly, the field fem.bnd.shape is a cell vector, which specifies for each boundary group which shape function objects are active. If fem.bnd.shape is not given, then it is inherited from fem.equ.shape. This means that a shape function object, which is active in a subdomain, is also active on the boundary of that subdomain (as well as boundaries lying within the subdomain).</p>
  <p num="p-0423">In 3-D, the field fem.edg.shape similarly specifies the usage of shape function objects on edge groups. If the usage of shape function objects is not given, it is inherited from the usage on subdomains and boundaries. That is, a shape function object which is active on some subdomain or some boundary, is also active on all edges that touch this subdomain or boundary. In 2-D and 3-D, the field fem.pnt.shape similarly specifies usage on vertices. Specifying usage on vertices is defaulted by inheritance from subdomain, boundaries, and edges.</p>
  <p num="p-0424">The fields fem.usage and fem.border mentioned earlier can be implemented in terms of the fem.***.shape fields by not assigning a shape function object to a subdomain, boundary, edge or point. Thus with the fields fem.***.shape, the fields fem.border and fem.usage are no longer necessary.</p>
  <p num="p-0425">The additional fields cporder, gporder, weak, dweak, constr, and expr are available in the fields fem.equ <b>286</b>, fem.bnd <b>288</b>, fem.edg <b>290</b>, and fem.pnt <b>292</b>. A user can define new field variables in tetins of others in the fields fem.expr <b>284</b>, fem.equ.expr, fem.bnd.expr, fem.edg.expr, and fem.pnt.expr. This can be convenient if your equations contain the same expression several times.</p>
  <p num="p-0426">In the field fem.expr <b>284</b> a user can put variable definitions that apply on all domain groups (of all dimensions). The field fem.expr <b>284</b> is a cell vector of alternating variable names and expressions. In fem.equ.expr a user can put variable definitions that are in force on subdomains. For example, fem.equ.expr={W B*H/2divux+vy}; defines W=B*H/2, and div=ux+vy on all subdomain groups. The defining expressions in the fem.equ.expr cell vector can be cell vectors, for instance fem.equ.expr={v {a+b ab } w pi*x*b}. This defines v to be a+b on subdomain group 1, and ab on subdomain group 2. The use of an empty vector [ ] instead of an expression means that the variable is not defined on the corresponding subdomain group. For example, fem.equ.expr={v {a+b [ ]}}; means that v=a+b on subdomain group 1, and v is undefined on subdomain group 2. Similarly, variable definitions on boundaries, edges, and vertices are put in fem.bnd.expr, fem.edg.expr, and fern.pnt.expr, respectively.</p>
  <p num="p-0427">The integrals occurring in the assembly of the matrices are computed numerically using a quadrature formula. The order of this quadrature formula is specified in the fields fem.equ.gporder, fer.bnd.gporder, fem.edg.gporder, and fem.pnt.gporder. The fem.***.gporder fields are entered in the dialog box of <figref idrefs="DRAWINGS">FIG. 38</figref> for subdomains. There are similar dialog boxes for boundaries, edges and points. The field fem.equ.gporder gives the order for integrals over subdomains. Fem.equ.gporder can be a number or a cell vector. In the first case, fem.equ.gporder applies to all subdomain groups. In the second case, fem.equ.gporder{i} applies to the ith subdomain group. Fem.equ.gporder{i} can be a number or a cell vector of numbers. In the latter case, fem.equ.gporder{i} {k} applies to the kth equation in coefficient or general form, and the kth integrand fem.equ.weak{i} {k} in the weak formulation.</p>
  <p num="p-0428">Similarly, fem.bnd.gporder, fem.edg.gporder, and fem.pntgporder gives the order for integrals over boundaries, edges, and vertices, respectively. The default value of the gporder fields is twice the maximum order of the shape functions you are using.</p>
  <p num="p-0429">The pointwise constraints are enforced in the Lagrange points of a certain order. This order is given in the fields fem.equ.cporder, fem.bnd.cporder, fem.edg.cporder, and fem.pnt.cporder. These fields have the same syntax as the gporder fields. The field fem.equ.cporder gives the order for constraints on subdomains. Fem.equ.cporder can be a number or a cell vector. In the first case, fem.equ.cporder applies to all subdomain groups. In the second case, fem.equ.cporder{i} applies to the ith subdomain group. Fem.equ.cporder{i} can be a number or a cell vector of numbers. In the latter case, fem.equ.cporder{i} {k} applies to the kth constraint on subdomain group i. Similarly, fem.bnd.cporder, fem.edg.cporder, and fem.pnt.cporder gives the order for constraints on boundaries, edges, and vertices, respectively. The default value of the cporder fields is equal to the maximum of the orders of the shape functions you are using. The fem.***.cporder fields are entered in the dialog box of <figref idrefs="DRAWINGS">FIG. 38</figref> for subdomains. There are similar dialog boxes for boundaries, edges and points.</p>
  <p num="p-0430">Equations in weak form are stored in the fields fem.equ.weak, fem.bnd.weak, fem.edg.weak, and fem.pnt.weak. The field fem.equ.weak contains the integrand in the integral over subdomains. Fem.equ.weak can be a string expression or a cell vector. In the first case the expression applies to all subdomain groups. In the second case, fem.equ.weak{k} applies to the kth subdomain group. Fem.equ.weak{k} can be an expression or a cell vector of expressions. In the latter case, the expressions in the cell vector are added. In the expressions representing the integrand, the test function corresponding to a variable v is denoted v_test. Then v_test will have the same shape functions as v. Similarly, the fields fem.bnd.weak, fem.edg.weak, and fem.pnt.weak contain integrands that are integrated over boundaries, edges, and points, respectively, All these integrals are put on the right-hand side of the weak equation.</p>
  <p num="p-0431">For a time-dependent problem, the terms containing time derivatives are stored in fern.equ.dweak, fem.bnd.dweak, fem.edg.dweak, and fem.pnt.dweak. These have the same syntax as the weak fields, except that the time derivatives must enter linearly. The time derivative of a variable v is denoted v_time. The integrals defined by the dweak fields are put on the left-hand side of the weak equation. The <figref idrefs="DRAWINGS">FIGS. 39</figref>, <b>37</b>, <b>44</b>, and <b>43</b> shows the dialog boxes for entering the fields weak and dweak for subdomains, boundaries, edges, and points, respectively.</p>
  <p num="p-0432">Eigenvalue problems are specified like time-dependent problems. Then v_time may be interpreted.</p>
  <p num="p-0433">The constraints in the weak problem formulation are stored in the fields fem.equ.constr, fem.bnd.constr, fem.edg.constr, and fem.pnt.constr. These constraints are implemented pointwise. In contrast, when using the general form, the Jacobian of R will only account for derivatives with respect to the dim variables (and not with respect to their derivatives, for example). The constraints on subdomains (R(n), where n is the space dimension) are given in the field fem.equ.constr. This field can be an expression or a cell vector. In the first case, the expression fem.equ.constr is constrained to be zero on all subdomain groups. In the second case, fem.equ.constr{k} applies to the kth subdomain group. Fem.equ.constr{k} can be an expression or a (possibly empty) cell vector of expressions. These expressions are constrained to be zero on the kth subdomain group. Similarly, constraints on boundaries, edges, and vertices are defined in fem.bnd.constr, fem.eng.constr, and fem.pnt.constr, respectively.</p>
  <p num="p-0434">Referring to <figref idrefs="DRAWINGS">FIG. 41</figref>, shown is an example of a weak formulation <b>1100</b> or weak solution form. The first equation <b>1102</b> is the weak equation, and the others are the constraints <b>1104</b>. Here W is the subdomains, B is the boundaries (including outer and internal boundaries), and P is the vertices (points) defined in the geometry. The integrands W<sup>i </sup>are scalar expressions involving the dependent variables u<sub>1</sub>, u<sub>2</sub>, . . . , u<sub>N </sub>as well as the test functions v<sub>1</sub>, v<sub>2</sub>, . . . , v<sub>N</sub>, and their derivatives. The test functions and their derivatives enter linearly.</p>
  <p num="p-0435">Referring to <figref idrefs="DRAWINGS">FIG. 42</figref>, shown is a conversion from general form to weak form. Moreover, conversion from general form to weak form is performed according to the formula <b>1200</b>, as shown in <figref idrefs="DRAWINGS">FIG. 42</figref>, where there is an implicit summation over the k and i indices in each product, and n is the space dimension. Affected fields are therefore ga, f, weak, da and dweak from equ and g, weak, r and constr from bnd, with weak, dweak and constr, which are the only fields remaining. Other fields within equ and bnd, such as shape, init, etc., remain unchanged.</p>
  <p num="p-0436">In addition, when converting to weak form, according to <figref idrefs="DRAWINGS">FIG. 42</figref>, fem.border can be taken into account. That is to say that if fem.border is not 1 or on, there may be borders on which boundary conditions should not be applied. In order to decide in which subdomains each dependent variable is in use, and hence decide on which boundaries and borders to apply conditions, a comparison is made between the variable names in fem.dim and the field variables defined by the shape function objects being used.</p>
  <p num="p-0437">Referring to <figref idrefs="DRAWINGS">FIG. 43</figref>, shown is an example of a Point Settings dialog box <b>1300</b>. The Point Settings dialog box allows <b>1300</b> permits entry of fem.pnt.weak, fem.pnt.dweak and fem.pnt.constr fields on each point in the respective weak <b>1302</b>, dweak <b>1304</b>, and constr <b>1306</b> fields of the dialog box <b>1300</b>.</p>
  <p num="p-0438">Referring to <figref idrefs="DRAWINGS">FIG. 44</figref>, shown is an example of an Edge Settings dialog box <b>1400</b>. The Edge Settings dialog box <b>1400</b> permits entry of fem.edg.weak, fem.edg.dweak, and fem.edg.constr fields on each edge (in 3-D) in the respective weak <b>1402</b>, dweak <b>1404</b> and constr <b>1406</b> fields of the dialog box <b>1400</b>. In coefficient view, there are similar user interfaces for adding weak, dweak, and constr contributions on boundary and subdomain level.</p>
  <p num="p-0439">Referring to <figref idrefs="DRAWINGS">FIGS. 45A</figref>, <b>45</b>B and <b>45</b>C, shown are various pages of a Coupling Variable Settings dialog box <b>1500</b>, respectively showing a Variables page <b>1500</b>A, Source page <b>1500</b>B and Destination page <b>1500</b>C. In the Coupling Variable Settings dialog box <b>1500</b> a user can specify non-local coupling variables. On the Variables page <b>1500</b>A shown in <figref idrefs="DRAWINGS">FIG. 45A</figref>, a user can specify the name of the coupling variable in the Variable name edit field <b>1502</b>. The type of coupling is specified in the Variable type drop-down list box <b>1504</b>. A user can select scalar, extrusion or projection variables from the Variable type drop-down list box <b>1504</b>. After a user has entered a new variable name, the user can click Add <b>1506</b> to add the new variable name to the list of coupling variables. The user can also click Delete <b>1508</b> to delete the highlighted variable in the list.</p>
  <p num="p-0440">On the Source page <b>1500</b>B, as shown in <figref idrefs="DRAWINGS">FIG. 45B</figref>, the source of the coupling is specified, i.e. the details of the evaluation undertaken. The evaluation may take place in any geometry in one or more of the domains at one of the levels subdomain, boundary, edge, or point. The levels which may be used are partly dependent on the geometry selected in the Geometry drop-down list box <b>1502</b>, and partly dependent on variable type being used, so not all levels will always be available in the Level drop-down list box <b>1504</b>.</p>
  <p num="p-0441">When selecting geometry and domain level, the Source page <b>1500</b>B will enter the corresponding mode. Domains are then selected either from the list box <b>1506</b> or by clicking on the domains in the GUI. For extrusion variables, the expression given in the Expression edit field <b>1508</b> will be the one which is evaluated within the selected domain(s). For scalar and projection variables, the Expression edit field <b>1508</b> is replaced by an Integrand edit field (not shown), and the Integration order edit field (not shown), which gives the order of the Gauss quadrature rule which is used for integrating the variables over the source domains for the scalar variable, along the projection curve for projection variables.</p>
  <p num="p-0442">The Local mesh transformation edit fields x <b>1510</b> <i>a</i>, y <b>1510</b> <i>b</i>, and z <b>1510</b> <i>c </i>may only be used when defining an extrusion or projection variable. The fields <b>1510</b> <i>a</i>, <b>1510</b> <i>b </i>and <b>1510</b> <i>c </i>contain expressions of the space coordinates, e.g. x, y, and z, or local mesh parameters, e.g. s, s1, or s2, which are then applied to create a new source mesh for use in interpolating or setting the position and direction of lines used for evaluating line integrals. The number n of these edit fields, which are enabled, depends on the dimensionality of the domain(s) used as the source. For example, n is 2 if using boundaries in a 3-D geometry, because such boundaries are 2-D surfaces.</p>
  <p num="p-0443">On the Destination page <b>1500</b> <i>c</i>, as shown in <figref idrefs="DRAWINGS">FIG. 45C</figref>, a user can define where the variable is to be made available. The destination geometry and domain are specified in the same way as the source geometry, level, and domain are specified on the Source page <b>1500</b>B. For scalar variables, a user can simply use the Active Member in this domain checkbox if the user would like the specified variable to be available in the selected domain. For extrusion and projection variables, defining an Evaluation point transformation in the edit fields x <b>1512</b> <i>a</i>, y <b>1512</b> <i>b</i>, z <b>1512</b> <i>c </i>activates the variable in the selected domain. If n of the mesh transformation edit fields were enabled on the Source page <b>1500</b>B, there will be respectively n and n1 evaluation point transformation edit fields enabled on the Destiantion page <b>1500</b>C for extrusion and projection variables. Again the mesh transformation edit fields x <b>1512</b> <i>a</i>, y <b>1512</b> <i>b </i>and z <b>1512</b> <i>c </i>should be expressions of the space coordinates or local mesh parameters.</p>
  <p num="p-0444">For extrusion variables the user can set the interpolation points within the source mesh. For projection variables the evaluation for each destination evaluation point is a line integral. The position of the line is given as follows; the first n1 coordinates in the source mesh are specified by the evaluation point transformations) applied to the destination evaluation point, and the n-th coordinate is allowed to vary.</p>
  <p num="p-0445">Referring to <figref idrefs="DRAWINGS">FIGS. 46 and 47</figref>, respectively shown are examples of a variables page <b>1600</b>A and a Definition page <b>1600</b>B of an Expression Variable Settings dialog box <b>1600</b>. In the Expression Variable Settings dialog box <b>1600</b>, the user can define expressions to be used in a model. The Expression Variable Settings dialog box <b>1600</b> provides a convenient way to introduce short names for complicated expressions that the user wants to use when entering parameters for the model. Another use for expression variables is in post processing, where if the user wants to plot some quantity that is defined by different application modes, which are in different domains, the user can define an expression variable that uses the correct expression in the different domains and then plot the expression variable.</p>
  <p num="p-0446">On the Variables page <b>1600</b>A, as shown in <figref idrefs="DRAWINGS">FIG. 46</figref>, the user can enter the name of the variable in the Variable name field <b>1602</b> to define an expression. Expressions can be either domain-based, i.e. at subdomain/boundaryledge/point level, or geometry-based, i.e., the expression is defined everywhere on the geometry. This variable type can be specified in the Variable type drop-down list box <b>1604</b>.</p>
  <p num="p-0447">On the Definition page, as shown in <figref idrefs="DRAWINGS">FIG. 47</figref>, the user can specify in which geometry and in which domain the expression should be defined by respectively selecting from the Geometry drop-down list <b>1606</b> and the Level drop-down list <b>1608</b>. In the Expression edit field <b>1610</b>, the user can enter the expression to be defined by the specified variable. The definitions are recorded in the fields fem.expr, fem.equ.expr, fem.bnd.expr, etc. in the data structure (<figref idrefs="DRAWINGS">FIG. 40</figref>) for the appropriate geometry. Where a definition is not given in the dialog for a subdomain, the corresponding entry in fem.equ.expr will be the empty matrix, which means that it is not defined, this similarly holds true for bnd, edg, and pnt.</p>
  <p num="p-0448">Referring to <figref idrefs="DRAWINGS">FIGS. 48-50</figref>, shown is an example of another embodiment of a flowchart of steps of one method for automatically specifying one or more systems of PDEs, which PDEs are associated with non-local coupling of variables, representing the PDEs in a single combined form, and solving a system of PDEs. Many of these steps are similar to those described in connection with, for examples, <figref idrefs="DRAWINGS">FIGS. 22 and 23</figref> described elsewhere herein. What will now be described are a highlight of additional steps with respect to other descriptions in connection with <figref idrefs="DRAWINGS">FIGS. 22 and 23</figref>.</p>
  <p num="p-0449">Referring now to <figref idrefs="DRAWINGS">FIG. 48</figref>, the flowchart <b>2200</b> at step <b>2202</b>, a first geometry is selected. At step <b>2204</b>, a determination is made as to whether all geometries are processed. If not, control proceeds to step <b>2100</b>. If all geometries are processed, control proceeds to step <b>2120</b>. Generally, the processing steps set forth in <figref idrefs="DRAWINGS">FIG. 49</figref>, flowchart <b>2000</b> may be performed for each geometry of interest. Additionally, this embodiment uses PDEs in the weak form. Thus, step <b>2114</b> provides for forming the weak form of the equations from the general form of step <b>2112</b>.</p>
  <p num="p-0450">Several specific examples of the present invention, as set forth herein, include a scalar coupling example, an extrusion coupling example, and a projection coupling example, followed by a discussion of the Weak solution form and the Solvers; Sparsity of Jacobian and Non-Local Dirichlet Boundary Conditions. In addition, other specific examples of the present invention, as set forth herein, include a Packed Bed Reactor example and a Magnetic Brake example.</p>
  <p num="h-0019">Extended Multiphysics</p>
  <p num="h-0020">Coupling Variables</p>
  <p num="p-0451">Variables in FEMLAB are generally evaluated locally-their value at each evaluation point is computed using information only from that evaluation point. In contrast, the value of a coupling variable is the result of a computation carried our elsewhere in the geometry or even in another geometry altogether. When used in the PDE and boundary conditions, the result is the introduction of non-local dependenciesextended multiphysicsas opposed to ordinary multiphysics, which refers to dependencies between variables in same geometric location.</p>
  <p num="p-0452">The coupling variables are extremely powerful in their ability to make the values of an expression available non-locally. The coupling variables are not only useful for modeling coupled problems-they can also be used solely for post processing and visualization purposes.</p>
  <p num="p-0453">All coupling variables are defined in two steps. First define the source, i.e., the domains in which the evaluation takes place, the nature of that evaluation, and the name given to the resulting variable; secondly define the destination, i.e. the domains within which it is possible to use the resulting variable.</p>
  <p num="p-0454">There are three kinds of coupling variables implemented: scalar, extrusion, and projection.</p>
  <p num="h-0021">Specifying Non-Local Couplings</p>
  <p num="p-0455">In the graphical user interface you can define coupling variables by using the Coupling Variable Settings dialog box from the Options menu as shown in <figref idrefs="DRAWINGS">FIG. 51</figref>.</p>
  <p num="p-0456">The Source and Destination tabs allow you to define the source and destination details and the Variable type gives the choice of scalar, extrusion, or projection variables.</p>
  <p num="p-0457">The following examples, also give advice on defining coupling variables.</p>
  <p num="p-0458">Coupling variables can be defined at the MATLAB prompt by creating element syntax structures.</p>
  <p num="h-0022">Scalar Couplings</p>
  <p num="p-0459">Use scalar coupling variables to make scalar values available elsewhere in your model. The source of the scalar value can be an expression in a vertex. In addition, the source of the scalar value can be the integral of an expression over one or several subdomains, boundaries, or edges. The destination of the scalar variable can be the full geometry, one or several subdomains, boundaries, edges, or vertices.</p>
  <p num="h-0023">Scalar Coupling Example</p>
  <p num="p-0460">As a simple example, consider the case of Poisson's equation on a single rectangular domain as shown in <figref idrefs="DRAWINGS">FIG. 52</figref>. The integral of the square of the solution is used as in-flux in a Neumann boundary condition on the right boundary. There is a Dirichlet boundary condition on the left boundary, and the top and button boundaries have zero in-flux. The problem is nonlinear so you have to use the nonlinear solver. The right boundary condition contains the scalar coupling variable in a coefficient, so the weak solution form must be used.</p>
  <p num="p-0461"> <maths id="MATH-US-00016" num="00016"> <math overflow="scroll"> <mrow> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mi>u</mi> </mrow> <mo>=</mo> <mrow> <mn>1</mn> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi></mi> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00016-2" num="00016.2"> <math overflow="scroll"> <mrow> <mi>u</mi> <mo>=</mo> <mrow> <mi>x</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <msub> <mi></mi> <mn>1</mn> </msub> </mrow> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00016-3" num="00016.3"> <math overflow="scroll"> <mrow> <mfrac> <mrow> <mo></mo> <mi>u</mi> </mrow> <mrow> <mo></mo> <mi>n</mi> </mrow> </mfrac> <mo>=</mo> <mrow> <mn>0</mn> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <msub> <mi></mi> <mrow> <mn>2</mn> <mo>,</mo> <mn>3</mn> </mrow> </msub> </mrow> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00016-4" num="00016.4"> <math overflow="scroll"> <mrow> <mfrac> <mrow> <mo></mo> <mi>u</mi> </mrow> <mrow> <mo></mo> <mi>n</mi> </mrow> </mfrac> <mo>=</mo> <mrow> <mo>-</mo> <mrow> <msubsup> <mo></mo> <mi></mi> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </msubsup> <mo></mo> <mrow> <msup> <mi>u</mi> <mn>2</mn> </msup> <mo></mo> <mstyle> <mspace width="0.2em" height="0.2ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi></mi> </mrow> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <msub> <mi></mi> <mn>4</mn> </msub> </mrow> </mrow> </mrow> </mrow> </mrow> </math> </maths> <br>
Model Navigator
<br>
Start FEMLAB and select the 2-D, Coefficient, Nonlinear, PDE mode in the Model navigator. Use the LagrangeQuadratic element type. Press the More button, and select solution form Weak.
<br>
Draw Mode
</p>
  <p num="p-0462">Draw a single rectangle of any size.</p>
  <p num="h-0024">Boundary Mode</p>
  <p num="p-0463">Change the following boundary coefficients:</p>
  <p num="p-0464"> <tables id="TABLE-US-00006" num="00006"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="5"> <colspec colname="offset" colwidth="14pt" align="left"> </colspec> <colspec colname="1" colwidth="63pt" align="left"> </colspec> <colspec colname="2" colwidth="49pt" align="left"> </colspec> <colspec colname="3" colwidth="49pt" align="left"> </colspec> <colspec colname="4" colwidth="42pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="4" align="center" rowsep="1" class="description-td" colspan="5"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">BOUNDARY</td> <td class="description-td">1</td> <td class="description-td">2-3</td> <td class="description-td">4</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="4" align="center" rowsep="1" class="description-td" colspan="5"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Type</td> <td class="description-td">Dirichlet</td> <td class="description-td">Neumann</td> <td class="description-td">Neumann</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">r</td> <td class="description-td">x</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">g</td> <td class="description-td"> </td> <td class="description-td">0</td> <td class="description-td">int2</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="4" align="center" rowsep="1" class="description-td" colspan="5"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Subdomain Mode
</p>
  <p num="p-0465">Use the default PDE coefficients (Poisson's equation).</p>
  <p num="p-0466">Open the Add/Edit Coupling Variables dialog box.</p>
  <p num="p-0467">Enter the variable name int2, and choose the default rye Scalar. Press Add.</p>
  <p num="p-0468">Go to the Source page and select subdomain 1. Enter u^2 in the Expression field, and enter 4 in the Integration order field.</p>
  <p num="p-0469">As a simple rule, the integration order can be the maximum of the quadrature order for the integration of the shape functions of the variables in the expression.</p>
  <p num="p-0470">On the Destination page, select boundary 4 and check Active in this domain.</p>
  <p num="p-0471">Return to the Variables page to check the definition. Finally, press OK.</p>
  <p num="h-0025">Solve Problem</p>
  <p num="p-0472">Press the Solve Problem button to start the simulation.</p>
  <p num="h-0026">Post Mode</p>
  <p num="p-0473">Open the Subdomain Integration item on the Post menu. Type u^2 in the expression field. Select subdomain 1 and press Apply. The integral of the solution is displayed in the message log.</p>
  <p num="p-0474">Open the Plot Parameters dialog box. Check Contour and uncheck Surface. Press the Contour tab. Change the Contour expression to ux. Click in the GUI on the right boundary, and verify that the in-flux is equal to the integral.</p>
  <p num="h-0027">Brief Examples of Scalar Couplings</p>
  <p num="p-0475">One example of scalar couplings is to use scalar values from a vertices on the adjacent boundary as shown in <figref idrefs="DRAWINGS">FIG. 53A</figref>. In structural mechanics, you can use this type of coupling to formulate displacement constraints along a boundary in terms for the displacements of the end point.</p>
  <p num="p-0476">Another example is to use the integral over a subdomain in a 2-D geometry along a subdomain in another 1-D geometry as shown in <figref idrefs="DRAWINGS">FIG. 53B</figref>. This is useful for process industry models, where two different processes interact.</p>
  <p num="h-0028">Extrusion Couplings</p>
  <p num="p-0477">An extrusion coupling variable takes values from the source domain(s) by interpolation of an expression at points that are dependent in some way on the position of the evaluation points in the destination domain(s).</p>
  <p num="p-0478">When the destination domain has more space dimensions than the source domain, the variable performs extrusion of values. The extrusion coupling variable can also be used for mapping values from the source to the destination. This is applicable when the source and destination domains have the same number of space dimensions.</p>
  <p num="p-0479">The method employed is that first a one-to-one transformation is applied to the mesh of the source domain(s). This transformation may be trivial and leave the coordinates unchanged, but it can also be used to rescale, stretch, bend, or reflect the mesh. Then a second transformation is applied to the evaluation points in the destination domain(s), and the resulting points are used for the interpolation of an expression at points in the transformed source mesh.</p>
  <p num="h-0029">Extrusion Coupling Example</p>
  <p num="p-0480">Consider the case of a single rectangular domain, where the source term in Poisson's equation comes from the inward flux over the right boundary for the corresponding y coordinate.</p>
  <p num="p-0481">
    <maths id="MATH-US-00017" num="00017"> <math overflow="scroll"> <mrow> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mi>u</mi> </mrow> <mo>=</mo> <mrow> <mfrac> <mrow> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </mrow> <mrow> <mo></mo> <mi>n</mi> </mrow> </mfrac> <mo></mo> <mrow> <mi>u</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <msub> <mi>x</mi> <mn>2</mn> </msub> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi></mi> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00017-2" num="00017.2"> <math overflow="scroll"> <mrow> <mi>u</mi> <mo>=</mo> <mrow> <mi>xy</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>on</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi></mi> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0482">The figure shown in <figref idrefs="DRAWINGS">FIG. 54</figref> illustrates the extrusion process. The values of the in-flux on the boundary become available throughout the domain by extrusion along the y-axis. The source transformation mapping is y, and the destination transformation mapping is y.</p>
  <p num="p-0483">The problem is linear so you can use the linear solver. We use the weak term to specify the source term in the Poisson equation, so we do not have to use the weak solution form.</p>
  <p num="h-0030">Model Navigator</p>
  <p num="p-0484">Start FEMLAB and select the 2-D, Coefficient, Linear, PDE mode in the Model navigator. Use the LagrangeQuadratic element type.</p>
  <p num="h-0031">Draw Mode</p>
  <p num="p-0485">Draw a single rectangle of any size.</p>
  <p num="h-0032">Boundary Mode</p>
  <p num="p-0486">In boundary mode, select all boundaries. Sec the r coefficient to x*y.</p>
  <p num="h-0033">Subdomain Mode</p>
  <p num="p-0487">On the Weak tab, set the subdomain 1 weak term to u_test*flux. (Poisson's equation with source flux)</p>
  <p num="p-0488">Open the Add/Edit Coupling Variables dialog box.</p>
  <p num="p-0489">Enter the variable name flux and choose the default type Extrusion and press Add.</p>
  <p num="p-0490">Go to the Source page and select boundary 4. Enter ncu in the Expression field, and set local mesh transformation to y.</p>
  <p num="p-0491">On the Destination page, select subdomain 1, and set local mesh transformation to y.</p>
  <p num="p-0492">Return to the Variables page to check the definition. Finally, press OK.</p>
  <p num="h-0034">Solve Problem</p>
  <p num="p-0493">Press the Solve Problem button.</p>
  <p num="h-0035">Post Mode</p>
  <p num="p-0494">On the Surface tab, change Surface expression to flux.</p>
  <p num="p-0495">On the Line tab, check Line plot, and select ncu as Line expression.</p>
  <p num="p-0496">Press OK.</p>
  <p num="p-0497">The plot shows both the value of the flux variable on the destination domain and the source ncu on the boundary.</p>
  <p num="h-0036">Brief Examples of Extrusion Couplings</p>
  <p num="p-0498">One application of extrusion couplings is to mirror the solution in the x-axis as shown in <figref idrefs="DRAWINGS">FIG. 55A</figref>. This can be very useful for post processing. The source transformation mapping is x, y, and the destination transformation mapping is x, y.</p>
  <p num="p-0499">Another example is to extrude the solution in the 1-D geometry to the 2-D along the s axis as shown in <figref idrefs="DRAWINGS">FIG. 55B</figref>. The source transformation mapping is x, and the destination transformation mapping is r.</p>
  <p num="p-0500">Yet another example is to map values on the lower boundary to the right boundary on the same rectangle as shown in <figref idrefs="DRAWINGS">FIG. 55C</figref>. The source transformation mapping is (x+1)/2 and the destination transformation mapping is y.</p>
  <p num="h-0037">Projection Couplings</p>
  <p num="p-0501">A projection coupling variable takes values from the source domain(s) by evaluating a series of line integrals within the source domain(s), where the line positions are dependent on the positions of the evaluation points in the destination domain(s). In this way you can evaluate the average of a variable over one space variable at a range of different points along the other space axis, giving a result which varies over the latter space variable.</p>
  <p num="p-0502">The method employed is that first a one-to-one transformation is applied to the mesh of the source domain(s). The last space dimension hi the transformed mesh is the one integrated over, so the lines used to integrate are vertical in the transformed source mesh. The placement of the vertical lines in the transformed source mesh is given by the positions of the transformed destination evaluation points. The integrals are then carried out in the source domains) over lines which correspond to the vertical lines in the transformed source mesh.</p>
  <p num="p-0503">Then a second transformation is applied to the evaluation points in the destination domain(s), and the resulting points are used for the interpolation of an expression at points in the transformed source mesh.</p>
  <p num="h-0038">Brief Examples of Projection Couplings</p>
  <p num="p-0504">Referring to <figref idrefs="DRAWINGS">FIGS. 56A-56C</figref>, for each point r return</p>
  <p num="p-0505">
    <maths id="MATH-US-00018" num="00018"> <math overflow="scroll"> <mrow> <mrow> <mi>v</mi> <mo></mo> <mrow> <mo>(</mo> <mi>r</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <msub> <mo></mo> <mrow> <mi>y</mi> <mo>=</mo> <mrow> <mi>r</mi> <mo>/</mo> <mn>2</mn> </mrow> </mrow> </msub> <mrow> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> <mo></mo> <msub> <mi>S</mi> <mn>2</mn> </msub> </mrow> </munder> <mo></mo> <mrow> <mrow> <mi>u</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.2em" height="0.2ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0506">The source transformation mapping is y, x, and the destination transformation mapping is r/2.</p>
  <p num="p-0507">For each Point (0,s) return</p>
  <p num="p-0508">
    <maths id="MATH-US-00019" num="00019"> <math overflow="scroll"> <mrow> <mrow> <mi>v</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mn>0</mn> <mo>,</mo> <mi>s</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <msub> <mo></mo> <mrow> <mi>y</mi> <mo>=</mo> <mi>s</mi> </mrow> </msub> <mrow> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> <mo></mo> <msub> <mi>S</mi> <mn>2</mn> </msub> </mrow> </munder> <mo></mo> <mrow> <mrow> <mi>u</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.2em" height="0.2ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0509">The source transformation mapping is y, x, and the destination transformation mapping is s.</p>
  <p num="p-0510">For each point (r,0) return</p>
  <p num="p-0511">
    <maths id="MATH-US-00020" num="00020"> <math overflow="scroll"> <mrow> <mrow> <mi>v</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>r</mi> <mo>,</mo> <mn>0</mn> </mrow> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <msub> <mo></mo> <mrow> <mi>y</mi> <mo>=</mo> <mrow> <mi>r</mi> <mo>/</mo> <mn>2</mn> </mrow> </mrow> </msub> <mrow> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> <mo></mo> <msub> <mi>S</mi> <mn>2</mn> </msub> </mrow> </munder> <mo></mo> <mrow> <mrow> <mi>u</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mi>y</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.2em" height="0.2ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> </mrow> </mrow> </mrow> </math> </maths> </p>
  <p num="p-0512">The source transformation mapping is y, x, and the destination transformation mapping is r/2.</p>
  <p num="p-0513">Also non-rectangular domains can be swept by the integration. Only the source domains will be included in the integrals. Other domains and the external area will be excluded from the integrals.</p>
  <p num="h-0039">The Weak Solution Form and the Solvers</p>
  <p num="p-0514">FEMLAB computes the exact Jacobian contribution for the coupling variables when the coupling variables are evaluated as weak terms. The easiest way of achieving this is by using solution form Weak. It can also be achieved by with solution form Coefficient or General by specifying all coupling variables in weak terms on the Weak tabs.</p>
  <p num="p-0515">If you use a coupling variable in a coefficient, without using solution form Weak, the Jacobian is likely to be incorrect-and the nonlinear solver might not converge even for linear couplings.</p>
  <p num="p-0516">For stationary problems with coupling variables, you should always use the nonlinear solver-it can sometimes be difficult to see if the problem is nonlinear or not. If you are sure about the linearity of the problem, and coupling variables only occur in weak terms, the linear solver can be safely used.</p>
  <p num="h-0040">Sparsity of Jacobian</p>
  <p num="p-0517">The Jacobian for problems formulated using the finite element method is usually large, but rather sparse, i.e., with relatively few nonzero elements. This is because the solution at each node in the mesh can be dependent at most on the degrees of freedom from the neighboring mesh elements. If however coupling variables are introduced, non-local dependencies are introduced, filling up the rows and columns of the affected source and destination nodes. This extra filling may make the Jacobian matrix slightly less sparse (in which case the solution speed is only slightly affected) or it may make it a great deal less sparse (in which case the memory use and CPU time involved in solving the problem may be increased a great deal). For this reason care should be taken when introducing non-local couplings.</p>
  <p num="h-0041">Non-Local Dirichlet Boundary Conditions</p>
  <p num="p-0518">When using coupling variables in Dirichlet boundary conditions, the constraint is handled by adjusting both the source and the destination values until the constraint is satisfied. This corresponds approximately to how periodic boundary constraints are handled in FEMLAB, and this may be appropriate in the context of the problem being modeled. Often, however, it is more appropriate to leave the source unaffected and constrain only the destination. If this is the case, the constraint should be handled</p>
  <p num="h-0042">Packed Bed Reactor</p>
  <p num="p-0519">One of the most common reactors in the chemical industry, for use in heterogeneous catalytic processes, is the packed bed reactor as shown in <figref idrefs="DRAWINGS">FIG. 57</figref>. This type of reactor is used both in synthesis as well as in effluent treatment and catalytic combustion. The reactor consists in essence of a container filled with catalyst particles. These particles can be contained within a supporting structure, like tubes or channels, or they can be packed in one single compartment in the reactor.</p>
  <p num="p-0520">The structure that is formed by the packed catalyst particles makes the modeling of mass and energy transport in the reactor a challenging task. The difficulty lies in the description of the porous structure, which gives transport of different orders of magnitudes within the particles and between the particles. In most cases, the structure between the particles is described as macro porous and the pore radius can be of the order of magnitude of mm. When a pressure difference is applied across the bed, convection arises in the macro pores. The pores inside the catalyst particles form the microstructure of the bed. The pore radius in these particles is often between one and ten mm.</p>
  <p num="p-0521">This model presents a simple and fast alternative for studying macro- and micro-mass balances in packed beds and other heterogeneous rectors with bimodal pore distribution. The simulation gives the mass and reaction distribution, and the same type of approach for the heat balance accounts for the temperature profile in the reactor. The equations are based on simple mass balances for the macro and micro systems.</p>
  <p num="p-0522">The mass balance for the macro system are based on the equation for convection-diffusion-reaction:
<br>(<i>Dc+cu</i>)+<i>R=</i>0</p>
  <p num="p-0523">In the above equation D denotes the diffusion coefficient (m<sup>2</sup>s<sup>1</sup>), c concentration (mol m<sup>3</sup>), u the velocity vector (m s<sup>1</sup>) and R denotes the reaction term (mol m<sup>3 </sup>s<sup>1</sup>). The solution of the above equation requires proper boundary conditions:</p>
  <p num="p-0524">
    <maths id="MATH-US-00021" num="00021"> <math overflow="scroll"> <mrow> <mrow> <mi>c</mi> <mo>=</mo> <mrow> <mrow> <mrow> <msub> <mi>c</mi> <mn>0</mn> </msub> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>at</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <msub> <mi></mi> <mi>inlet</mi> </msub> </mrow> </mrow> <mo></mo> <mstyle> <mtext> </mtext> </mstyle> <mo>-</mo> <mrow> <mi>D</mi> <mo></mo> <mrow> <mrow> <mo></mo> <mi>c</mi> </mrow> <mo></mo> <mi>n</mi> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mn>0</mn> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>at</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mrow> <mrow> <mo></mo> <mrow> <msub> <mi></mi> <mi>outlet</mi> </msub> <mo></mo> <mstyle> <mtext> </mtext> </mstyle> <mo>(</mo> <mrow> <mrow> <mrow> <mo>-</mo> <mi>D</mi> </mrow> <mo></mo> <mrow> <mo></mo> <mi>c</mi> </mrow> </mrow> <mo>+</mo> <mi>cu</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mi>n</mi> </mrow> </mrow> <mo>-</mo> <mrow> <mn>0</mn> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>at</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>all</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>other</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>bounderies</mi> </mrow> </mrow> </mrow> </mrow> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </mrow> </math> </maths> </p>
  <p num="p-0525">At a first glance, these equations look simple to solve, especially if the velocity vector is given by an analytical expression, which is the case for plug flow in a packed bed reactor. However, the reaction term, R, depends on the transport in the micro particles, which in general is obtained by calculating the flux into the particles, at the outer surface of the particle, times the available outer surface area of the particles per unit volume:
<br> <i>R=A</i> <sub>p</sub> <i>N</i>(<i>r=R</i> <sub>p</sub>)<i>n </i> </p>
  <p num="p-0526">In this equation, A<sub>p </sub>denotes the outer surface area of the particle per unit volume (m<sup>2 </sup>m<sup>3</sup>), N denotes the flux vector (mole m<sup>2</sup>s<sup>1</sup>), in this case the flux in the porous particle, r the independent variable for the radius of the particle (m), Rp the radius of the particle, and n the normal vector to the particle surface.</p>
  <p num="p-0527">To solve the equations above, the reaction term, R, has to be calculated. This implies the formulation of a new mass balance in micro scale. Such a mass balance is expressed by the equation below:
<br>(<i>Dc</i>)+<i>kc</i> <sup>y</sup>=</p>
  <p num="p-0528">Here, D is the effective diffusion coefficient in the particle, c is the concentration in the particle, and k the reaction rate constant for the heterogeneous reaction in the particle (mol<sup>(y1)</sup>s<sup>1</sup>m<sup>3(y1)</sup>) In this case, transport takes place by diffusion only.</p>
  <p num="p-0529">The diffusion-reaction equation, combined with the boundary conditions for the particle, give the concentration distribution in the particle.</p>
  <p num="p-0530"> <maths id="MATH-US-00022" num="00022"> <math overflow="scroll"> <mrow> <mrow> <mrow> <mo>-</mo> <msup> <mi>D</mi> <mi></mi> </msup> </mrow> <mo></mo> <mrow> <mrow> <mo></mo> <msup> <mi>c</mi> <mi></mi> </msup> </mrow> <mo></mo> <mi>n</mi> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mn>0</mn> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>at</mi> <mo></mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo></mo> <mi>r</mi> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </mrow> </math> </maths> <maths id="MATH-US-00022-2" num="00022.2"> <math overflow="scroll"> <mrow> <msup> <mi>c</mi> <mi></mi> </msup> <mo>=</mo> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mi>c</mi> </mrow> </mrow> </math> </maths> <br>
where  denotes the porosity of the particle. This implies symmetry in the middle of the particle. In addition, the concentration at the surface of the particle is equal to the concentration outside of the particle compensated by the fact that part of the particle volume is occupied by solid catalyst support.
</p>
  <p num="p-0531">The concentration distribution in the particle gives the flux at every point in the particles. This implies that the reaction term for the catalyst bed is given by the solution of the micro mass balance:
<br> <i>R=A</i> <sub>p</sub>(<i>Dcn</i>)</p>
  <p num="p-0532">The complication in solving this system of equations is that the macro balance and the micro balance are defined in different coordinate systems. This problem is general for many chemical reaction engineering applications and is often solved by using analytical approximations of the solution to the micro balance. One possibility is to use Thiele modulus in the effectiveness value formulation. However, this approach cannot be used for complicated reaction mechanisms involving several reacting species. The solution exemplified here is general and can be used for very complex reaction mechanisms involving a large number of species.</p>
  <p num="p-0533">Input data for the model are the following:</p>
  <p num="p-0534"> <tables id="TABLE-US-00007" num="00007"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="49pt" align="left"> </colspec> <colspec colname="1" colwidth="91pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">EXPRESSION</td> <td class="description-td">VALUE</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D</td> <td class="description-td">1e-6</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D</td> <td class="description-td">1e-7</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">c0</td> <td class="description-td">3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">u</td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Ap</td> <td class="description-td">4e3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">k</td> <td class="description-td">100</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"></td> <td class="description-td">0.6</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Rp</td> <td class="description-td">1e-3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td"></td> <td class="description-td">1.5</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Model Library Chemical_Engineering/Mass_Transport/Packed_Bed_Reactor
<br>
Solving the Problem Using the Graphical User Interface
</p>
  <p num="p-0535">The approach here will be to model the bed as a 1-D model with independent variable x. At each x-coordinate there is also a model of one particle typical of all of the particles at that position in the packed bed. Since the particles are spherically symmetric and the surface concentration c is to all intents and purposes constant around each particle, a 1-D model with independent variable r can he used for each of the particles. In order to model particles for each position along the packed bed, many such 1-D models can be placed side by side creating effectively a 2-D geometry with independent variables x and r.</p>
  <p num="p-0536">In this 2-D model all of the particles can be modeled independently. There is therefore a 2-D geometry for the particles and a 1-D geometry for the packed bed. Two couplings are used in the model. The packed bed concentration is used in the boundary condition for the particles and the flux at the surface of the particles is used in the reaction term in the packed bed.
</p> <ul> <li id="ul0001-0001" num="0000"> <ul> <li id="ul0002-0001" num="0536">Firstly switch to the Multiphysics window in the Model Navigator. Select the 2-D, ChEM:Diffusion application mode. Name the dependent variable c1 whilst setting the independent variables to x and r respectively. Press Add and select Solution form: Weak.</li> <li id="ul0002-0002" num="0537">Now choose a Weak, boundary constraint from the list, name the dependent variable lambda and Add the mode. This mode is added because coupling variables appearing in Dirichlet boundary conditions should usually be handled with weak boundary constraints.</li> <li id="ul0002-0003" num="0538">Press the topmost Add button to select a new geometry. Use 1-D as the dimension and press the top Add button once more.</li> <li id="ul0002-0004" num="0539">Select the ChEM: Convection and diffusion application mode. Name the Dependent variable to C and then Add the mode.</li> <li id="ul0002-0005" num="0540">Select Solution form: Weak, Solver type: Nonlinear stationary and press OK.
<br>
Draw Mode
</li> </ul> </li> </ul> <p num="p-0537">Choose I Geom I: Diffusion (di) from the Multiphysics menu.</p>
  <p num="p-0538">Draw a unit square with it's lower left corner at (0,0).</p>
  <p num="h-0043">Mesh Mode</p>
  <p num="p-0539">
    </p> <ul> <li id="ul0003-0001" num="0000">
        <ul> <li id="ul0004-0001" num="0543">Select Parameters from the Mesh menu and enter 2e1 in the Max edge size, general field.</li>
          <li id="ul0004-0002" num="0544">Press the More button and enter 3 1 e2 in the Max element size for edges field. This makes the mesh very fine on boundary 3 which represents the outer surfaces of all of the particles, near which the concentration changes rapidly. Press Remesh and then OK.
<br>
Draw Mode
</li>
        </ul> </li>
    </ul> <p num="p-0540">Choose 3 Geom2: Convection and Diffusion (cd) from the Multiphysics menu.</p>
  <p num="p-0541">Double click on the line and specify a geometry from 0 to 1.</p>
  <p num="h-0044">Mesh Mode</p>
  <p num="p-0542">
    </p> <ul> <li id="ul0005-0001" num="0000">
        <ul> <li id="ul0006-0001" num="0547">Select Parameters from the Mesh menu, enter 2e2 in the Max edge size, general field, press Remesh and then OK.
<br>
Options and Settings
</li>
          <li id="ul0006-0002" num="0548">Enter the following variable names for use later, in the Add/Edit Constants window under the Options menu.</li>
        </ul> </li>
    </ul> <p num="p-0543"> <tables id="TABLE-US-00008" num="00008"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="98pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">NAME</td> <td class="description-td">EXPRESSION</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">gamma</td> <td class="description-td">1.5</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D1</td> <td class="description-td">1e-7</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D</td> <td class="description-td">1e-6</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">C0</td> <td class="description-td">3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">k</td> <td class="description-td">100</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">epsil</td> <td class="description-td">0.6</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Ap</td> <td class="description-td">1e3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">rp</td> <td class="description-td">1e-3</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">u</td> <td class="description-td">0.4</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Enabling the Extended Multiphysics Couplings
<br>
First define a variable C_x to be available on boundary 3 in the particle geometry (the outer surfaces of the particles) to be equal to the packed bed concentration C at the corresponding x-coordinate.
</p> <ul> <li id="ul0007-0001" num="0000"> <ul> <li id="ul0008-0001" num="0550">Open the Add/Edit Coupling Variables dialog under the Options menu.</li> <li id="ul0008-0002" num="0551">Enter C_x in the Variable name edit field and select extrusion from the Variable type drop-down menu. Then press Add.</li> <li id="ul0008-0003" num="0552">Switch to the Source tab and select the Geometry Geom2 at the subdomain Level. Then select 1 in the window.</li> <li id="ul0008-0004" num="0553">Enter C in the Expression field and enter x for the Local mesh transformation coordinate x.</li> <li id="ul0008-0005" num="0554">Switch to the Destination tab, select Geom1 for the Geometry, boundary for the Level and choose boundary 3. Enter x in the Evaluation point transformation x field.</li> <li id="ul0008-0006" num="0555">Press Apply.
<br>
Now define a variable Ndotn_x to be the normal surface flux for the particles at position x, and make this variable available in the packed bed geometry.
</li> <li id="ul0008-0007" num="0556">Switch back to the Variables. Referring to <figref idrefs="DRAWINGS">FIG. 58</figref>, name the variable Ndotn_x and choose extrusion for its Variable type, then press Add.</li> <li id="ul0008-0008" num="0557">Go to the Source tab and select Geom1 at the boundary Level. Select boundary number 3 and enter D1*c1r/rp as the Expression and x as the Local mesh transformation x coordinate.</li> <li id="ul0008-0009" num="0558">Switch to the Destination tab and select Geom2 for the Geometry at the subdomain Level. Select I and enter x as the Evaluation point transformation x.</li> <li id="ul0008-0010" num="0559">Press OK and the coupling variables have been defined.
<br>
Subdomain Mode
</li> </ul> </li> </ul> <p num="p-0544">Choose I Geom I: Diffusion (di) from the Multiphysics menu.</p>
  <p num="p-0545">Enter subdomain settings according to the following table.</p>
  <p num="p-0546"> <tables id="TABLE-US-00009" num="00009"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="28pt" align="left"> </colspec> <colspec colname="1" colwidth="84pt" align="left"> </colspec> <colspec colname="2" colwidth="105pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">SUBDOMAIN</td> <td class="description-td">I</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D<sub>i </sub>(anisotropic)</td> <td class="description-td">0 0 0 (DI/rp{circumflex over ()}2)*r{circumflex over ()}2</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">R<sub>i</sub> </td> <td class="description-td">k*r{circumflex over ()}2*c|{circumflex over ()}gamma</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Note that the diffusion is only in the r direction because the 2-D geometry is not a physically 2-D domain, merely a more efficient way of handling a large number of 1-D models set one beside the other.
<br>
Boundary Mode
</p> <ul> <li id="ul0009-0001" num="0000"> <ul> <li id="ul0010-0001" num="0563">First select Insulation/symmetry conditions for boundaries 1, 2 and 4. The third boundary should be a Concentration boundary with epsil*C_x as its value.</li> <li id="ul0010-0002" num="0564">Switch to the second Multiphysics mode: 2 Geom 1: 1 variable weak constraint mode (w1). Open the Boundary Settings dialog and select boundary 3. Make it Active in this domain by selecting this checkbox and enter c1 as the Constraint variable. Press OK to make it active.
<br>
Subdomain Mode
</li> </ul> </li> </ul> <p num="p-0547">Choose 3 Geom2: Convection and Diffusion (cd) from the Multiphysics menu.</p>
  <p num="p-0548">Enter subdomain settings according to the following table.</p>
  <p num="p-0549"> <tables id="TABLE-US-00010" num="00010"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="35pt" align="left"> </colspec> <colspec colname="1" colwidth="91pt" align="left"> </colspec> <colspec colname="2" colwidth="91pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">SUBDOMAIN</td> <td class="description-td">I</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">D<sub>i</sub> </td> <td class="description-td">D</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">R<sub>i</sub> </td> <td class="description-td">Ap*Ndotn_x</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">u</td> <td class="description-td">u</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Boundary Mode
</p> <ul> <li id="ul0011-0001" num="0000"> <ul> <li id="ul0012-0001" num="0568">First select a Convection&gt;&gt;Diffusion condition for boundary 2.</li> <li id="ul0012-0002" num="0569">Boundary 1 should be a Concentration boundary with CO as its value. Finish by pressing the OK button.
<br>
Solve Problem
<br>
Press the Solve button to start the simulation.
<br>
Post mode
</li> </ul> </li> </ul> <p num="p-0550">The default plot will give the view of the concentration depicted in <figref idrefs="DRAWINGS">FIG. 59</figref>.</p>
  <p num="p-0551">For the particles (Multiphysics 1) it is interesting to see a contour plot. Open the Plot Parameters dialog. Deselect the Surface plot and instead select Countor plot, then switch to the Contour tab. Specify x as the Contour expression and concentration of c1 (c1) as the Height expression. Enter 40 in the Contour levels field and deselect the Color bar. The effect of this is to lay 40 lines across the geometry at 40 different x-coordinates and show the concentration distribution along each line. Each one therefore represents the concentration distribution within a single particle. It is also interesting to see how the value of the normal flux which is a multiple of c1r, changes as x changes, so switch to the Line tab and activate the line plot. Enter c1r in the Line expression field and c1r/20 in the Z expression field and press OK. The /20 is simply to rescale the curve to be able to see it on the same axes as the contour plot. The following plot results are shown in <figref idrefs="DRAWINGS">FIG. 60</figref>.</p>
  <p num="p-0552">Contour: x Height: concentration of c1(c1) Line: c1r Line Z: c1r/20</p>
  <p num="h-0045">Multidisciplinary Models</p>
  <p num="h-0046">Magnetic Brake</p>
  <p num="h-0047">This example studies a magnetic brake that slows down a copper disk rotating in the magnet's air gap as illustrated in <figref idrefs="DRAWINGS">FIG. 61</figref>. The rotation induces currents, and forces along the current lines impede the disk's motion.</p>
  <p num="p-0553">This time-dependent problem will be solved in two different ways: first using FEMLAB's extended multiphysics feature, and second as a Simulink simulation. In both cases the stationary problem of computing the magnetic field in the disk given a certain angular velocity  will be solved first.</p>
  <p num="p-0554">Assume the disk rotates around the z-axis with angular velocity . The velocity v at a point (x,y) is then
<br> <i>v</i>=(<i>y,x,</i>0).</p>
  <p num="p-0555">When the disk is inserted in the air gap and it encounters the magnetic field B<sub>0</sub>, the configuration induces a current density j according to Lorentz' equation:</p>
  <p num="p-0556">
    <maths id="MATH-US-00023" num="00023"> <math overflow="scroll"> <mrow> <mo>{</mo> <mtable> <mtr> <mtd> <mrow> <mrow> <mi>E</mi> <mo>+</mo> <mrow> <mi>v</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>B</mi> <mo>+</mo> <msub> <mi>B</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <mfrac> <mn>1</mn> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mi>d</mi> </mrow> </mfrac> <mo></mo> <mi>j</mi> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mo></mo> <mrow> <mo></mo> <mi>E</mi> </mrow> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mo></mo> <mrow> <mo></mo> <mi>B</mi> </mrow> </mrow> <mo>=</mo> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mrow> <mi>j</mi> <mo>.</mo> </mrow> </mrow> </mrow> </mtd> </mtr> </mtable> <mo></mo> </mrow> </math> </maths> </p>
  <p num="p-0557">In these equations, B represents the magnetic field, E the electric field,  the permeability,  the electric conductivity, and d the plate's thickness. This example uses the Dirichlet boundary condition B=0.</p>
  <p num="p-0558">In this model the magnetic flux B has only a vertical component and the currents and electric field have no z-components. Solving for B gives the following scalar partial differential equation:</p>
  <p num="p-0559"> <maths id="MATH-US-00024" num="00024"> <math overflow="scroll"> <mrow> <mrow> <mo>-</mo> <mrow> <mi>div</mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mrow> <mo></mo> <mi>B</mi> </mrow> <mo>+</mo> <mrow> <mi></mi> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo></mo> <mrow> <mi></mi> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>B</mi> <mo>+</mo> <msub> <mi>B</mi> <mrow> <mn>0</mn> <mo></mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </mrow> </msub> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> <mrow> <mo>(</mo> <mtable> <mtr> <mtd> <mi>y</mi> </mtd> </mtr> <mtr> <mtd> <mrow> <mo>-</mo> <mi>x</mi> </mrow> </mtd> </mtr> </mtable> <mo>)</mo> </mrow> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </math> </maths> <br>
where B is the z-component of B and B<sub>0 </sub>equals the z-component of B<sub>0</sub>.
</p>
  <p num="p-0560">Now consider how the system evolves over time. The disc is slowed down by the induced torque and an ordinary differential equation (ODE) must be set up to model the angular velocity .</p>
  <p num="p-0561">To obtain the time derivative of the angular velocity , the torque arising from the induced currents must be computed. For a small surface element, the force equals
<br> <i>dF=j</i>(<i>B+B</i> <sub>0</sub>)<i>dxdy </i> <br>
and integrating over the disk gives the total torque:
</p>
  <p num="p-0562"> <maths id="MATH-US-00025" num="00025"> <math overflow="scroll"> <mrow> <mi>M</mi> <mo>=</mo> <mrow> <msub> <mo></mo> <mi>Disk</mi> </msub> <mo></mo> <mrow> <mfrac> <mn>1</mn> <mi></mi> </mfrac> <mo></mo> <mi>r</mi> <mo></mo> <mrow> <mo>{</mo> <mrow> <mrow> <mo>(</mo> <mrow> <mo></mo> <mrow> <mo></mo> <mi>B</mi> </mrow> </mrow> <mo>)</mo> </mrow> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>B</mi> <mo>+</mo> <msub> <mi>B</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> <mo>}</mo> </mrow> <mo></mo> <mstyle> <mspace width="0.2em" height="0.2ex"> </mspace> </mstyle> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> <mo></mo> <mrow> <mrow> <mo></mo> <mi>y</mi> </mrow> <mo>.</mo> </mrow> </mrow> </mrow> </mrow> </math> </maths> <br>
In this case, M has only a z-component with the value.
</p>
  <p num="p-0563"> <maths id="MATH-US-00026" num="00026"> <math overflow="scroll"> <mrow> <mi>M</mi> <mo>=</mo> <mrow> <msub> <mo></mo> <mi>Disk</mi> </msub> <mo></mo> <mrow> <mfrac> <mn>1</mn> <mi></mi> </mfrac> <mo></mo> <mrow> <mrow> <mo>(</mo> <mrow> <mrow> <mi>y</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi>B</mi> </mrow> <mrow> <mo></mo> <mi>x</mi> </mrow> </mfrac> </mrow> <mo>-</mo> <mrow> <mi>x</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi>B</mi> </mrow> <mrow> <mo></mo> <mi>y</mi> </mrow> </mfrac> </mrow> </mrow> <mo>)</mo> </mrow> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>B</mi> <mo>+</mo> <msub> <mi>B</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> <mo></mo> <mrow> <mrow> <mo></mo> <mi>y</mi> </mrow> <mo>.</mo> </mrow> </mrow> </mrow> </mrow> </math> </maths> <br>
Thus the ODE for  may be formulated as
</p>
  <p num="p-0564"> <maths id="MATH-US-00027" num="00027"> <math overflow="scroll"> <mrow> <mrow> <mi>J</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi></mi> </mrow> <mrow> <mo></mo> <mi>t</mi> </mrow> </mfrac> </mrow> <mo>=</mo> <mi>M</mi> </mrow> </math> </maths> <br>
where the moment of inertia J for a disk with radius r equals
</p>
  <p num="p-0565"> <maths id="MATH-US-00028" num="00028"> <math overflow="scroll"> <mrow> <mi>J</mi> <mo>=</mo> <mrow> <mrow> <mi>m</mi> <mo></mo> <mfrac> <msup> <mi>r</mi> <mn>2</mn> </msup> <mn>2</mn> </mfrac> </mrow> <mo>=</mo> <mrow> <mfrac> <mrow> <mi></mi> <mo></mo> <mrow> <mo></mo> <msup> <mi>r</mi> <mn>4</mn> </msup> </mrow> <mo></mo> <mi></mi> </mrow> <mn>2</mn> </mfrac> <mo>.</mo> </mrow> </mrow> </mrow> </math> </maths> <br>
Model Library FEMLAB/Multidisciplinary/Magnet_Brake
<br>
Using the Graphical User InterfaceFixed 
<br>
Before solving the time-dependent problem, consider first the problem where  is fixed.
<br>
Select the 2-D, Coefficient, Linear stationary PDE mode in the Model Navigator. Click on the button marked More, change the Dependent variable name to B and then click OK.
<br>
Options and Settings
</p>
  <p num="p-0566">To help when drawing the geometry, set axis and grid settings:</p>
  <p num="p-0567">
    <tables id="TABLE-US-00011" num="00011"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="21pt" align="left"> </colspec> <colspec colname="1" colwidth="77pt" align="left"> </colspec> <colspec colname="2" colwidth="119pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">AXIS</td>
              <td class="description-td">GRID</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
            </tr> </tbody> </tgroup> <tgroup align="left" colsep="0" rowsep="0" cols="6"> <colspec colname="offset" colwidth="21pt" align="left"> </colspec> <colspec colname="1" colwidth="28pt" align="left"> </colspec> <colspec colname="2" colwidth="49pt" align="char" char="."> </colspec> <colspec colname="3" colwidth="49pt" align="left"> </colspec> <colspec colname="4" colwidth="21pt" align="center"> </colspec> <colspec colname="5" colwidth="49pt" align="center"> </colspec> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">X min</td>
              <td class="description-td">0.15</td>
              <td class="description-td">X spacing</td>
              <td class="description-td">0.05</td>
              <td class="description-td"> </td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">X max</td>
              <td class="description-td">0.15</td>
              <td class="description-td">Extra X</td>
              <td class="description-td">0.03</td>
              <td class="description-td">0.07</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">Y min</td>
              <td class="description-td">0.1</td>
              <td class="description-td">Y spcaing</td>
              <td class="description-td">0.02</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">Y max</td>
              <td class="description-td">0.1</td>
              <td class="description-td">Extra Y</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="5" align="center" rowsep="1" class="description-td" colspan="6"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0568">Enter the following constants:</p>
  <p num="p-0569"> <tables id="TABLE-US-00012" num="00012"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="35pt" align="left"> </colspec> <colspec colname="1" colwidth="70pt" align="left"> </colspec> <colspec colname="2" colwidth="112pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">NAME</td> <td class="description-td">EXPRESSION</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">K</td> <td class="description-td">4e{circumflex over ()}7*pi*5.99e7*0.02</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">w</td> <td class="description-td">2*pi*100</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
The variable w represents the fixed angular velocity . The variable K is the product of ,  and d.
<br>
Draw Mode
</p>
  <p num="p-0570">Draw a circle centered at (0,0) with a radius of 0.1.</p>
  <p num="p-0571">Draw a square centered at (0.05,0) with each side 0.04 units long as shown in <figref idrefs="DRAWINGS">FIG. 62</figref>.</p>
  <p num="h-0048">Boundary Mode</p>
  <p num="p-0572">Check that the boundary settings are:</p>
  <p num="p-0573"> <tables id="TABLE-US-00013" num="00013"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="98pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">BOUNDARY</td> <td class="description-td">5, 6, 7, 8</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Type</td> <td class="description-td">Dirichlet</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">h</td> <td class="description-td">1</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">r</td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Subdomain Mode
</p>
  <p num="p-0574">Enter PDE settings as shown:</p>
  <p num="p-0575">
    <tables id="TABLE-US-00014" num="00014"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="35pt" align="left"> </colspec> <colspec colname="1" colwidth="105pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">SUBDOMAIN</td>
              <td class="description-td">1, 2</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">c</td>
              <td class="description-td">2</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">a, f, d<sub>a</sub> </td>
              <td class="description-td">0</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"></td>
              <td class="description-td">K*w*y  K*w*x</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td"></td>
              <td class="description-td">K*w*B0*y K*w*B0*x</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p>
  <p num="p-0576">The applied field B<sub>0 </sub>is used here and it has not been defined. It is different in the two subdomains, so it's best to use the Add/Edit Expressions dialog.</p>
  <p num="p-0577">Enter the name B0, select type subdomain and click Add in <figref idrefs="DRAWINGS">FIG. 63</figref>.</p>
  <p num="p-0578">Click the Definition tab, select subdomain 1 and enter the expression 0.</p>
  <p num="p-0579">Select subdomain 2 and enter the expression 1e3. Then press OK in <figref idrefs="DRAWINGS">FIG. 64</figref>.</p>
  <p num="h-0049">Mesh Mode</p>
  <p num="p-0580">
    </p> <ul> <li id="ul0013-0001" num="0000">
        <ul> <li id="ul0014-0001" num="0600">Open the Mesh Parameters dialog box by selecting Parameters . . . from the Mesh menu and set Max. edge size, general to 0.04.</li>
          <li id="ul0014-0002" num="0601">Click on More and enter 2 0.01 in the Max element size for subdomains box as shown in <figref idrefs="DRAWINGS">FIG. 65</figref>.</li>
          <li id="ul0014-0003" num="0602">Press OK and then press the initialize Mesh button.</li>
          <li id="ul0014-0004" num="0603">Press the Refine mesh button.
<br>
Solve Problem
</li>
        </ul> </li>
    </ul> <p num="p-0581">Press the Solve Problem button to solve the problem. (Time to solve: 5 s) as shown in <figref idrefs="DRAWINGS">FIG. 66</figref>.</p>
  <p num="h-0050">Using the Programming LanguageFixed </p>
  <p num="h-0051">% Clear the FEM structure, set the variable name and</p>
  <p num="h-0052">% choose quadratic elements.</p>
  <p num="h-0053">clear fem</p>
  <p num="h-0054">fem.dim=B;</p>
  <p num="h-0055">fem.shape=2;</p>
  <p num="h-0056">% Specify the constants K and w.</p>
  <p num="h-0057">fem.variables={K,4e7*pi*5.99e7*0.02, . . .</p>
  <p num="p-0582">
    </p> <ul> <li id="ul0015-0001" num="0000">
        <ul> <li id="ul0016-0001" num="0605">w,2*pi*100};
<br>
% Create the geometry.
<br>
fem.geom=circ2(0,0,0.1)+rect2(0.03,0.07,0.02,0.02);
<br>
% Specify the boundary conditions, i.e. homogeneous Dirichlet
<br>
% conditions at the edge of the disk (boundary elements 5, 6, 7
<br>
% and 8).
<br>
fem.bnd.h=1;
<br>
fem.bnd.r=0;
<br>
fem.bnd.ind={5:8};
<br>
% Specify the PDE coefficients.
<br>
fem.equ.c=1;
<br>
fem.equ.al={{{K*w*y K*w*x}}};
<br>
fem.equ.ga={{{K*w*BO*y K*w*BO*x}}};
<br>
fem.equ.expr={BO {O 1e3}};
<br>
% Generate the mesh.
<br>
fem.mesh=meshinit(fem,hmax,{0.04 [ ] [ ] [2 0.01]});
<br>
fem.mesh=meshrefine(fem);
<br>
% Solve the problem and plot the solution.
<br>
fem.xmesh=meshextend(fem);
<br>
fem.sol=femlin(fem);
<br>
postplot(fem,tridata,B,tribar,on, . . . trirefine, 10, axisequal, on);
<br>
Using the Graphical User InterfaceTime-Dependent 
</li>
        </ul> </li>
    </ul> <p num="p-0583">In this section FEMLAB's extended multiphysics feature will be used to solve the time-dependent problem.</p>
  <p num="p-0584">The approach taken here will be to set up a second geometry to handle the ODE for angular velocity.</p>
  <p num="p-0585"> <maths id="MATH-US-00029" num="00029"> <math overflow="scroll"> <mrow> <mrow> <mi>J</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi></mi> </mrow> <mrow> <mo></mo> <mi>t</mi> </mrow> </mfrac> </mrow> <mo>=</mo> <mi>M</mi> </mrow> </math> </maths> <br>
and then use extended multiphysics element structures to allow variables from each geometry to be made available when solving the problem in the other geometry.
<br>
Note An alternative approach is to use only one geometry and introduce a new variable w, active at a single point within that geometry using a Point weak form, application mode. In this alternative the same coupling variables M and w are used but the source and destination domains would have to be suitably altered. The ODE for w would then be specified using the coefficients on the Weak tab in the Point settings dialog; first multiply both sides of the ODE by the test function for w, then set dweak and weak to be the left and right hand side respectively, i.e. J*w_time*w_test and M*w_test.
<br>
Options
</p> <ul> <li id="ul0017-0001" num="0000"> <ul> <li id="ul0018-0001" num="0609">Add the following constants to the variable list which already includes K and w:</li> </ul> </li> </ul> <p num="p-0586">
    <tables id="TABLE-US-00015" num="00015"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="63pt" align="left"> </colspec> <colspec colname="2" colwidth="112pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">NAME</td>
              <td class="description-td">EXPRESSION</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">J</td>
              <td class="description-td">8960*0.02*0, 1{circumflex over ()}4*pi/2</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td class="description-td">mu</td>
              <td class="description-td">4e-7*pi</td>
            </tr> <tr class="description-tr"> <td class="description-td"> </td>
              <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td>
            </tr> </tbody> </tgroup> </table> </tables> </p> <ul> <li id="ul0019-0001" num="0000">
        <ul> <li id="ul0020-0001" num="0611">Select the variable w in the list and Delete it so the list consists only of K, J and mu. The variable w here will be replaced by the dependent variable w from the ODE.</li>
          <li id="ul0020-0002" num="0612">In the Add/Exit Expressions dialog box, select the variable B0 in the list and change its definition in subdomain 2 to 0.1.
<br>
Add Geometry
<br>
Now add the new geometry to handle the ODE. An ODE can be thought of as a zero-dimensional PDE, so in principle a zero-dimensional geometry is all that is required here, but since there is no support for this in the graphical user interface, a trivial one-dimensional geometry will be used instead. In addition, the use of coupling variables means weak solution form must be used.
</li>
          <li id="ul0020-0003" num="0613">From the Multiphysics menu, choose Add/Edit Modes.</li>
          <li id="ul0020-0004" num="0614">Change the Solver type to Time dependent and the Solution form to Weak.</li>
          <li id="ul0020-0005" num="0615">Click on the button marked Add to the right of the Geometry name list.</li>
          <li id="ul0020-0006" num="0616">Select 1-D using the Dimension radio buttons.</li>
          <li id="ul0020-0007" num="0617">From the list on the left, select PDE, coefficient form.</li>
          <li id="ul0020-0008" num="0618">Change the Dependent variable name to w.</li>
          <li id="ul0020-0009" num="0619">Click on the &gt;&gt; button in the middle of the dialog box to add this mode and geometry to the model.</li>
          <li id="ul0020-0010" num="0620">Change the Solution form to Weak for this new geometry as well.</li>
          <li id="ul0020-0011" num="0621">Click OK.
<br>
Draw Mode
</li>
        </ul> </li>
    </ul> <p num="p-0587">From the Draw menu, choose Specify geometry.</p>
  <p num="p-0588">Enter 0 and 1 in the Start and Stop fields respectively.</p>
  <p num="p-0589">Click OK.</p>
  <p num="h-0058">Define Coupling Variables</p>
  <p num="h-0059">There are two extended multiphysics couplings in this model. In other words, two variables which are to be made available beyond the domains in which they exist naturally.</p>
  <p num="h-0060">Firstly, the source term M in the ODE described in geometry 2 was defined earlier to be</p>
  <p num="p-0590"> <maths id="MATH-US-00030" num="00030"> <math overflow="scroll"> <mrow> <mi>M</mi> <mo>=</mo> <mrow> <msub> <mo></mo> <mi>Disk</mi> </msub> <mo></mo> <mrow> <mfrac> <mn>1</mn> <mi></mi> </mfrac> <mo></mo> <mrow> <mrow> <mo>(</mo> <mrow> <mrow> <mi>y</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi>B</mi> </mrow> <mrow> <mo></mo> <mi>x</mi> </mrow> </mfrac> </mrow> <mo>-</mo> <mrow> <mi>x</mi> <mo></mo> <mfrac> <mrow> <mo></mo> <mi>B</mi> </mrow> <mrow> <mo></mo> <mi>y</mi> </mrow> </mfrac> </mrow> </mrow> <mo>)</mo> </mrow> <mo></mo> <mrow> <mo>(</mo> <mrow> <mi>B</mi> <mo>+</mo> <msub> <mi>B</mi> <mn>0</mn> </msub> </mrow> <mo>)</mo> </mrow> </mrow> <mo></mo> <mrow> <mo></mo> <mi>x</mi> </mrow> <mo></mo> <mrow> <mo></mo> <mi>y</mi> </mrow> </mrow> </mrow> </mrow> </math> </maths> <br>
so the result of this integral over subdomains 1 and 2 in geometry 1 must be made available in geometry 2 as the variable M.
</p>
  <p num="p-0591">Secondly, the angular velocity variable w is used in the coefficients  and  in the PDE in geometry 1. Previously w was defined in the Add/Edit Constants dialog box, but this time it must be taken from geometry 2. Thus the dependent variable w in geometry 2 must be made available in the subdomains of geometry 1.</p>
  <p num="h-0061">Define M First</p>
  <p num="p-0592">
    </p> <ul> <li id="ul0021-0001" num="0000">
        <ul> <li id="ul0022-0001" num="0627">Open the Add/Edit Coupling Variables dialog.</li>
          <li id="ul0022-0002" num="0628">Enter the variable name M and select the default type scalar.</li>
          <li id="ul0022-0003" num="0629">Press Add in <figref idrefs="DRAWINGS">FIG. 67</figref>.</li>
          <li id="ul0022-0004" num="0630">Click on the Source tab and then select Geom1, subdomain level as the source.</li>
          <li id="ul0022-0005" num="0631">Select subdomains 1 and 2 and set the integration order to 2 and the integrand (B+B0)*(y*Bxx*By)/mu as shown in <figref idrefs="DRAWINGS">FIG. 68</figref>.</li>
          <li id="ul0022-0006" num="0632">Click on the Destination tab and select Geom2, subdomain level.</li>
          <li id="ul0022-0007" num="0633">Select subdomain 1 and check the Active . . . box as shown in <figref idrefs="DRAWINGS">FIG. 69</figref>.
<br>
Now make w available in geometry 1.
</li>
          <li id="ul0022-0008" num="0634">From the Variables tab, add a scalar variable with the name w.</li>
          <li id="ul0022-0009" num="0635">On the Source tab set the source as Geom2, subdomain 1, with an integrand w and integration order 1.</li>
          <li id="ul0022-0010" num="0636">Set the Destination as Geom1, subdomains 1 and 2.</li>
          <li id="ul0022-0011" num="0637">Press Apply.</li>
        </ul> </li>
    </ul> <p num="p-0593">To check the variables have the correct source and destination domains, click on the Variables tab in <figref idrefs="DRAWINGS">FIG. 70</figref>:</p>
  <p num="p-0594">Note that the definition of w here means use the integral of w over subdomain 1 in geometry 2, but since w will be constant over the whole subdomain and the subdomain has length 1, this is the same as simply taking the value w at any point in the subdomain.</p>
  <p num="h-0062">Boundary Mode</p>
  <p num="p-0595">Set the boundary settings:</p>
  <p num="p-0596"> <tables id="TABLE-US-00016" num="00016"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="98pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">BOUNDARY</td> <td class="description-td">1, 2</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">Type</td> <td class="description-td">Neumann</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">q</td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">g</td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Subdomain Mode
</p>
  <p num="p-0597">Enter PDE settings as shown:</p>
  <p num="p-0598"> <tables id="TABLE-US-00017" num="00017"> <table frame="none" colsep="0" rowsep="0" class="description-table"> <tgroup align="left" colsep="0" rowsep="0" cols="3"> <colspec colname="offset" colwidth="42pt" align="left"> </colspec> <colspec colname="1" colwidth="98pt" align="left"> </colspec> <colspec colname="2" colwidth="77pt" align="left"> </colspec> <thead> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">SUBDOMAIN</td> <td class="description-td">1</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </thead> <tbody valign="top"> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">c, a, , , </td> <td class="description-td">0</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">d<sub>a</sub> </td> <td class="description-td">J</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">f</td> <td class="description-td">M</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td class="description-td">init</td> <td class="description-td">2*pi*200</td> </tr> <tr class="description-tr"> <td class="description-td"> </td> <td namest="offset" nameend="2" align="center" rowsep="1" class="description-td" colspan="3"> </td> </tr> </tbody> </tgroup> </table> </tables> <br>
Mesh Mode
</p> <ul> <li id="ul0023-0001" num="0000"> <ul> <li id="ul0024-0001" num="0644">Open the Mesh Parameters dialog box by selecting Parameters . . . from the Mesh menu and set Max. edge size, general to 1.</li> <li id="ul0024-0002" num="0645">Press OK and then press the Initialize Mesh button.</li> <li id="ul0024-0003" num="0646">Select Geometry 1 from the Multiphysics menu.</li> <li id="ul0024-0004" num="0647">Press the Initialize Mesh button. This resets the mesh to a coarser mesh than the one used in the fixed  case in order to shorten the solution time for the time dependent case.
<br>
Solve Problem
</li> <li id="ul0024-0005" num="0648">Open the Solve parameters dialog box and turn to the Timestepping page.</li> <li id="ul0024-0006" num="0649">Set the Output times to 0 8, and select fldae as the Timestepping algorithm, with Relative tolerance 1e3 and Absolute tolerance 1 e5.</li> <li id="ul0024-0007" num="0650">Click OK.</li> <li id="ul0024-0008" num="0651">Press the Solve Problem button on the toolbar.
<br>
Plot Mode
<br>
Once the problem has been solved, the results can be visualized in a number of ways.
</li> <li id="ul0024-0009" num="0652">An animation of the dissipation of B over time can be shown by pressing the Animate button.</li> <li id="ul0024-0010" num="0653">For a graph of the  against time, select Geometry 2 from the Multiphysics menu and open the Cross-section plot parameters dialog box from the Post menu. Select all the time steps in the list box and select Point plot. Then, on the Point sheet, make sure that the Point expression is w and click OK shown in <figref idrefs="DRAWINGS">FIG. 71</figref>.</li> <li id="ul0024-0011" num="0654">For a graph of d/dt against time, follow the same procedure as for , but set the Point expression to M/J instead.
<br>
Results
</li> </ul> </li> </ul> <p num="p-0599">The plots for  and d/dt against time are shown in <figref idrefs="DRAWINGS">FIGS. 72A-72B</figref>.</p>
  <p num="p-0600">While the invention has been disclosed in connection with preferred embodiments shown and described in detail, their modifications and improvements thereon will become readily apparent to those skilled in the art. Accordingly, the spirit and scope of the present invention should be limited only by the following claims.</p>
</div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5408638">US5408638</a></td><td class="patent-data-table-td patent-date-value">Dec 16, 1991</td><td class="patent-data-table-td patent-date-value">Apr 18, 1995</td><td class="patent-data-table-td ">Hitachi, Ltd.</td><td class="patent-data-table-td ">Method of generating partial differential equations for simulation, simulation method, and method of generating simulation programs</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6349272">US6349272</a></td><td class="patent-data-table-td patent-date-value">Apr 7, 2000</td><td class="patent-data-table-td patent-date-value">Feb 19, 2002</td><td class="patent-data-table-td ">Cadence Design Systems, Inc.</td><td class="patent-data-table-td ">Method and system for modeling time-varying systems and non-linear systems</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6810370">US6810370</a></td><td class="patent-data-table-td patent-date-value">Mar 14, 2000</td><td class="patent-data-table-td patent-date-value">Oct 26, 2004</td><td class="patent-data-table-td ">Exxonmobil Upstream Research Company</td><td class="patent-data-table-td ">Method for simulation characteristic of a physical system</td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">Non-Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">Reference</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">16th American Society of Civil Engineers (ASCE) Engineering Mechanics Conference, Jul. 16-18, 2003. Printed Jan. 10, 2007. http://www.ce.washington.edu/em03/proceedings/authorindex.htm.</td></tr><tr><td class="patent-data-table-td ">2</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Anderson, D.G. "<a href='http://scholar.google.com/scholar?q="Iterative+Procedures+for+Nonlinear+Integral+Equations."'>Iterative Procedures for Nonlinear Integral Equations.</a>" Journal of the ACM. vol. 12, Issue 4. Oct. 1965.</td></tr><tr><td class="patent-data-table-td ">3</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Brenner et al., "<a href='http://scholar.google.com/scholar?q="The+Mathematical+Theory+of+Finite+Element+Methods%2C"'>The Mathematical Theory of Finite Element Methods,</a>" Springer-Verlag 1-12 (1994) The Finite Element Method: 1-12.</td></tr><tr><td class="patent-data-table-td ">4</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">C. Johnson, "<a href='http://scholar.google.com/scholar?q="Numerical+Solution+of+Partial+Differential+Equations+by+the+Finite+Element+Method%2C"'>Numerical Solution of Partial Differential Equations by the Finite Element Method,</a>" Studentlitteratur 14-18 (1987) Test Function 14-18.</td></tr><tr><td class="patent-data-table-td ">5</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Canova, A. and M. Repetto. "<a href='http://scholar.google.com/scholar?q="Integral+Solution+of+Nonlinear+Magnetostatic+Field+Problems"'>Integral Solution of Nonlinear Magnetostatic Field Problems</a>", IEEE Transactions on Magnetics, vol. 37, No. 3, pp. 1070-1077, May 2001.</td></tr><tr><td class="patent-data-table-td ">6</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Dahlquist, et al., "<a href='http://scholar.google.com/scholar?q="Numerical+Methods%2C"'>Numerical Methods,</a>" Prentice Hall 284-355 (1974) Interpolation: 284-285; Linear Solver: 146-172; Time-Dependent Solver: 347-355; Eigenvalue Solver: 208-211; Damped Newton Method: 248-253.</td></tr><tr><td class="patent-data-table-td ">7</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Davenport et al., "<a href='http://scholar.google.com/scholar?q="Computer+Algebra+Systems+and+Algorithms+for+Algebraic+Computation%2C"'>Computer Algebra Systems and Algorithms for Algebraic Computation,</a>" Academic Press 28-32 (1993) Symbolic Differentiation: 28-32.</td></tr><tr><td class="patent-data-table-td ">8</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Femlab 2.2: New Features. (C) 2001. Printed from http://www.technion.ac.il/~leonidb/BursteinSite/Femlb22About.htm.</td></tr><tr><td class="patent-data-table-td ">9</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Femlab(R) Installation and New Features Guide, Version 2.3. Nov. 2002.</td></tr><tr><td class="patent-data-table-td ">10</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Femlab(R) Reference Manual, Version 1.0. Jul. 1998.</td></tr><tr><td class="patent-data-table-td ">11</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Chemical+Engineering+Module%2C"'>Chemical Engineering Module,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">12</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Electromagnetics+Module%2C"'>Electromagnetics Module,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">13</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Installation+Guide%2C"'>Installation Guide,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">14</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Model+Library%2C"'>Model Library,</a>" For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">15</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Model+Library%2C"'>Model Library,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">16</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Reference+Manual%2C"'>Reference Manual,</a>" For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">17</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Reference+Manual%2C"'>Reference Manual,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">18</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="Structural+Mechanics+Engineering+Module%2C"'>Structural Mechanics Engineering Module,</a>" For Use With Femlab (Copyright 1994-1998).</td></tr><tr><td class="patent-data-table-td ">19</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="User%27s+Guide+and+Instruction%2C"'>User's Guide and Instruction,</a>" For Use With Matlab, Windows, Unix, Linux, Macintosh; Version 2.2 (Copyright 1994-2001 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">20</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Femlab, "<a href='http://scholar.google.com/scholar?q="User%27s+Guide+and+Introduction%2C"'>User's Guide and Introduction,</a>" For Use With Matlab V5, Windows 95/98, Windows NT, Unix, Version 1.0 (Copyright 1994-1998 by Comsol AB).</td></tr><tr><td class="patent-data-table-td ">21</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Frey et al., "<a href='http://scholar.google.com/scholar?q="Mesh+Generation%2C+Application+to+Finite+Elements%2C"'>Mesh Generation, Application to Finite Elements,</a>" Hermes, Paris 88-90 (2000) Mesh Search: 88-90.</td></tr><tr><td class="patent-data-table-td ">22</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">George et al., "<a href='http://scholar.google.com/scholar?q="Delaunay+Triangulation+and+Meshing%2C"'>Delaunay Triangulation and Meshing,</a>" Hermes, Paris 33-238 (1998) Delaunay triangulation: 33-46, 50-59; Constrained triangulation: 73-99; Parametric surface meshing: 161-173; Optimizations: 215-238.</td></tr><tr><td class="patent-data-table-td ">23</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Mathworks, Inc., "<a href='http://scholar.google.com/scholar?q="Partial+Differential+Equation+Toolbox%3A+User%27s+Guide"'>Partial Differential Equation Toolbox: User's Guide</a>" For Use with Matlab (C) (Copyright 1984-1997 The Mathworks, Inc.).</td></tr><tr><td class="patent-data-table-td ">24</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Persson, P. "<a href='http://scholar.google.com/scholar?q="Implementation+of+Finite+Element-Based+Navier-Stokes+Solver+2.094-Project"'>Implementation of Finite Element-Based Navier-Stokes Solver 2.094-Project</a>", Apr. 25, 2002. http://www.mit.edu/ persson/nsfem-report.pdf.</td></tr><tr><td class="patent-data-table-td ">25</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Rao, P. "<a href='http://scholar.google.com/scholar?q="An+Efficient+Scalable+Finite+Element+Model+for+Simulating+Large+Scale+Hydrodynamic+Flows"'>An Efficient Scalable Finite Element Model for Simulating Large Scale Hydrodynamic Flows</a>", 16th ASCE Engineering Mechanics Conf., Jul. 16-18, 2003.</td></tr><tr><td class="patent-data-table-td ">26</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Ribeiro, P. "<a href='http://scholar.google.com/scholar?q="Non-linear+Forced+Vibrations+of+Thin%2FThick+Beams+and+Plates+by+the+Finite+Element+and+Shooting+Methods"'>Non-linear Forced Vibrations of Thin/Thick Beams and Plates by the Finite Element and Shooting Methods</a>", Computers and Structures, vol. 82, pp. 1413-1423, May 2004.</td></tr><tr><td class="patent-data-table-td ">27</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Saitz, J. "<a href='http://scholar.google.com/scholar?q="Newton-Raphson+Method+and+Fixed-Point+Technique+in+Finite+Element+Computation+of+Magnetic+Field+Problems+in+Media+with+Hysteresis"'>Newton-Raphson Method and Fixed-Point Technique in Finite Element Computation of Magnetic Field Problems in Media with Hysteresis</a>", IEEE Transactions on Magnetic, vol. 35, No. 3, pp. 1398-1401, May 1999.</td></tr><tr><td class="patent-data-table-td ">28</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Wilks, "<a href='http://scholar.google.com/scholar?q="Primer+on+Object-Oriented+Programming%2C"'>Primer on Object-Oriented Programming,</a>" http://www.eimc.brad.ac.uk/java/tutorial/Project1/ooprim.htm (1996).</td></tr><tr><td class="patent-data-table-td ">29</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Zienkiewicz et al., "<a href='http://scholar.google.com/scholar?q="The+Finite+Element+Method%2C"'>The Finite Element Method,</a>" McGraw-Hill 1:23-177 (1989) Basis Function: 23-26; Quadrature Formulas, Gauss Points, Weights: 175-177.</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Referenced by</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Citing Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8457932">US8457932</a></td><td class="patent-data-table-td patent-date-value">Jun 19, 2009</td><td class="patent-data-table-td patent-date-value">Jun 4, 2013</td><td class="patent-data-table-td ">Comsol Ab</td><td class="patent-data-table-td ">Method for assembling the finite element discretization of arbitrary weak equations involving local or non-local multiphysics couplings</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8626475">US8626475</a></td><td class="patent-data-table-td patent-date-value">Jul 15, 2011</td><td class="patent-data-table-td patent-date-value">Jan 7, 2014</td><td class="patent-data-table-td ">Comsol Ab</td><td class="patent-data-table-td ">System and method for accessing a multiphysics modeling system via a design system user interface</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20120249560">US20120249560</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 28, 2012</td><td class="patent-data-table-td patent-date-value">Oct 4, 2012</td><td class="patent-data-table-td ">Paul Frederick Cilgrim Dickenson</td><td class="patent-data-table-td ">Parallel computation of matrix problems</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014026171A2?cl=en">WO2014026171A2</a></td><td class="patent-data-table-td patent-date-value">Aug 9, 2013</td><td class="patent-data-table-td patent-date-value">Feb 13, 2014</td><td class="patent-data-table-td ">Comsol Ab</td><td class="patent-data-table-td ">System and method for creating application interfaces for forming and solving problems in a modeling system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014100727A1?cl=en">WO2014100727A1</a></td><td class="patent-data-table-td patent-date-value">Dec 20, 2013</td><td class="patent-data-table-td patent-date-value">Jun 26, 2014</td><td class="patent-data-table-td ">Comsol Ab</td><td class="patent-data-table-td ">System and method for creating reusable geometry sequences for multiphysics modeling</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc703/defs703.htm&usg=AFQjCNFjRYlbUvF5zAHOiHvB24Z6eD1I9g#C703S002000">703/2</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc703/defs703.htm&usg=AFQjCNFjRYlbUvF5zAHOiHvB24Z6eD1I9g#C703S009000">703/9</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc703/defs703.htm&usg=AFQjCNFjRYlbUvF5zAHOiHvB24Z6eD1I9g#C703S007000">703/7</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc703/defs703.htm&usg=AFQjCNFjRYlbUvF5zAHOiHvB24Z6eD1I9g#C703S006000">703/6</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0017120000">G06F17/12</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0017130000">G06F17/13</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0007600000">G06F7/60</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06G0007500000">G06G7/50</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06G0007480000">G06G7/48</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=FNq0BQABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F17/12">G06F17/12</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">G06F17/12</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">Aug 27, 2012</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">4</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">May 8, 2012</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CLAIMS 1-41 IS CONFIRMED. CLAIMS 42-44 ARE CANCELLED. NEW CLAIMS 45-55 ARE ADDED AND DETERMINED TO BE PATENTABLE.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Aug 31, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100601</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Feb 22, 2002</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">COMSOL AB., SWEDEN</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:LANGEMYR, LARS;BERTILSSON, DANIEL;NORDMARK, ARNE;AND OTHERS;REEL/FRAME:012616/0909;SIGNING DATES FROM 20020122 TO 20020206</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_8a2b04e7bf975d5171d8e4c0b6365c7a.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U0UzactrZS7ngrYqTAjvR47OgZ2qA\u0026id=FNq0BQABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U2ckBJkbsS42asE0Cp7-B7MZqb4nQ\u0026id=FNq0BQABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U3IZf6qUwl3X8gSskMeZSsymUhAzA","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/Method_for_assembling_the_finite_element.pdf?id=FNq0BQABERAJ\u0026output=pdf\u0026sig=ACfU3U0N6PBj3rVdRslDYltsuM2bVHQdoA"},"sample_url":"http://www.google.com/patents/reader?id=FNq0BQABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>