<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_8a2b04e7bf975d5171d8e4c0b6365c7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_8a2b04e7bf975d5171d8e4c0b6365c7a__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="System, apparatus and method for the detection and removal of viruses in macros"><meta name="DC.contributor" content="Eva Y. Chen" scheme="inventor"><meta name="DC.contributor" content="Jonny T. Ro" scheme="inventor"><meta name="DC.contributor" content="Ming M. Deng" scheme="inventor"><meta name="DC.contributor" content="Leta M. Chi" scheme="inventor"><meta name="DC.contributor" content="Trend Micro, Incorporated" scheme="assignee"><meta name="DC.date" content="1996-10-2" scheme="dateSubmitted"><meta name="DC.description" content="The detection and removal of viruses from macros is disclosed. A macro virus detection module includes a macro locating and decoding module, a macro virus scanning module, a macro treating module, a file treating module, and a virus information module. The macro locating and decoding module determines whether a targeted file includes a macro, and, where a macro is found, locates and decodes it to produce a decoded macro. The macro virus scanning module accesses the decoded macro and scans it to determine whether it includes any viruses. Unknown macro viruses are detected by the macro virus scanning module by obtaining comparison data that includes sets of instruction identifiers from the virus information module and determining whether the decoded macro includes a combination of suspect instructions which correspond to instruction identifiers. The macro treating module locates suspect instructions in the decoded macro using the comparison data and removes the suspect instructions to produce a treated macro. The file correcting module accesses a targeted file with an infected macro and replaces the infected macro with the treated macro produced by the macro treating module."><meta name="DC.date" content="1999-9-14" scheme="issued"><meta name="DC.relation" content="EP:0666671:A1" scheme="references"><meta name="DC.relation" content="JP:H06350784" scheme="references"><meta name="DC.relation" content="US:4975950" scheme="references"><meta name="DC.relation" content="US:5278901" scheme="references"><meta name="DC.relation" content="US:5319776" scheme="references"><meta name="DC.relation" content="US:5321840" scheme="references"><meta name="DC.relation" content="US:5408642" scheme="references"><meta name="DC.relation" content="US:5414833" scheme="references"><meta name="DC.relation" content="US:5440723" scheme="references"><meta name="DC.relation" content="US:5444850" scheme="references"><meta name="DC.relation" content="US:5448668" scheme="references"><meta name="DC.relation" content="US:5452442" scheme="references"><meta name="DC.relation" content="US:5485575" scheme="references"><meta name="DC.relation" content="US:5491791" scheme="references"><meta name="DC.relation" content="US:5511163" scheme="references"><meta name="DC.relation" content="US:5530757" scheme="references"><meta name="DC.relation" content="US:5550976" scheme="references"><meta name="DC.relation" content="US:5550984" scheme="references"><meta name="DC.relation" content="US:5649095" scheme="references"><meta name="DC.relation" content="WO:1993022723:A1" scheme="references"><meta name="citation_reference" content="Malarky, Anti Virus comaprative Review, Virus Bulletin, pp. 10 11, May 1996."><meta name="citation_reference" content="Malarky, Anti Virus comaprative Review, Virus Bulletin, pp. 10-11, May 1996."><meta name="citation_reference" content="Meyer, &quot;Possible Macro Virus Attacks and How to Prevent Them&quot;, Computers &amp; Security, vol. 15, No. 7, pp. 595-625, 1996."><meta name="citation_reference" content="Meyer, Possible Macro Virus Attacks and How to Prevent Them , Computers &amp; Security, vol. 15, No. 7, pp. 595 625, 1996."><meta name="citation_patent_number" content="US:5951698"><meta name="citation_patent_application_number" content="US:08/724,949"><link rel="canonical" href="http://www.google.com/patents/US5951698"/><meta property="og:url" content="http://www.google.com/patents/US5951698"/><meta name="title" content="Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros"/><meta name="description" content="The detection and removal of viruses from macros is disclosed. A macro virus detection module includes a macro locating and decoding module, a macro virus scanning module, a macro treating module, a file treating module, and a virus information module. The macro locating and decoding module determines whether a targeted file includes a macro, and, where a macro is found, locates and decodes it to produce a decoded macro. The macro virus scanning module accesses the decoded macro and scans it to determine whether it includes any viruses. Unknown macro viruses are detected by the macro virus scanning module by obtaining comparison data that includes sets of instruction identifiers from the virus information module and determining whether the decoded macro includes a combination of suspect instructions which correspond to instruction identifiers. The macro treating module locates suspect instructions in the decoded macro using the comparison data and removes the suspect instructions to produce a treated macro. The file correcting module accesses a targeted file with an infected macro and replaces the infected macro with the treated macro produced by the macro treating module."/><meta property="og:title" content="Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("yZbtU_75LeK7sQTU0YGACQ"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407723702.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("ITA"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("yZbtU_75LeK7sQTU0YGACQ"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407723702.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("ITA"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us5951698?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US5951698"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=NthLBAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS5951698&amp;usg=AFQjCNFNq3kuQZpqNkc8uSu2snQgxlMiLg" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US5951698.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US5951698.pdf"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US5951698" style="display:none"><span itemprop="description">The detection and removal of viruses from macros is disclosed. A macro virus detection module includes a macro locating and decoding module, a macro virus scanning module, a macro treating module, a file treating module, and a virus information module. The macro locating and decoding module determines...</span><span itemprop="url">http://www.google.com/patents/US5951698?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros" title="Patent US5951698 - System, apparatus and method for the detection and removal of viruses in macros"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US5951698 A</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 08/724,949</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Sep 14, 1999</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">Oct 2, 1996</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">Oct 2, 1996</td></tr><tr><td class="patent-bibdata-heading">Fee status<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The fee status is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the status or dates listed."></span></td><td class="single-patent-bibdata">Paid</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Also published as</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/WO1998014872A1">WO1998014872A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">08724949, </span><span class="patent-bibdata-value">724949, </span><span class="patent-bibdata-value">US 5951698 A, </span><span class="patent-bibdata-value">US 5951698A, </span><span class="patent-bibdata-value">US-A-5951698, </span><span class="patent-bibdata-value">US5951698 A, </span><span class="patent-bibdata-value">US5951698A</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Eva+Y.+Chen%22">Eva Y. Chen</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Jonny+T.+Ro%22">Jonny T. Ro</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Ming+M.+Deng%22">Ming M. Deng</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Leta+M.+Chi%22">Leta M. Chi</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Trend+Micro,+Incorporated%22">Trend Micro, Incorporated</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US5951698.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US5951698.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US5951698.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (20),</span> <span class="patent-bibdata-value"><a href="#npl-citations">Non-Patent Citations</a> (4),</span> <span class="patent-bibdata-value"><a href="#forward-citations">Referenced by</a> (102),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (6),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (11)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/5951698&usg=AFQjCNG5TOzh-zEx-89WT6r6pcFTrUzn9A">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D5951698&usg=AFQjCNHqMPj91EjcyBKIPuOz4OcCtlCRxQ">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D5951698A%26KC%3DA%26FT%3DD&usg=AFQjCNHz2cpawLaWEU8HQr6GVOodpjgl3w">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT54474732" lang="EN" load-source="patent-office">System, apparatus and method for the detection and removal of viruses in macros</invention-title></span><br><span class="patent-number">US 5951698 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA37959287" lang="EN" load-source="patent-office"> <div class="abstract">The detection and removal of viruses from macros is disclosed. A macro virus detection module includes a macro locating and decoding module, a macro virus scanning module, a macro treating module, a file treating module, and a virus information module. The macro locating and decoding module determines whether a targeted file includes a macro, and, where a macro is found, locates and decodes it to produce a decoded macro. The macro virus scanning module accesses the decoded macro and scans it to determine whether it includes any viruses. Unknown macro viruses are detected by the macro virus scanning module by obtaining comparison data that includes sets of instruction identifiers from the virus information module and determining whether the decoded macro includes a combination of suspect instructions which correspond to instruction identifiers. The macro treating module locates suspect instructions in the decoded macro using the comparison data and removes the suspect instructions to produce a treated macro. The file correcting module accesses a targeted file with an infected macro and replaces the infected macro with the treated macro produced by the macro treating module.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(7)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-1.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-1.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-2.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-2.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-3.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-3.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-4.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-4.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-5.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-5.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-6.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-6.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/pages/US5951698-7.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/pages/US5951698-7.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(25)</span></span></div><div class="patent-text"><div mxw-id="PCLM5442915" lang="EN" load-source="patent-office" class="claims">
    <claim-statement>We claim:</claim-statement> <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">obtaining comparison data including information for detecting a virus;</div> <div class="claim-text">retrieving a macro;</div> <div class="claim-text">decoding the macro to produce a decoded macro; and</div> <div class="claim-text">scanning the decoded macro for a virus by comparing the decoded macro to the comparison data;</div> <div class="claim-text">wherein the comparison data includes a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">wherein the scanning the decoded macro comprises:<div class="claim-text">determining whether the decoded macro includes a first portion which corresponds to the first suspect instruction identifier;</div> <div class="claim-text">determining whether the decoded macro includes a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">determining that the decoded macro includes the virus if the decoded macro includes the first and second portions; and</div> </div> <div class="claim-text">wherein the first suspect instruction identifier identifies a macro virus enablement instruction.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. The method of claim 1, further comprising:<div class="claim-text">removing the virus from the macro to produce a treated macro if the scanning the decoded macro indicates that the macro is infected with the virus.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. The method of claim 1, wherein the retrieving a macro comprises:<div class="claim-text">accessing a targeted file;</div> <div class="claim-text">determining whether the targeted file is a template file;</div> <div class="claim-text">if the targeted file is not a template file, determining whether the targeted file includes an embedded macro; and</div> <div class="claim-text">if the targeted file includes an embedded macro, locating the embedded macro.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. The method of claim 1, wherein the second suspect instruction identifier detects a macro virus reproduction instruction.</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. The method of claim 1, wherein the removing the virus comprises:<div class="claim-text">locating a first suspect macro instruction in the decoded macro which corresponds to the first suspect instruction identifier; and</div> <div class="claim-text">removing the first suspect macro instruction.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6. The method of claim 5, wherein the removing the first suspect macro instruction includes replacing the first suspect instruction with a benign instruction.</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7. The method of claim 5, wherein the removing the virus comprises:<div class="claim-text">locating a second suspect macro instruction in the decoded macro which corresponds to the second suspect instruction identifier; and</div> <div class="claim-text">removing the second suspect macro instruction from the decoded macro to produce a treated macro.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8. The method of claim 1, wherein the comparison data includes a plurality of sets of suspect instruction identifiers.</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">obtaining comparison data including information for detecting a virus;</div> <div class="claim-text">retrieving a macro;</div> <div class="claim-text">decoding the macro to produce a decoded macro;</div> <div class="claim-text">scanning the decoded macro for a virus by comparing the decoded macro to the comparison data; and</div> <div class="claim-text">removing the virus from the macro to produce a treated macro if the step of scanning the decoded macro indicates that the macro is infected with the virus;</div> <div class="claim-text">verifying the integrity of the treated macro; and</div> <div class="claim-text">replacing the infected macro in a targeted file with the treated macro dependent upon the integrity verification of the treated macro.</div> </div>
    </div>
    </div> <div class="claim"> <div num="10" class="claim">
      <div class="claim-text">10. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">obtaining comparison data including information for detecting a virus;</div> <div class="claim-text">retrieving a macro;</div> <div class="claim-text">decoding the macro to produce a decoded macro;</div> <div class="claim-text">scanning the decoded macro for a virus by comparing the decoded macro to the comparison data;</div> <div class="claim-text">wherein the comparison data includes a first suspect instruction identifier and a second suspect instruction identifiers; and</div> <div class="claim-text">wherein a first set of respective first and second suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 67 C2 80.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11. The method of claim 10, wherein a second set of respective first and second suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 64 6F 02 67 DE 00 73 87 01 12 73 7F, a third set of respective first and second suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 6D 61 63 72 6F 73 76 08, a fourth set of respective first and second suspect instruction identifiers comprises the strings 12 6C 01 00 and 64 67 C2 80 6A 0F 47, and a fifth set of respective first and second suspect instruction identifiers comprises the strings 79 7C 66 6F 72 6D 61 74 20 63 6A and 80 05 6A 07 43 4F 4D.</div>
    </div>
    </div> <div class="claim"> <div num="12" class="claim">
      <div class="claim-text">12. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">retrieving a macro;</div> <div class="claim-text">obtaining comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a second portion which corresponds to the second suspect instruction identifier; and</div> <div class="claim-text">determining that the macro is infected with the virus if the macro includes the first and second portions;</div> <div class="claim-text">wherein the first suspect instruction identifier includes the string 73 CB 00 0C 6C 01 00 and the second suspect instruction identifier includes the string 67 C2 80.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13. The method of claim 12, further comprising:<div class="claim-text">treating the macro to produce a treated macro if it is determined that the macro includes the first and second portions.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14. The method of claim 13, wherein the treating the macro comprises:<div class="claim-text">locating a first macro instruction in the infected macro which corresponds to the first suspect instruction identifier; and</div> <div class="claim-text">removing the first macro instruction from the infected macro to repair the infected macro.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15. The method of claim 14, wherein the treating the macro comprises:<div class="claim-text">locating a second macro instruction in the infected macro which corresponds to the second suspect instruction identifier; and</div> <div class="claim-text">removing the second macro instruction from the infected macro to repair the infected macro.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16. The method of claim 12, wherein the retrieving a macro comprises:<div class="claim-text">accessing a targeted file; and</div> <div class="claim-text">determining whether the targeted file is a template file;</div> <div class="claim-text">if the file is not a template file, determining whether the targeted file includes an embedded macro; and</div> <div class="claim-text">if the file includes an embedded macro, locating the embedded macro.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17. The method of claim 12, wherein the comparison data includes a plurality of sets of suspect instruction identifiers.</div>
    </div>
    </div> <div class="claim"> <div num="18" class="claim">
      <div class="claim-text">18. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">retrieving a macro;</div> <div class="claim-text">obtaining comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">determining that the macro is infected with the virus if the macro includes the first and second portions,</div> <div class="claim-text">wherein the comparison data includes a plurality of sets of respective first and second suspect instruction identifiers; and</div> <div class="claim-text">wherein a first set of suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 67 C2 80, a second set of suspect instruction comprises the strings 73 CB 00 0C 6C 01 00 and 64 6F 02 67 DE 00 73 87 01 12 73 7F, a third set of suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 6D 61 63 72 6F 73 76 08, a fourth set of suspect instruction identifiers comprises the strings 12 6C 01 00 and 64 67 C2 80 6A 0F 47, and a fifth set of suspect instruction identifiers comprises the strings 79 7C 66 6F 72 6D 61 74 20 63 6A and 80 05 6A 07 43 4F 4D.</div> </div>
    </div>
    </div> <div class="claim"> <div num="19" class="claim">
      <div class="claim-text">19. In a computer system comprising a processor and a memory, a method for detecting viruses in macros, the method comprising:<div class="claim-text">retrieving a macro;</div> <div class="claim-text">obtaining comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier;</div> <div class="claim-text">scanning the macro to determine whether the macro includes a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">determining that the macro is infected with the virus if the macro includes the first and second portions; and</div> <div class="claim-text">treating the macro to produce a treated macro if it is determined that the macro includes the firs and second portions, further comprising:</div> <div class="claim-text">accessing a targeted file;</div> <div class="claim-text">locating a macro within the targeted file;</div> <div class="claim-text">removing the macro from the targeted file; and</div> <div class="claim-text">adding the treated macro to the targeted file to produce a corrected file.</div> </div>
    </div>
    </div> <div class="claim"> <div num="20" class="claim">
      <div class="claim-text">20. An apparatus for detecting viruses in macros, the apparatus comprising:<div class="claim-text">a virus information module, for storing comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">a macro virus scanning module, in communication with the virus information module, for receiving the comparison data and scanning a macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier and a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">a macro locating and decoding module, in communication with the macro virus scanning module, for accessing a targeted file, determining whether the targeted file is a template file, determining whether the targeted file includes an embedded macro, and decoding the macro to produce a decoded macro;</div> <div class="claim-text">a macro treating module, in communication with the virus information module, for accessing the decoded macro and removing a first macro instruction which corresponds to the first suspect instruction identifier and a second macro instruction which corresponds to the second suspect instruction identifier to produce a treated macro; and</div> <div class="claim-text">a file correcting module, in communication with the macro treating module, for accessing the targeted file, locating the macro within the targeted file, removing the macro from the targeted file and adding the treated macro to the targeted file to produce a corrected file.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="21" class="claim">
      <div class="claim-text">21. The apparatus of claim 20, wherein the comparison data includes a plurality of sets of suspect instruction identifiers.</div>
    </div>
    </div> <div class="claim"> <div num="22" class="claim">
      <div class="claim-text">22. An apparatus for detecting viruses in macros, the apparatus comprising:<div class="claim-text">a virus information module, for storing comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier; and</div> <div class="claim-text">a macro virus scanning module, in communication with the virus information module, for receiving the comparison data and scanning a macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier and a second portion which corresponds to the second suspect instruction identifier, wherein the first instruction identifier includes the string 73 CB 00 0C 6C 01 00 and the second suspect instruction identifier includes the string 67 C2 80.</div> </div>
    </div>
    </div> <div class="claim"> <div num="23" class="claim">
      <div class="claim-text">23. An apparatus for detecting viruses in macros, the apparatus comprising:<div class="claim-text">a virus information module, for storing comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier; and</div> <div class="claim-text">a macro virus scanning module, in communication with the virus information module, for receiving the comparison data and scanning a macro to determine whether the macro includes a first portion which corresponds to the first suspect instruction identifier and a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">wherein the comparison data includes a plurality of sets of respective first and second suspect instruction identifiers; and</div> <div class="claim-text">wherein a first set of suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 67 C2 80, a second set of suspect instruction comprises the strings 73 CB 00 0C 6C 01 00 and 64 6F 02 67 DE 00 73 87 01 12 73 7F, a third set of suspect instruction identifiers comprises the strings 73 CB 00 0C 6C 01 00 and 6D 61 63 72 6F 73 76 08, a fourth set of suspect instruction identifiers comprises the strings 12 6C 01 00 and 64 67 C2 80 6A 0F 47, and a fifth set of suspect instruction identifiers comprises the strings 79 7C 66 6F 72 6D 61 74 20 63 6A and 80 05 6A 07 43 4F 4D.</div> </div>
    </div>
    </div> <div class="claim"> <div num="24" class="claim">
      <div class="claim-text">24. An apparatus for detecting viruses in macros, the apparatus comprising:<div class="claim-text">means for obtaining comparison data for detecting a virus, the comparison data including a first suspect instruction identifier and a second suspect instruction identifier;</div> <div class="claim-text">means for scanning the macro to determine whether a macro includes a first portion which corresponds to the first suspect instruction identifier;</div> <div class="claim-text">means for scanning the macro to determine whether the macro includes a second portion which corresponds to the second suspect instruction identifier;</div> <div class="claim-text">means for determining that the macro is infected with the virus if the macro includes the first and second portions;</div> <div class="claim-text">means for accessing a targeted file and determining whether the targeted file includes a macro; and</div> <div class="claim-text">means for correcting a file, the means for correcting a file including means for accessing the targeted file, means for removing the macro from the targeted file and means for adding the treated macro to the targeted file to produce a corrected file.</div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="25" class="claim">
      <div class="claim-text">25. The apparatus of claim 24, further comprising:<div class="claim-text">means for locating a first macro instruction and a second macro instruction within the macro which respectively correspond to the first suspect instruction identifier and the second suspect instruction identifier; and</div> <div class="claim-text">means for removing the first macro instruction and the second macro instruction from the macro to produce a treated macro.</div> </div>
    </div>
  </div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES67334871" lang="EN" load-source="patent-office" class="description">
    <heading>BACKGROUND OF THE INVENTION</heading> <p>1. Field of the Invention</p>
    <p>The present invention relates generally to the detection of viruses in computer files and more particularly to the detection and removal of viruses in macros.</p>
    <p>2. Description of the Related Art</p>
    <p>The increasing use of computers and the increasing communication between vast numbers of computers has greatly facilitated and promoted the spread of computer viruses. Computer viruses are found in portions of code which are buried within computer programs. When programs that are infected with the virus are executed, the code portions are activated to provide unintended and sometimes damaging operations in the computer system.</p>
    <p>Viruses are commonly detected using signature scanning techniques. Known viruses have extended strings or signatures which are like a fingerprint that can be used to detect the virus. In signature scanning an executable file sequence is scanned to see if it includes an extended string that matches a string that is known to be a virus. When the signature or string is found within the executable file, a positive virus determination is made. Since matching to known patterns is involved, the signature scan is virtually useless against viruses whose patterns have not been previously identified. Particularly, signature scanning completely fails to detect new, unknown virus strains, and does not adequately protect against mutating viruses, which intentionally assume various shapes and forms upon replication. Additionally, since executable files (e.g., those with extensions .exe or .com) are typically scanned, viruses which do not reside in such files are not examined and therefore are not detected with signature scanning.</p>
    <p>Many application programs support the use of macros which are used to automatically perform long or repetitive sequences of actions. Macros are a series of instructions including menu selections, keystrokes and/or commands that are recorded and assigned a name or a key. Macros can be triggered by the application program such as by pressing the key or calling the macro name. Some macros are embedded within application data files, and thus may remain hidden from the user. Additionally, macros can be arranged to execute automatically, without user input. Thus, a macro which the user does not know about and which does not need manual triggering by the user may reside in files such as application data files. Certain viruses reside in macros and use macro instructions to perform unintended and sometimes damaging actions. These viruses are referred to as macro viruses. One problem with macro viruses is that they avoid executable file scanners since they typically do not reside in executable files. Additionally, macro viruses avoid detection since they can be hidden or embedded within files such as application data files. Furthermore, there are a tremendous number of computer users who know how to use macro programming languages so the number and variation of macro viruses is extremely high. Accordingly, even if signature scanning techniques were used to detect viruses in macros they would be ineffective since there are numerous unknown macro viruses. Additionally, even if a comprehensive signature scanner were available, it would quickly become obsolete because of the ongoing generation and production of new, unknown macro viruses.</p>
    <p>Conventional virus treatment techniques are also inadequate for treating macros with viruses. These techniques look for particular, known viruses and apply a specific correction technique dependent upon the particular virus detected. Because of the vast array of unknown macro viruses, such techniques are not very effective in the treatment of macros which are infected by viruses. Even if unknown macros were detected, merely deleting the file with the infected macro is not an attractive solution, since infected macros often include legitimate operations that the user may want to retain. Thus, there is a need to selectively remove viruses, particularly unknown viruses, from macros to provide a clean, corrected file which can be subsequently used.</p>
    <p>Another problem is that viruses, and therefore, the information that is needed to detect them, are in a constant state of change. Thus, a virus detection method and apparatus which facilitates easy updates of virus detection information is needed. Particularly required is easily modified unknown macro virus detection information.</p>
    <p>Thus, there is a need for the detection of viruses which reside in macros. Moreover, there is a need for detecting unknown macro viruses, for cleaning macro viruses selectively, and for conveniently updating macro virus detection information.</p>
    <heading>BRIEF SUMMARY OF THE INVENTION</heading> <p>The present invention overcomes the limitations and shortcomings of the prior art with systems, apparatuses and methods for detecting and removing viruses from macros.</p>
    <p>In accordance with the present invention, a macro virus detection module includes a macro locating and decoding module, a macro virus scanning module, a macro treating module, a virus information module, a file correcting module, and a data buffer. A file is targeted for virus detection according to the configuration settings of the macro virus detection module and is copied into the data buffer for analysis. The macro locating and decoding module examines the file to determine whether it is a template file. If it is determined that the file is a template file, any macros within the template file are located and decoded. If the target file is not a template file, then the macro locating and decoding module examines the target file to determine whether it includes any embedded macros that are then located and decoded. The decoded macros are stored in the data buffer.</p>
    <p>The macro scanning module is in communication with the macro locating and decoding module and the data buffer and thus accesses the decoded macros for virus scanning. The macro virus scanning module is also in communication with the macro virus information module. The macro virus information module includes information that is used by the macro virus scanning module to detect both known and unknown viruses in macros. First, a decoded macro is scanned for known viruses. If a known virus is detected, then the decoded macro is flagged as infected. The decoded macro, the flag and information associating the decoded macro to the known virus that was detected in the decoded macro are stored in the data buffer. Thus, the infected macro and the file that the infected macro resides in can be properly treated and corrected by the macro treating module and the file correcting module.</p>
    <p>If a known virus is not detected, then the macro virus scanning module determines whether the decoded macro includes an unknown virus. The macro virus scanning module detects unknown macro viruses using comparison data which is stored in the virus information module. The comparison data includes information that is used to detect combinations of suspect instructions in macros. An exemplary set of comparison data includes first and second suspect instruction identifiers. The macro virus scanning module determines that the macro includes a virus if it is determined that the macro includes both the first and second suspect instructions. If an unknown macro virus is detected, then the macro is flagged as infected according to the set of instruction identifiers that resulted in the positive unknown virus detection. As with the detection of a known virus, the information which resulted in the positive detection is stored in the data buffer along with the infected macro so that the macro treating module and the file correcting module can properly treat and correct the infected macro. Since combinations of suspect instructions in lieu of a particular sequential signature are sought, unknown viruses are detected by the macro virus scanning module. The information for detecting known and unknown viruses resides in a separate module and thus is easily updated.</p>
    <p>The macro treating module is in communication with the macro virus scanning module and the data buffer and thereby accesses information about detected viruses. The macro treating module removes detected viruses from macros to provide a cleaned or sanitized macro so that the file which includes the infected macro can be repaired or otherwise corrected by the file treating module. The macro treating module accesses the decoded macro in the data buffer and determines whether it has been flagged as infected with a known virus. If the macro is flagged as infected by a known virus, then the known virus is removed from the macro. If the macro is not infected by a known virus, then the macro treating module treats the macro using the set of instruction identifiers that was used to detect an unknown virus in the macro. The macro treating module receives decoded macros and information regarding the presence of viruses from the macro virus scanning module and the data buffer. The suspect instructions within the decoded macro are identified and located using the instruction identifiers. The suspect instructions are then removed from the infected macro, preferably by replacement with benign instructions, to provide a treated macro which has been cleaned or sanitized. The treated macro is stored in the data buffer for access by the file correcting module. The integrity of the treated macro is verified and the validity of the treated macro is flagged accordingly. If macro integrity is maintained upon completion of macro treatment, then the validity flag is set. If integrity is not maintained, the flag is not set.</p>
    <p>The file correcting module is in communication with the macro locating and decoding module, the macro virus scanning module, the macro treating module, the data buffer and the virus information module. Information about the treated macro and the targeted file that includes an infected macro are accessed in the data buffer. The file correcting module accesses the targeted file in its original form and stores a copy of the targeted file in the data buffer. The copy of the targeted file includes the infected macro. If the macro validity flag is not set, then the treated macro is not used to replace the infected macro and alternative corrective action is taken, such as deleting the targeted file, notifying the user about the presence of a file with an infected macro, or removing the infected macro from the targeted file and replacing the targeted file with the version without a macro. If the macro validity flag is set, then the file correcting module corrects the targeted file by replacing the infected macro with the treated macro. To replace the infected macro, the file correcting module locates and removes the infected macro from the targeted file so that a version of the targeted file without the macro is stored in the data buffer. The treated macro is then added to the version of the targeted file without the macro to provide a corrected file. The corrected file is used to replace the targeted file (in its original location). Thus, unknown viruses are removed from macros and the files which include such macros are corrected so that their legitimate functions are retained.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading> <p>These and other more detailed and specific features of the present invention are more fully disclosed in the following specification, reference being had to the accompanying drawings, in which:</p>
    <p>FIG. 1 is a block diagram illustrating a computer system including a macro virus detection apparatus in accordance with the present invention.</p>
    <p>FIG. 2 is a block diagram illustrating a preferred embodiment of a memory in accordance with the present invention.</p>
    <p>FIG. 3 is a block diagram illustrating a preferred embodiment of a macro virus detection module in accordance with the present invention.</p>
    <p>FIG. 4 is a flow chart illustrating a preferred method of detecting and correcting viruses in macros in accordance with the present invention.</p>
    <p>FIG. 5 is a flow chart illustrating a preferred method of locating and decoding macros in accordance with the present invention.</p>
    <p>FIG. 6 is a flow chart illustrating a preferred method of scanning macros for viruses in accordance with the present invention.</p>
    <p>FIG. 7 is a flow chart illustrating a preferred method of treating macros in accordance with the present invention.</p>
    <p>FIG. 8 is a flow chart illustrating a preferred method of correcting files in accordance with the present invention.</p>
    <p>FIG. 9 is a table including exemplary sets of comparison data used in the detection of macro viruses.</p>
    <heading>DETAILED DESCRIPTION OF THE INVENTION</heading> <p>Referring now to FIG. 1, a computer system 100 constructed in accordance with an embodiment of the present invention comprises a central processing unit (CPU) 104, a display device 102, a memory 106, an input device 108, a data storage device 110, and a communications link 112. The CPU 104 is coupled by a bus 114 to the display device 102, memory 106, input device 108, data storage device 110 and communications unit 112 in a conventional architecture such as a von Nuemann architecture such as provided in a personal computer. The CPU 104 is preferably a microprocessor such as a Pentium as provided by Intel, Inc. of Santa Clara, Calif.; the display device 102 is preferably a video monitor; the memory 106 is preferably random access memory (RAM); the input device 108 preferably comprises a keyboard and mouse; the data storage device 110 is preferably a hard disk; and the communications unit 112 is a device, such as a modem, for facilitating communication with other systems.</p>
    <p>It is understood that a variety of alternative computer system configurations are available and that the present invention is independent of their use. For example, alternative processors may be used for the CPU 104 such as those provided by Motorola, Inc., and the memory 106 may be read only memory (ROM) or a combination of RAM and ROM. Additionally, the system 100 may be connected to other computer systems such as through a network interface (not shown). It is also understood that the computer system 100 may be a minicomputer or mainframe computer.</p>
    <p>The CPU 104, as directed by instructions received from the memory 106 as configured in accordance with the present invention, provides signals for accessing computer files, determining whether they include macros, locating the macros and scanning them to determine whether viruses including unknown viruses are present, and taking corrective action when such viruses are detected.</p>
    <p>Referring now to FIG. 2, a preferred embodiment of the memory 106 as configured in accordance with the present invention is shown in more detail. The memory 106 includes an operating system 202, application programs 204 and a macro virus detection module 206.</p>
    <p>The operating system 202 is preferably a conventional one for a personal computer such as WINDOWS 3.1 as provided by Microsoft, Inc. of Redmond, Wash. Any of the wide variety of application programs 204 may be included in the memory 106 such as word processing, spreadsheet and drawing programs. For example, the memory 106 may include Microsoft WORD as a word processing application and Microsoft EXCEL as a spreadsheet application. The application programs 204 typically create application data files. For example, WORD generates data files which typically use the file extension .DOC. Typical application programs 204 accommodate macros which allow sequential operations without necessitating repetitive user input. Conventional macros include various instructions including those for relatively simple operations such as keystrokes as well as those for operations such us opening, copying and deleting files. Sometimes, the macro instructions invoke the operating system (or DOS shell) to execute lower level commands like FORMAT. The instructions which may be used by macros are usually dictated by the application programs 204 which support macro programming languages. For example, macros for WORD files may be written using the WordBasic programming language.</p>
    <p>Various operating systems 202 may be alternatively used in accordance with the present invention, such as OS/2 as provided by IBM, Inc. Also, various application programs 204 may be used. Although certain embodiments of the present invention describe the detection of macro viruses which use WordBasic commands in WORD application data files, the artisan will understand that the present invention applies to such alternative operating systems 202 and application programs 204.</p>
    <p>The macro virus detection module 206 includes routines for the accessing files, determining whether such files include macros, scanning the macros to determine whether they contain viruses, treating macros which are found to contain viruses and correcting files with infected macros. The macro virus detection module 206 operates in conjunction with the operating system 202 and the application programs 204. The macro virus detection module 206 is typically implemented in software, but can also be implemented in hardware or firmware. Although the macro virus detection module 206 is preferably separate from the operating system 202 and application programs 204 as shown, the macro virus detection module 206 can alternatively be integrated into the operating system 202 or application programs 204 to perform similar functions of virus detection and correction.</p>
    <p>Referring now to FIG. 3, a preferred embodiment of the macro virus detection module 206 includes a macro locating and decoding module 302, a macro virus scanning module 304, a macro treating module 306, and a file correcting module 310. Additionally, a virus information module 308 provides comparison data for the detection of viruses in macros and the treatment of macros with viruses, and the data buffer 312 provides for the storage of information which is used in the detection and correction of macro viruses. Although the data buffer 312 is shown as a single module which includes several separate storage locations, a plurality of separate data buffers may be used for the various described functions of the data buffer 312.</p>
    <p>The macro virus detection module 206 accesses targeted files and determines whether they includes macros. Files are accessed dependent upon the configuration settings of the module 302 which are preset or determined by the user. For example, a system user may target a single file for analysis. Alternatively, groups of files may be targeted such as the files corresponding to a selected application program 204 or all files within selected directories or storage areas. Various events may initiate the analysis of files. For example, the user may initiate a virus scan, the analysis may be initiated any time certain application files are opened, or a complete analysis may be undertaken at every nth boot up of the system 100 or at periodic interval. Preferably, the macro locating and decoding module 302 is arranged to access any files which may contain a macro virus and to access such files prior to the launching of an application program 204 and accordingly prior to the opening of any application data files. This is advantageous because some macro viruses operate automatically upon a launching of the relevant application program and, accordingly, may require detection prior to user initiation of a scan.</p>
    <p>Each targeted file is accessed and stored in the data buffer 312 for analysis by the macro virus detection module 206. While, for ease of understanding, the analysis of a single file is described in connection with certain functions of the various modules 302, 304, 306, 308, 310, 312 several files can be concurrently or sequentially analyzed in accordance with the present invention.</p>
    <p>The macro locating and decoding module 302 examines targeted files to determine whether they are of a type that may include macros, examines targeted files to determine whether they include embedded macros, and locates and decodes macros within targeted files.</p>
    <p>The macro locating and decoding module 302 is in communication with the data buffer 312 and thus accesses a targeted file for analysis. Macros are found in template files and embedded within application data files. The macro locating and decoding module 302 initially determines whether the targeted file is a template file. This determination is made by checking the file extension. For example, if the file is associated with the WORD application program 204, then the file is checked for the extension DOT. The DOT extension indicates that the file is a template file.</p>
    <p>If the targeted file is not determined to be a template file, it may still include an embedded macro. For example, an application data file such as a WORD file with a .DOC extension may include an embedded macro. The macro locating and decoding module 302 accesses the targeted file stored in the data buffer 312, and determines whether its formatting indicates an embedded macro. The formatting fields vary according to the conventional rules of each application program 204 and are supplied by application program 204 manufacturers.</p>
    <p>The macro is located within the targeted file once the determination is made that the targeted file includes a macro, whether it is embedded, provided in a template file or provided in another file type that can support macros. The macro locating and decoding module 302 is in communication with the operating system 202. The operating system includes information sharing resources such as Object Linking and Embedding (OLE, or OLE2) as provided in the Windows 3.1 operating system. The information sharing resources provide details regarding the structure of files such as application files, so that objects which are embedded may be located within the files. The information sharing resource commands vary dependent upon the operating system 202, but generally simple commands such as those for opening objects, seeking particular streams, and reading and writing to files are provided. Conventional programming techniques can be used to implement the information sharing resources in locating and decoding macros. After the macro is located, the macro locating and decoding module 302 decodes the macro so that it can be scanned for viruses. The information sharing resources of the operating system 202 are used to decode the macros into coherent information and ASCII conversion is used to convert the decoded macro into a form which is suitable for scanning. The decoded macro is stored in the data buffer 312. Additionally information associating the decoded macro to the targeted file from which it was derived are stored in the data buffer 312.</p>
    <p>The macro virus scanning module 304 is in communication with the macro locating and decoding module 302 and the data buffer 312, and, accordingly, the macro locating and decoding module 302 provides the decoded macro to the macro scanning module 304. A preferred method of locating and decoding macros which is used by the macro locating and decoding module 302 is described in further detail with reference to FIG. 5.</p>
    <p>The macro virus scanning module 304 includes routines for scanning the decoded macros to detect known and unknown viruses based upon comparison of the decoded macros to data from the virus information module 308. The macro virus scanning module 304 may be configured to provide various modes of macro virus detection. For example, it may be configured to detect only certain classes of viruses to facilitate shorter scanning periods; known, unknown, or both types of viruses may be detected; an alarm may be provided upon the first detection of a virus; or a scan of several targeted files may be completed prior to the indication that a virus has been detected.</p>
    <p>The macro virus scanning module 304 accesses decoded macros in the data buffer 312, scans the decoded macros for known viruses and, where known viruses are not found, scans the decoded macros for unknown viruses. To scan for known viruses, the macro virus scanning module 304 uses signature scanning techniques. The virus scanning module 304 is in communication with the virus information module 308. The virus information module 308 includes information for detecting known viruses. For example, the virus information module includes strings of data, or signatures, for identifying known viruses. The virus scanning module 304 accesses a decoded macro in the data buffer 312 and scans the decoded macro to determine whether it includes any known virus signatures. A state machine or similar techniques can be used to conduct the scanning. If a known virus signature is found in the decoded macro, then the macro virus scanning module 304 identifies the decoded macro as infected according to the known virus and stores information associating the decoded macro to the known virus in the data buffer 312 so that other modules such as the macro treating module 306 can subsequently treat the infected macro accordingly.</p>
    <p>If known viruses are not detected, the macro scanning module 304, scans for unknown viruses in the decoded macros. As indicated above, application programs 204 often include programming languages, such as WordBasic, which include instructions that are used by macros for various operations. Macro viruses use the various operations and instructions to perform undesired and often damaging actions.</p>
    <p>Typical application programs 204 support macros by providing them in template files. Template files include stylistic and other settings such as word processing settings. Additionally, template files can include macros. Typically, a global template file provides the settings and macros for the data files. For example, for Microsoft WORD, the global settings and pool of macros reside in the template file NORMAL.DOT. When an application program 204 opens a data file, it usually opens the global template file first, loads the global settings and macros, and then opens the data file. Typical data files are formatted to indicate to the application program 204 that they do not include embedded macros. However, a data file can be formatted to indicate to the application program 204 that it does include a template file.</p>
    <p>Certain macro viruses cause infected document files to be saved in template formats but maintain a document or data file extension (.DOC) to remain undetected. Thus, infected macros may be embedded within a document that appears to merely be an application data file. Some such macros include commands such as "AutoOpen", "AutoExec" or "AutoClose" which cause the macro to be executed when the data file is opened. Thus, a user can attempt to open what appears to be a regular data file but, in doing so, will be causing an embedded macro to execute automatically. Macro viruses also replicate themselves in other files. For example, a macro virus will often copy itself into a data file and format the data file to indicate a template format while maintaining a regular file extension for the data file. The file which is attacked by the macro virus may have its formatting changed directly, or, alternatively, the macro virus may save the attacked data file with the updated format information. The infected macros may also be copied into the global template and thereby spread to other files as they are opened.</p>
    <p>The macro virus scanning module 304 includes routines to detect macro instruction combinations which are very likely to be used by macro viruses, or, in other words, combinations of suspect instructions. One combination of suspect instructions that is detected by the macro virus scanning module 304 is a macro enablement instruction and a macro reproduction instruction. A macro enablement instruction is one which allows the formatting of a file to be set to indicate that the file include a macro for execution. For example, the file formatting may be set to indicate a template file so that an application program 204 causes the template file to be executed when the file is opened. A macro reproduction instruction is one which allows the macro virus to be replicated. The combination of a macro enablement instruction and a macro reproduction instruction indicates a macro virus since such instructions allow replication and execution of a macro in a destination file, two common characteristics of macro viruses.</p>
    <p>To identify suspect instruction combinations, the macro virus scanning module 304 accesses comparison data from the virus information module 308. The comparison data includes sets of instruction identifiers which are used to identify combinations of suspect instructions in the decoded macro. An exemplary set of instruction identifiers includes first and second suspect instruction identifiers. The instruction identifiers are binary strings and the decoded macros are scanned to determine whether they include the binary strings and, accordingly, the suspect instructions. If it is determined that the macro includes the combination of suspect instructions defined and identified by the set of instruction identifiers, then it is determined that the macro is infected by an unknown virus corresponding to that set of data. The macro virus scanning module 304 flags the decoded macro as infected with an unknown virus and stores information associating the decoded macro to the set of instruction identifiers that resulted in a positive unknown virus detection in the data buffer 312 so that other modules such as the macro treating module 306 can treat the infected macro accordingly. Combinations of suspect instructions which are detected by the macro virus scanning module 304, including those for macro virus enablement and macro virus reproduction, are described in further detail with reference to the flow chart of FIG. 6.</p>
    <p>Preferably, the virus information module 308 is separate from the other modules 302, 304, 306, 310, 312 in the macro virus detection module 206. Thus, the information for the detection of macro viruses may be easily updated. For example, the virus information 308 may be updated by copying new information obtained from sources such as a floppy disk. Alternatively, the new information may be downloaded from internet resources which may be accessed through the communications unit 112 of the computer system 100, or through network links (not shown). The separate virus information module 308 facilitates more efficient information transfer, is easier to update and, thus, provides better protection of the system 100 from viruses, including those which are unknown.</p>
    <p>The macro treating module 306 is in communication with the data buffer 312 and the macro virus scanning module 304 and accordingly receives information regarding the detection of viruses within the decoded macros from targeted files. The macro treating module 306 includes routines for checking the status of decoded macros to determine whether the macro virus scanning module 304 detected a known or unknown virus in the decoded macros, for removing macro viruses from the decoded macros and for verifying the integrity of treated macros.</p>
    <p>The macro treating module 306 accesses a decoded macro in the data buffer 312 and checks the status of the decoded macro to determine whether the macro virus scanning module 304 detected a known virus. The status is provided by information in the data buffer 312 such as a status flag. Additionally, the data buffer 312 includes information associating the decoded macro to the known virus which infects it. As indicated, this information is provided from the macro virus scanning module 304. Alternatively, the macro virus scanning module 304 can store the appropriate information and communicate directly with the macro treating module 306. If the known virus determination flag is set, the macro treating module uses the information about the known virus to remove the known virus from the decoded macro. Preferably, known macro virus is selectively removed from the decoded macro and is replaced with benign instructions so that the remaining portions of the macro are retained for future use. The treated macro is separately stored in the data buffer 312 by the macro treating module 306. The integrity of the treated macro is then ascertained by the macro treating module and, where such integrity is maintained the treated macro is flagged as valid. If the integrity of the treated macro is not maintained, then the treated macro is flagged as invalid. The integrity of the macro can be checked by ascertaining whether the remaining instructions are intact and, additionally, by ascertaining whether the sequential linking of the instructions remains intact. Macro integrity verification allows other modules such as the file correcting module 310 to determine alternative remedies such as whether to replace an infected macro with a treated macro or to merely delete an infected macro from a targetted file.</p>
    <p>If the macro virus scanning module 304 detected an unknown virus, then the macro treating module 306 treats the macro to remove the effects of the unknown virus. Similar to the known virus treatment protocol, the treating module 306 communicates with the data buffer 312 to determine whether an unknown virus was detected and, if so, to identify the instruction identifier set which resulted in a positive virus determination. Preferably, the set of suspect instruction identifiers that resulted in the detection of an unknown virus in the macro are used to correct the macro. Each instruction identifier is correlated to one or more suspect instructions so that such instructions may be identified and removed from the macro. The virus correction 306 locates and decodes the macro for correction or, alternatively, accesses macros which were previously decoded by the macro virus scanning module 304. Again, the suspect instructions are preferably removed from the decoded macro and replaced with benign instructions. The treated macro is stored in the data buffer 312 for access by other modules such as the file correcting module 310. Similar to the known virus treatment protocol, the integrity of the treated macro is verified and the macro is flagged accordingly. A preferred macro treating routine is described in more detail with reference to FIG. 7.</p>
    <p>The file correcting module 310 is in communication with the data buffer 312 and other modules such as the macro treating module 306 and thereby receives information about the viruses which were detected in macros from targeted files. The file correcting module 310 includes routines for providing remedial action where infected files are indicated. The routines in the correcting module 306 may be configured to take various forms of remedial action automatically or only upon user authorization. For example, the file correcting module 310 may copy a targeted file with an infected macro, replace the infected macro with a treated macro, and then replace the targeted file with a corrected file without informing the user. The file correcting module 310 can also be configured to prompt the user at various correction stages whether the user wishes to proceed. This, of course, may be undertaken interactively using the input 108 and display devices 102 of the computer system 100. For example, the correcting module 310 may indicate to the user that a certain type of virus or unknown virus was detected in a macro from a targeted file. The user may then be asked whether he or she wishes to replace the targeted file with a corrected file. The artisan will recognize the various ways that the correcting module 306 may be configured and that the user may be prompted at various stages.</p>
    <p>The file correcting module 310 communicates with the data buffer 312 which indicates targeted files that include infected macros. The file correcting module 310 accesses a targeted file that includes an infected macro and stores a copy of the targeted file in the data buffer 312 so that the file can be repaired. As described regarding the macro locating and decoding module 302, the macro virus scanning module 304, and the macro treating module 306 above, the data buffer 312 includes information about the targeted file such as an association of the targeted file to a treated macro, the validity of the treated macro, and information about the type of virus that was detected. The file correcting module 310 checks the macro validity flag in the data buffer 312 to determine whether the macro treating module 306 was able to remove the detected virus and maintain the integrity of the treated macro. If the integrity of the treated macro was maintained, then the file correcting module 310 repairs the targeted file in the data buffer 312 by replacing its infected macro with a treated macro. First, the viral macro is located within the infected file. This can be done by communication with the macro locating and decoding module 302 or may be independently done by the file correcting module 310, which like the locating and decoding module 302 can access the information sharing resources of the operating system 202 to locate the macro. After the macro is located within the infected targeted file, the macro is removed and a copy of the targeted file without the macro is stored in the data buffer 312. Then, the treated macro is added to the version of the targeted file that does not include the macro to provide a corrected file. The corrected file is used to replace the targeted file in its original location. This may be a direct replacement of the targeted file with the corrected file. Alternatively, the targeted file can be deleted or overwritten and the corrected file can be stored in a separate location.</p>
    <p>Preferably a treated macro which corresponds to the targeted file which is flagged as invalid is not used to replace the infected macro. In such a situation, various alternative corrective actions may be taken by the file correcting module 310. For example, the user could be notified that the targeted file includes a virus, the infected macro could be removed from the infected macro without replacement, or the targeted file could be deleted.</p>
    <p>Referring now to FIG. 4, a flow chart of a preferred method 400 of unknown virus detection in macros is shown. First, a file which is targeted for virus detection is accessed 420. Typically, targeted files will reside in memory 106 and such targeted files may be copied to the data buffer 312 so that the macro virus detection module 206 can detect and remove macro viruses from them. Although the processing of a single targeted file is described in detail, numerous files can be accessed and tested with the present invention. The timing and scope of file access depends upon how the macro virus detection module 206 is configured as explained in the description of the macro virus detection module 206 above. Specifically, various files may be targeted and the detection of viruses may be triggered based upon conditions which can be selected by the user. Preferably, though, the macro virus detection module 206 is configured to scan relevant application program 204 files including application data files without necessitating the launching of the application program 204 so that macro viruses which operate upon application program 204 launching can be detected and removed.</p>
    <p>After accessing the targeted file and providing it in the data buffer 312, the macro locating and decoding module 302 determines whether any macros are in the targeted file and proceeds to locate and decode them. A preferred method 500 of locating and decoding a file is described in further detail with reference to FIG. 5. Next, it is determined 440 whether a macro was found by the locating and decoding module 302. If it is determined 440 that a macro is present in the targeted file, the macro is scanned 600 by the macro virus scanning module 304 to determine whether it is infected by a macro virus. If it is determined 440 that a macro is not present in the targeted file, then the method of macro virus detection ends. A preferred method of file scanning 600 is described in further detail with reference to FIG. 6. If a virus is detected 460 in the scan, then the infected macro is treated 700 by the macro treating module 306. If a virus is not detected 460 in the scan, then the method of virus detection ends. A preferred method of macro treating is described in further detail with reference to FIG. 7. After the macro is treated 700, corrective action 800 is taken on the infected targeted file after which the preferred method of macro virus detection ends. A preferred method of file correcting is described in further detail with reference to FIG. 8.</p>
    <p>Referring now to FIG. 5, a flow chart of a preferred method 500 of macro locating and decoding in accordance with the present invention is shown. Various files may be targeted including application data files and template files. The macro locating and decoding module 302 includes routines which initially determine whether the targeted file includes a macro by determining in step 505 what type of file it is. This determination is made by checking the file extension of the targeted file. Through examination of the file type, it can be determined whether the targeted file is a template file. If the file is a template file, then the macro locating and decoding module 302 does not have to determine whether the targeted file includes an embedded macro. Thus, if it is determined in step 510 that the file is a template file, any macros within it are located 525 and decoded 530 so that they can be scanned for viruses by the macro virus scanning module 304. Any decoded macros are stored 535 in the data buffer 312 for access by the macro virus scanning module 304.</p>
    <p>If it is determined in step 510 that the file is not a template file or other type of file that may include a macro, then in step 515 the targeted file is examined to determine whether it includes an embedded macro. If there are no embedded macros it is determined in step 540 that the targeted file does not include a macro and the preferred method ends. The determination of whether a file includes an embedded macro is performed by checking the file formatting. For example, one file format allows an application data file to indicate to an application program 204 that it includes a template file even where the file extension indicates otherwise. If the file format indicates a template file is included, then the targeted file may include an embedded macro. In step 520, if it is determined that the file does not include an embedded macro, then it is determined in step 540 that a macro does not reside in the targeted file and the preferred method 500 ends.</p>
    <p>If it is determined in step 520 that the targeted file includes an embedded macro or in step 510 that the targeted file is a template file with a macro, the macro is located in step 525 and decoded in step 530. Preferably, the locating and decoding module 302 includes routines which use the operating system 202 information sharing resources such as Object Linking and Embedding (OLE, or OLE2) as provided in the Windows 3.1 operating system. As described regarding the locating and decoding module 302 above, the information sharing resources include instructions which provide details regarding the structure of files, such as application files and template files, so that objects which are integrated into files may be located and decoded. Conventional programming techniques can be used to implement the information sharing resources to locate and decode macros. After the macros are located and decoded, they are converted to binary code (e.g. by ASCII conversion) and in step 535 they are stored in the data buffer 312 so that can be scanned for viruses. In addition to storing the decoded macros, the macro locating and decoding module 302 maintains and stores an association between the decoded macro and the targeted file so that other modules such as the macro virus scanning module 304, the macro treating module 306 and the file correcting module 310 can properly scan, treat and correct targeted files. After the macros are decoded and stored in step 535, the preferred method 500 of locating and decoding ends.</p>
    <p>Referring now to the flow chart of FIG. 6, a preferred method 600 for detecting viruses in macros in accordance with the present invention is shown. The macro virus scanning module 304 includes routines which access the decoded macro information provided by the locating and decoding module 302 and compare the decoded macro information to virus information 308 to detect the presence of a virus.</p>
    <p>In a first step 605, the decoded macro is scanned for known viruses. To scan for known viruses, the macro virus scanning module 304 uses signature scanning techniques. The macro virus scanning module 304 accesses decoded macros in the data buffer 312 and determines whether they include known virus signatures that are provided by the virus information module. In step 610 it is determined whether the decoded macro includes a known virus based upon the known virus scanning step 605, and, if there are any known viruses present, in step 615 the macro virus scanning module flags the macro as infected according to the known virus and stores information associating the decoded macro to the known virus in the data buffer 312.</p>
    <p>If in step 610 it is determined that known viruses were not detected in the scanning step 605, the macro virus scanning module 304 scans for unknown viruses in the decoded macros. In step 615, the macro virus scanning module 304 obtains a set of instruction identifiers for detecting unknown viruses. The macro scanning module 304 detects instructions which are likely to be used by macro viruses. These instructions are also referred to as suspect instructions. Certain combinations of suspect instructions are very likely to be used macro viruses. By looking for combinations of suspect instructions, false positive virus detection is avoided since a macro with two (or more) different suspect instructions is very likely to be infected.</p>
    <p>As indicated in the description of the macro virus scanning module 304 above, typical application programs 204 provide macros in template files. Typically, application data files use a global template file but application data files can also be formatted to indicate that they include embedded macros. For example, WORD files can be saved in the .DOT format to indicate inclusion of a template file. Many macro viruses cause infected document files to be saved in template formats (.DOT) but maintain a document or data file extension (.DOC) to remain undetected. Thus, infected macros may be embedded within a document that appears to merely be an application data file. Macro viruses also replicate themselves in other files. For example, a macro virus will often copy itself into a data file and format the data file to indicate a template format while maintaining a regular file extension for the data file.</p>
    <p>One combination of suspect instructions that is detected by the macro scanning module 304 is a macro enablement instruction and a macro reproduction instruction. A macro enablement instruction is one which formats a file to indicate that the file includes a macro for execution. For example, the file formatting may be set to indicate a template file so that an application program 204 causes the template file to be executed when the file is opened. A macro reproduction instruction is one which allows the macro virus to be replicated. The combination of a macro enablement instruction and a macro reproduction instruction indicates a macro virus since such instructions allow replication and execution of a macro in a destination file, two common characteristics of macro viruses.</p>
    <p>In certain application files, such as Microsoft WORD files, if the file format field .format is set to 1, then the application program 204 (WORD) determines that the file may include embedded macros and, at appropriate initiation, will access and execute any macros which are embedded within the file. Thus, setting .format to 1 in a file enables execution of a macro in the file and any macro instruction that seeks to provide such a setting in a destination file may be construed as a macro enablement instruction. For example, the instruction if dlg.format=0 then dlg.format=1 is a macro enablement instruction since it allows the .format to be changed from 0 to 1 in a destination file. Other instructions, such as FileSaveAs a$, 1 keep an original file and save an additional copy of the file under a different format such as one that indicates that the file can include an embedded macro. Therefore, these types of instructions are also macro enablement instructions. Various alternative instructions which enable macro virus execution in files will be recognized.</p>
    <p>A macro virus reproduction instruction is a type that allows replication of the macro virus. For example, the MacroCopy instruction copies a macro, and, if the macro is infected, all of its harmful instructions, from a source to a destination. Other instructions, such as Organizer .copy, also facilitate macro virus reproduction. It is understood that various alternative instructions can facilitate macro virus reproduction.</p>
    <p>As indicated regarding the preferred method 500 of locating and decoding macros, the macro instructions from the targeted file are located and decoded into binary code for analysis. A unique binary code also corresponds to suspect instructions. For example, the macro virus enablement instruction if dlg.format=0 then dlg.format=1 has a particular corresponding binary code as does the macro virus reproduction instruction MacroCopy. Thus, the comparison data which is obtained 615 from the virus information module 308 may respectively include the binary code for the first and second instructions, or unique portions of the binary codes, to identify the first and second instructions in the macro from a targeted file.</p>
    <p>Furthermore, in accordance with the present invention, it has been determined that unique binary code portions may correspond to several suspect instructions. For example, the binary string 73 CB 00 0C 6C 01 00 (in hexadecimal form) corresponds to the instruction portion .format=1 which is found in several macro virus enablement instructions. For example, the instruction if dlg.format=0 then dlg.format=1 noted above, as well as the instructions if bewaardlg.format=0 then bewarrdlg.format=1; FileSaveAs .Format=1; and FileSaveAs .Name=Filename$(), .Format=1 include the binary string 73 CB 00 0C 6C 01 00. Thus, a particular string such as 73 CB 00 0C 6C 01 00 is used by the present invention as an identifier for detecting a plurality of different suspect macro instructions.</p>
    <p>The comparison data in the virus information module 308 preferably includes several sets of instruction identifiers. Various combinations of suspect instructions may be detected using the sets of instruction identifiers. Various different macro virus enablement and/or macro virus reproduction instructions may be identified using each set of instruction identifiers. The instruction identifiers are not restricted to macro virus enablement and reproduction instructions. For example, an instruction which causes the computer hard disk to be reformatted without verification and an instruction which changes the system settings to allow such reformatting without user notice could be used as a suspect instruction combination.</p>
    <p>Referring now to FIG. 9, a data table including exemplary sets of instruction identifiers which are stored in the virus information module 308 is shown. The exemplary data table 900 includes rows 902 which correspond to several different sets of instruction identifiers. Columns identifying the sets of instruction identifiers 903, their instruction identifier numbers 904 and text and corresponding hexadecimal representations 905 of the binary code for the instruction identifiers are included. Preferably, two instruction identifiers are included in each set of instruction identifiers, but additional instruction identifiers can be included in a set. Additionally, a positive macro virus determination can be made based upon detection of two out of three instruction identifiers or some other subset of identifiers. The data table 900 is exemplary only. The comparison data may be variously stored in the virus information module 308.</p>
    <p>Referring again to the flow chart of FIG. 6, once a set of instruction identifiers is obtained by the macro virus scanning module 304 in step 615, the decoded macro is scanned to determine whether it includes a combination of suspect instructions as identified by the instruction identifiers. In step 620, the decoded macro is scanned using a first instruction identifier. For example, the decoded macro may be scanned 620 to determine whether a string 73 CB 00 0C 6C 01 00 which corresponds to the first instruction identifier in the first set of exemplary instruction identifiers 900 is present. The scanning in step 620 may be undertaken by a state machine which scans the decoded macro and determines whether the string is present. In step 625, it is determined whether the first suspect instruction identifier is present in the decoded macro. If it is determined 625 that the no instruction corresponding to the first instruction identifier is present, then in step 645 it is determined that the macro is not infected according to the set of instruction identifiers and the method of macro virus scanning 600 ends.</p>
    <p>Therefore a first set of suspect instruction identifiers as shown in FIG. 9 includes the strings 73 CB 00 0C 6C 01 100 and 67 C2 80. A second set of suspect instruction identifiers includes the strings 73 CB 00 0C 6C 01 00 and 64 6F 02 67 DE 00 73 87 02 12 73 7F. A third set of suspect instruction identifiers includes the strings 73 CB 00 0C 6C 01 00 and 6D 61 63 72 6F 73 76 08. A fourth set of suspect instruction identifiers includes the strings 12 6C 01 00 and 64 67 C2 80 6A 0F 47 and a fifth set of suspect instruction identifiers includes the strings 79 7C 66 6F 72 6D 61 74 20 63 6A and 80 05 6A 07 43 4F 4D.</p>
    <p>If it is determined in step 625 that the first instruction identifier is present, then the decoded macro is scanned in step 630 to determine whether the second instruction identifier is present. If in step 635 it is determined that the macro includes the second suspect instruction identifier, then in step 640 the decoded macro is flagged as infected by an unknown virus corresponding to the set of instruction identifiers. Information associating the decoded macro to the set of instruction identifiers that resulted in a positive unknown virus detection is stored in the data buffer 312 so that other modules such as the macro treating module 306 can treat the infected macro accordingly.</p>
    <p>If it is determined in step 635 that the second identifier is not present, the macro virus scanning module 304 determines in step 645 that, according to the set of instruction identifiers, an unknown virus is not present in the decoded macro and the preferred method 600 of macro virus scanning ends. The determination in step 635 is provided with regard to a single set of instruction identifiers. Other sets of instruction identifiers can be iteratively compared to the decoded macro to otherwise provide a positive determination of an unknown virus. Additionally, the presence of a common first instruction identifier can be determined prior to searching for various alternative second instruction identifiers.</p>
    <p>Referring now to the flow chart of FIG. 7 a preferred method 700 for treating infected macros is shown. In step 705, the known virus determination flag is checked to determine whether the macro virus scanning module 304 detected a known virus in the decoded macro. The known virus determination flag is provided to the macro treating module 306 in the data buffer 312, which also associates the decoded macro to the virus information used to detect the known virus. The virus information is used, in step 715, to remove the known virus from the decoded macro. Preferably, the virus is removed from the macro by replacing it with benign instructions (such as no-ops). Since the virus is known, it can be selectively removed such that the legitimate portions of the macro remain. After removal of the virus, in step 735 the treated macro is checked to verify its integrity. If it is determined that the integrity of the treated macro was maintained, then in step 745 the treated macro is flagged as valid by the macro treating module 306. The treated macro is or remains stored in the data buffer 312 as does the information regarding its validity. If it is determined in step 740 that integrity was not maintained, then the treated macro is flagged as invalid in step 750 and the information is similarly stored in the data buffer.</p>
    <p>Referring back to step 710, if it is determined by the macro treating module 306 that a known virus is not present in the decoded macro, then the macro is treated to selectively remove an unknown virus. The set of instruction identifiers that was used to detect an unknown virus in the decoded macro is available to the macro treating module 306 in the data buffer 312. An exemplary set includes first and second suspect instruction identifiers. In step 720, the first suspect instruction identifier is used to locate each suspect instruction which corresponds to the identifier. The decoded macros can be scanned to locate such instructions using the techniques described in connection with detecting the instructions used by the macro virus scanning module 304. If the instruction identifiers correspond to fragments of instructions rather than whole instructions, then the macro treating module 306 correlates each detected fragment to a whole instruction. The correlation will depend upon the programming language used by the macro. Conventional techniques can be used for the correlation. In step 725, the additional suspect instruction identifiers are used to locate corresponding additional suspect instructions. The located suspect instructions are then replaced in step 730. Similar to the replacement of known virus strings, preferably the suspect instructions are replaced with benign instructions. The integrity of the macro is verified and the treated macro is flagged according to whether its integrity was maintained, after which the method 700 of treating macros ends.</p>
    <p>Referring now to the flow chart of FIG. 8, a preferred method 800 of file correcting in accordance with the present invention is shown. The file correcting module 310 is in communication with the data buffer 312 as well as the various modules 302, 304, 306, 308, 310 and thereby accesses information such as the macro viruses which were detected and the targeted files that the infected macros were found in. In step 805, a targeted file which includes a macro virus is stored in the data buffer 312. Preferably, the targeted file is accessed in its original location and is copied with its infected macro into the data buffer 312. The file correcting module 310 then takes corrective action by replacing the macro in the targeted file with a treated macro or by taking alternative corrective action. In step 810, the macro validity flag is checked to determine the integrity of the treated macro which corresponds to the targeted file. If the treated macro is indicated to be valid, then the file correcting module 310 replaces the infected macro in the targeted file with a treated macro. In step 810 the infected macro is located within the targeted file. This is done by using the information sharing resources (OLE) of the operating system 202. In step 820, the located macro is removed from the targeted file using the information sharing resources and a version of the targeted file without the macro is stored in the data buffer 312. In step 825, the treated macro which was produced by the macro treating module 306 is added to the version of the targeted file without the macro to provide a corrected file. In step 830, the corrected file is used to replace the targeted file in its original location. The corrected file can directly replace the originally targeted file. Alternatively, the targeted file can be deleted or overwritten and the corrected file stored elsewhere.</p>
    <p>Referring back to step 810, if the treated macro which corresponds to the targeted file is flagged as invalid, the treated macro is preferably not used to replace the infected macro. Thus, in step 835, alternative corrective action is taken by the file correcting module dependent upon how it is configured by the user. Various alternative corrective steps will be recognized such as notifying the user that the targeted file includes a virus, removing the infected macro from the targeted file without replacement, or deleting the targeted file.</p>
    <p>Although the present invention has been described with reference to certain preferred embodiments, those skilled in the art will recognize that various modifications may be provided. For example, although a sequence of accessing, locating, decoding, detecting and correcting has been described with respect to various modules, it is understood that the various processes may be integrated into common modules which perform equivalent functions in detecting an unknown virus in a macro. These and other variations upon and modifications to the described embodiments are provided for by the present invention which is limited only by the following claims.</p>
    </div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4975950">US4975950</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Nov 3, 1988</td><td class="patent-data-table-td patent-date-value">Dec 4, 1990</td><td class="patent-data-table-td ">Lentz Stephen A</td><td class="patent-data-table-td ">System and method of protecting integrity of computer data and software</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5278901">US5278901</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 30, 1992</td><td class="patent-data-table-td patent-date-value">Jan 11, 1994</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Pattern-oriented intrusion-detection system and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5319776">US5319776</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 29, 1992</td><td class="patent-data-table-td patent-date-value">Jun 7, 1994</td><td class="patent-data-table-td ">Hilgraeve Corporation</td><td class="patent-data-table-td ">In transit detection of computer virus with safeguard</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5321840">US5321840</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Aug 12, 1993</td><td class="patent-data-table-td patent-date-value">Jun 14, 1994</td><td class="patent-data-table-td ">Transaction Technology, Inc.</td><td class="patent-data-table-td ">Distributed-intelligence computer system including remotely reconfigurable, telephone-type user terminal</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5408642">US5408642</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 24, 1991</td><td class="patent-data-table-td patent-date-value">Apr 18, 1995</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Method for recovery of a computer program infected by a computer virus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5414833">US5414833</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 27, 1993</td><td class="patent-data-table-td patent-date-value">May 9, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Network security system and method using a parallel finite state machine adaptive active monitor and responder</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5440723">US5440723</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 19, 1993</td><td class="patent-data-table-td patent-date-value">Aug 8, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Automatic immune system for computers and computer networks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5444850">US5444850</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Aug 4, 1993</td><td class="patent-data-table-td patent-date-value">Aug 22, 1995</td><td class="patent-data-table-td ">Trend Micro Devices Incorporated</td><td class="patent-data-table-td ">Method and apparatus for controlling network and workstation access prior to workstation boot</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5448668">US5448668</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jul 8, 1993</td><td class="patent-data-table-td patent-date-value">Sep 5, 1995</td><td class="patent-data-table-td ">Perelson; Alan S.</td><td class="patent-data-table-td ">Method of detecting changes to a collection of digital signals</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5452442">US5452442</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 14, 1995</td><td class="patent-data-table-td patent-date-value">Sep 19, 1995</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Methods and apparatus for evaluating and extracting signatures of computer viruses and other undesirable software entities</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5485575">US5485575</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Nov 21, 1994</td><td class="patent-data-table-td patent-date-value">Jan 16, 1996</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Automatic analysis of a computer virus structure and means of attachment to its hosts</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5491791">US5491791</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 13, 1995</td><td class="patent-data-table-td patent-date-value">Feb 13, 1996</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">System and method for remote workstation monitoring within a distributed computing environment</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5511163">US5511163</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 19, 1994</td><td class="patent-data-table-td patent-date-value">Apr 23, 1996</td><td class="patent-data-table-td ">Multi-Inform A/S</td><td class="patent-data-table-td ">Network adaptor connected to a computer for virus signature recognition in all files on a network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5530757">US5530757</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 28, 1994</td><td class="patent-data-table-td patent-date-value">Jun 25, 1996</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Distributed fingerprints for information integrity verification</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5550976">US5550976</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 8, 1992</td><td class="patent-data-table-td patent-date-value">Aug 27, 1996</td><td class="patent-data-table-td ">Sun Hydraulics Corporation</td><td class="patent-data-table-td ">Decentralized distributed asynchronous object oriented system and method for electronic data management, storage, and communication</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5550984">US5550984</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 7, 1994</td><td class="patent-data-table-td patent-date-value">Aug 27, 1996</td><td class="patent-data-table-td ">Matsushita Electric Corporation Of America</td><td class="patent-data-table-td ">Security system for preventing unauthorized communications between networks by translating communications received in ip protocol to non-ip protocol to remove address and routing services information</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5649095">US5649095</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 4, 1993</td><td class="patent-data-table-td patent-date-value">Jul 15, 1997</td><td class="patent-data-table-td ">Cozza; Paul D.</td><td class="patent-data-table-td ">Method and apparatus for detecting computer viruses through the use of a scan information cache</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0666671A1?cl=en">EP0666671A1</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 25, 1995</td><td class="patent-data-table-td patent-date-value">Aug 9, 1995</td><td class="patent-data-table-td ">Dassault Automatismes Et Telecommunications</td><td class="patent-data-table-td ">Communication in digital network with anti-virus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="http://www.google.com/url?id=NthLBAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3DH06350784A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHCjBCh2I0eCZqbqY_IqiG7gWhshg">JPH06350784A</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">Title not available</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1993022723A1?cl=en">WO1993022723A1</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 28, 1993</td><td class="patent-data-table-td patent-date-value">Nov 11, 1993</td><td class="patent-data-table-td ">Multi Inform As</td><td class="patent-data-table-td ">Network adaptor connected to a computer for virus signature recognition in all files on a network</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">Non-Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">Reference</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Malarky, Anti Virus comaprative Review, Virus Bulletin, pp. 10 11, May 1996.</td></tr><tr><td class="patent-data-table-td ">2</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Malarky, Anti Virus comaprative Review, Virus Bulletin, pp. 10-11, May 1996.</td></tr><tr><td class="patent-data-table-td ">3</td><td class="patent-data-table-td "></td><td class="patent-data-table-td ">Meyer, "<a href='http://scholar.google.com/scholar?q="Possible+Macro+Virus+Attacks+and+How+to+Prevent+Them"'>Possible Macro Virus Attacks and How to Prevent Them</a>", Computers &amp; Security, vol. 15, No. 7, pp. 595-625, 1996.</td></tr><tr><td class="patent-data-table-td ">4</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td ">Meyer, Possible Macro Virus Attacks and How to Prevent Them , Computers &amp; Security, vol. 15, No. 7, pp. 595 625, 1996.</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Referenced by</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Citing Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6108799">US6108799</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 12, 1998</td><td class="patent-data-table-td patent-date-value">Aug 22, 2000</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Automated sample creation of polymorphic and non-polymorphic marcro viruses</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6338141">US6338141</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 30, 1998</td><td class="patent-data-table-td patent-date-value">Jan 8, 2002</td><td class="patent-data-table-td ">Cybersoft, Inc.</td><td class="patent-data-table-td ">Method and apparatus for computer virus detection, analysis, and removal in real time</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6480962">US6480962</a></td><td class="patent-data-table-td patent-date-value">Apr 18, 2000</td><td class="patent-data-table-td patent-date-value">Nov 12, 2002</td><td class="patent-data-table-td ">Finjan Software, Ltd.</td><td class="patent-data-table-td ">System and method for protecting a client during runtime from hostile downloadables</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6577920">US6577920</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 2, 1998</td><td class="patent-data-table-td patent-date-value">Jun 10, 2003</td><td class="patent-data-table-td ">Data Fellows Oyj</td><td class="patent-data-table-td ">Computer virus screening</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6640317">US6640317</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 20, 2000</td><td class="patent-data-table-td patent-date-value">Oct 28, 2003</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Mechanism for automated generic application damage detection and repair in strongly encapsulated application</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6671812">US6671812</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 4, 2002</td><td class="patent-data-table-td patent-date-value">Dec 30, 2003</td><td class="patent-data-table-td ">Networks Associates Technology, Inc.</td><td class="patent-data-table-td ">Computer cleaning system, method and computer program product</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6697950">US6697950</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 22, 1999</td><td class="patent-data-table-td patent-date-value">Feb 24, 2004</td><td class="patent-data-table-td ">Networks Associates Technology, Inc.</td><td class="patent-data-table-td ">Method and apparatus for detecting a macro computer virus using static analysis</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6728886">US6728886</a></td><td class="patent-data-table-td patent-date-value">Dec 1, 1999</td><td class="patent-data-table-td patent-date-value">Apr 27, 2004</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Distributed virus scanning arrangements and methods therefor</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6738972">US6738972</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 30, 1999</td><td class="patent-data-table-td patent-date-value">May 18, 2004</td><td class="patent-data-table-td ">Opentv, Inc.</td><td class="patent-data-table-td ">Method for flow scheduling</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6804780">US6804780</a></td><td class="patent-data-table-td patent-date-value">Mar 30, 2000</td><td class="patent-data-table-td patent-date-value">Oct 12, 2004</td><td class="patent-data-table-td ">Finjan Software, Ltd.</td><td class="patent-data-table-td ">System and method for protecting a computer and a network from hostile downloadables</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6836792">US6836792</a></td><td class="patent-data-table-td patent-date-value">Dec 3, 1999</td><td class="patent-data-table-td patent-date-value">Dec 28, 2004</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Techniques for providing add-on services for an email system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6842861">US6842861</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 24, 2000</td><td class="patent-data-table-td patent-date-value">Jan 11, 2005</td><td class="patent-data-table-td ">Networks Associates Technology, Inc.</td><td class="patent-data-table-td ">Method and system for detecting viruses on handheld computers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6957423">US6957423</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">May 15, 2001</td><td class="patent-data-table-td patent-date-value">Oct 18, 2005</td><td class="patent-data-table-td ">Xilinx, Inc.</td><td class="patent-data-table-td ">Method of inlining a VHDL function call into Verilog</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6965928">US6965928</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 9, 2001</td><td class="patent-data-table-td patent-date-value">Nov 15, 2005</td><td class="patent-data-table-td ">Networks Associates Technology, Inc.</td><td class="patent-data-table-td ">System and method for remote maintenance of handheld computers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6965968">US6965968</a></td><td class="patent-data-table-td patent-date-value">Feb 27, 2003</td><td class="patent-data-table-td patent-date-value">Nov 15, 2005</td><td class="patent-data-table-td ">Finjan Software Ltd.</td><td class="patent-data-table-td ">Policy-based caching</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7010696">US7010696</a></td><td class="patent-data-table-td patent-date-value">Jul 26, 2001</td><td class="patent-data-table-td patent-date-value">Mar 7, 2006</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">Method and apparatus for predicting the incidence of a virus</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7058822">US7058822</a></td><td class="patent-data-table-td patent-date-value">May 17, 2001</td><td class="patent-data-table-td patent-date-value">Jun 6, 2006</td><td class="patent-data-table-td ">Finjan Software, Ltd.</td><td class="patent-data-table-td ">Malicious mobile code runtime monitoring system and methods</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7089591">US7089591</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jul 30, 1999</td><td class="patent-data-table-td patent-date-value">Aug 8, 2006</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Generic detection and elimination of marco viruses</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7155461">US7155461</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 21, 2003</td><td class="patent-data-table-td patent-date-value">Dec 26, 2006</td><td class="patent-data-table-td ">Hitachi, Ltd.</td><td class="patent-data-table-td ">Information processing system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7155742">US7155742</a></td><td class="patent-data-table-td patent-date-value">May 16, 2002</td><td class="patent-data-table-td patent-date-value">Dec 26, 2006</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Countering infections to communications modules</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7159149">US7159149</a></td><td class="patent-data-table-td patent-date-value">Oct 24, 2002</td><td class="patent-data-table-td patent-date-value">Jan 2, 2007</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Heuristic detection and termination of fast spreading network worm attacks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7203959">US7203959</a></td><td class="patent-data-table-td patent-date-value">Mar 14, 2003</td><td class="patent-data-table-td patent-date-value">Apr 10, 2007</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Stream scanning through network proxy servers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7210041">US7210041</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 30, 2001</td><td class="patent-data-table-td patent-date-value">Apr 24, 2007</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">System and method for identifying a macro virus family using a macro virus definitions database</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7249187">US7249187</a></td><td class="patent-data-table-td patent-date-value">Nov 27, 2002</td><td class="patent-data-table-td patent-date-value">Jul 24, 2007</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Enforcement of compliance with network security policies</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7296293">US7296293</a></td><td class="patent-data-table-td patent-date-value">Dec 31, 2002</td><td class="patent-data-table-td patent-date-value">Nov 13, 2007</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Using a benevolent worm to assess and correct computer security vulnerabilities</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7337327">US7337327</a></td><td class="patent-data-table-td patent-date-value">Mar 30, 2004</td><td class="patent-data-table-td patent-date-value">Feb 26, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Using mobility tokens to observe malicious mobile code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7363506">US7363506</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 30, 2002</td><td class="patent-data-table-td patent-date-value">Apr 22, 2008</td><td class="patent-data-table-td ">Cybersoft, Inc.</td><td class="patent-data-table-td ">Software virus detection methods, apparatus and articles of manufacture</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7367056">US7367056</a></td><td class="patent-data-table-td patent-date-value">Jun 4, 2002</td><td class="patent-data-table-td patent-date-value">Apr 29, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Countering malicious code infections to computer files that have been infected more than once</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7370233">US7370233</a></td><td class="patent-data-table-td patent-date-value">May 21, 2004</td><td class="patent-data-table-td patent-date-value">May 6, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Verification of desired end-state using a virtual machine environment</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7373667">US7373667</a></td><td class="patent-data-table-td patent-date-value">May 14, 2004</td><td class="patent-data-table-td patent-date-value">May 13, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Protecting a computer coupled to a network from malicious code infections</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7380277">US7380277</a></td><td class="patent-data-table-td patent-date-value">Sep 25, 2002</td><td class="patent-data-table-td patent-date-value">May 27, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Preventing e-mail propagation of malicious computer code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7398553">US7398553</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 29, 2001</td><td class="patent-data-table-td patent-date-value">Jul 8, 2008</td><td class="patent-data-table-td ">Tread Micro, Inc.</td><td class="patent-data-table-td ">Scripting virus scan engine</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7401122">US7401122</a></td><td class="patent-data-table-td patent-date-value">Nov 8, 2004</td><td class="patent-data-table-td patent-date-value">Jul 15, 2008</td><td class="patent-data-table-td ">Trend Micro, Inc.</td><td class="patent-data-table-td ">Techniques for providing add-on services for an email system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7418729">US7418729</a></td><td class="patent-data-table-td patent-date-value">Oct 4, 2002</td><td class="patent-data-table-td patent-date-value">Aug 26, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Heuristic detection of malicious computer code by page tracking</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7418731">US7418731</a></td><td class="patent-data-table-td patent-date-value">May 3, 2004</td><td class="patent-data-table-td patent-date-value">Aug 26, 2008</td><td class="patent-data-table-td ">Finjan Software, Ltd.</td><td class="patent-data-table-td ">Method and system for caching at secure gateways</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7418732">US7418732</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 26, 2002</td><td class="patent-data-table-td patent-date-value">Aug 26, 2008</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Network switches for detection and prevention of virus attacks</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7421587">US7421587</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jul 26, 2001</td><td class="patent-data-table-td patent-date-value">Sep 2, 2008</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">Detecting computer programs within packed computer files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7426574">US7426574</a></td><td class="patent-data-table-td patent-date-value">Dec 16, 2003</td><td class="patent-data-table-td patent-date-value">Sep 16, 2008</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Technique for intercepting data in a peer-to-peer network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7441042">US7441042</a></td><td class="patent-data-table-td patent-date-value">Aug 25, 2004</td><td class="patent-data-table-td patent-date-value">Oct 21, 2008</td><td class="patent-data-table-td ">Symanetc Corporation</td><td class="patent-data-table-td ">System and method for correlating network traffic and corresponding file input/output traffic</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7469419">US7469419</a></td><td class="patent-data-table-td patent-date-value">Oct 7, 2002</td><td class="patent-data-table-td patent-date-value">Dec 23, 2008</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Detection of malicious computer code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7478431">US7478431</a></td><td class="patent-data-table-td patent-date-value">Aug 2, 2002</td><td class="patent-data-table-td patent-date-value">Jan 13, 2009</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Heuristic detection of computer viruses</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7480683">US7480683</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 1, 2004</td><td class="patent-data-table-td patent-date-value">Jan 20, 2009</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">System and method for heuristic analysis to identify pestware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7480941">US7480941</a></td><td class="patent-data-table-td patent-date-value">Dec 21, 2005</td><td class="patent-data-table-td patent-date-value">Jan 20, 2009</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">System, method and computer program product for performing one or more maintenance tasks on a remotely located computer connected to a server computer via a data network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7483993">US7483993</a></td><td class="patent-data-table-td patent-date-value">Oct 4, 2002</td><td class="patent-data-table-td patent-date-value">Jan 27, 2009</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Temporal access control for computer virus prevention</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7484094">US7484094</a></td><td class="patent-data-table-td patent-date-value">May 14, 2004</td><td class="patent-data-table-td patent-date-value">Jan 27, 2009</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Opening computer files quickly and safely over a network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7533131">US7533131</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Oct 1, 2004</td><td class="patent-data-table-td patent-date-value">May 12, 2009</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">System and method for pestware detection and removal</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7533415">US7533415</a></td><td class="patent-data-table-td patent-date-value">Apr 21, 2004</td><td class="patent-data-table-td patent-date-value">May 12, 2009</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Method and apparatus for controlling traffic in a computer network</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7565686">US7565686</a></td><td class="patent-data-table-td patent-date-value">Nov 8, 2004</td><td class="patent-data-table-td patent-date-value">Jul 21, 2009</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Preventing unauthorized loading of late binding code into a process</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7590707">US7590707</a></td><td class="patent-data-table-td patent-date-value">Aug 7, 2006</td><td class="patent-data-table-td patent-date-value">Sep 15, 2009</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">Method and system for identifying network addresses associated with suspect network destinations</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7603712">US7603712</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 21, 2005</td><td class="patent-data-table-td patent-date-value">Oct 13, 2009</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Protecting a computer that provides a Web service from malware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7613926">US7613926</a></td><td class="patent-data-table-td patent-date-value">Mar 7, 2006</td><td class="patent-data-table-td patent-date-value">Nov 3, 2009</td><td class="patent-data-table-td ">Finjan Software, Ltd</td><td class="patent-data-table-td ">Method and system for protecting a computer and a network from hostile downloadables</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7631353">US7631353</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 17, 2002</td><td class="patent-data-table-td patent-date-value">Dec 8, 2009</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Blocking replication of e-mail worms</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7636856">US7636856</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 6, 2004</td><td class="patent-data-table-td patent-date-value">Dec 22, 2009</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Proactive computer malware protection through dynamic translation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7647633">US7647633</a></td><td class="patent-data-table-td patent-date-value">Jun 22, 2005</td><td class="patent-data-table-td patent-date-value">Jan 12, 2010</td><td class="patent-data-table-td ">Finjan Software, Ltd.</td><td class="patent-data-table-td ">Malicious mobile code runtime monitoring system and methods</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7669059">US7669059</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 23, 2004</td><td class="patent-data-table-td patent-date-value">Feb 23, 2010</td><td class="patent-data-table-td ">Network Equipment Technologies, Inc.</td><td class="patent-data-table-td ">Method and apparatus for detection of hostile software</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7673150">US7673150</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 14, 2007</td><td class="patent-data-table-td patent-date-value">Mar 2, 2010</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">Virus detection system, method and computer program product for handheld computers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7690034">US7690034</a></td><td class="patent-data-table-td patent-date-value">Sep 10, 2004</td><td class="patent-data-table-td patent-date-value">Mar 30, 2010</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Using behavior blocking mobility tokens to facilitate distributed worm detection</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7769992">US7769992</a></td><td class="patent-data-table-td patent-date-value">Aug 18, 2006</td><td class="patent-data-table-td patent-date-value">Aug 3, 2010</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">File manipulation during early boot time</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7802303">US7802303</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 30, 2006</td><td class="patent-data-table-td patent-date-value">Sep 21, 2010</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Real-time in-line detection of malicious code in data streams</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7818739">US7818739</a></td><td class="patent-data-table-td patent-date-value">Jun 22, 2004</td><td class="patent-data-table-td patent-date-value">Oct 19, 2010</td><td class="patent-data-table-td ">Mcafee, Inc.</td><td class="patent-data-table-td ">Virus detection system, method and computer program product for handheld computers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7865947">US7865947</a></td><td class="patent-data-table-td patent-date-value">Apr 12, 2010</td><td class="patent-data-table-td patent-date-value">Jan 4, 2011</td><td class="patent-data-table-td ">Whitecell Software, Inc.</td><td class="patent-data-table-td ">Computer system lock-down</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7917585">US7917585</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jun 21, 2001</td><td class="patent-data-table-td patent-date-value">Mar 29, 2011</td><td class="patent-data-table-td ">Cybersoft, Inc.</td><td class="patent-data-table-td ">Apparatus, methods and articles of manufacture for intercepting, examining and controlling code, data and files and their transfer</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7975305">US7975305</a></td><td class="patent-data-table-td patent-date-value">Dec 9, 2004</td><td class="patent-data-table-td patent-date-value">Jul 5, 2011</td><td class="patent-data-table-td ">Finjan, Inc.</td><td class="patent-data-table-td ">Method and system for adaptive rule-based content scanners for desktop computers</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7996903">US7996903</a></td><td class="patent-data-table-td patent-date-value">Jul 7, 2006</td><td class="patent-data-table-td patent-date-value">Aug 9, 2011</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">Method and system for detecting and removing hidden pestware files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8060747">US8060747</a></td><td class="patent-data-table-td patent-date-value">Mar 20, 2006</td><td class="patent-data-table-td patent-date-value">Nov 15, 2011</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Digital signatures for embedded code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8065664">US8065664</a></td><td class="patent-data-table-td patent-date-value">Aug 7, 2006</td><td class="patent-data-table-td patent-date-value">Nov 22, 2011</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">System and method for defining and detecting pestware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8069487">US8069487</a></td><td class="patent-data-table-td patent-date-value">Oct 15, 2010</td><td class="patent-data-table-td patent-date-value">Nov 29, 2011</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Cloud-based application whitelisting</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8079032">US8079032</a></td><td class="patent-data-table-td patent-date-value">Mar 22, 2006</td><td class="patent-data-table-td patent-date-value">Dec 13, 2011</td><td class="patent-data-table-td ">Webroot Software, Inc.</td><td class="patent-data-table-td ">Method and system for rendering harmless a locked pestware executable object</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8079086">US8079086</a></td><td class="patent-data-table-td patent-date-value">May 26, 2009</td><td class="patent-data-table-td patent-date-value">Dec 13, 2011</td><td class="patent-data-table-td ">Finjan, Inc.</td><td class="patent-data-table-td ">Malicious mobile code runtime monitoring system and methods</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8104086">US8104086</a></td><td class="patent-data-table-td patent-date-value">Mar 3, 2005</td><td class="patent-data-table-td patent-date-value">Jan 24, 2012</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Heuristically detecting spyware/adware registry activity</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8151109">US8151109</a></td><td class="patent-data-table-td patent-date-value">Mar 11, 2011</td><td class="patent-data-table-td patent-date-value">Apr 3, 2012</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Selective authorization of the loading of dependent code modules by running processes</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8161292">US8161292</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Apr 22, 2008</td><td class="patent-data-table-td patent-date-value">Apr 17, 2012</td><td class="patent-data-table-td ">Cybersoft, Inc.</td><td class="patent-data-table-td ">Software virus detection methods, apparatus and articles of manufacture</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8171550">US8171550</a></td><td class="patent-data-table-td patent-date-value">Aug 7, 2006</td><td class="patent-data-table-td patent-date-value">May 1, 2012</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">System and method for defining and detecting pestware with function parameters</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8181244">US8181244</a></td><td class="patent-data-table-td patent-date-value">Apr 20, 2006</td><td class="patent-data-table-td patent-date-value">May 15, 2012</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">Backward researching time stamped events to find an origin of pestware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8190902">US8190902</a></td><td class="patent-data-table-td patent-date-value">Feb 27, 2006</td><td class="patent-data-table-td patent-date-value">May 29, 2012</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Techniques for digital signature formation and verification</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8201243">US8201243</a></td><td class="patent-data-table-td patent-date-value">Apr 20, 2006</td><td class="patent-data-table-td patent-date-value">Jun 12, 2012</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">Backwards researching activity indicative of pestware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8205087">US8205087</a></td><td class="patent-data-table-td patent-date-value">Feb 27, 2006</td><td class="patent-data-table-td patent-date-value">Jun 19, 2012</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Tool for digitally signing multiple documents</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8225408">US8225408</a></td><td class="patent-data-table-td patent-date-value">Aug 30, 2004</td><td class="patent-data-table-td patent-date-value">Jul 17, 2012</td><td class="patent-data-table-td ">Finjan, Inc.</td><td class="patent-data-table-td ">Method and system for adaptive rule-based content scanners</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8239944">US8239944</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 28, 2008</td><td class="patent-data-table-td patent-date-value">Aug 7, 2012</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Reducing malware signature set size through server-side processing</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8271774">US8271774</a></td><td class="patent-data-table-td patent-date-value">Aug 11, 2003</td><td class="patent-data-table-td patent-date-value">Sep 18, 2012</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Circumstantial blocking of incoming network traffic containing code</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8312537">US8312537</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 28, 2008</td><td class="patent-data-table-td patent-date-value">Nov 13, 2012</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Reputation based identification of false positive malware detections</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8359645">US8359645</a></td><td class="patent-data-table-td patent-date-value">Mar 25, 2005</td><td class="patent-data-table-td patent-date-value">Jan 22, 2013</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Dynamic protection of unpatched machines</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8381296">US8381296</a></td><td class="patent-data-table-td patent-date-value">Jul 18, 2011</td><td class="patent-data-table-td patent-date-value">Feb 19, 2013</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">Method and system for detecting and removing hidden pestware files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8387147">US8387147</a></td><td class="patent-data-table-td patent-date-value">Jul 18, 2011</td><td class="patent-data-table-td patent-date-value">Feb 26, 2013</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">Method and system for detecting and removing hidden pestware files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8452744">US8452744</a></td><td class="patent-data-table-td patent-date-value">Jun 6, 2005</td><td class="patent-data-table-td patent-date-value">May 28, 2013</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">System and method for analyzing locked files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8490183">US8490183</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Feb 4, 2005</td><td class="patent-data-table-td patent-date-value">Jul 16, 2013</td><td class="patent-data-table-td ">Trend Micro Incorporated</td><td class="patent-data-table-td ">Security ensuring by program analysis on information device and transmission path</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8516583">US8516583</a></td><td class="patent-data-table-td patent-date-value">Mar 31, 2005</td><td class="patent-data-table-td patent-date-value">Aug 20, 2013</td><td class="patent-data-table-td ">Microsoft Corporation</td><td class="patent-data-table-td ">Aggregating the knowledge base of computer systems to proactively protect a computer from malware</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8533824">US8533824</a></td><td class="patent-data-table-td patent-date-value">Nov 8, 2007</td><td class="patent-data-table-td patent-date-value">Sep 10, 2013</td><td class="patent-data-table-td ">Glasswall (Ip) Limited</td><td class="patent-data-table-td ">Resisting the spread of unwanted code and data</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8578495">US8578495</a></td><td class="patent-data-table-td patent-date-value">Jul 26, 2006</td><td class="patent-data-table-td patent-date-value">Nov 5, 2013</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">System and method for analyzing packed files</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8635438">US8635438</a></td><td class="patent-data-table-td patent-date-value">Mar 6, 2012</td><td class="patent-data-table-td patent-date-value">Jan 21, 2014</td><td class="patent-data-table-td ">Webroot Inc.</td><td class="patent-data-table-td ">Method and system of file manipulation during early boot time by accessing user-level data associated with a kernel-level function</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8646083">US8646083</a></td><td class="patent-data-table-td patent-date-value">Aug 6, 2012</td><td class="patent-data-table-td patent-date-value">Feb 4, 2014</td><td class="patent-data-table-td ">Fortinet, Inc.</td><td class="patent-data-table-td ">Virus co-processor instructions and methods for using such</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8677494">US8677494</a></td><td class="patent-data-table-td patent-date-value">Nov 7, 2011</td><td class="patent-data-table-td patent-date-value">Mar 18, 2014</td><td class="patent-data-table-td ">Finjan, Inc.</td><td class="patent-data-table-td ">Malicious mobile code runtime monitoring system and methods</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8763076">US8763076</a></td><td class="patent-data-table-td patent-date-value">Jun 4, 2012</td><td class="patent-data-table-td patent-date-value">Jun 24, 2014</td><td class="patent-data-table-td ">Symantec Corporation</td><td class="patent-data-table-td ">Endpoint management using trust rating data</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20120072988">US20120072988</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Mar 25, 2011</td><td class="patent-data-table-td patent-date-value">Mar 22, 2012</td><td class="patent-data-table-td ">Telcordia Technologies, Inc.</td><td class="patent-data-table-td ">Detection of global metamorphic malware variants using control and data flow analysis</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101438529B?cl=en">CN101438529B</a></td><td class="patent-data-table-td patent-date-value">Dec 5, 2005</td><td class="patent-data-table-td patent-date-value">Dec 28, 2011</td><td class="patent-data-table-td "></td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP1727067A2?cl=en">EP1727067A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jul 6, 2005</td><td class="patent-data-table-td patent-date-value">Nov 29, 2006</td><td class="patent-data-table-td ">DrayTek Corp.</td><td class="patent-data-table-td ">Method for detecting viruses in macros of a data stream</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2000022710A2?cl=en">WO2000022710A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 28, 1999</td><td class="patent-data-table-td patent-date-value">Apr 20, 2000</td><td class="patent-data-table-td ">Cybersoft Inc</td><td class="patent-data-table-td ">Method and apparatus for computer virus detection, analysis, and removal in real time</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2003032134A1?cl=en">WO2003032134A1</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Sep 20, 2002</td><td class="patent-data-table-td patent-date-value">Apr 17, 2003</td><td class="patent-data-table-td ">France Telecom</td><td class="patent-data-table-td ">Generic method of detecting attack programs hidden in data chains</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2005076135A1?cl=en">WO2005076135A1</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Jan 9, 2004</td><td class="patent-data-table-td patent-date-value">Aug 18, 2005</td><td class="patent-data-table-td ">Internet Crimes Group Inc</td><td class="patent-data-table-td ">Information security threat identification, analysis, and management</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2006062849A2?cl=en">WO2006062849A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 5, 2005</td><td class="patent-data-table-td patent-date-value">Jun 15, 2006</td><td class="patent-data-table-td ">Microsoft Corp</td><td class="patent-data-table-td ">Proactive computer malware protection through dynamic translation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2006104508A2?cl=en">WO2006104508A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Aug 1, 2005</td><td class="patent-data-table-td patent-date-value">Oct 5, 2006</td><td class="patent-data-table-td ">Microsoft Corp</td><td class="patent-data-table-td ">Dynamic protection of unpatched machines</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2008068450A2?cl=en">WO2008068450A2</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Nov 8, 2007</td><td class="patent-data-table-td patent-date-value">Aug 7, 2008</td><td class="patent-data-table-td ">Glasswall Ip Ltd</td><td class="patent-data-table-td ">Improvements in resisting the spread of unwanted code and data</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc714/defs714.htm&usg=AFQjCNF69HBVWbRkdZeFUtAyhUaqKU35WQ#C714S038100">714/38.1</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0021220000">G06F21/22</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0001000000">G06F1/00</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=G06F0021000000">G06F21/00</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=NthLBAABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F21/563">G06F21/563</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">G06F21/56B2</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">Mar 14, 2011</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">12</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Nov 9, 2010</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">THE PATENTABILITY OF CLAIMS 9-25 IS CONFIRMED. CLAIMS 1, 4, AND 5 ARE DETERMINED TO BE PATENTABLE AS AMENDED. CLAIMS 2, 3, AND 6-8, DEPENDENT ON AN AMENDED CLAIM, ARE DETERMINED TO BE PATENTABLE. NEW CLAIMS 26-35 ARE ADDED AND DETERMINED TO BE PATENTABLE.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Apr 13, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100129</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Mar 30, 2010</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20100111</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jul 7, 2009</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20090527</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jun 5, 2009</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">TREND MICRO INCORPORATED, JAPAN</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CORRECTIVE ASSIGNMENT TO CORRECT THE ADDRESS PREVIOUSLY RECORDED ON  REEL 009849 FRAME 0559;ASSIGNORS:CHEN, EVA Y.;RO, JONNY T.;CHI, IETA M.;AND OTHERS;REEL/FRAME:022783/0287;SIGNING DATES FROM 19990311 TO 19990315</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Mar 14, 2007</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">8</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jul 28, 2003</td><td class="patent-data-table-td ">FPAY</td><td class="patent-data-table-td ">Fee payment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Year of fee payment: </span><span class="nested-value">4</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jul 28, 2003</td><td class="patent-data-table-td ">SULP</td><td class="patent-data-table-td ">Surcharge for late payment</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">Apr 2, 2003</td><td class="patent-data-table-td ">REMI</td><td class="patent-data-table-td ">Maintenance fee reminder mailed</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">Mar 25, 1999</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">TREND MICRO, INCORPORATED, CALIFORNIA</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:CHEN, EVA Y.;RO, JONNY T.;CHI, IETA, M.;AND OTHERS;REEL/FRAME:009849/0559;SIGNING DATES FROM 19990311 TO 19990315</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_8a2b04e7bf975d5171d8e4c0b6365c7a.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U0wjLIMjsFAfUK080FstwYf-q8I3g\u0026id=NthLBAABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U0Sqj0Lw1WK-hG4A1c8M5K3rs7ZuQ\u0026id=NthLBAABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U0Qe7p7cuOFPt9sJDyay-_PKVS4nQ","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/System_apparatus_and_method_for_the_dete.pdf?id=NthLBAABERAJ\u0026output=pdf\u0026sig=ACfU3U2WEnAJivP4UL_NJaWAm7GEVWscOA"},"sample_url":"http://www.google.com/patents/reader?id=NthLBAABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>