<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html><head><title>Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system - Google Patents</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_4ff636b3d23669b7103f3b3a3a18b4cd/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_4ff636b3d23669b7103f3b3a3a18b4cd__en.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "en",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Method and apparatus for demodulating signals in a pulse oximetry system"><meta name="DC.contributor" content="Mohamed K. Diab" scheme="inventor"><meta name="DC.contributor" content="Walter M. Weber" scheme="inventor"><meta name="DC.contributor" content="Ammar Al-Ali" scheme="inventor"><meta name="DC.contributor" content="Masimo Corporation" scheme="assignee"><meta name="DC.date" content="2007-5-18" scheme="dateSubmitted"><meta name="DC.description" content="A method and an apparatus measure blood oxygenation in a subject. A light source is activated to cause a first emission at a first wavelength and a second emission at a second wavelength. A detector detects a composite signal indicative of an attenuation of the first and second wavelengths by tissue of a patient. The composite signal is demodulated into a first intensity signal and a second intensity signal. Blood oxygenation in the subject is determined from the first and second intensity signals. In one embodiment, demodulation is based at least in part on a period when at least one of the wavelengths is not activated. In one embodiment, a modulation of the first and second wavelengths is determined in order to avoid frequencies of ambient noise. In one embodiment, the composite signal&#39;s sampling rate is reduced before and/or after demodulation."><meta name="DC.date" content="2012-4-3" scheme="issued"><meta name="DC.relation" content="DE:3328862:A1" scheme="references"><meta name="DC.relation" content="EP:0335357:A2" scheme="references"><meta name="DC.relation" content="EP:0761159:A2" scheme="references"><meta name="DC.relation" content="JP:2002051129" scheme="references"><meta name="DC.relation" content="US:3638640" scheme="references"><meta name="DC.relation" content="US:3704706" scheme="references"><meta name="DC.relation" content="US:4407290" scheme="references"><meta name="DC.relation" content="US:4773422" scheme="references"><meta name="DC.relation" content="US:4781195" scheme="references"><meta name="DC.relation" content="US:4785463" scheme="references"><meta name="DC.relation" content="US:4824242" scheme="references"><meta name="DC.relation" content="US:4848901" scheme="references"><meta name="DC.relation" content="US:4863265" scheme="references"><meta name="DC.relation" content="US:4867571" scheme="references"><meta name="DC.relation" content="US:4948248" scheme="references"><meta name="DC.relation" content="US:5193543" scheme="references"><meta name="DC.relation" content="US:5276705" scheme="references"><meta name="DC.relation" content="US:5349952" scheme="references"><meta name="DC.relation" content="US:5521938" scheme="references"><meta name="DC.relation" content="US:5555882" scheme="references"><meta name="DC.relation" content="US:5579341" scheme="references"><meta name="DC.relation" content="US:5640416" scheme="references"><meta name="DC.relation" content="US:5800348" scheme="references"><meta name="DC.relation" content="US:5919134" scheme="references"><meta name="DC.relation" content="US:5921921" scheme="references"><meta name="DC.relation" content="US:5940346" scheme="references"><meta name="DC.relation" content="US:6229856" scheme="references"><meta name="DC.relation" content="US:6643530" scheme="references"><meta name="DC.relation" content="US:RE35122" scheme="references"><meta name="DC.relation" content="WO:1994009698:A1" scheme="references"><meta name="DC.relation" content="WO:1998046125:A1" scheme="references"><meta name="DC.relation" content="WO:1999052420:A1" scheme="references"><meta name="citation_patent_number" content="US:8150487"><meta name="citation_patent_application_number" content="US:11/750,930"><link rel="canonical" href="http://www.google.com/patents/US8150487"/><meta property="og:url" content="http://www.google.com/patents/US8150487"/><meta name="title" content="Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system"/><meta name="description" content="A method and an apparatus measure blood oxygenation in a subject. A light source is activated to cause a first emission at a first wavelength and a second emission at a second wavelength. A detector detects a composite signal indicative of an attenuation of the first and second wavelengths by tissue of a patient. The composite signal is demodulated into a first intensity signal and a second intensity signal. Blood oxygenation in the subject is determined from the first and second intensity signals. In one embodiment, demodulation is based at least in part on a period when at least one of the wavelengths is not activated. In one embodiment, a modulation of the first and second wavelengths is determined in order to avoid frequencies of ambient noise. In one embodiment, the composite signal&#39;s sampling rate is reduced before and/or after demodulation."/><meta property="og:title" content="Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>(function(){try{var aa=function(a,b,c,d){d=d||{};d._sn=["cfg",b,c].join(".");window.gbar.logger.ml(a,d)};var g=window.gbar=window.gbar||{},l=window.gbar.i=window.gbar.i||{},m={},n;function _tvn(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}function _tvf(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function _tvv(a){return!!a}function p(a,b,c){(c||g)[a]=b}g.bv={n:_tvn("2",0),r:"",f:".67.",e:"0",m:_tvn("0",1)};
function q(a,b,c){var d="on"+b;if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent(d,c);else{var f=a[d];a[d]=function(){var a=f.apply(this,arguments),b=c.apply(this,arguments);return void 0==a?b:void 0==b?a:b&&a}}}var s=function(a){return function(){return g.bv.m==a}},ba=s(1),ca=s(2);p("sb",ba);p("kn",ca);l.a=_tvv;l.b=_tvf;l.c=_tvn;l.i=aa;var da=window.gbar.i.i;var t,u,v,w;function ea(a){v=a}function fa(a){var b;if(b=v&&window.encodeURIComponent)b=a.href,b=!b.match(/^http[s]?:\/\/accounts\.google\.[^/]*\/ClearSID/i)&&!b.match(/^http[s]?:\/\/[^/]*\/accounts\/ClearSID/i);if(b=b&&encodeURIComponent(v()))a.href=a.href.replace(/([?&]continue=)[^&]*/,"$1"+b)}function ga(a){window.gApplication&&(a.href=window.gApplication.getTabUrl(a.href))}
function ha(a){var b=document.forms[0].q,c=window.encodeURIComponent&&b&&b.value,b=b&&b.placeholder;c&&c!=b&&(a.href=a.href.replace(/([?&])q=[^&]*|$/,function(a,b){return(b||"&")+"q="+encodeURIComponent(c)}))}n=l.a("")?ga:ha;
function x(a,b,c,d,f,e){var h=document.getElementById(a);if(h){var k=h.style;k.left=d?"auto":b+"px";k.right=d?b+"px":"auto";k.top=c+"px";k.visibility=u?"hidden":"visible";f&&e?(k.width=f+"px",k.height=e+"px"):(x(t,b,c,d,h.offsetWidth,h.offsetHeight),u=u?"":a)}}
var y=[],ia=function(a,b){y.push(b)},ja=function(a){a=a||window.event;var b=a.target||a.srcElement;a.cancelBubble=!0;null==t&&(a=document.createElement(Array.every||window.createPopup?"iframe":"div"),a.frameBorder="0",t=a.id="gbs",a.src="javascript:''",b.parentNode.appendChild(a),q(document,"click",z));var c=b,b=0;"gb3"!=c.className&&(c=c.parentNode);a=c.getAttribute("aria-owns")||"gbi";var d=c.offsetWidth,f=20<c.offsetTop?46:24;document.getElementById("tphdr")&&(f-=3);var e=!1;do b+=c.offsetLeft||
0;while(c=c.offsetParent);var c=(document.documentElement.clientWidth||document.body.clientWidth)-b-d,h,d=document.body,k=document.defaultView;k&&k.getComputedStyle?(d=k.getComputedStyle(d,""))&&(h=d.direction):h=d.currentStyle?d.currentStyle.direction:d.style.direction;h="rtl"==h;if("gbi"==a){for(d=0;k=y[d++];)k();A(null,window.navExtra);h&&(b=c,e=!0)}else h||(b=c,e=!0);u!=a&&z();x(a,b,f,e)},z=function(){u&&x(u,0,0)},A=function(a,b){var c,d=document.getElementById("gbi"),f=a;f||(f=d.firstChild);
for(;b&&(c=b.pop());){var e=d,h=c,k=f;w||(w="gb2");e.insertBefore(h,k).className=w}},ka=function(a,b,c){if((b=document.getElementById(b))&&a){a.className="gb4";var d=document.createElement("span");d.appendChild(a);d.appendChild(document.createTextNode(" | "));d.id=c;b.appendChild(d)}},la=function(){return document.getElementById("gb_70")},ma=function(){return!!u};p("qs",n);p("setContinueCb",ea);p("pc",fa);p("tg",ja);p("close",z);p("addLink",ka);p("almm",A);p("si",la);p("adh",ia);p("op",ma);var B=function(){},C=function(){},F=function(a){var b=new Image,c=D;b.onerror=b.onload=b.onabort=function(){try{delete E[c]}catch(a){}};E[c]=b;b.src=a;D=c+1},E=[],D=0;p("logger",{il:C,ml:B,log:F});var G=window.gbar.logger;var H={},na={},I=[],oa=l.b("0.1",.1),pa=l.a("1",!0),qa=function(a,b){I.push([a,b])},ra=function(a,b){H[a]=b},sa=function(a){return a in H},J={},K=function(a,b){J[a]||(J[a]=[]);J[a].push(b)},ta=function(a){K("m",a)},L=function(a,b){var c=document.createElement("script");c.src=a;c.async=pa;Math.random()<oa&&(c.onerror=function(){c.onerror=null;B(Error("Bundle load failed: name="+(b||"UNK")+" url="+a))});(document.getElementById("xjsc")||document.getElementsByTagName("body")[0]||
document.getElementsByTagName("head")[0]).appendChild(c)},N=function(a){for(var b=0,c;(c=I[b])&&c[0]!=a;++b);!c||c[1].l||c[1].s||(c[1].s=!0,M(2,a),c[1].url&&L(c[1].url,a),c[1].libs&&m.d&&m.d(c[1].libs))},O=function(a){K("gc",a)},P=null,ua=function(a){P=a},M=function(a,b,c){if(P){a={t:a,b:b};if(c)for(var d in c)a[d]=c[d];try{P(a)}catch(f){}}};p("mdc",H);p("mdi",na);p("bnc",I);p("qGC",O);p("qm",ta);p("qd",J);p("lb",N);p("mcf",ra);p("bcf",qa);p("aq",K);p("mdd","");p("has",sa);
p("trh",ua);p("tev",M);var Q=l.b("0.1",.001),R=0;
function _mlToken(a,b){try{if(1>R){R++;var c,d=a,f=b||{},e=encodeURIComponent,h=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&jexpid=",e("17483"),"&srcpg=",e("prop=22"),"&jsr=",Math.round(1/Q),"&ogev=",e("N1npU5W6FOS5sQTVsYK4Aw"),"&ogf=",g.bv.f,"&ogrp=",e("1"),"&ogv=",e("1407464522.0"),"&oggv="+e("es_plusone_gc_20140723.0_p0"),"&ogd=",e("com"),"&ogc=",e("EGY"),"&ogl=",e("en")];f._sn&&(f._sn="og."+
f._sn);for(var k in f)h.push("&"),h.push(e(k)),h.push("="),h.push(e(f[k]));h.push("&emsg=");h.push(e(d.name+":"+d.message));var r=h.join("");S(r)&&(r=r.substr(0,2E3));c=r;var Aa=window.gbar.logger._aem(a,c);F(Aa)}}catch(Na){}}var S=function(a){return 2E3<=a.length},va=function(a,b){return b};function T(a){B=a;p("_itl",S,G);p("_aem",va,G);p("ml",B,G);a={};H.er=a}l.a("")?T(function(a){throw a;}):l.a("1")&&Math.random()<Q&&T(_mlToken);I.push(["m",{url:"//ssl.gstatic.com/gb/js/scm_7385cc5883250b43a39405734c1bea59.js"}]);g.mcf("c",{});g.sg={c:""};if(l.a("1")){var wa=l.a("");I.push(["gc",{auto:wa,url:"//ssl.gstatic.com/gb/js/abc/gci_91f30755d6a6b787dcc2a4062e6e9824.js",libs:"googleapis.client:plusone:gapi.iframes"}]);var xa={version:"gci_91f30755d6a6b787dcc2a4062e6e9824.js",index:"",lang:"en"};H.gc=xa;var U=function(a){window.googleapis&&window.iframes?a&&a():(a&&O(a),N("gc"))};p("lGC",U);l.a("1")&&p("lPWF",U)};window.__PVT="";if(l.a("1")&&l.a("1")){var V=function(a){U(function(){K("pw",a);N("pw")})};p("lPW",V);I.push(["pw",{url:"//ssl.gstatic.com/gb/js/abc/pwm_45f73e4df07a0e388b0fa1f3d30e7280.js"}]);var W=[],ya=function(a){W[0]=a},za=function(a,b){var c=b||{};c._sn="pw";B(a,c)},Ba={signed:W,elog:za,base:"https://plusone.google.com/u/0",loadTime:(new Date).getTime()};H.pw=Ba;var X=function(a,b){for(var c=b.split("."),d=function(){var b=arguments;a(function(){for(var a=g,d=0,e=c.length-1;d<e;++d)a=a[c[d]];a[c[d]].apply(a,b)})},f=g,e=0,h=c.length-1;e<h;++e)f=
f[c[e]]=f[c[e]]||{};return f[c[e]]=d};X(V,"pw.clk");X(V,"pw.hvr");p("su",ya,g.pw)};function Ca(){function a(){for(var b;(b=e[h++])&&"m"!=b[0]&&!b[1].auto;);b&&(M(2,b[0]),b[1].url&&L(b[1].url,b[0]),b[1].libs&&m.d&&m.d(b[1].libs));h<e.length&&setTimeout(a,0)}function b(){0<f--?setTimeout(b,0):a()}var c=l.a("1"),d=l.a(""),f=3,e=I,h=0,k=window.gbarOnReady;if(k)try{k()}catch(r){da(r,"ml","or")}d?p("ldb",a):c?q(window,"load",b):b()}p("rdl",Ca);var Da={D:1,H:2,da:3,p:4,W:5,M:6,F:7,g:8,ha:9,U:10,L:11,T:12,S:13,N:14,Q:15,P:16,fa:17,w:18,O:19,ga:20,ea:21,u:22,G:23,ja:24,ka:25,ia:26,A:27,j:28,o:29,k:30,ca:31,Z:32,$:33,J:34,K:35,ba:36,aa:37,Y:38,B:39,R:40,v:41,X:42,V:43,h:48,C:49,I:500},Y=[1,2,3,4,5,6,9,10,11,13,14,28,29,30,34,35,37,38,39,40,41,42,43,48,49,500];var Z=l.b("0.001",1E-4),Ea=l.b("1",1),Fa=!1,Ga=!1;if(l.a("1")){var Ha=Math.random();Ha<=Z&&(Fa=!0);Ha<=Ea&&(Ga=!0)}var Ia=Da,$=null;function Ja(){var a=0,b=function(b,d){l.a(d)&&(a|=b)};b(1,"");b(2,"");b(4,"");b(8,"");return a}
function Ka(a,b){var c=Z,d=Fa,f;f=a;if(!$){$={};for(var e=0;e<Y.length;e++){var h=Y[e];$[h]=!0}}if(f=!!$[f])c=Ea,d=Ga;if(d){d=encodeURIComponent;g.rp?(f=g.rp(),f="-1"!=f?f:"1"):f="1";c=["//www.google.com/gen_204?atyp=i&zx=",(new Date).getTime(),"&oge=",a,"&ogex=",d("17483"),"&ogev=",d("N1npU5W6FOS5sQTVsYK4Aw"),"&ogf=",g.bv.f,"&ogp=",d("22"),"&ogrp=",d(f),"&ogsr=",Math.round(1/c),"&ogv=",d("1407464522.0"),"&oggv="+
d("es_plusone_gc_20140723.0_p0"),"&ogd=",d("com"),"&ogl=",d("en"),"&ogc=",d("EGY"),"&ogus=",Ja()];if(b){"ogw"in b&&(c.push("&ogw="+b.ogw),delete b.ogw);var k;f=b;e=[];for(k in f)0!=e.length&&e.push(","),e.push(La(k)),e.push("."),e.push(La(f[k]));k=e.join("");""!=k&&(c.push("&ogad="),c.push(d(k)))}F(c.join(""))}}function La(a){"number"==typeof a&&(a+="");return"string"==typeof a?a.replace(".","%2E").replace(",","%2C"):a}C=Ka;p("il",C,G);var Ma={};H.il=Ma;setTimeout(function(){C(Ia.g)},0);}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var b=window.gbar.i.i;var c=window.gbar;var f=function(d){try{var a=document.getElementById("gbom");a&&d.appendChild(a.cloneNode(!0))}catch(e){b(e,"omas","aomc")}};c.aomc=f;}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{var a=window.gbar;a.mcf("pm",{p:""});}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
(function(){try{window.gbar.rdl();}catch(e){window.gbar&&gbar.logger&&gbar.logger.ml(e,{"_sn":"cfg.init"});}})();
if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{float:left;height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}#gbs,.gbm{background:#fff;left:0;position:absolute;text-align:left;visibility:hidden;z-index:1000}.gbm{border:1px solid;border-color:#c9d7f1 #36c #36c #a2bae7;z-index:1001}.gb1{margin-right:.5em}.gb1,.gb3{zoom:1}.gb2{display:block;padding:.2em .5em}.gb2,.gb3{text-decoration:none !important;border-bottom:none}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb2,a.gb3,a.gb4{color:#00c !important}.gbi .gb3,.gbi .gb2,.gbi .gb4{color:#dd8e27 !important}.gbf .gb3,.gbf .gb2,.gbf .gb4{color:#900 !important}a.gb2:hover{background:#36c;color:#fff !important}#gbar .gbz0l{color:#000 !important;cursor:default;font-weight:bold;text-decoration:none !important}
#gbar { padding:.3em .6em !important;}</style></head><body  topmargin="3" marginheight="3"><div id=gbar><nobr><a onclick=gbar.qs(this);gbar.logger.il(1,{t:1}); class=gb1 id=gb_1 href="https://www.google.com/search?sa=N&tab=tw">Search</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:2}); class=gb1 id=gb_2 href="http://www.google.com/search?hl=en&tbm=isch&source=og&sa=N&tab=ti">Images</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:8}); class=gb1 id=gb_8 href="http://maps.google.com/maps?hl=en&sa=N&tab=tl">Maps</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:78}); class=gb1 id=gb_78 href="https://play.google.com/?hl=en&sa=N&tab=t8">Play</a> <a onclick=gbar.qs(this);gbar.logger.il(1,{t:36}); class=gb1 id=gb_36 href="http://www.youtube.com/results?sa=N&tab=t1">YouTube</a> <a onclick=gbar.logger.il(1,{t:5}); class=gb1 id=gb_5 href="http://news.google.com/nwshp?hl=en&tab=tn">News</a> <a onclick=gbar.logger.il(1,{t:23}); class=gb1 id=gb_23 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a onclick=gbar.logger.il(1,{t:25}); class=gb1 id=gb_25 href="https://drive.google.com/?tab=to">Drive</a> <a class=gb3 href="http://www.google.com/intl/en/options/" onclick="this.blur();gbar.tg(event);return !1" aria-haspopup=true><u>More</u> <small>&#9660;</small></a><div class=gbm id=gbi><a onclick=gbar.logger.il(1,{t:24}); class=gb2 id=gb_24 href="https://www.google.com/calendar?tab=tc">Calendar</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:51}); class=gb2 id=gb_51 href="http://translate.google.com/?hl=en&sa=N&tab=tT">Translate</a><a onclick=gbar.logger.il(1,{t:17}); class=gb2 id=gb_17 href="http://www.google.com/mobile/?hl=en&tab=tD">Mobile</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:10}); class=gb2 id=gb_10 href="http://www.google.com/search?hl=en&tbo=u&tbm=bks&source=og&sa=N&tab=tp">Books</a><a onclick=gbar.logger.il(1,{t:212}); class=gb2 id=gb_212 href="https://wallet.google.com/manage/?tab=ta">Wallet</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:6}); class=gb2 id=gb_6 href="http://www.google.com/search?hl=en&tbo=u&tbm=shop&source=og&sa=N&tab=tf">Shopping</a><a onclick=gbar.logger.il(1,{t:30}); class=gb2 id=gb_30 href="http://www.blogger.com/?tab=tj">Blogger</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:27}); class=gb2 id=gb_27 href="http://www.google.com/finance?sa=N&tab=te">Finance</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:31}); class=gb2 id=gb_31 href="https://plus.google.com/photos?sa=N&tab=tq">Photos</a><a onclick=gbar.qs(this);gbar.logger.il(1,{t:12}); class=gb2 id=gb_12 href="http://www.google.com/search?hl=en&tbo=u&tbm=vid&source=og&sa=N&tab=tv">Videos</a><div class=gb2><div class=gbd></div></div><a onclick=gbar.logger.il(1,{t:66}); href="http://www.google.com/intl/en/options/" class=gb2>Even more &raquo;</a></div></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=http://www.google.com/patents%3Fhl%3Den&hl=en" class=gb4>Sign in</a><div style="display: none"><div class=gbm id=gbd5 aria-owner=gbg5><div class=gbmc><ol id=gbom class=gbmcc></ol></div></div></div></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="http://www.google.com/patents/us8150487?hl=en&amp;output=html_text" title="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."><img border="0" src="http://www.google.com/images/cleardot.gif"alt="Screen reader users: click this link for accessible mode. Accessible mode has the same essential features but works better with your reader."></a></div><div id="guser"><nobr></nobr></div><div style="clear:both;"></div><div id="gb-top-search-box" class="gb-top-search-box-small gb-reset"><table><tr><td class="logo"><a href="http://www.google.com/patents" class="logo-link"><img class="logo-img" src="/intl/en/images/logos/google_logo_41.png" alt="Go to Google Books Home" height="41"/></a></td><td><form action="http://www.google.com/search" name="f" id="vheadf" method="get"><span id="hf"></span><input type="hidden" name="tbm" value="pts"/><input type="hidden" name="tbo" value="1"/><input type="hidden" name="hl" value="en"/><table><tr><td><div class="inputs"><table><tr><td><div class="text-input"><input type="text" name="q" id="vheadq" class="text" maxlength="2048" size="31" value="" title="Search Patents" accesskey="s" autocomplete="off"/><script>window._OC_autoDir &&window._OC_autoDir('vheadq', 'tia-vheadq');</script></div></td><td><div class="submit-input"><input name="btnG" class="submit" type="submit" value=""/></div></td></tr></table></div></td><td class="col-ext-links"><div class="ext-links"><a href="http://www.google.com/advanced_patent_search">&lt;nobr&gt;Advanced Patent Search&lt;/nobr&gt;</a></div></td></tr></table></form></td></tr></table></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents">Patents</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/US8150487"></a><a id="appbar-patents-discuss-this-link" href="http://www.google.com/url?id=ev81BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpatent%3DUS8150487&amp;usg=AFQjCNFmLDmSutbk9B6ucs8ODP3oH4jMYA" data-is-grant="true"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/US8150487.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/US8150487.pdf"></a><a class="appbar-application-grant-link" data-label="Application" href="/patents/US20070225582"></a><a class="appbar-application-grant-link" data-selected="true" data-label="Grant" href="/patents/US8150487"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="http://www.google.com/patents/US8150487" style="display:none"><span itemprop="description">A method and an apparatus measure blood oxygenation in a subject. A light source is activated to cause a first emission at a first wavelength and a second emission at a second wavelength. A detector detects a composite signal indicative of an attenuation of the first and second wavelengths by tissue...</span><span itemprop="url">http://www.google.com/patents/US8150487?utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system</span><img itemprop="image" src="http://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system" title="Patent US8150487 - Method and apparatus for demodulating signals in a pulse oximetry system"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="http://www.google.com/advanced_patent_search">Advanced Patent Search</a></li></ol></div><table id="viewport_table" cellpadding="0" style="clear:both" cellspacing="0"><tr><td id="viewport_td"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata"><tr><td class="patent-bibdata-heading">Publication number</td><td class="single-patent-bibdata">US8150487 B2</td></tr><tr><td class="patent-bibdata-heading">Publication type</td><td class="single-patent-bibdata">Grant</td></tr><tr><td class="patent-bibdata-heading">Application number</td><td class="single-patent-bibdata">US 11/750,930</td></tr><tr><td class="patent-bibdata-heading">Publication date</td><td class="single-patent-bibdata">Apr 3, 2012</td></tr><tr><td class="patent-bibdata-heading">Filing date</td><td class="single-patent-bibdata">May 18, 2007</td></tr><tr><td class="patent-bibdata-heading">Priority date<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="The priority date is an assumption and is not a legal conclusion. Google has not performed a legal analysis and makes no representation as to the accuracy of the date listed."></span></td><td class="single-patent-bibdata">Apr 14, 1997</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Also published as</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/DE69932330D1">DE69932330D1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1067861A1">EP1067861A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1067861B1">EP1067861B1</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1709902A2">EP1709902A2</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP1709902A3">EP1709902A3</a>, </span><span class="patent-bibdata-value"><a href="/patents/US6229856">US6229856</a>, </span><span class="patent-bibdata-value"><a href="/patents/US6643530">US6643530</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7003339">US7003339</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7221971">US7221971</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8185180">US8185180</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8718737">US8718737</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20010002206">US20010002206</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20040152965">US20040152965</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20060161056">US20060161056</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20070225582">US20070225582</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20080033265">US20080033265</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20120253155">US20120253155</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO1999052420A1">WO1999052420A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading">Publication number</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">11750930, </span><span class="patent-bibdata-value">750930, </span><span class="patent-bibdata-value">US 8150487 B2, </span><span class="patent-bibdata-value">US 8150487B2, </span><span class="patent-bibdata-value">US-B2-8150487, </span><span class="patent-bibdata-value">US8150487 B2, </span><span class="patent-bibdata-value">US8150487B2</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Inventors</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Mohamed+K.+Diab%22">Mohamed K. Diab</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Walter+M.+Weber%22">Walter M. Weber</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=ininventor:%22Ammar+Al-Ali%22">Ammar Al-Ali</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Original Assignee</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="http://www.google.com/search?tbo=p&tbm=pts&hl=en&q=inassignee:%22Masimo+Corporation%22">Masimo Corporation</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">Export Citation</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/US8150487.bibtex">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8150487.enw">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8150487.ris">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">Patent Citations</a> (32),</span> <span class="patent-bibdata-value"><a href="#classifications">Classifications</a> (11),</span> <span class="patent-bibdata-value"><a href="#legal-events">Legal Events</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">External Links:&nbsp;</span><span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/8150487&usg=AFQjCNFRNh499or9B32OmqI37BD4J5CH5Q">USPTO</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D8150487&usg=AFQjCNGuumofL2FdeSTN56JKcBVmAEKdrw">USPTO Assignment</a>, </span><span class="patent-bibdata-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DUS%26NR%3D8150487B2%26KC%3DB2%26FT%3DD&usg=AFQjCNGBGILMkg4YCVze1euUEmYMG6Tmig">Espacenet</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT110786081" lang="EN" load-source="patent-office">Method and apparatus for demodulating signals in a pulse oximetry system</invention-title></span><br><span class="patent-number">US 8150487 B2</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title">Abstract</span></div><div class="patent-text"><abstract mxw-id="PA93758938" lang="EN" load-source="patent-office"> <div num="p-0001" class="abstract">A method and an apparatus measure blood oxygenation in a subject. A light source is activated to cause a first emission at a first wavelength and a second emission at a second wavelength. A detector detects a composite signal indicative of an attenuation of the first and second wavelengths by tissue of a patient. The composite signal is demodulated into a first intensity signal and a second intensity signal. Blood oxygenation in the subject is determined from the first and second intensity signals. In one embodiment, demodulation is based at least in part on a period when at least one of the wavelengths is not activated. In one embodiment, a modulation of the first and second wavelengths is determined in order to avoid frequencies of ambient noise. In one embodiment, the composite signal's sampling rate is reduced before and/or after demodulation.</div>
  </abstract></div></div><div class="patent-section patent-drawings-section"><div class="patent-section-header"><span class="patent-section-title">Images<span class="patent-section-count">(19)</span></span></div><div class="patent-drawings-body"><div class="patent-drawings-carousel"><div class="drawings"><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00000.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00000.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00001.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00001.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00002.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00002.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00003.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00003.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00004.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00004.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00005.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00005.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00006.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00006.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00007.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00007.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00008.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00008.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00009.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00009.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00010.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00010.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00011.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00011.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00012.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00012.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00013.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00013.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00014.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00014.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00015.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00015.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00016.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00016.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00017.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00017.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div><div class="patent-image"><div class="patent-thumbnail"><a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-D00018.png"><img class="patent-thumbnail-image" alt="Patent Drawing"src="//patentimages.storage.googleapis.com/thumbnails/US8150487B2/US08150487-20120403-D00018.png" /></a></div><div class="patent-thumbnail-caption">&nbsp;</div></div></div></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img" alt="Previous page"src="/googlebooks/images/kennedy/page_left.png"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img" alt="Next page"src="/googlebooks/images/kennedy/page_right.png"width="21" height="21" /></div></div></div><div class="patent-post-drawings"></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">Claims<span class="patent-section-count">(20)</span></span></div><div class="patent-text"><div mxw-id="PCLM57503506" lang="EN" load-source="patent-office" class="claims">
    <claim-statement>What is claimed is:</claim-statement> <div class="claim"> <div id="CLM-00001" num="00001" class="claim">
      <div class="claim-text">1. A method of demodulating a detected light signal representative of light attenuated by tissue of a patient, the method comprising:
<div class="claim-text">receiving a composite signal representative of an attenuation of a first and second emissions by body tissue;</div>
<div class="claim-text">adaptively demodulating said composite signal into at least a first intensity signal representative of said attenuation of said first emission by body tissue and a second intensity signal representative of said attenuation of said second emission by body tissue;</div>
<div class="claim-text">and</div>
<div class="claim-text">determining a physiological measurement based on the first and second intensity signals.</div>
</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00002" num="00002" class="claim">
      <div class="claim-text">2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising reducing a sampling rate of said first and second intensity signals.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00003" num="00003" class="claim">
      <div class="claim-text">3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising reducing a sample rate of said composite signal before demodulating said composite signal.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00004" num="00004" class="claim">
      <div class="claim-text">4. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein reducing a sample rate comprises decimating.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00005" num="00005" class="claim">
      <div class="claim-text">5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein adaptively demodulating comprises adjusting demodulation parameters during operation.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00006" num="00006" class="claim">
      <div class="claim-text">6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the demodulation parameters comprise a decimation rate.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00007" num="00007" class="claim">
      <div class="claim-text">7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein adaptively demodulating comprises using feedback.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00008" num="00008" class="claim">
      <div class="claim-text">8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein adaptively demodulating using feedback comprises using feedback from previously demodulated signals.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00009" num="00009" class="claim">
      <div class="claim-text">9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising low pass filtering and sample rate compressing the composite signal.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00010" num="00010" class="claim">
      <div class="claim-text">10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising low pass filtering and sample rate compressing the first and second intensity signals.</div>
    </div>
    </div> <div class="claim"> <div id="CLM-00011" num="00011" class="claim">
      <div class="claim-text">11. A system for demodulating a detected light signal representative of light attenuated by tissue of a patient, the system comprising:
<div class="claim-text">an input for receiving a composite signal representative of an attenuation of a first and second emissions by body tissue;</div>
<div class="claim-text">a demodulation module configured to adaptively demodulate said composite signal into at least a first intensity signal representative of said attenuation of said first emission by body tissue and a second intensity signal representative of said attenuation of said second emission by body tissue;</div>
<div class="claim-text">and</div>
<div class="claim-text">a processor configured to determine and output a physiological measurement based on the first and second intensity signals.</div>
</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00012" num="00012" class="claim">
      <div class="claim-text">12. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising a first reducing module configured to reduce a sample rate of said composite signal.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00013" num="00013" class="claim">
      <div class="claim-text">13. The system of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein said first reducing module is configured to decimate said composite output signal.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00014" num="00014" class="claim">
      <div class="claim-text">14. The system of <claim-ref idref="CLM-00012">claim 12</claim-ref> further comprising a second reducing module configured to reduce a sample rate of said first and second intensity signals.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00015" num="00015" class="claim">
      <div class="claim-text">15. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein said second reducing module is configured to decimate said first and second intensity signals.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00016" num="00016" class="claim">
      <div class="claim-text">16. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the demodulation module adaptively demodulates by adjusting demodulation parameters during operation.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00017" num="00017" class="claim">
      <div class="claim-text">17. The system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the demodulation parameters comprise a decimation rate.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00018" num="00018" class="claim">
      <div class="claim-text">18. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the demodulation module adaptively demodulates by using feedback.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00019" num="00019" class="claim">
      <div class="claim-text">19. The system of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the demodulation module adaptively demodulates by using feedback from previously demodulated signals.</div>
    </div>
    </div> <div class="claim-dependent"> <div id="CLM-00020" num="00020" class="claim">
      <div class="claim-text">20. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising a low pass filter module and a sample rate compression module.</div>
    </div>
  </div> </div></div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title">Description</span></div><div class="patent-text"><div mxw-id="PDES45475003" lang="EN" load-source="patent-office" class="description">
    <heading>REFERENCE TO PRIOR RELATED APPLICATION</heading> <p num="p-0002">This application is a continuation of U.S. application Ser. No. 11/311,213, filed Dec. 19, 2005, entitled “Method And Apparatus For Demodulating Signals In A Pulse Oximetry System,” which is a continuation of U.S. application Ser. No. 10/700,324 (now U.S. Pat. No. 7,003,339), filed Nov. 3, 2003, entitled “Method And Apparatus For Demodulating Signals In A Pulse Oximetry System,” which is a divisional of U.S. application Ser. No. 09/735,960 (now U.S. Pat. No. 6,643,530) filed Dec. 13, 2000, entitled “Method And Apparatus For Demodulating Signals In A Pulse Oximetry System,” which is a divisional of U.S. application Ser. No. 09/058,799 (now U.S. Pat. No. 6,229,056) filed Apr. 10, 1998, entitled “Method And Apparatus For Demodulating Signals In A Pulse Oximetry System,” which is a continuation-in-part of U.S. application Ser. No. 09/005,898 (now U.S. Pat. No. 5,919,134) filed Jan. 12, 1998, entitled “Method And Apparatus For Demodulating Signals In A Pulse Oximetry System,” which claims priority from U.S. Provisional Application No. 60/043,620, filed Apr. 14, 1997.</p>
    <heading>BACKGROUND OF THE INVENTION</heading> <p num="p-0003">1. Field of the Invention</p>
    <p num="p-0004">The present invention relates to the field of signal processing, and, more particularly, relates to the field of processing of signals generated in a physiological monitoring system, such as, for example, in a system for measuring blood oxygen saturation using pulse oximetry.</p>
    <p num="p-0005">2. Description of the Related Art</p>
    <p num="p-0006">The present invention will be described herein in connection with a pulse oximetry apparatus and a method, which are used to measure blood oxygen saturation in a subject, such as, for example, a human patient. The teachings of the present invention can be used in other applications wherein useable signal information is obtained in a noisy environment.</p>
    <p num="p-0007">In an exemplary pulse oximetry apparatus and a corresponding method, blood oxygen saturation is determined by transmitting pulses of electromagnetic energy through a portion of a subject which has blood flowing therein (e.g., through a finger, through an ear lobe, or other portion of the body where blood flows close to the skin). In the examples described herein, the pulses of electromagnetic energy comprise periodic pulses of red light having wavelengths of approximately 660 nanometers, for example, and periodic pulses of infrared light having wavelengths of approximately 905 nanometers. As described, for example, in U.S. Pat. No. 5,482,036 and in U.S. Pat. No. 5,490,505 the pulses of red light and the pulses of infrared light are applied with the same periodicity but in an alternating and non-overlapping manner. In particular, in preferred embodiments, the red pulses are active for approximately 25% of each cycle and the infrared pulses are also active for approximately 25% of each cycle. The red pulses are separated in time from the infrared pulses such that both pulses are inactive for approximately 25% of each cycle between a red pulse and the next infrared pulse and both pulses are inactive for approximately 25% of each cycle between an infrared pulse and the next red pulse. (Although described herein below in connection with pulses having 25% duty cycles, it should be understood by persons of skill in the art that the duty cycles of the pulses can be changed in some applications.) After propagating through the portion of the subject, the red pulses and the infrared pulses are detected by a detector which is responsive to light at both wavelengths and which generates an electrical signal which has a predictable relationship to the intensity of the electromagnetic energy incident on the detector. The electrical signal is processed in accordance with the present invention to provide a representation of the blood oxygen saturation of the subject. In conventional time division multiplexing (TDM) demodulation that uses rectangular waves to drive the red and infrared LEDs, the conventional process of demodulation using square waves can result in the aliasing of the ambient noise components that come close to the sidebands of harmonics and the fundamental frequency of the rectangular waves, and the noise components are thus collapsed into the output signal generated by the demodulation. In particular, it is very difficult to avoid including harmonics of the line frequency in the demodulated output signal.</p>
    <p num="p-0008">In conventional time division multiplexing (TDM) demodulation that uses rectangular waves to drive the red and infrared LEDs, the conventional process of demodulation using square waves can result in the aliasing of the ambient noise components that come close to the sidebands of harmonics and the fundamental frequency of the rectangular waves, and the noise components are thus collapsed into the output signal generated by the demodulation. In particular, it is very difficult to avoid including harmonics of the line frequency in the demodulated output signal.</p>
    <heading>SUMMARY OF THE INVENTION</heading> <p num="p-0009">The present invention avoids the problems associated with conventional demodulation and separation of TDM signals. In particular, the present invention avoids the problem of aliasing of the ambient noise into the passband of the system by selectively demodulating certain harmonics of the TDM signal. For example, in one embodiment, only two harmonics (e.g., the fundamental and the first harmonic) are demodulated. In resulting from demodulating with only certain harmonics instead of demodulating with all harmonics as is done using conventional square wave demodulation. In a digital implementation of the present, invention, the output of the photodetector is initially sampled at a very high frequency (e.g., 46,875 Hz), and the signals are decimated (where decimation is lowpass filtering followed by sample rate compression) such that the final output signals are generated at a relatively low sampling rate (e.g., 62.5 Hz) which provides increased resolution at the output. Thus, bandwidth is traded for resolution in the output signal, thus increasing the signal to noise ratio.</p>
    <p num="p-0010">One aspect of the present invention is an apparatus for measuring blood oxygenation in a subject. The apparatus comprises a first signal source which applies a first input signal during a first time interval. A second signal source applies a second input signal during a second time interval. A detector detects a first parametric signal responsive to the first input signal passing through a portion of the subject having blood therein. The detector also detects a second parametric signal responsive to the second input signal passing through the portion of the subject. The detector generates a detector output signal responsive to the first and second parametric signals. A signal processor receives the detector output signal. The signal processor demodulates the detector output signal by applying a first demodulation signal to a signal responsive to the detector output signal to generate a first output signal responsive to the first parametric signal and by applying a second demodulation signal to the signal responsive to the detector output signal to generate a second output signal responsive to the second parametric signal. Each of the first demodulation signal and the second demodulation signal comprises at least a first component having a first frequency and a first amplitude and a second component having a second frequency and a second amplitude. The second frequency is a harmonic of the first frequency. The second amplitude is selected to be related to the first amplitude to minimize crosstalk from the first parametric signal to the second output signal and to minimize crosstalk from the second parametric signal to the first output signal. In one embodiment, the second amplitude is determined by turning off one of the first and second signal sources and measuring the crosstalk between one of the parametric signals and the non-corresponding output signal while varying the second amplitude. A second amplitude is selected that minimizes the measured crosstalk.</p>
    <p num="p-0011">Another aspect of the present invention is a method of minimizing crosstalk between two signals generated by applying a first pulse and a second pulse to measure a parameter. The first pulse and the second pulse are applied periodically at a first repetition rate defining a period. The first pulse is generated during a first interval in each period, and the second pulse is generated during a second interval in each period. The second interval is spaced, apart from the first interval. The first and second pulses produce first and second parametric signals responsive to the parameter. The first and second parametric signals are received by a single detector that outputs a composite signal responsive to the first and second parametric signals. The method comprises the step of applying a first demodulation signal to the composite signal to generate a first demodulated output signal wherein the first demodulation signal comprises at least a first component having a first frequency corresponding to the first repetition rate. The first component has a first amplitude. The first demodulation signal further comprises a second component having a second frequency that is a harmonic of the first frequency. The second component has a second amplitude which has a selected proportional relationship to the first amplitude. The method further includes the step of applying a second demodulation signal to the composite signal to generate a second demodulated output signal. The second demodulation signal comprises the first component at the first frequency and the first amplitude and further comprises the second component at the second frequency and the second amplitude. At least one of the fast and second components of the second demodulation signal has a selected phase difference with respect to the corresponding one of the first and second components of the first demodulation signal. The method further includes the steps of lowpass filtering the first demodulated output signal to generate a first recovered output signal responsive to the first parametric signal; and lowpass filtering the second demodulated output signal to generate a second recovered output signal responsive to the second parametric signal.</p>
    <p num="p-0012">Preferably, the selected phase difference is π. Also preferably, the first pulse and the second pulse are generally rectangular pulses having a respective duty cycle. The rectangular pulses comprise a plurality of sinusoidal components including a fundamental component corresponding to the first frequency and a first harmonic component corresponding to the second frequency. The fundamental component has a fundamental component amplitude and the first harmonic component has a first harmonic component amplitude. The first harmonic component amplitude is related to the fundamental harmonic component amplitude by a first proportionality value. The second amplitude of the second component of the first demodulation signal is related to the first amplitude of the first component of the first demodulation signal by a second proportionality value which is approximately the inverse of the first proportionality value.</p>
    <p num="p-0013">The method in accordance with this aspect of the invention preferably includes the further steps of sampling the composite signal when neither the first pulse nor the second pulse is active to obtain a sampled signal; and measuring the sampled signal to determine a noise level of the parametric signals.</p>
    <p num="p-0014">In a further embodiment according to this aspect of the present invention, the method further includes the steps of performing a transform on the composite signal to generate a spectra of the composite signal; sampling the spectra at a plurality of frequencies other than at predetermined ranges of frequencies around the first frequency and around harmonics of the first frequency; determining an average of the magnitudes of the sampled plurality of frequencies; and comparing the average to a selected threshold to determine whether the average magnitude exceeds the selected threshold.</p>
    <p num="p-0015">Another aspect of the present invention is a method of demodulating a composite signal generated by applying first and second periodic pulses of electromagnetic energy to a system having a parameter to be measured and by receiving signals responsive to the electromagnetic energy after having passed through the system and being affected by the parameter being measured. The signals are received as a composite signal having components responsive to the first and second pulses. The method comprises the step of applying a first demodulation signal to the composite signal to generate a first demodulated signal. The first demodulation signal comprises a first component having a first frequency corresponding to a repetition frequency of the first and second pulses and comprises a second component having a frequency that is a harmonic of the first frequency. The first component has a first amplitude and the second component has a second amplitude. The second amplitude has a predetermined relationship to the first amplitude. The predetermined relationship is selected to cause the first demodulated signal to have low frequency components responsive only to the first pulse. The method includes the further step of lowpass filtering the first demodulated signal to generate a first output signal. The first output signal varies in response to an effect of the parameter on the electromagnetic energy received from the first pulse.</p>
    <p num="p-0016">Preferably, the method in accordance with this aspect of the invention includes the further step of applying a second demodulation signal to the composite signal to generate a second demodulated signal. The second demodulation signal has first and second components corresponding to the first and second components of the first demodulation signal. At least one of the first and second components of the second demodulation signal has a selected phase relationship with the corresponding one of the first and second components of the first demodulation signal. The method includes the further step of lowpass filtering the second demodulated signal to generate a second output signal. The second output signal varies in response to an effect of the parameter on the electromagnetic energy received from the second pulse.</p>
    <p num="p-0017">Another aspect of the present invention is a pulse oximetry system that comprises a modulation signal generator. The modulation signal generator generates a first modulation signal that comprises a first pulse that repeats at a first repetition frequency. The first pulse has a duty cycle of less than 50%. The modulation signal generator generates a second modulation signal comprising a second pulse that also repeats at the first repetition frequency. The second pulse has a duty cycle of less than 50%. The second pulse occurs at non-overlapping times with respect to the first pulse. Each of the first and second pulses comprises a plurality of components wherein a first component has a frequency corresponding to the repetition frequency and wherein a second component has a second frequency corresponding to twice the first frequency. The second component has an amplitude which has a first predetermined relationship to an amplitude of the first component. A first transmitter emits electromagnetic energy at a first wavelength in response to the first pulse; and a second transmitter emits electromagnetic energy at a second wavelength in response to the second pulse. A detector receives electromagnetic energy at the first and second wavelengths after passing through a portion of a subject and generates a detector output signal responsive to the received electromagnetic energy. The detector output signal includes a signal component responsive to attenuation of the electromagnetic energy at the first wavelength and a signal component responsive to attenuation of the electromagnetic energy at the second wavelength. A first demodulator multiplies the detector signal try a first demodulation signal and generates a first demodulated output signal. The first demodulation signal comprises a first component having the first frequency and having a first amplitude. The first demodulation signal also comprises a second component having the second frequency and having a second amplitude. The second amplitude has a second predetermined relationship to the first amplitude. The second predetermined relationship is approximately inversely proportional to the first predetermined relationship. A second demodulator multiplies the detector signal by a second demodulation signal and generates a second demodulated output signal. The second demodulation signal comprises a first component having the first frequency and having the first amplitude. The second demodulation signal further comprises a second component having the second frequency and having the second amplitude. At least one component of the second demodulation signal has a selected phase relationship with a corresponding one component of the first demodulation signal. Preferably, the selected phase relationship is a π phase difference.</p>
    <p num="p-0018">Another embodiment incorporates declination before demodulation. In yet another embodiment, a multi-channel demodulator, with or without pre-demodulation decimation is disclosed.</p>
    <p num="p-0019">In yet another embodiment, an adaptive algorithm is used to control the operation of pre-demodulation decimators and post-demodulation decimators. The adaptive algorithm may control both the characteristics of a lowpass filter in the decimator and the decimation rate provided by a signal rate compressor in the decimator.</p>
    <p num="p-0020">Another embodiment of the invention is a method for selecting a sample rate that reduces the interference caused by ambient light.</p>
    <description-of-drawings> <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading> <p num="p-0021">The present invention will be described below in connection with the accompanying drawing figures in which:</p>
      <p num="p-0022"> <figref idrefs="DRAWINGS">FIG. 1</figref> illustrates an exemplary block diagram of a representation of a signal processing system in accordance with the present invention used to determine blood oxygen saturation in a subject;</p>
      <p num="p-0023"> <figref idrefs="DRAWINGS">FIG. 2</figref> illustrates exemplary waveforms of the current through the LEDs in <figref idrefs="DRAWINGS">FIG. 1</figref> and the resulting intensities of the red light and the infrared light generated by the LEDs;</p>
      <p num="p-0024"> <figref idrefs="DRAWINGS">FIG. 3</figref> illustrates a block diagram of the overall processing system in accordance with the present invention;</p>
      <p num="p-0025"> <figref idrefs="DRAWINGS">FIG. 4</figref> illustrates a frequency spectra of the first modulation signal MI(t) for n=0, 1, 2, . . . , where the horizontal axis represents frequency and the vertical axis represents the energy in the DC and harmonic components of the signal;</p>
      <p num="p-0026"> <figref idrefs="DRAWINGS">FIG. 5</figref> illustrates an exemplary spectrum of the first and second harmonics of the present invention when the fundamental frequency is selected to be 316.7 Hz in comparison to the fundamental and harmonics of conventional 60 Hz power;</p>
      <p num="p-0027"> <figref idrefs="DRAWINGS">FIG. 6</figref> illustrates the effect of the value of B on the measured signal output Ŝ<sub>2</sub>(t) responsive to the red modulation pulses as the value of B is varied while the infrared modulation pulses are off;</p>
      <p num="p-0028"> <figref idrefs="DRAWINGS">FIG. 7</figref> illustrates a preferred embodiment of the present invention implemented in a digital processing system;</p>
      <p num="p-0029"> <figref idrefs="DRAWINGS">FIG. 8</figref> illustrates a detailed block diagram of the demodulation portion of the present invention;</p>
      <p num="p-0030"> <figref idrefs="DRAWINGS">FIG. 9</figref> illustrates a detailed block diagram of the modulation portion of the present invention;</p>
      <p num="p-0031"> <figref idrefs="DRAWINGS">FIG. 10</figref> illustrates the red drive waveform and the infrared drive waveform generated by the modulation portion of <figref idrefs="DRAWINGS">FIG. 9</figref>;</p>
      <p num="p-0032"> <figref idrefs="DRAWINGS">FIG. 11</figref> illustrates the demodulation waveforms generated by the demodulation portion of <figref idrefs="DRAWINGS">FIG. 8</figref>;</p>
      <p num="p-0033"> <figref idrefs="DRAWINGS">FIG. 12</figref> illustrates a method of time domain sampling the digital detection signal during the times when both the red pulses and the infrared pulses are off to obtain information regarding the level of ambient noise;</p>
      <p num="p-0034"> <figref idrefs="DRAWINGS">FIG. 13</figref> illustrates a block diagram of a system that performs the time domain sampling of <figref idrefs="DRAWINGS">FIG. 12</figref>;</p>
      <p num="p-0035"> <figref idrefs="DRAWINGS">FIG. 14</figref> illustrates a method of frequency domain sampling to determine the noise floor at frequencies other than the signal frequencies;</p>
      <p num="p-0036"> <figref idrefs="DRAWINGS">FIG. 15</figref> illustrates a block diagram of a system that performs the frequency domain sampling of <figref idrefs="DRAWINGS">FIG. 14</figref>;</p>
      <p num="p-0037"> <figref idrefs="DRAWINGS">FIG. 16</figref> illustrates a block diagram of the overall processing system in accordance with a pre-demodulation decimation embodiment of the present invention;</p>
      <p num="p-0038"> <figref idrefs="DRAWINGS">FIG. 17</figref> illustrates a block diagram of a multi-channel processing system in accordance with a pre-demodulation decimation embodiment of the present invention;</p>
      <p num="p-0039"> <figref idrefs="DRAWINGS">FIG. 18</figref> illustrates a block diagram of an adaptive multi-channel processing system in accordance with a pre-demodulation decimation embodiment of the present invention;</p>
      <p num="p-0040"> <figref idrefs="DRAWINGS">FIG. 19</figref> illustrates a flowchart of a method for choosing the modulation frequency and decimation rate in order to minimize the affects of ambient light; and</p>
      <p num="p-0041"> <figref idrefs="DRAWINGS">FIG. 20</figref> is a graph to be used in connection with graphical method for designing a demodulation system to minimize interference due to ambient light.</p>
    </description-of-drawings> <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading> <p num="p-0042"> <figref idrefs="DRAWINGS">FIG. 1</figref> illustrates an exemplary block diagram of a representation of a signal presented, the measurements are performed on a portion of the subject, such as a finger <b>102</b> illustrated in <figref idrefs="DRAWINGS">FIG. 1</figref>. An LED modulation circuit <b>104</b> drives a pair of back-to-back light emitting diodes (LEDs) <b>106</b>, <b>108</b> by applying a periodic signal to the two light emitting diodes <b>106</b>, <b>108</b>. The LED <b>106</b> is selected to emit electromagnetic energy in the red visible light range, and has a wavelength of, for example, approximately 660 nanometers. The LED <b>108</b> is selected to emit electromagnetic energy in the infrared range, and has a wavelength of, for example, approximately 905 nanometers. The LED modulation circuit <b>104</b> supplies current in alternating directions so that the two LEDs <b>106</b>, <b>108</b> are activated one at a time. In particular, as illustrated by a current waveform <b>120</b> in <figref idrefs="DRAWINGS">FIG. 2</figref>, current is first applied in a forward direction with respect to the red LED <b>106</b> during a first time interval <b>122</b> having a duration τ. Thereafter, no current is applied to either LED during a second time interval <b>124</b> having a like duration τ. Then, current is applied in a forward direction with respect to the infrared LED <b>108</b> during a third time interval <b>126</b>, also having a duration τ. Then, no current is applied to either LED during a fourth time interval <b>128</b> having a like duration τ. Thereafter, the current is again applied in the forward direction for the red LED <b>106</b> during a fifth time interval <b>130</b> which corresponds to the first time interval <b>122</b>. It can be seen that the overall cycle repeats with a period of duration T equal to 4τ. The red LED <b>106</b> emits light only when the current is applied in the forward direction with respect to the red LED <b>106</b>. Thus, as illustrated by a red intensity waveform <b>132</b>, the red LED <b>106</b> emits light as a pulse <b>134</b> during the first time interval <b>122</b> and as a pulse <b>136</b> during the fifth time interval <b>130</b>, and so on. The red pulses repeat with a periodicity equal to T. Similarly, the infrared LED <b>108</b> emits infrared light only when the current is applied in the forward direction with respect to the infrared LED <b>108</b>. Thus, as illustrated by an infrared intensity waveform <b>140</b>, the infrared LED <b>108</b> emits infrared light as a pulse <b>142</b> during the third interval <b>126</b>. A next infrared pulse <b>144</b> occurs at an interval T after the infrared pulse <b>142</b>. Thus, the infrared pulses also repeat with a periodicity equal to T. It can be seen that the red pulses and the infrared pulses each have a duty cycle of 25%, and the red pulses and the infrared pulses are separated by intervals of one-fourth of each period T (i.e., the beginning of one pulse occurs an interval τ after the end of the previous pulse).</p>
    <p num="p-0043">As further illustrated in <figref idrefs="DRAWINGS">FIG. 1</figref>, the electromagnetic energy pulses from the red LED <b>106</b> and the infrared LED <b>108</b> are applied to the finger <b>102</b>. A detector <b>150</b> is positioned to receive the electromagnetic energy after the energy has passed through a portion of the finger <b>102</b>. The detector <b>150</b> is selected to be responsive to both the red light and the infrared light and to generate an output signal responsive to the intensity of the energy received from each source. An exemplary current output signal from the detector <b>150</b> is represented by a waveform <b>152</b> in <figref idrefs="DRAWINGS">FIG. 2</figref>. As illustrated, the detector signal waveform <b>152</b> comprises a first pulse <b>154</b> responsive to the first red pulse <b>134</b>, a second pulse <b>156</b> responsive to the infrared pulse <b>142</b> and a third pulse <b>158</b> responsive to the second red pulse <b>136</b>. During the time between the first pulse <b>154</b> and the second pulse <b>156</b>, the detector signal waveform <b>152</b> comprises noise <b>160</b>, and during the time between the second pulse <b>156</b> and the third pulse <b>158</b>, the detector signal waveform <b>150</b> comprises noise <b>162</b>. The signal pulses <b>154</b>, <b>156</b> and <b>158</b> also include noise superimposed thereon. Although shown as repeating noise, it should be understood that the noise varies with time. For example, noise caused by ambient light will vary with a periodicity corresponding to the 50 Hz or 60 Hz power frequency and their harmonics, particularly when the ambient light is provided by fluorescent lights which generate significant noise at the first harmonic (i.e., 100 Hz or 120 Hz) and the third harmonic (i.e., 200 Hz or 240 Hz).</p>
    <p num="p-0044">The output of the-detector <b>150</b> is applied as an input to a signal processor block <b>170</b> which processes the detector signal and generates a first signal Ŝ<sub>1</sub>(t) responsive to the detected intensity of the red light incident on the detector <b>150</b> and generates a second signal Ŝ<sub>2</sub>(t) responsive to the detected intensity of the infrared light incident on the detector <b>150</b>. As illustrated, the signal processing block <b>170</b> is synchronized with the LED modulator <b>104</b> via a set of control lines <b>180</b>. As will be discussed below, the control lines <b>180</b> advantageously communicate signals which provide timing information that determines when to activate the red LED <b>106</b> and when to activate the infrared LED <b>108</b>.</p>
    <p num="p-0045"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a pictorial representation of a model of an exemplary system which incorporates the present invention. The red LED <b>106</b> provides a light intensity represented as IRD, and the infrared LED <b>108</b> provides a light intensity represented as I<sub>IR</sub>.</p>
    <p num="p-0046">The effects of turning the LEDs <b>106</b>, <b>108</b> on and off on periodic bases are modeled by a first multiplier or modulator <b>190</b> which applies a first modulation signal M<sub>1</sub>(t) to the red light intensity to generate a modulated red signal I<sub>IRMOD</sub>(t) and by a second multiplier or modulator <b>192</b> which applies a second modulation signal M<sub>2</sub>(t) to the infrared light intensity to generate a modulated infrared signal I<sub>IRMOD</sub>(t). The modulated light red signal and the modulated infrared signal are applied to the finger <b>102</b>, or other body portion, as described above. The finger <b>102</b> has blood flowing therein and is represented in <figref idrefs="DRAWINGS">FIG. 3</figref> as a block <b>102</b>. The blood in the finger <b>102</b> has a volume and scattering components which vary throughout each cardiac cycle. The blood carries oxygen and other materials therein. The oxygen content is a function of both the blood volume and the concentration of the oxygen in the blood volume. The concentration of the oxygen in the blood volume is generally measured as blood oxygen saturation for reasons which are described in full in the above-identified issued U.S. Pat. Nos. 5,482,036 and 5,490,505. As further described in the two referenced patents, the blood oxygen saturation is determined by comparing the relative absorption of the red light and the infrared light in the finger <b>102</b>. The comparison is complicated by the noise caused by movement, ambient light, light scattering, and other factors.</p>
    <p num="p-0047">In <figref idrefs="DRAWINGS">FIG. 3</figref>, a pair of signals S<sub>1</sub>(t) and S<sub>2</sub>(t) represent the effect of the time-varying volume and scattering components of the blood in the finger <b>102</b> on the red light and the infrared light, respectively, passing through the finger <b>102</b> from the LEDs <b>106</b>, <b>108</b> to the detector <b>150</b>. The red light signal portion S<sub>1</sub>(t) is caused by the variable attenuation of the red light passing through the finger <b>102</b>. The infrared light signal portion S<sub>2</sub>(t) is caused by the variable attenuation of the infrared light passing through the finger <b>102</b>. To show the effect of the variable attenuations, the signal portion S<sub>1</sub>(t) is illustrated as being applied to a first attenuation modulator <b>191</b> which multiplies the signal S<sub>1</sub>(t) by the modulated red output I<sub>IRMOD</sub>(t) of the first modulator <b>190</b>. Similarly, the infrared light signal portion S<sub>2</sub>(t) is illustrated as being applied to a second attenuation modulator <b>193</b> which multiplies the signal S<sub>2</sub>(t) by the modulated infrared output I<sub>IRMOD</sub>(t) of the second modulator <b>192</b>. The outputs of the first and second attenuation modulators <b>191</b>, <b>193</b> are provided to the receiving photodetector <b>150</b>. The photodetector <b>150</b> is modeled as adder <b>194</b> and an adder <b>196</b>. The outputs of the first and second attenuation modulators <b>191</b>, <b>193</b> are provided to the adder <b>194</b> to generate a composite signal M(t) where:
<br> <i>M</i>(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)+<i>S</i> <sub>2</sub>(<i>t</i>)<i>M</i> <sub>2</sub>(<i>t</i>).  (1)</p>
    <p num="p-0048">The signal M(t) from the adder <b>194</b> is provided to the adder <b>196</b> where the signal M(t) is added to a signal n(t) which represents a composite noise signal caused by ambient light, electromagnetic pickup, and the like, which are also detected by the photodetector <b>150</b>. The output of the adder <b>196</b> is a signal M′(t)=M(t)+n(t) which includes noise components as well as the signal components. The noise components include DC components and harmonics of the power line frequency that appear in the ambient light. In addition, as will be discussed in more detail below, the signal M′(t) may also include noise at higher frequencies caused, for example, by other devices such as electrocauterization equipment, or the like.</p>
    <p num="p-0049">The M′(t) signal output of the third adder <b>196</b> (i.e., the output of the detector <b>150</b>) is applied to the input of the signal processing block <b>170</b>. Within the signal processing block <b>170</b>, the signal M′(t) is first passed through a fixed gain amplifier <b>197</b> and then through an analog bandpass filter <b>198</b>. The analog bandpass filter <b>198</b> has a passband selected to pass signals in the range of 20 Hz, to 10,000 Hz. Thus, the analog bandpass filter <b>198</b> removes a significant portion of the noise below 10 Hz. The signal components responsive to the blood oxygen saturation are frequency shifted by the operation of the two modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t) and are passed by the analog bandpass filter <b>198</b>.</p>
    <p num="p-0050">In the preferred embodiment, the output of the analog bandpass filter <b>198</b> is sampled by an analog-to-digital converter <b>199</b> and converted therein to digital signals. For example, the signals are preferably sampled at 46,875 samples per second. The output of the analog-to-digital converter <b>199</b> is a signal MF(k).</p>
    <p num="p-0051">The signal MF(k) is provided as a first input to a first demodulating multiplier <b>210</b>. The signal MF(k) is also provided as a first input to a second demodulating multiplier <b>212</b>. A first demodulating signal D<sub>1</sub>(k) is provided as a second input to the first demodulating multiplier <b>210</b>, and a second demodulating signal D<sub>2</sub>(k)) is provided as a second input to the second demodulating multiplier <b>212</b>. The output of the first demodulating multiplier <b>210</b> is provided as an input to a first lowpass filter <b>220</b>, and the output of the second demodulating multiplier is provided as an input to a second lowpass filter <b>222</b>. The bandwidths of the lowpass filters <b>220</b>, <b>222</b> are preferably approximately 10 Hz.</p>
    <p num="p-0052">The output of the first lowpass filter <b>220</b> is a signal Ŝ<sub>1</sub>(t), which, as discussed below, is an estimate of the signal Ŝ<sub>1</sub>(t). The output of the second lowpass filter <b>222</b> is a signal Ŝ<sub>2</sub>(t), which, as discussed below, is an estimate of the signal Ŝ<sub>2</sub>(t). As will be shown below, the selection of the first demodulating signal D<sub>1</sub>(k) and the second demodulating signal D<sub>2</sub>(k) in accordance with the present invention substantially reduces or eliminates the effects of noise in the two output signals Ŝ<sub>1</sub>(t) and Ŝ<sub>1</sub>(t) and also substantially reduces or eliminates crosstalk between the two signals.</p>
    <p num="p-0053">In the preferred embodiment of the present invention, the sample rates of the outputs of the lowpass filter <b>220</b> and the lowpass filter <b>222</b> are compressed by respective sample rate compressors <b>221</b> and <b>223</b>. In particular, the sample rate compressors <b>221</b>, <b>223</b> reduce the sample rate by 750 to a sample rate of, for example, 62.5 Hz to provide an output which can be further processed in accordance with the methods and apparatuses described in the above-referenced patents. The sample rate compressions which occur in the sample rate compressors <b>221</b>, <b>223</b> reduce the rate at which the output signals Ŝ<sub>1</sub>(t) and Ŝ<sub>2</sub>(t) need to be processed while maintaining the sample rate well above the 0-10 Hz frequency content of the signals of interest. The outputs of the filters <b>220</b>, <b>222</b>, or the sample rate compressors <b>221</b>, <b>223</b>, if included, are provided on respective output lines <b>224</b> and <b>226</b>.</p>
    <p num="p-0054">In order to facilitate an understanding of how the present invention operates in demodulating the output signal MF(k) from the analog-to-digital converter <b>199</b>, the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t)) will first be described in terms of their frequency components. One skilled in the art will appreciate that the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t) can each be represented as a Fourier cosine series expansion (e.g., Σ<sub>n=0</sub> <sup>∞</sup>a<sub>n </sub>cos(nωt), where ω=2π/T) representing the fundamental and harmonic frequencies of the rectangular signal pulses. One skilled in the art will understand that the Fourier series expansion includes phases; however, by suitably selecting the time origin, the phases are set to zero. A component which is 180° out of phase with a corresponding component will advantageously be represented by a minus sign before the coefficient.</p>
    <p num="p-0055"> <figref idrefs="DRAWINGS">FIG. 4</figref> illustrates a frequency spectra of the first modulation signal M<sub>1</sub>(t) for n=0, 1, 2, . . . , where the horizontal axis represents frequency, with the energy in the DC component along the vertical axis and increasing harmonics of the fundamental frequency along the horizontal axis. The length of each component of M<sub>1</sub>(t) along the vertical axis represents the energy E(n) in each component of the frequency spectra. The first component to the right of the vertical axis is at the fundamental frequency (i.e., 1/T), which is designated herein as f<sub>0</sub>; however, it should be understood that the fundamental frequency f<sub>0 </sub>corresponds to n=1. The second component to the right of the vertical axis is the first harmonic f<sub>1 </sub>(i.e., n=2), which has a frequency which is twice the fundamental frequency. The third component to the right of the vertical axis is the second harmonic f<sub>2 </sub>(i.e., n=3), which has a frequency which is three times the fundamental frequency. The components to the right of the second harmonic are numbered accordingly. (Note, other conventions identify the fundamental frequency as the first harmonic, and designate the second harmonic as the frequency that is twice the fundamental frequency. The identification of the fundamental frequency as f<sub>0 </sub>is used in the discussion that follows.)</p>
    <p num="p-0056">In <figref idrefs="DRAWINGS">FIG. 4</figref>, a modulation envelope <b>230</b> is shown in dashed lines. The modulation envelope <b>230</b> represents the magnitudes of the fundamental and the harmonics of the signal M<sub>1</sub>(t). The shape of the envelope is determined by the modulation signal M<sub>1</sub>(t) which, for a repeating rectangular pulse train starting at time t=0 and having a normalized amplitude of 1, can be expressed as:</p>
    <p num="p-0057"> <maths id="MATH-US-00001" num="00001"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>M</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mfrac> <mi>τ</mi> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mn>0</mn> </mrow> <mi>∞</mi> </munderover> <mo>⁢</mo> <mrow> <mi>sin</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>c</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>τ</mi> </mrow> <mi>T</mi> </mfrac> <mo>)</mo> </mrow> </mrow> <mo>⁢</mo> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>t</mi> </mrow> <mi>T</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>2</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
Where sinc is the function (sin πx)/πx (i.e., sinc(πτ/T)=sin(nπτ/T)/(nπτ/T)). In the example shown, τ=¼T. (Note that for sampled signals, the envelope is more accurately represented as sin α/sin β; however, as well known in the art, for the frequencies of interest, the sinc function is a suitable approximation.) Thus, the frequency spectra has nulls at n=4, n=8, n=12, and so on, corresponding to the third harmonic f<sub>3</sub>, the seventh harmonic f<sub>7</sub>, the eleventh harmonic f<sub>11</sub>, and so on. Note that Equation 2 is an idealized form of the equation for M<sub>1</sub>(t), and that in general:
</p>
    <p num="p-0058"> <maths id="MATH-US-00002" num="00002"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>M</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mfrac> <mi>τ</mi> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mn>0</mn> </mrow> <mi>∞</mi> </munderover> <mo>⁢</mo> <mrow> <msub> <mi>a</mi> <mi>n</mi> </msub> <mo>⁢</mo> <mi>sin</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>c</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mfrac> <mrow> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>τ</mi> </mrow> <mi>T</mi> </mfrac> <mo>⁢</mo> <msup> <mi>ⅇ</mi> <mrow> <mrow> <mo>-</mo> <mi>j</mi> </mrow> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <msub> <mi>ω</mi> <mn>0</mn> </msub> <mo>⁢</mo> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>t</mi> </mrow> </msup> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>3</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
where a<sub>n </sub>is a complex number. In the discussion that follows, the values of a<sub>n </sub>are assumed to be real numbers only.
</p>
    <p num="p-0059">A similar frequency spectra (not shown) for the modulation signal M<sub>2</sub>(t) is determined by the expression:</p>
    <p num="p-0060">
      <maths id="MATH-US-00003" num="00003"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>M</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mfrac> <mi>τ</mi> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mn>0</mn> </mrow> <mi>∞</mi> </munderover> <mo>⁢</mo> <mrow> <msup> <mrow> <mo>(</mo> <mrow> <mo>-</mo> <mn>1</mn> </mrow> <mo>)</mo> </mrow> <mi>n</mi> </msup> <mo>⁢</mo> <mi>sin</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>c</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>τ</mi> </mrow> <mi>T</mi> </mfrac> <mo>)</mo> </mrow> </mrow> <mo>⁢</mo> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>t</mi> </mrow> <mi>T</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>4</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> </p>
    <p num="p-0061">An envelope for the frequency spectra of second modulation signal M<sub>2</sub>(t) will have the same magnitudes; however, it should be understood that because of the (−1)<sup>n </sup>term in the expression for M<sub>2</sub>(t), the fundamental f<sub>0 </sub>and every even harmonic (i.e., f<sub>2</sub>, f<sub>4</sub>, etc.) are 180° out of phase with the corresponding harmonic of the first modulation signal M<sub>1</sub>(t).</p>
    <p num="p-0062">In <figref idrefs="DRAWINGS">FIG. 3</figref>, the analog-to-digital converter <b>199</b> converts the signal M′(t) to a sequence of sampled digital values MF(k) at a sampling rate of, for example, 46,875 samples per second. As discussed above, the first demodulating multiplier <b>210</b> multiplies the output MF(k) of the converter <b>199</b> by the first demodulating, signal D<sub>1</sub>(k) to generate the first output sequence Ŝ<sub>1</sub>(k), and the second demodulating multiplier <b>212</b> multiplies the output MF(k) by the second demodulating signal D<sub>2</sub>(k) to generate the second output sequence Ŝ<sub>2</sub>(k). The multiplication by the multipliers <b>210</b>, <b>212</b> can also be expressed as follows:
<br> <i>Ŝ</i> <sub>2</sub>(<i>k</i>)=<i>LP[MF</i>(<i>k</i>)<i>D</i> <sub>1</sub>(<i>k</i>)]  (5)<br>
and
<br> <i>Ŝ</i> <sub>2</sub>(<i>k</i>)=<i>LP[MF</i>(<i>k</i>)<i>D</i> <sub>2</sub>(<i>k</i>)]  (6)<br>
where LP is the transfer function of the lowpass filter <b>220</b> and of the lowpass filter <b>222</b>. If, for simplicity, the noise is assumed to be zero, then:
<br> <i>M</i>′(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)+<i>S</i> <sub>2</sub>(<i>t</i>)<i>M</i> <sub>2</sub>(<i>t</i>)  (7)<br>
Therefore:
<br> <i>Ŝ</i> <sub>1</sub>(<i>k</i>)=<i>LP[[S</i> <sub>1</sub>(<i>k</i>)<i>M</i> <sub>1</sub>(<i>k</i>)+<i>S</i> <sub>2</sub>(<i>k</i>)<i>M</i> <sub>2</sub>(<i>k</i>)]<i>D</i> <sub>1</sub>(<i>k</i>)]  (8)<br>
and thus
<br> <i>Ŝ</i> <sub>1</sub>(<i>k</i>)=<i>LP[[S</i> <sub>1</sub>(<i>k</i>)<i>M</i> <sub>1</sub>(<i>k</i>)]<i>D</i> <sub>1</sub>(<i>k</i>)+[<i>S</i> <sub>2</sub>(<i>k</i>)<i>M</i> <sub>2</sub>(<i>k</i>)]<i>D</i> <sub>1</sub>(<i>k</i>)]  (9)<br>
Similarly:
<br> <i>Ŝ</i> <sub>2</sub>(<i>k</i>)=<i>LP[[S</i> <sub>2</sub>(<i>k</i>)<i>M</i> <sub>2</sub>(<i>k</i>)]<i>D</i> <sub>2</sub>(<i>k</i>)+[<i>S</i> <sub>1</sub>(<i>k</i>)<i>M</i> <sub>1</sub>(<i>k</i>)]<i>D</i> <sub>2</sub>(<i>k</i>)]  (10)</p>
    <p num="p-0063">Since LP is a linear operator, the right-hand side of Equations 9 and 10 can be split into two terms. The first term on the right-hand side of each of Equations 9 and 10 above is the desired signal portion of the equation, and the second term on the right-hand side of each of the equations is the crosstalk portion. Thus, in order to reduce the crosstalk to zero, the second term of each of Equations 9 and 10 is set to zero:
<br> <i>LP[S</i> <sub>2</sub>(<i>k</i>)<i>M</i> <sub>2</sub>(<i>k</i>)<i>D</i> <sub>1</sub>(<i>k</i>)]=0  (11)<br>
and
<br> <i>LP[S</i> <sub>1</sub>(<i>k</i>)<i>M</i> <sub>1</sub>(<i>k</i>)<i>D</i> <sub>2</sub>(<i>k</i>)]=0  (12)<br>
By setting the second terms to zero, Equations 9 and 10 reduce to:
<br> <i>Ŝ</i> <sub>1</sub>(<i>k</i>)=<i>LP[S</i> <sub>1</sub>(<i>k</i>)<i>M</i> <sub>1</sub>(<i>k</i>)<i>D</i> <sub>1</sub>(<i>k</i>)]  (13)<br>
and
<br> <i>Ŝ</i> <sub>2</sub>(<i>k</i>)=<i>LP[S</i> <sub>2</sub>(<i>k</i>)<i>M</i> <sub>2</sub>(<i>k</i>)<i>D</i> <sub>2</sub>(<i>k</i>)]  (14)</p>
    <p num="p-0064">One goal of the present invention is to select the demodulating signals D<sub>1</sub>(k) and D<sub>2</sub>(k) to satisfy Equations 11 and 12 to thereby reduce Equations 9 and 10 to Equations 13 and 14. This is accomplished by utilizing Equations 2 and 3 to simplify the two equations by selectively using components of the two modulating signals M<sub>1</sub>(t) and M<sub>2</sub>(t) to generate the demodulating sequences D<sub>1</sub>(k) and D<sub>2</sub>(k).</p>
    <p num="p-0065">In order to simplify the discussion, Equation 2 can be rewritten as:</p>
    <p num="p-0066"> <maths id="MATH-US-00004" num="00004"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>M</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>∞</mi> </munderover> <mo>⁢</mo> <mrow> <mrow> <mi>E</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>n</mi> <mo>)</mo> </mrow> </mrow> <mo>⁢</mo> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>n</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>ω</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>t</mi> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>15</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
where E(n) is the sinc envelope for the fundamental frequency f<sub>0 </sub>(n=1) and the harmonics f<sub>1</sub>(n=2), f<sub>2</sub>(n=3), and so on, where cos(nωt) represents the cosine term cos(2πnt/T), where ω=2π/T. (Note, as discussed above, for discrete sampled signals, the actual envelope of E(n) is a sin α/sin β function; however, for the frequencies of interest, the sine function is a suitable representation.)
</p>
    <p num="p-0067">As discussed above, the DC term (n=0) does not need to be considered because of the operation of the filter <b>198</b>, and the analog-to-digital converter <b>199</b>, as well as the action of the demodulation, which shift any unwanted DC or low frequency signals having a frequency less than approximately 10 Hz (hereinafter near-DC signals) to higher frequencies before lowpass filtering. As a further simplification, the magnitude of the fundamental term in Equation 15 is normalized to a value of 1 (i.e., E(1)=1). Note that the normalization results in the need for a scale factor, which will be discussed below. Thus, Equation 15 becomes:
<br> <i>M</i> <sub>1</sub>(<i>t</i>)=cos ω<i>t+a </i>cos 2ω<i>t+b </i>cos 3ω<i>t+c </i>cos 4ω<i>t+ . . . </i>  (16)<br>
The demodulation signal D<sub>1</sub>(t) is defined as:
<br> <i>D</i> <sub>1</sub>(<i>t</i>)=cos ω<i>t+B </i>cos 2<i>ωt</i>  (17)<br>
For reasons set forth below, only the first two cosine terms are needed.
</p>
    <p num="p-0068">Similarly, the second modulating signal M<sub>2</sub>(t) becomes:
<br> <i>M</i> <sub>2</sub>(<i>t</i>)=−cos ω<i>t+a </i>cos 2ω<i>t−b </i>cos 3ω<i>t+c </i>cos 4ω<i>t+ . . . </i>  (18)<br>
and the second demodulating signal D<sub>2</sub>(t) is defined as:
<br> <i>D</i> <sub>2</sub>(<i>t</i>)=−cos ω<i>t+B </i>cos 2ω<i>t</i>  (19)<br>
Note that the signs of the fundamental and odd harmonics in Equation 18 are 180° out of phase with the corresponding terms in Equation 16.
</p>
    <p num="p-0069">Note, as will be developed more fully below, by including only the fundamental s(cos ωt) and the first harmonic (cos 2ωt) in each of the demodulation signals, only the signals proximate to the fundamental and first harmonic need to be considered. By eliminating higher harmonics, the effects of the higher harmonics of the power line frequency are also eliminated in the output signals generated by the present invention.</p>
    <p num="p-0070">Assume that the filter <b>198</b> and the analog-to-digital converter <b>199</b> do not affect the magnitude of the signal MF(k) with respect to M′(t) for the frequencies having significant energy. Therefore, starting with Equation 7 above, M′(t) can be written as:
<br> <i>M</i>′(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)[cos ω<i>t+a </i>cos 2ω<i>t+b </i>cos 3ω<i>t+ . . . ]+S</i> <sub>2</sub>(<i>t</i>)[−cos ω<i>t+a </i>cos 2ω<i>t−b </i>cos 3ω<i>t+ . . . ]</i>  (20)<br>
When the first demodulating multiplier <b>210</b> multiplies M(t) by DI(t), the terms on the right-hand side of Equation 20 are multiplied by the terms on the right-hand side of Equation 17.
<br>
Thus:
<br> <i>M</i>′(<i>t</i>)<i>D</i> <sub>1</sub>(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)[cos ω<i>t+a </i>cos 2ω<i>t+b </i>cos 3ω<i>t </i>. . . ][cos ω<i>t+B </i>cos 2ω<i>t]+S</i> <sub>2</sub>(<i>t</i>)[−cos ω<i>t+a </i>cos 2ω<i>t−b </i>cos 3ω<i>t</i>+ . . . ][cos ω<i>t+B </i>cos 2ω<i>t]</i>  (21)<br>
The term S<sub>1</sub>(t)[cos ωt+a cos 2ωt+b cos 3ωt+ . . . ][cos ωt+B cos 2ωt] is the signal term which is to be preserved, and the term S<sub>2</sub>(t)[−cos ωt+a cos 2ωt−b cos 3ωt+ . . . ][cos ωt+B cos 2ωt] is the crosstalk term to be eliminated.
</p>
    <p num="p-0071">Expanding the crosstalk term from Equation 21, generates:
<br>crosstalk=<i>S</i> <sub>2</sub>(<i>t</i>)[−cos<sup>2 </sup> <i>ωt−B </i>cos ω<i>t </i>cos 2ω<i>t+a </i>cos 2ω<i>t </i>cos ω<i>t+aB </i>cos<sup>2 </sup>2ω<i>t−b </i>cos 3<i>ωt </i>cos ω<i>t−bB </i>cos 3ω<i>t </i>cos 2ω<i>t+ . . . ]</i>  (22)</p>
    <p num="p-0072">Using the identity, cos(x)cos(y)=½[cos(x+y)+cos(x−y)], the crosstalk term from Equation 22 becomes:
<br>crosstalk=<i>S</i> <sub>2</sub>(<i>t</i>)[−½(cos 2ω<i>t+</i>1)+((<i>a−B</i>)/2)[cos 3ω<i>t</i>+cos ω<i>t</i>]+(<i>aB/</i>2)[cos 4ω<i>t+</i>1]−(<i>b/</i>2)[cos 4ω<i>t</i>+cos 2ω<i>t</i>]−(<i>bB/</i>2)[cos 5ω<i>t+</i>cos ω<i>t]+ . . . ]</i>  (23)<br>
The remaining terms in Equation 23 will all have a factor of cos rot or higher. Thus, Equation 23, when fully expanded only includes near-DC terms:
<br>crosstalk<sub>DC</sub> <i>=LP[S</i> <sub>2</sub>(<i>t</i>)[<i>aB/</i>2)−½]]  (24)<br>
where S<b>2</b>(<i>t</i>) corresponds to the infrared portion of the original plethysmograph signal which has a bandwidth of interest of approximately 0 to 10 Hz. Any components present above 10 Hz will be eliminated by the action of the lowpass filter <b>220</b>. Thus, it can be seen that only the signals of interest are folded back to DC or near-DC. By using the lowpass filter <b>220</b>, the DC terms and near-DC terms can be isolated so that only the DC terms and near-DC terms of the crosstalk are presented at the output of the lowpass filter <b>220</b>. Thus, in order to eliminate the crosstalk, the crosstalk terms in Equation 24 need to be set to zero:
<br> <i>LP[S</i> <sub>2</sub>(<i>t</i>)[<i>aB/</i>2−½]]=0  (25)<br>
Thus:
<br> <i>B=</i>1<i>/a</i>  (26)</p>
    <p num="p-0073">The result in Equation 26 can also be expressed using a geometric interpretation of vector projection (i.e., dot products) of S<sub>2</sub>(t) and S<sub>1</sub>(t) wherein the projection of S<sub>2</sub>(t) onto D<sub>1</sub>(t) is equal to zero and the projection of S<sub>2</sub>(t) onto D<sub>2</sub>(t) is maximized. In other words, express S<sub>1</sub>(t), S<sub>2</sub>(t), D<sub>1</sub>(t) and D<sub>2</sub>(t) as vectors of samples in an n-dimensional sample space (e.g., S<sub>1</sub>(t) is represented as a vector S<sub>1 </sub>of samples S<sub>1</sub>(k)). For example, in a preferred embodiment, n=148, and thus S<sub>1</sub>, S<sub>2</sub>, D<sub>1 </sub>and D<sub>2 </sub>are vectors of 148 samples each. The first crosstalk term is S<sub>1</sub>·D<sub>2</sub>. The second crosstalk term is S<sub>2</sub>·D<sub>1</sub>. The first signal output is S<sub>1</sub>−D<sub>1</sub>. The second signal output is S<sub>2</sub>·D<sub>2</sub>. Select the vectors D<sub>1 </sub>and D<sub>2 </sub>to drive the crosstalk terms to zero.</p>
    <p num="p-0074">The relationship in Equation 26 also works to preserve the signal term. In particular, the signal term in Equation 21 can be expanded and lowpass filtered in the same manner as the crosstalk term to obtain:
<br>signal=<i>Ŝ</i> <sub>1</sub>(<i>t</i>)=<i>LP[S</i> <sub>1</sub>(<i>t</i>)[(<i>aB/</i>2)+½]]  (27)<br>
Using the relationship from Equation 26, then Equation 27 becomes:
<br>signal=<i>Ŝ</i> <sub>1</sub>(<i>t</i>)=<i>LP[S</i> <sub>1</sub>(<i>t</i>)[(<i>a/</i>2<i>a</i>)+½]=<i>LP[S</i> <sub>1</sub>(<i>t</i>)]=<i>S</i> <sub>1</sub>(<i>t</i>)  (28)</p>
    <p num="p-0075">It can be readily shown that the same relationship holds for the crosstalk term and 5 the signal term for the signal S<sub>2</sub>(t) by defining the second demodulation signal D<sub>2</sub>(t) as:
<br> <i>D</i> <sub>2</sub>(<i>t</i>)=−cos ω<i>t+B </i>cos 2ω<i>t</i>  (29)<br>
and multiplying M<b>2</b>(<i>t</i>) by D<b>2</b>(<i>t</i>). After expanding the crosstalk and signal terms and eliminating the terms above 10 Hz, it can be shown that by selecting B=1/a, the crosstalk term is canceled and the signal term S<sub>2</sub>(t) is recovered.
</p>
    <p num="p-0076">From the foregoing, it can be seen that by choosing the relationship between the magnitude of B as the reciprocal of a, then the crosstalk terms are eliminated and the signal terms are preserved. Note that neither A nor B is an absolute value. As set forth in Equation 16, a is the magnitude of the cos 2ωt term of M<sub>1</sub>(t) when the magnitude of the cos ωt term of M<sub>1</sub>(t) is normalized to <b>1</b>. Similarly, from Equation 17, B is the magnitude of the cos 2ωt term of D<sub>1</sub>(t) when the cos ωt term of D<sub>1</sub>(t) is normalized to 1.</p>
    <p num="p-0077">It should be understood that both D<sub>1</sub>(t) and D<sub>2</sub>(t) can include higher harmonic terms; however, such additional terms could result in increased sensitivity to the noise of fluorescent lights and the like because of the harmonics of the 60 Hz power line frequency (or the 50 Hz power line frequency in other countries). For example, <figref idrefs="DRAWINGS">FIG. 5</figref> illustrates an exemplary spectrum of the first and second harmonics of the present invention when the fundamental frequency is selected to be 316.7 Hz. Thus, the first harmonic frequency is 633.4 Hz. Note that the variations in the signals caused by blood flow throughout a cardiac cycle causes the fundamental and harmonics of modulation frequency to be surrounded by sidebands representing the frequency content of the plethysmograph. For example, in <figref idrefs="DRAWINGS">FIG. 5</figref>, the first and second harmonics are at 316.7 Hz and 633.4 Hz, ±10 Hz.</p>
    <p num="p-0078">As further illustrated in <figref idrefs="DRAWINGS">FIG. 5</figref>, the conventional 60 Hz power line frequency has harmonics at 120 Hz, 180 Hz; <b>240</b>, etc. Thus, the nearest harmonics of the power line frequency to the first harmonic of the present invention are at 300 Hz and 360 Hz, and the nearest harmonics of the power line frequency to the second harmonic of the present invention are 600 Hz. and 660 Hz. Similarly, if used in a country having a 50 Hz power line frequency, the nearest harmonics to the first harmonic of the present invention are 300 Hz and 350 Hz, and the nearest harmonics to the second harmonic of the present invention are 600 Hz and 650 Hz. Even if the power frequency were to vary by up to 1.5 percent, the noise generated by the ambient light from fluorescent lamps, or the like, would not be at the first and second harmonic frequencies of the present invention. The fundamental frequency has thus been selected to avoid power line caused ambient noise at the first and second harmonic frequencies.</p>
    <p num="p-0079">The foregoing discussion assumed that the filter <b>198</b> did not significantly affect the amplitude of the filtered signal. If the filter <b>198</b> does have an affect on the amplitude, then B will be a constant times the value of B determined above:
<br> <i>B=k/a</i>  (30)<br>
where k depends on the relative attenuation of the first harmonic and the second harmonic through the filter <b>198</b>.
</p>
    <p num="p-0080">Although the value of the coefficient B can be calculated as set forth above, the calculations may be complicated if the filter <b>198</b> or the modulators <b>190</b>, <b>192</b> introduce phase changes which cause the calculations to be performed on complex numbers. For example, if the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t) are not rectangular waves which have 25% duty cycles and which are precisely 180° out of phase, as illustrated herein, then the coefficients of the frequency components of the modulation signals may be complex to account for the phase relationships, and thus, the coefficients of the demodulation signals may be complex.</p>
    <p num="p-0081">As illustrated in <figref idrefs="DRAWINGS">FIG. 6</figref>, the value of B can also be determined empirically by performing a initial measurement with one channel (i.e., either the red pulse or the infrared pulse turned off) and minimizing the crosstalk. In particular, during the initial measurement, the waveform <b>140</b> in <figref idrefs="DRAWINGS">FIG. 2</figref> is set to a continuous zero value so that no infrared pulses are generated. Thus, the detector <b>150</b> (<figref idrefs="DRAWINGS">FIG. 1</figref>) receives only the light generated by the red LED <b>106</b>. Thus, M<sub>2</sub>(t) is set to zero, and Equation 10 for Ŝ<sub>2</sub>(t) becomes:
<br> <i>Ŝ</i> <sub>2</sub>(<i>t</i>)=<i>LP[S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)<i>D</i> <sub>2</sub>(<i>t</i>)]  (31)<br>
It can be seen that Ŝ<sub>2</sub>(t) includes only a crosstalk portion, which can be measured on the output from the second lowpass filter <b>222</b>. Thus, by varying the value B while monitoring the magnitude or the RMS (root-mean-squared) value of the output signal Ŝ<sub>2</sub>(t), a minimum magnitude Ŝ<sub>2</sub>(t)<sub>min</sub>, for the output signal Ŝ<sub>2</sub>(t) can be found which corresponds to the best value B<sub>BEST </sub>for B. In an ideal system, the best value for B corresponds to a zero value for the output signal Ŝ<sub>2</sub>(t); however, in a real environment, the best value of B may correspond to a non-zero value for Ŝ<sub>2</sub>(t) (i.e., a minimum error for Ŝ<sub>2</sub>(t)). It should be understood that the value of B<sub>BEST </sub>can also be determined by turning off the red LED <b>106</b> and varying B while monitoring Ŝ<sub>1</sub>(t) until Ŝ<sub>1</sub>(t) is minimized.
</p>
    <p num="p-0082">From the foregoing, it can be seen that the effect of the modulation signals D<sub>1</sub>(t) and D<sub>2</sub>(t) is to shift the DC or near-DC noise terms up in frequency while shifting the signals of interest at the harmonics back to DC or near-DC, which in effect interchanges the noise spectra and the signal spectra so that the noise spectra can be eliminated by the action of the lowpass filters <b>220</b>, <b>222</b>, leaving only the signals of interest.</p>
    <p num="p-0083"> <figref idrefs="DRAWINGS">FIG. 7</figref> illustrates a preferred embodiment of the present invention which implements the functions described above in a digital system. Preferably, the digital system comprises a digital signal processor (not shown), and the blocks described herein comprise data structures within the digital signal processor and software routines that implement the processes described below. In particular, the present invention comprises an LED demodulation block <b>300</b> which receives a digital configuration signal on a bus <b>310</b>, a clock signal on a line <b>312</b> and a digital detector signal on a bus <b>314</b> as inputs. The digital configuration signal bus <b>310</b> provides a way to change the configuration of the LED demodulation block <b>300</b> to accommodate different LEDs and different detection algorithms. Preferably, the clock signal on the line <b>312</b> is 'a 46,875 Hz (46.875 kHz) square wave signal which is used to synchronize the timing functions of the present invention. The digital detector signal on the line <b>314</b> is the output of the analog-to-digital converter <b>199</b>. The analog-to-digital converter <b>199</b> is connected to the output of the detector <b>150</b> (via the amplifier <b>197</b> and the filter <b>198</b>) and samples the output of the detector <b>150</b> at 46,875 samples per second to provide a stream of sampled digital values of the red light and infrared light incident on the detector <b>150</b>.</p>
    <p num="p-0084">The LED modulation block <b>300</b> generates a demodulated red signal output on a bus <b>340</b> and generates a demodulated infrared signal output on a bus <b>342</b>. The demodulated red signal output is passed through the low pass filter <b>220</b> and is output therefrom as the signal Ŝ<sub>1</sub>(t). The demodulated infrared signal output is passed through the low pass filter <b>222</b> and is output therefrom as the signal Ŝ<sub>2</sub>(t). As further illustrated in <figref idrefs="DRAWINGS">FIG. 8</figref>, the LED demodulation block <b>300</b> comprises a modulo-M block <b>350</b>, an LED demodulation state table block <b>352</b>, the first demodulating multiplier <b>210</b> and the second demodulating multiplier <b>212</b>.</p>
    <p num="p-0085">The modulo-M block <b>350</b> receives the main 46,875 Hz clock signal on the line <b>312</b> as one input and receives a MODULUS signal on a bus <b>354</b> as a second input. The bus <b>354</b> forms a portion of the configuration bus <b>310</b>. The modulo-M block <b>350</b> divides the clock signal by the MODULUS signal and generates a RESIDUE signal (described below) on a bus <b>356</b> which is provided as one input to the LED modulation state table block <b>352</b>. The LED modulation state table block <b>352</b> also receives the configuration signals on the configuration bus <b>310</b>.</p>
    <p num="p-0086">The LED demodulation state table is responsive to the residue signal and the configuration signals to generate the first demodulating signal D<sub>1</sub>(t) on a bus <b>360</b> and to generate the second demodulating signal D<sub>2</sub>(t) on a bus <b>362</b>. The first demodulating signal D<sub>1</sub>(t) is provided as one input to the first demodulating multiplier <b>210</b>, as described above. The second demodulating signal D<sub>2</sub>(t) is provided as one input to the second demodulating multiplier <b>212</b>, as described above. The first demodulating multiplier <b>210</b> and the second demodulating multiplier <b>212</b> receive the digital detector signal on the line <b>314</b> as respective second inputs. The demodulating multipliers <b>210</b>, <b>212</b> multiply the digital detector signal by the first demodulating signal D<sub>1</sub>(t) and the second demodulating signal D<sub>2</sub>(t), respectively, to generate a demodulated red signal and a demodulated infrared signal on the buses <b>340</b> and <b>342</b>, respectively. Because the outputs of the two demodulating multipliers <b>210</b> and <b>212</b> include the terms cos ωt, cos 2ωt, and higher, the demodulated signals on the buses <b>340</b> and <b>342</b> are provided as respective inputs to the low pass filters <b>220</b> and <b>222</b> to pass only the near-DC terms, as discussed above. The outputs of the lowpass filters <b>220</b> and <b>222</b> on the buses <b>344</b> and <b>346</b>, respectively, are the Ŝ<sub>1</sub>(t) signal and the Ŝ<sub>2</sub>(t) signal which contain only the near-DC terms, which, in accordance with the discussion presented above represent the original input signals S<sub>1</sub>(t) and S<sub>2</sub>(t) with the unwanted noise substantially reduced or eliminated. The two signals Ŝ<sub>1</sub>(t) and Ŝ<sub>2</sub>(t) are then applied to computation circuitry (not shown) which computes the blood oxygen saturation and other cardiographic parameters in a manner described in the above-cited U.S. Pat. Nos. 5,482,036 and 5,490,505.</p>
    <p num="p-0087">The residue signal generated as the output from the modulo-M block <b>350</b> is a multiple bit signal that counts from 0 to MODULUS-1. In the preferred embodiment described herein, MODULUS has a value of 148. Thus, the RESIDUE output of the modulo-M block <b>350</b> counts from 0 to 147. The RESIDUE output of the modulo-M block <b>350</b> is a number that is provided as the input to the LED demodulation state table block <b>352</b>. As illustrated in <figref idrefs="DRAWINGS">FIG. 9</figref>, the RESIDUE output on the bus <b>356</b> corresponds to the signal <b>180</b> in <figref idrefs="DRAWINGS">FIG. 1</figref> and is also provided to the input of an LED modulation state table block <b>370</b> which, together with an LED driver circuit <b>372</b>, comprise the modulation block <b>104</b> (<figref idrefs="DRAWINGS">FIG. 1</figref>) which generates the drive signals to the red LED <b>106</b> and the infrared LED <b>108</b>. As described above, the red LED <b>106</b> and the infrared LED <b>108</b> generate the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t), respectively, which effectively operate as carriers for the plethysmograph waveform to be measured. In particular, as illustrated by a red drive timing waveform <b>374</b> and by a infrared drive timing waveform <b>376</b> in <figref idrefs="DRAWINGS">FIG. 10</figref>, the modulation state table block <b>370</b> generates a red signal pulse <b>378</b> during the time when the RESIDUE signal increments from 0 to 36. Then, the modulation state table block <b>370</b> generates neither a red signal pulse nor an infrared signal pulse during the time when the RESIDUE signal increments from 37 to 73. Then, the modulation state table block <b>370</b> generates the infrared signal pulse <b>380</b> during the time when the RESIDUE signal increments from 74 to 110. Then, the modulation state table block <b>370</b> again generates neither a red signal pulse nor an infrared signal pulse during the time when the RESIDUE signal, increments from 111 to 147. The RESIDUE signal then resets to 0 and the process repeats continuously.</p>
    <p num="p-0088">The red signal pulse <b>378</b> and the infrared signal pulse <b>380</b> from the modulation state table block <b>370</b> are provided as inputs to the LED driver circuit <b>372</b> which turns on the red LED <b>106</b> when the red signal pulse <b>376</b> is active and turns on the infrared LED <b>108</b> when the infrared signal pulse <b>378</b> is active by generating the current waveform <b>120</b> illustrated in <figref idrefs="DRAWINGS">FIG. 2</figref>. The circuitry for converting the red signal pulse <b>376</b> and the infrared signal pulse <b>378</b> to the bi-directional current pulses of the waveform <b>120</b> is conventional and does not need to be described herein.</p>
    <p num="p-0089">In the preferred embodiment, the LED demodulation state table block <b>352</b> implements demodulation equations which generally correspond to the Equations 17 and 19 described above. In particular, the LED demodulation state table block <b>352</b> receives the RESIDUE as. one input to the state table and steps through the state table based upon the current value of the RESIDUE. The LED demodulation state table block <b>352</b> generates two output values for each value of the RESIDUE, wherein the first output value is the first demodulation signal D<sub>1</sub>(t) on the signal bus <b>360</b>, and the second output value is the second demodulation signal D<sub>2</sub>(t) on the signal bus <b>362</b>.</p>
    <p num="p-0090">In particular, the LED demodulation state table block <b>352</b> implements the following forms of the demodulation signal D<sub>1</sub>(t) and the D<sub>2</sub>(t) equations:</p>
    <p num="p-0091">
      <maths id="MATH-US-00005" num="00005"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>D</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <mo>-</mo> <mrow> <mi>SCL</mi> <mo>(</mo> <mrow> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>[</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>R</mi> <mo>-</mo> <mn>18.5</mn> <mo>-</mo> <mrow> <mi>HW</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>Δ</mi> </mrow> </mrow> <mi>Modulus</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> <mo>+</mo> </mrow> </mrow> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi> </mi> <mo>⁢</mo> <mrow> <mi>HWD</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>[</mo> <mrow> <mn>4</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>R</mi> <mo>-</mo> <mn>18.5</mn> <mo>-</mo> <mrow> <mi>HW</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>Δ</mi> </mrow> </mrow> <mi>Modulus</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mi>and</mi> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>32</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>D</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <mo>-</mo> <mrow> <mi>SCL</mi> <mo>(</mo> <mrow> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>[</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>R</mi> <mo>-</mo> <mn>18.5</mn> <mo>-</mo> <mrow> <mi>HW</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>Δ</mi> </mrow> </mrow> <mi>Modulus</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> <mo>-</mo> </mrow> </mrow> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi> </mi> <mo>⁢</mo> <mrow> <mi>HWD</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>cos</mi> <mo>⁡</mo> <mrow> <mo>[</mo> <mrow> <mn>4</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mfrac> <mrow> <mi>R</mi> <mo>-</mo> <mn>18.5</mn> <mo>-</mo> <mrow> <mi>HW</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>Δ</mi> </mrow> </mrow> <mi>Modulus</mi> </mfrac> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </mtd> <mtd> <mrow> <mo>(</mo> <mn>33</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> </p>
    <p num="p-0092">In Equations 32 and 33, the value SCL is a scale factor which determines the magnitudes is of the two demodulation signals and which is used to compensate for the normalization discussed above and to compensate for other factors; such as, for example, non-ideal rectangular pulses. The method of determining the scale factor will be set forth below. In one particularly preferred embodiment, the value of SCL is 2.221441469. The value HWD is a hardware distortion factor, which corresponds to the value of B discussed above. The determination of the value B was described above, and will be described again below in connection with this preferred embodiment. In one particularly preferred embodiment where the pulses applied to the red LED <b>106</b> and the infrared LED <b>108</b> are idealized rectangular waves having 25% duty cycles, the value of HWD can be calculated to be 1.414213562. This ideal value for HWD can be determined by recognizing that the value of the coefficient A for the cos 2ωt terms in Equations 16 and 18 is determined by the sine function. When the coefficient of the cos ωt term is normalized to 1, as in the two equations, then the value of the coefficient a is equal to √{square root over (2/2)}. Thus, the ideal value for B (i.e., HWD) is √{square root over (2)}. Of course, the actual value of the coefficient B, and thus HWD, will vary when the red pulses and the infrared pulses are not true rectangular waves. Since, in actual embodiments, the pulses will have finite rise times and fall times, the optimum value of HWD is preferably found empirically in the manner described below.</p>
    <p num="p-0093">The value 18.5 in Equations 32 and 33 is used to align the demodulation waveforms with the modulation waveforms so that the peak of the cosine functions corresponds to the midpoints of each of the modulation waveforms. The value HWΔ is a hardware delay factor which may be needed in certain embodiments to compensate for delays in the analog processing, the digital processing or both, which cause the demodulation signals D<sub>1</sub>(t) and D<sub>2</sub>(t) to be out of phase with the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t). In an ideal environment, the value of the hardware delay factor is 0. However, in one particularly preferred embodiment, the value of the hardware delay factor is 39. The modulus was described above and is basically the number of steps in each period of the waveforms. In the embodiment described herein, the modulus is 148. The value R is the RESIDUE, which varies from 0 to modulus-1, and thus, in the preferred embodiment, R varies from 0 to 147.</p>
    <p num="p-0094">In operation, the clock signal on the line <b>312</b> causes the modulo-M block <b>350</b> to generate the RESIDUE signal, as described above. The RESIDUE value is applied to the LED modulation block <b>104</b> which generates the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t), as described above. The RESIDUE value is also applied to the LED demodulation state table block <b>352</b> which generates a new value for D<sub>1</sub>(t) and a new value for D<sub>2</sub>(t) for each new RESIDUE value. Thus, 148 values of D<sub>1</sub>(t) and D<sub>2</sub>(t) are generated for each complete cycle. Because the clock signal is operating at 46,875 Hz, the modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t) and the demodulation signals D<sub>1</sub>(t) and D<sub>2</sub>(t) have a fundamental frequency of 316.722973 Hz, which, as discussed above, does not correspond to any harmonic of conventional 50 Hz or 60 Hz power line frequencies.</p>
    <p num="p-0095">The HWΔ (hardware delay factor) value, the HWD (hardware distortion factor) value and the SCL (scaling factor) value are found empirically as follows. First, the ideal values of the hardware delay factor, the hardware distortion factor and the scale factor are applied to the Equations 32 and 33 in the LED demodulation state table block <b>352</b> (i.e., HWΔ=0, HWD=1.414213562, and SCL=2221441469). To determine the optimum value of the hardware delay factor, the second modulation signal M<b>2</b>(<i>t</i>) is set to a constant value of zero (i.e., the infrared LED is maintained in its OFF state). The red LED pulses are applied as set forth above, and the digital detector output signal from the analog-to-digital converter is monitored and compared to the modulation signal MI(t). The relative delay between the beginning of the modulation signal M<b>1</b>(<i>t</i>) and the detection of the beginning of the responsive output from the analog-to-digital converter is the optimum hardware delay factor (HWΔ) value. In one exemplary embodiment, the optimum value of the hardware delay factor is 39.</p>
    <p num="p-0096">After determining the value of the hardware delay factor and applying it to Equations 32 and 33, the ideal value of the hardware distortion factor and the ideal value of the scale factor are applied to the two equations. Again, with the red LED pulses applied to the red LED <b>106</b> and no pulses applied to the infrared LED, the value of the hardware distortion factor is slowly varied from its ideal value while the DC component of the demodulated infrared signal output on the line <b>342</b> is monitored. The value of the hardware distortion factor is varied until the measured DC component is minimized, and the value of the hardware distortion factor corresponding to the minimal DC component is selected as the optimum value for the hardware distortion factor.</p>
    <p num="p-0097">Next, with the value of the hardware delay factor and the value of the hardware distortion factor set to their respective optimum values, as determined above, the value of the scale factor (SCL) is initially set to 1. Again, with the modulation system generating pulses only to the red LED <b>106</b>, the DC component of the demodulated red signal output on the line <b>340</b> is measured. In addition, the difference in amplitude between the on state and the off state of the digital detector signal from the filter <b>198</b> is measured. The ratio of the measured amplitude difference to the measured DC component of the demodulated red signal output is selected as the optimum value for the scale factor.</p>
    <p num="p-0098">An exemplary demodulation waveform D<sub>1</sub>(t) is illustrated by a waveform <b>400</b> in <figref idrefs="DRAWINGS">FIG. 11</figref> and an exemplary demodulation waveform D<sub>2</sub>(t) is illustrated by a waveform <b>402</b> in <figref idrefs="DRAWINGS">FIG. 11</figref>. The demodulation waveforms in <figref idrefs="DRAWINGS">FIG. 11</figref> are illustrated with the hardware delay factor set to 0 in order to align the waveforms with the modulation waveforms in <figref idrefs="DRAWINGS">FIG. 10</figref>. It should be understood that when the hardware delay factor is non-zero, the demodulation waveforms in <figref idrefs="DRAWINGS">FIG. 11</figref> will be shifted in phase with respect to the modulation waveforms in <figref idrefs="DRAWINGS">FIG. 10</figref>.</p>
    <p num="p-0099">Although described above in connection with the variation of the amplitude of the first harmonic component of the demodulation signals in order to minimize the crosstalk, it should be understood that the relative amplitude of the second harmonic component of the demodulation signals with respect to the amplitude of the fundamental component of the demodulation signals is determined by the relationship of the amplitude of the first harmonic component of the modulation signals to the amplitude of the fundamental component of the modulation signals. The relationship of the amplitude of the first harmonic component of the modulation signals depends in part upon the duty cycles of the modulation signals. If the modulation duty cycles are varied, the amplitude of the first harmonic component of the modulation signals changes. Thus, the crosstalk may also be minimized by holding the amplitudes of the components of the demodulation signals constant while varying the duty cycles of the modulation signals. One skilled in the art will appreciate that other variations in the modulation and demodulation signals may also be used to minimize the crosstalk between the two output signals.</p>
    <p num="p-0100">A plurality of signals S<sub>1</sub>, S<sub>2</sub>, S<sub>3 </sub>. . . S<sub>n </sub>can be demodulated and the crosstalk between signals reduced to a minimum by application of the foregoing invention to more. than two signals.</p>
    <p num="p-0101">Additional information can advantageously be derived from the digitized detection signal on the bus <b>314</b> and can be used to provide indications regarding the reliability of the demodulated signals generated as described above. In particular, although the present system is capable of demodulating the Ŝ<sub>1</sub>(t) signal and the Ŝ<sub>2</sub>(t) signal in the presence of significant ambient noise from light and other sources, it is possible that the level of the ambient noise is sufficiently high to affect the demodulated signals. <figref idrefs="DRAWINGS">FIGS. 12 and 13</figref> illustrate a time domain method and system for determining the ambient noise level, and <figref idrefs="DRAWINGS">FIGS. 14 and 15</figref> illustrate a frequency domain method and system for determining the ambient noise level.</p>
    <p num="p-0102">As illustrated in <figref idrefs="DRAWINGS">FIG. 12</figref>, the digital detection signal <b>152</b> is sampled by a sample signal represented by a waveform <b>500</b>, which comprises a plurality of sampling pulses <b>502</b>. The sampling pulses <b>502</b> are timed to occur during the intervals between the red pulses <b>134</b>, <b>136</b> and the infrared pulses <b>142</b>, <b>144</b> when no red light and no infrared light should be detected by the detector <b>150</b> (<figref idrefs="DRAWINGS">FIG. 1</figref>). Thus, any energy detected during the sample intervals is primarily caused by ambient light and other noise sources. As illustrated, the sampling pulses <b>502</b> preferably occur at the approximate midpoint of each interval between the red and infrared pulses.</p>
    <p num="p-0103">As illustrated in <figref idrefs="DRAWINGS">FIG. 13</figref>, the digital detection signal bus <b>314</b> is provided as an input to a time domain sampler <b>520</b>. The time domain sampler <b>520</b> also receives the RESIDUE signal on the bus <b>356</b> as a second input. The time domain sampler is responsive to the RESIDUE signal to sample the digital detection signal at times when the value of the RESIDUE signal corresponds to the quiescent times of the red pulses <b>134</b>,<b>136</b> and the infrared pulses <b>142</b>, <b>144</b>. As described above, the red pulses <b>134</b>, <b>136</b> are generated when the RESIDUE signal has values between 0 and 36, and the infrared pulses are generated when the RESIDUE signal has values between 74 and 110. Thus, assuming no hardware delay, the sampling pulses <b>502</b> are preferably generated, for example, when the RESIDUE signal has a value of 55 and when the RESIDUE signal has a value of 129, which positions the sampling pulses at the approximate midpoints of the quiescent intervals between the pulses. As discussed above, the actual system has a hardware delay caused by processing times. Thus, if the system has a hardware delay factor of, for example, 39, the sampling pulses <b>502</b> are shifted in time to occur when the RESIDUE signal has a value of 94 and a value of 20 (168 modulo <b>14</b> <i>g</i>). The sample times used by the time domain sampler <b>520</b> are advantageously determined by configuration signals received via the digital configuration bus <b>310</b>, described above. For example, the time domain sampler <b>520</b> can be initially set to sample at RESIDUE signal values of 55 and 129, and the value of the hardware delay value factor (HWΔ) communicated by the digital configuration bus <b>310</b> is added to both values to shift the sample to the correct sample interval.</p>
    <p num="p-0104">As illustrated in <figref idrefs="DRAWINGS">FIG. 14</figref>, a detection signal spectra <b>550</b> includes the two frequency components corresponding to the fundamental and first harmonic of the modulation signal at 316.7 Hz and 633.4 Hz, respectively. The spectra <b>550</b> further includes the fundamental and multiple harmonics of the 60 Hz power line frequency. In addition, the spectra <b>550</b> includes noise at a multitude of frequencies which may be caused by various sources. One particularly troublesome source of noise encountered in pulse oximetry systems is an electrocauterization device, which uses a high frequency electrical current to make surgical incisions and to cauterize the surrounding blood vessels at the same time. Although primarily high frequency noise sources, such devices also generate significant noise at lower frequencies because of arcing. When an electrocauterization device is operated close to a pulse oximeter detector, the noise generated by the device can overwhelm the signals generated by the pulse oximetry detector. In other words, the noise floor can be greater than the detectable signal from the pulse oximetry detector.</p>
    <p num="p-0105">It is desirable to detect when the noise floor is too high so that the pulse oximetry system can indicate that the demodulated signals may not be reliable. In order to determine the level of the noise floor, the present invention samples the spectra <b>550</b> to determine the content of the frequency components detected at frequencies other than the fundamental and harmonic frequencies of the modulation signals. In particular, as illustrated by a sample control signal <b>560</b> in <figref idrefs="DRAWINGS">FIG. 14</figref>, the portions of the spectra <b>550</b> which do not include the fundamental and harmonics of the modulation signal are sampled. Thus, in the preferred embodiment, the magnitudes of the spectra at 316.7 Hz, 633.4 Hz, 950.1 Hz, etc., are not sampled. Furthermore, because a band of frequencies around the fundamental and harmonics of the modulation signal also include significant information caused by the modulation of the red pulses and the infrared pulses by the changes in blood flow during each cardiac cycle. Thus, as illustrated in <figref idrefs="DRAWINGS">FIG. 14</figref>, in the preferred embodiment, a band of frequencies surrounding the fundamental and harmonic frequencies of the modulation signals (i.e., the sidebands discussed above) are not included in the samples. For example, a band of at least ±10 Hz around each of the fundamental and harmonic frequencies is not included in the samples.</p>
    <p num="p-0106">The intensities at the sampled frequencies are averaged, and an output signal is generated which represents the average intensity of the noise signals. Other portions (not shown) of the digital processing system advantageously monitor the average intensity of the noise signals, and, if the average intensity exceeds a selected threshold based upon the size of the measured plethysmograph, then the demodulated output signals from the system are considered as being unreliable and should not be used.</p>
    <p num="p-0107"> <figref idrefs="DRAWINGS">FIG. 15</figref> illustrates a preferred embodiment of a system that determines the noise floor, as described above. The system of <figref idrefs="DRAWINGS">FIG. 15</figref> includes a Fast Fourier Transform block <b>600</b> which receives a plurality of samples from the digitized detector bus <b>314</b> and generates a transformed output on a bus <b>610</b>. The transformed output on the bus <b>610</b> represents the spectra of the samples. In the preferred embodiment, a sufficient number of samples are taken to represent approximately 44 milliseconds of data so that at least two cycles of the 60 Hz power are included within the samples. For example, approximately 1,024 samples can be taken during the 44-millisecond interval at a sample rate of approximately 23.4 kHz (e.g., one-half the system timing rate). The spectra for a 44-millisecond interval are provided as inputs to a spectral sampler <b>620</b> which eliminates the samples in the ±10 Hz bands around the fundamental and harmonic frequencies of the modulation signals. The output of the spectral sampler <b>620</b> is provided on a bus <b>630</b> and is thereby provided as an input to an averager <b>640</b>. The averager <b>640</b> averages the sampled noise (spectra which it receives and provides an averaged output on a bus <b>650</b>. The averaged output on the bus <b>650</b> represents the noise floor and is provided to other portions of the digital processing system where it is compared to the selected threshold to determine whether the noise floor is excessive. The threshold is not necessarily fixed, but is dependent on the strength of the plethysmograph, which in turn depends upon the perfusion of blood in the body portion being measured.</p>
    <p num="p-0108">The embodiment of <figref idrefs="DRAWINGS">FIG. 15</figref> can also advantageously be used to determine whether the ambient noise is primarily at 60 Hz, corresponding to power line frequencies in the United States and Canada, or at 50 Hz, corresponding to power line frequencies in Europe. The foregoing modulation frequency of 316.7 Hz is selected to avoid the harmonics of the 60 Hz power line frequency as well as the 50 Hz power line frequency. If a significant shift in the power line frequency is detected such that aliasing of the ambient noise occurs at the frequencies of interest, then the modulation frequency can be changed to displace the modulation harmonics farther from the harmonics of the power line frequency, such as, for example, by changing the 46,875 Hz sampling frequency, or by changing the modulus.</p>
    <p num="h-0006">Pre-Demodulation Decimation</p>
    <p num="p-0109">For convenience, the previous embodiments do not show the signal MF(k) being decimated before demodulation. However, as discussed in more detail below, the signal MF(k) can advantageously be decimated prior to demodulation. The pre-demodulation decimation technique can reduce the computational burden required to perform the demodulation operations, primarily because the decimated sample rate is lower than the original (undecimated) sample rate. Computation can also be reduced because, as will be seen, the numerical sequences used in the demodulator are, in some circumstances, shorter than the sequences given in Equations 32 and 33. Pre-demodulation decimation is a generalization of the previous embodiments and reduces to the previous embodiments when the pre-demodulation decimation rate is one.</p>
    <p num="p-0110"> <figref idrefs="DRAWINGS">FIG. 16</figref> is a pictorial representation of a system that incorporates pre-demodulation filtering and decimation. <figref idrefs="DRAWINGS">FIG. 16</figref> is similar to <figref idrefs="DRAWINGS">FIG. 3</figref>, and like numbers refer to like elements in the two figures. <figref idrefs="DRAWINGS">FIG. 16</figref> shows the first modulator <b>191</b> having a signal input S<sub>1</sub>(t) and a modulation input M<sub>1</sub>(t). The second modulator <b>193</b> has a signal input S<sub>2</sub>(t) and a modulation input M<sub>2</sub>(t). The pair of signals S<sub>1</sub>(t) and S<sub>2</sub>(t) represent the effect of the time-varying volume and scattering components of the blood in a finger (or other body part) on the red light and the infrared light, respectively, passing through the finger. The red light signal portion S<sub>1</sub>(t) is caused by the variable attenuation of the red light passing through the finger <b>102</b> (shown in <figref idrefs="DRAWINGS">FIG. 1</figref>). The infrared light signal portion S<sub>2</sub>(t) is caused by the variable attenuation of the infrared light passing through the finger <b>102</b>. The outputs of the first and second modulators <b>191</b>,<b>193</b> are provided to the receiving photodetector <b>150</b>. The photodetector <b>150</b> is modeled as an adder <b>194</b> and an adder <b>196</b>. The outputs of the first and second modulators <b>191</b>, <b>193</b> are provided to the adder <b>194</b> to generate a composite signal M(t) where:
<br> <i>M</i>(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)+<i>S</i> <sub>2</sub>(<i>t</i>))<i>M</i> <sub>2</sub>(<i>t</i>)).  (34)</p>
    <p num="p-0111">The output signal M(t) from the adder <b>194</b> is provided to an adder <b>196</b> where a signal n(t) is added to the signal M(t). The signal n(t) represents a composite noise signal caused by ambient light (including DC and harmonics of the power line frequency), electromagnetic pickup, and the like, which are also detected by the photodetector <b>150</b>. In addition, the signal n(t) may also include noise at higher frequencies caused, for example, by other devices such as electrocauterization equipment, or the like. The output of the adder <b>196</b> is a signal M′(t)=M(t)+n(t) which includes noise components as well as the signal components.</p>
    <p num="p-0112">The M′(t) signal output of the adder <b>196</b> (i.e., the output of the detector <b>150</b>) is applied to the input of a signal processing block <b>1600</b>. Within the signal processing block <b>1600</b>, the signal M′(t) is first passed through the amplifier <b>197</b> and then through the analog bandpass filter <b>198</b>. The analog bandpass filter <b>198</b> provides anti-aliasing and removal of low frequency noise and DC. The filter <b>198</b> has a passband selected to pass signals in the preferred range of 20 Hz to 10,000 Hz. The analog bandpass filter .<b>198</b> removes a significant portion of the noise below 20 Hz. The signal components responsive to the blood oxygen saturation are frequency shifted by the operation of the two modulation signals M<sub>1</sub>(t) and M<sub>2</sub>(t) and are passed by the analog bandpass filter <b>198</b>.</p>
    <p num="p-0113">In one embodiment, the output of the analog bandpass filter <b>198</b> is sampled by the analog-to-digital converter <b>199</b> and converted therein to digital signals. In one embodiment, the signals are sampled at 46,875 samples per second. The digital signals from the analog-to-digital converter <b>199</b> are provided as inputs to a lowpass digital filter <b>1620</b>. Output signals from the digital filter <b>1620</b> are provided to a sample rate compression block <b>1622</b> that reduces (compresses) the sample rate by a decimation rate R<sub>1</sub>. The lowpass digital filter <b>1620</b> and sample rate compressor <b>1622</b> together comprise a decimator <b>1621</b> (decimation comprises lowpass filtering followed by sample rate compression). The digital filter <b>1620</b> provides anti-aliasing filtering and the sample rate compression block <b>1622</b> preferably operates at a sampling rate of at least twice the highest frequency of interest as determined by the digital filter <b>1</b>.<b>620</b>. In one embodiment, the sample rate compression block <b>1622</b> reduces the sample rate by a factor of R<sub>1</sub>=37, corresponding to the number of samples during the period τ as illustrated in <figref idrefs="DRAWINGS">FIG. 10</figref>. The output of the sample rate compression block <b>1622</b> provides one sample per time period τ and thus four samples per time period T. The output of the sample rate compression block <b>1622</b> is a signal MF(k) (where k is a discrete index) which comprises approximately 1,266 samples per second.</p>
    <p num="p-0114">The signal MF(k) is provided as a first input to a first mixer <b>1624</b>. The signal MF(k) is also provided as a first input to a second mixer <b>1626</b>. A first demodulating signal D<sub>1</sub>(k) is provided as a second input to the first mixer <b>1624</b>, and a second demodulating signal D<sub>2</sub>(k) is provided as a second input to the second mixer <b>1626</b>. The output of the first mixer <b>1624</b> is provided as an input to a first lowpass filter <b>1630</b>, and the output of the second mixer is provided as an input to a second lowpass filter <b>1640</b>. The bandwidths of the lowpass filters <b>1630</b>, <b>1640</b> are preferably approximately 10 Hz. The signal MF(k) is also provided as a first input to a noise channel mixer <b>1628</b>. A noise demodulating signal D<sub>o</sub>(k) is provided as a second input to the noise channel mixer <b>1628</b>. The output of the low pass filter <b>1650</b> is provided to a sample rate compression block <b>1652</b>. The output of the sample rate compression block <b>1652</b> is an estimate of the noise n(t). The output of the lowpass filters <b>1630</b> is provided to an input of a sample rate compressor <b>1632</b> and the output of the lowpass filter <b>1640</b> is provided to an input of a sample rate compressor <b>1642</b>. The lowpass filter <b>1630</b> and the sample rate compressor <b>1632</b> together comprise a decimator <b>1631</b>. The lowpass filter <b>1640</b> and the sample rate compressor <b>1642</b> together comprise a decimator <b>1641</b>,</p>
    <p num="p-0115">The output of the decimator <b>1631</b> is a signal Ŝ<sub>1</sub>(k), which, as discussed below, is an estimate of the signal S<sub>1</sub>(k). The output of the decimator <b>1641</b> is a signal Ŝ<sub>1</sub>(k), which, as discussed below, is an estimate of the signal S<sub>2</sub>(k). As will be shown below, the selection of the first demodulating signal D<sub>1</sub>(k) and the second demodulating signal D<sub>2</sub>(k) in accordance with the present invention can reduce or eliminate the effects of noise in the two output signals Ŝ<sub>1</sub>(k) and Ŝ<sub>2</sub>(k) and also reduce or eliminate crosstalk between the two signals.</p>
    <p num="p-0116">The decimators <b>1632</b>, <b>1642</b> decimate by a decimation rate R<sub>2</sub>. In a preferred embodiment, the decimators <b>1632</b>, <b>1642</b> decimate by a decimation rate R<b>2</b>=20 to a sample rate of, for example, 63.3 Hz to provide a decimated output which can be further processed in accordance with the methods and apparatuses described in the above-referenced patents. The decimations which occur in the decimators <b>1632</b>, <b>1642</b> reduce the rate at which the output signals Ŝ<sub>1</sub>(k) and Ŝ<sub>2</sub>(k) need to be processed while maintaining the sample rate well above the 10 Hz frequency content of the signals of interest. The outputs of the decimators <b>1632</b>, <b>1642</b> are provided on respective output lines <b>1634</b> and <b>1644</b>.</p>
    <p num="p-0117">Decimating the signal MF(k) prior to demodulation, although not an approximation technique, can be simplified by assuming that each desired signal S<sub>1</sub>(t) does not change appreciably during each period τ. In many applications it is reasonable to assume that the desired signals S<sub>1</sub>(t) and S<sub>2</sub>(t) will not change significantly during the time interval τ shown in <figref idrefs="DRAWINGS">FIG. 2</figref>. One skilled in the art will recognize that a sufficient condition for this assumption is that the highest significant frequency components in S<sub>1</sub>(t) and S<sub>2</sub>(t) are much lower than the modulation frequency. In the pulse-oximetry application the highest frequency of interest is typically around 10 Hz, which is far below the 316.7 Hz fundamental of the modulation. Since n(t) is not a desired signal, no such assumption is necessary for n(t). Thus, while n(t) may vary erratically over a modulation cycle, the signals S<sub>1</sub>(t)) and S<sub>2</sub>(t) do not. Therefore, it is possible to perform pre-demodulation decimation that has little effect on S<sub>1</sub>(t) and S<sub>2</sub>(t) but may shape n(t) into n′(t). The measured signal is decimated by a factor R<sub>1</sub>=Q (where Q is the number of samples in a time period τ) and then demodulated.</p>
    <p num="p-0118">Assuming R<sub>1</sub>=Q, then the spectral domain representation of the signal MF(k) at the output of the sample rate compression block <b>1622</b> is given by (approximately):</p>
    <p num="p-0119">
      <maths id="MATH-US-00006" num="00006"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mtable> <mtr> <mtd> <mrow> <mrow> <mi>MF</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <mrow> <mfrac> <mn>1</mn> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mrow> <mo>-</mo> <mn>00</mn> </mrow> </mrow> <mi>oo</mi> </munderover> <mo>⁢</mo> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mi>n</mi> <mi>T</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msup> <mrow> <mo>(</mo> <mrow> <mo>-</mo> <mn>1</mn> </mrow> <mo>)</mo> </mrow> <mi>″</mi> </msup> <mo>⁢</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mi>n</mi> <mi>T</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> </mrow> <mo>+</mo> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi> </mi> <mo>⁢</mo> <mrow> <mfrac> <mn>4</mn> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>m</mi> <mo>=</mo> <mrow> <mo>-</mo> <mn>00</mn> </mrow> </mrow> <mi>oo</mi> </munderover> <mo>⁢</mo> <mrow> <msup> <mi>n</mi> <mi>′</mi> </msup> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mrow> <mn>4</mn> <mo>⁢</mo> <mi>m</mi> </mrow> <mi>T</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> </mtr> </mtable> </mtd> <mtd> <mrow> <mo>(</mo> <mn>35</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> </p>
    <p num="p-0120">Since the sample rate compression block <b>1622</b> decimates at the same rate as the number of samples per period τ, the decimation removes any τ dependence in the expression for MF(f). The frequency components indexed by m increase four times faster than the frequency components indexed by n. This occurs because the modulated signals S<sub>1 </sub>(t)) and S<sub>2</sub>(t), which are indexed by n, occur in only one fourth of the samples, but the noise n(t), which is indexed by m, occurs in every sample.</p>
    <p num="p-0121">The demodulation operation can be performed either in the frequency or the time domain. A method for frequency domain demodulation of the signal MF(k) can be obtained by rewriting Equation 35 as:
<br> <i>MF</i>(<i>f</i>)= . . . <i>MF</i> <sub>−2</sub>(<i>f</i>)+<i>MF</i> <sub>−1</sub>(<i>f</i>)+<i>MF</i> <sub>0</sub>(<i>f</i>)+<i>MF</i> <sub>1</sub>(<i>f</i>)+<i>MF</i> <sub>2</sub>(<i>f</i>)+ . . .   (36)<br>
where
</p>
    <p num="p-0122"> <maths id="MATH-US-00007" num="00007"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <mrow> <msub> <mi>MF</mi> <mrow> <mo>-</mo> <mn>2</mn> </mrow> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>MF</mi> <mrow> <mo>-</mo> <mn>1</mn> </mrow> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>MF</mi> <mi>o</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <mn>4</mn> <mo>⁢</mo> <mrow> <msup> <mi>n</mi> <mi>′</mi> </msup> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>MF</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>MF</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>MF</mi> <mn>3</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>-</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <msub> <mi>MF</mi> <mn>4</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <mn>4</mn> <mo>⁢</mo> <mrow> <msup> <mi>n</mi> <mi>′</mi> </msup> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>T</mi> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>37</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
Where n′(k) is the decimated noise signal n(t). Estimates for the signal S<sub>1</sub>(f) can be obtained by shifting the spectra of MF<sub>1</sub>(f) and MF<sub>2</sub>(f) by −1/T and −2/T, respectively, and then dividing the sum of the resultant by 2. Likewise, S<sub>2</sub>(f) can be obtained by dividing the difference of the resultant spectra by 2. In other words:
<br> <i>Ŝ</i> <sub>1</sub>(<i>f</i>)=<i>MF</i> <sub>1</sub>(<i>f−</i>1<i>/T</i>)+<i>MF</i> <sub>2</sub>(<i>f−</i>2<i>/T</i>)<br> <i>Ŝ</i> <sub>2</sub>(<i>f</i>)=<i>MF</i> <sub>1</sub>(<i>f−</i>1<i>/T</i>)+<i>MF</i> <sub>2</sub>(<i>f−</i>2<i>/T</i>)  (38)</p>
    <p num="p-0123">emodulation in the time domain is a more elegant method for obtaining S<sub>1</sub>(k) and S<sub>2</sub>(k). Time domain demodulation is obtained by using the frequency shift property of the Fourier transform given by:
<br> <i>F(ω+ω</i> <sub>o</sub> </p> <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-P00001.png"> <img id="CUSTOM-CHARACTER-00001" he="2.12mm" wi="2.46mm" file="US08150487-20120403-P00001.TIF" alt="Figure US08150487-20120403-P00001" img-content="character" img-format="tif" orientation="portrait" inline="no" src="//patentimages.storage.googleapis.com/US8150487B2/US08150487-20120403-P00001.png" class="patent-full-image" width="9" height="8"> </a> </div> <i>e</i> <sup>−jω0</sup> <sup> <sup2>t</sup2> </sup> <i>f</i>(<i>t</i>))   (39)<br>
According to Equation 39, the frequency domain terms MF<sub>1</sub>(f) are related by a time shift in the time domain and this property can be used to generate the demodulation sequences D<sub>0</sub>-D<sub>2</sub>. A more complete development of this process (for the general case of N channels) is provided in Equations 42-50 below and in the text accompanying those equations. For the present case, where N=2, using equations 42-50 gives:
<br> <i>D</i> <sub>0</sub>(<i>k</i>)=0,1,0,1, . . .<br> <i>D</i> <sub>1</sub>(<i>k</i>)=1,−0.5,0,−0.5, . . .<br> <i>D</i> <sub>2</sub>(<i>k</i>)=0,−0.5,1,−0.5, . . .   (40)<p num="p-0124">The sequences shown in Equation 40 are repeating sequences of the four values shown. Thus, the demodulation waveforms are no more than short repeating sequences of simple coefficients. Since the samples MF(k) are time domain sequences, demodulation simply involves multiplying the samples MF(k) by the sequences in Equation 40. For example, the sequence of coefficients D<sub>o</sub>(k)=(0, 1, 0, 1, . . . ) is provided to the multiplier <b>1628</b> to demodulate the signal MF(k) and produce the estimate of n(k). Similarly, the sequence of coefficients D<sub>1</sub>(k)=(1, −0.5, 0, −0.5, . . . ) is provided to the multiplier <b>1624</b> to demodulate the signal MF(k) and produce the estimate of S<sub>1</sub>(k).</p>
    <p num="h-0007">Multiple Channel Modulation and Demodulation</p>
    <p num="p-0125">The two-channel pre-demodulation decimation technique described in the previous section can be extended to multi-channel systems having more than two desired signals. <figref idrefs="DRAWINGS">FIG. 17</figref> illustrates an expansion of the two-channel modulator into a multi-channel modulator/demodulator. <figref idrefs="DRAWINGS">FIG. 17</figref> shows the first modulator <b>191</b> and the second modulator <b>193</b> as shown in <figref idrefs="DRAWINGS">FIG. 16</figref>. Further, <figref idrefs="DRAWINGS">FIG. 17</figref> shows a third modulator <b>1701</b> and an N<sup>th </sup>modulator <b>1702</b>. The signal input S<sub>1</sub>(t) and a modulation input M<sub>1</sub>(t) are provided to the first modulator <b>191</b>. The signal input S<sub>2</sub>(t) and a modulation input M<sub>2</sub>(t) are provided to the second modulator <b>193</b>. A signal input S<sub>3</sub>(t) and a modulation input M<sub>3</sub>(t) are provided to the third modulator <b>1701</b>. A signal input S<sub>N</sub>(t) and a modulation input M<sub>N</sub>(t) are provided to the N<sup>th </sup>modulator <b>1702</b>.</p>
    <p num="p-0126">The photodetector <b>150</b> is modeled as an adder <b>194</b> and an adder <b>196</b>. The outputs of the modulators <b>191</b>, <b>193</b>, <b>1701</b>, and <b>1703</b> are added together in the adder <b>194</b>, to generate a composite signal M(t) where:
<br> <i>M</i>(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)+<i>S</i> <sub>2</sub>(<i>t</i>)<i>M</i> <sub>2</sub>(<i>t</i>)+<i>S</i> <sub>3</sub>(<i>t</i>)<i>M</i> <sub>3</sub>(<i>t</i>)+ . . . +<i>S</i> <sub>N</sub>(<i>t</i>)<i>M</i> <sub>N</sub>(<i>t</i>)  (41)</p>
    <p num="p-0127">The signal M(t) from the adder <b>194</b> is provided to the adder <b>196</b> where the signal M(t) is added to the signal n(t) which represents a composite noise signal caused by ambient light, electromagnetic pickup, and the like, which are also detected by the photodetector <b>150</b>. The output of the adder <b>196</b> is the signal M′(t)=M(t)+n(t), which includes the noise components as well as the signal components.</p>
    <p num="p-0128">The M′(t) signal output of the adder <b>196</b> (i.e., the output of the detector <b>150</b>) is applied to the input of the signal-processing block <b>1700</b>. Within the signal-processing block <b>1700</b>, the signal M′(t) is first passed through an amplifier <b>197</b> and then through the analog bandpass filter <b>198</b>. The analog bandpass filter <b>198</b> provides anti-aliasing and removal of low frequency noise and DC. The desired signal components in the signals S<sub>1</sub>{t) are frequency shifted by the operation of the modulation signals M<sub>1</sub>(t) and are passed by the analog bandpass filter <b>198</b>.</p>
    <p num="p-0129">The output of the analog bandpass filter <b>198</b> is sampled by the analog-to-digital converter <b>199</b> and converted therein to digital signals and provided to an input of the lowpass digital filter <b>1620</b>. Output signals from the digital filter <b>1620</b> are provided to a sample rate compression block <b>1622</b>, which reduces the sample rate by a decimation factor R<sub>1</sub>. Together, the digital filter <b>1620</b> and the sample rate compression block <b>1622</b> comprise a decimator <b>1621</b>. The output of the sample rate compression block <b>1622</b> is a signal MF(k). The signal MF(k) is provided as: the first input to the first mixer <b>1624</b>; the first input to the second mixer <b>1626</b>; a first input to a third mixer <b>1710</b>; a first input to an N<sup>th </sup>mixer <b>1712</b>; and a first input to a noise channel mixer <b>1713</b>. A first demodulating signal D<sub>1</sub>(k) is provided as a second input to the first mixer <b>1624</b>. A second demodulating signal D<sub>2</sub>(k) is provided as a second input to the second mixer <b>1626</b>. A third demodulating signal D<sub>3</sub>(k) is provided to the third mixer <b>1710</b>. A fourth demodulating signal D<sub>N</sub>(k) is provided to the N<sup>th </sup>mixer <b>1712</b>. A noise demodulating signal D<sub>o</sub>(k) is provided to the noise channel mixer <b>1713</b>. The outputs of the mixers <b>1624</b>, <b>1626</b>, <b>1710</b>, <b>1712</b>, and <b>1713</b> are provided as respective inputs of the lowpass filters <b>1630</b>, <b>1640</b>, <b>1720</b>, <b>1730</b>, and <b>1740</b>, The outputs of the lowpass filters <b>1630</b>, <b>1640</b>, <b>1720</b>, <b>1730</b>, and <b>1740</b> are provided as respective inputs of the decimators <b>1632</b>, <b>1642</b>, <b>1721</b>, <b>1731</b> and <b>1741</b>. Each of the decimators <b>1632</b>, <b>1642</b>, <b>1721</b>, <b>1731</b> and <b>1741</b> reduces the sample rate by a decimation rate R<sub>2</sub>.</p>
    <p num="p-0130">The output of the sample rate compressor <b>1632</b> is a signal Ŝ<sub>1</sub>(k), which, as discussed below, is an estimate of the signal S<sub>1</sub>(k). Likewise, the output of the sample rate compressor <b>1642</b> is an estimate of S<sub>2</sub>(t), the output of the sample rate compressor <b>1721</b> is an estimate of the signal S<sub>3</sub>(t), the output of the sample rate compressor <b>1731</b> is an estimate of the signal S<sub>N</sub>(t), and the output of the sample rate compressor <b>1741</b> is an estimate of the signal n(t).</p>
    <p num="p-0131">As will be shown below, the selection of the demodulating signals D<sub>i</sub>(t) for i= O . . . N in accordance with the present invention can substantially reduce or eliminate the effects of noise in the output signals Ŝ<sub>1</sub>(k) and n(k), and can also substantially reduce or eliminate crosstalk between the signals.</p>
    <p num="p-0132">As shown in <figref idrefs="DRAWINGS">FIG. 17</figref>, a set of N+1 signals S<sub>1</sub>[k] i=1 . . . N, and n(k) are sampled at a rate T/QN, where T is a modulation period. For simplicity, the decimation rate R<sub>1 </sub>is assumed to be the same as the factor Q. The assumption that R<sub>1</sub>=Q is not a necessary assumption, but rather is used here to simplify the mathematics. The signals are combined according to the formula:
<br> <i>S</i>(<i>k</i>)=<i>M</i> <sub>1</sub>(<i>k</i>)<i>S</i> <sub>1</sub>(<i>k</i>)+<i>M</i> <sub>2</sub>(<i>k</i>)<i>S</i> <sub>2</sub>(<i>k</i>)+<i>M</i> <sub>3</sub>(<i>k</i>)<i>S</i> <sub>3</sub>(<i>k</i>)+ . . . +<i>M</i> <sub>N</sub>(<i>k</i>)<i>S</i> <sub>N</sub>(<i>k</i>)+<i>n</i>(<i>k</i>)  (42)<br>
Using the symbol * to denote the convolution operator, the terms M<sub>i</sub>(k) are given by:
</p>
    <p num="p-0133"> <maths id="MATH-US-00008" num="00008"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <msub> <mi>M</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mrow> <mrow> <mi>Λ</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>N</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>*</mo> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>⁢</mo> <msub> <mo>|</mo> <mrow> <mi>t</mi> <mo>+</mo> <mrow> <mi>kT</mi> <mo>/</mo> <mi>QN</mi> </mrow> </mrow> </msub> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <msub> <mi>M</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mrow> <mrow> <mi>Λ</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>N</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>*</mo> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>⁢</mo> <msub> <mo>|</mo> <mrow> <mrow> <mi>t</mi> <mo>+</mo> <mrow> <mi>kT</mi> <mo>/</mo> <mi>QN</mi> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </mrow> </msub> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <msub> <mi>M</mi> <mn>3</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <mrow> <mi>Λ</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>N</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>t</mi> <mo>/</mo> <mi>T</mi> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>*</mo> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo>⁢</mo> <msub> <mo>|</mo> <mrow> <mi>t</mi> <mo>+</mo> <mrow> <mi>kT</mi> <mo>/</mo> <mi>QN</mi> </mrow> </mrow> </msub> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mi>where</mi> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>43</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mi>Δ</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mo>(</mo> <mi>x</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mo>{</mo> <mrow> <mtable> <mtr> <mtd> <mn>1</mn> </mtd> <mtd> <mrow> <mrow> <mi>if</mi> <mo>⁢</mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mo></mo> <mi>x</mi> <mo></mo> </mrow> </mrow> <mo>≤</mo> <mn>0.5</mn> </mrow> </mtd> </mtr> <mtr> <mtd> <mn>0</mn> </mtd> <mtd> <mi>otherwise</mi> </mtd> </mtr> </mtable> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mi>and</mi> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>44</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mrow> <mo>-</mo> <mn>00</mn> </mrow> </mrow> <mn>00</mn> </munderover> <mo>⁢</mo> <mrow> <mi>δ</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>t</mi> <mo>-</mo> <mi>nT</mi> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>45</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
(where δ(k) is the Kröneker delta function, which is 1 for k=0, and 0 for all other values of k), and
</p>
    <p num="p-0134">
      <maths id="MATH-US-00009" num="00009"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>=</mo> <mrow> <mrow> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>t</mi> <mo>-</mo> <mfrac> <mrow> <mrow> <mo>(</mo> <mrow> <mi>i</mi> <mo>-</mo> <mn>1</mn> </mrow> <mo>)</mo> </mrow> <mo>⁢</mo> <mi>T</mi> </mrow> <mi>N</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>for</mi> <mo>⁢</mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>i</mi> </mrow> <mo>=</mo> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>…</mi> <mo>⁢</mo> <mstyle> <mspace width="0.8em" height="0.8ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>N</mi> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>46</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> </p>
    <p num="p-0135">After the pre-demodulation and sample rate compression stage <b>1622</b>, which decimates by a factor Q, the signal in the frequency domain is given approximately by</p>
    <p num="p-0136"> <maths id="MATH-US-00010" num="00010"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mtable> <mtr> <mtd> <mrow> <mrow> <mi>MF</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>f</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <mfrac> <mn>1</mn> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>n</mi> <mo>=</mo> <mrow> <mo>-</mo> <mn>00</mn> </mrow> </mrow> <mi>oo</mi> </munderover> <mo>⁢</mo> <mrow> <mo>[</mo> <mrow> <mrow> <msub> <mi>S</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mi>n</mi> <mi>t</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> <mo>+</mo> <mrow> <mi>ξ</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mfrac> <mi>n</mi> <mn>1</mn> </mfrac> <mo>⁢</mo> <mrow> <msub> <mi>S</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>n</mi> </mrow> <mi>T</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo>+</mo> <mi>…</mi> <mo>+</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mi> </mi> <mo>⁢</mo> <mrow> <mi>ξ</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mfrac> <mi>n</mi> <mrow> <mi>N</mi> <mo>-</mo> <mn>1</mn> </mrow> </mfrac> <mo>⁢</mo> <mrow> <msub> <mi>S</mi> <mi>N</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mi>Nn</mi> <mrow> <mi>T</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> </mrow> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo>]</mo> </mrow> <mo>+</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi> </mi> <mo>⁢</mo> <mrow> <mfrac> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>N</mi> </mrow> <mi>T</mi> </mfrac> <mo>⁢</mo> <mrow> <munderover> <mo>∑</mo> <mrow> <mi>m</mi> <mo>=</mo> <mrow> <mo>-</mo> <mi>oo</mi> </mrow> </mrow> <mn>00</mn> </munderover> <mo>⁢</mo> <mrow> <msub> <mi>S</mi> <mi>n</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>f</mi> <mo>-</mo> <mfrac> <mrow> <mn>2</mn> <mo>⁢</mo> <mi>Nm</mi> </mrow> <mi>T</mi> </mfrac> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </mtd> </mtr> </mtable> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mi>where</mi> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>47</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mi>ξ</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mfrac> <mi>n</mi> <mi>k</mi> </mfrac> </mrow> <mo>=</mo> <mrow> <mi>ⅇ</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mfrac> <mrow> <mi>j</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mn>2</mn> <mo>⁢</mo> <mi>π</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>kn</mi> </mrow> <mi>N</mi> </mfrac> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>48</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br>
The demodulator sequences are then given by:
</p>
    <p num="p-0137">
      <maths id="MATH-US-00011" num="00011"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <mrow> <msub> <mi>D</mi> <mi>O</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mfrac> <mrow> <mo>(</mo> <mrow> <mn>1</mn> <mo>-</mo> <msup> <mrow> <mo>(</mo> <mrow> <mo>-</mo> <mn>1</mn> </mrow> <mo>)</mo> </mrow> <mi>k</mi> </msup> </mrow> </mrow> <mn>2</mn> </mfrac> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>D</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mfrac> <mrow> <msub> <mi>D</mi> <mi>o</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mi>N</mi> </mfrac> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>D</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <msub> <mi>P</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mfrac> <mrow> <msub> <mi>D</mi> <mi>o</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mi>N</mi> </mfrac> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mrow> <mrow> <msub> <mi>D</mi> <mi>N</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <msub> <mi>P</mi> <mi>N</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mfrac> <mrow> <msub> <mi>D</mi> <mi>o</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> <mi>N</mi> </mfrac> </mrow> </mrow> <mo>⁢</mo> <mstyle> <mtext> </mtext> </mstyle> <mo>⁢</mo> <mi>where</mi> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>49</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mtable> <mtr> <mtd> <msub> <mrow> <mrow> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>K</mi> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <msub> <mi>P</mi> <mn>1</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> </mrow> <mi>t</mi> </msub> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mfrac> <mrow> <mi>k</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>T</mi> </mrow> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>N</mi> </mrow> </mfrac> </mrow> <mo>,</mo> <mrow> <msub> <mi>P</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <msub> <mi>P</mi> <mn>2</mn> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> </mrow> <mo>⁢</mo> <mi>t</mi> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mfrac> <mrow> <mi>k</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>T</mi> </mrow> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>N</mi> </mrow> </mfrac> </mrow> <mo>,</mo> <mi>…</mi> <mo>⁢</mo> <mstyle> <mspace width="0.6em" height="0.6ex"> </mspace> </mstyle> <mo>,</mo> <mrow> <msub> <mi>P</mi> <mi>N</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>k</mi> <mo>)</mo> </mrow> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <msub> <mrow> <mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mrow> <msub> <mi>P</mi> <mi>N</mi> </msub> <mo>⁡</mo> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mrow> <mo></mo> </mrow> <mi>t</mi> </msub> </mtd> </mtr> <mtr> <mtd> <mrow> <mo>=</mo> <mi> </mi> <mo>⁢</mo> <mfrac> <mrow> <mi>k</mi> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>T</mi> </mrow> <mrow> <mn>2</mn> <mo>⁢</mo> <mstyle> <mspace width="0.3em" height="0.3ex"> </mspace> </mstyle> <mo>⁢</mo> <mi>N</mi> </mrow> </mfrac> </mrow> </mtd> </mtr> </mtable> </mtd> <mtd> <mrow> <mo>(</mo> <mn>50</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> </p>
    <p num="p-0138">The post demodulation lowpass filters <b>1630</b>, <b>1640</b>, <b>1720</b>, <b>1730</b> and <b>1740</b>, and the post demodulation sample rate compression stages <b>1632</b>, <b>1642</b>, <b>1721</b>, <b>1731</b> and <b>1741</b> suppress high frequency artifacts which are produced by the modulation/demodulation process. Note that Equation 49 reduces to Equation 40 for N=2.</p>
    <p num="h-0008">Adaptive Demodulation</p>
    <p num="p-0139">The multi-channel pre-demodulation decimation technique described in the previous section can be extended to an adaptive multi-channel system having an adjustable pre-demodulation decimation rate and an adjustable post-demodulation decimation rate. <figref idrefs="DRAWINGS">FIG. 18</figref> illustrates an expansion of the multi-channel modulator into a adaptive multi-channel modulator/demodulator <b>1800</b>. <figref idrefs="DRAWINGS">FIG. 18</figref> shows the first modulator <b>191</b> and the N<sup>th </sup>modulator <b>1702</b> as shown in <figref idrefs="DRAWINGS">FIG. 17</figref>. The signal input S<sub>1</sub>(t) and a modulation input M<sub>1</sub>(t) are provided to the first modulator <b>191</b>. A signal input S<sub>N</sub>(t) and a modulation input M<sub>N</sub>(t) are provided to the N<sup>th </sup>modulator <b>1702</b>.</p>
    <p num="p-0140">The photodetector <b>150</b> is modeled as an adder <b>194</b> and an adder <b>196</b>. The outputs of the modulators <b>191</b>, <b>193</b>, <b>1701</b>, and <b>1703</b> are added together in the adder <b>194</b>, to generate a composite signal M(t) where:
<br> <i>M</i>(<i>t</i>)=<i>S</i> <sub>1</sub>(<i>t</i>)<i>M</i> <sub>1</sub>(<i>t</i>)+ . . . +<i>S</i> <sub>N</sub>(<i>t</i>)<i>M</i> <sub>N</sub>(<i>t</i>)  (51)</p>
    <p num="p-0141">The signal M(t) from the adder <b>194</b> is provided to the adder <b>196</b> where the signal M(t) is added to the signal n(t) which represents a composite noise signal caused by ambient light, electromagnetic pickup, and the like, which are also detected by the photodetector <b>150</b>. The output of the adder <b>196</b> is the signal M′(t)=M(t)+n(t), which includes noise components as well as the signal components.</p>
    <p num="p-0142">The M′(t) signal output of the adder <b>196</b> (i.e., the output of the detector <b>150</b>) is applied to the input of the signal processing block <b>1800</b>. Within the signal processing block <b>1800</b>, the signal M′(t) is first passed through. the amplifier <b>197</b> and then through the analog bandpass filter <b>198</b>. The analog bandpass filter <b>198</b> provides anti-aliasing and removal of low frequency noise and DC. The desired signal components in the signals S<sub>1</sub>(t) are frequency shifted by the operation of the modulation signals M<sub>1</sub>(t) and are passed by the analog bandpass filter <b>198</b>.</p>
    <p num="p-0143">The output of the analog bandpass filter <b>198</b> is sampled by the analog-to-digital converter <b>199</b> and converted therein to digital signals and provided to an input of a decimation block <b>1820</b>. The adaptive decimation block <b>1820</b> comprises a digital lowpass filter and a sample rate compressor that reduces the sample rate by the decimation rate R<sub>1</sub>. The filter coefficients and decimation rate R<sub>1 </sub>are provided to a control input of the adaptive decimation block <b>1820</b> by an output of an adaptive algorithm block <b>1850</b>. Equation 35 assumes that the decimation rate R<sub>1 </sub>is equal to Q. However, in general, the value of Q may be different than the decimation rate R<sub>1</sub>. The output of the adaptive decimation block <b>1820</b> is a signal MF(k).</p>
    <p num="p-0144">The signal MF(k) is provided to the first input of the first mixer <b>1624</b>, to the first input of the N<sup>th </sup>mixer <b>1712</b>, and to the first input of the noise channel mixer <b>1713</b>. A first demodulating signal D<sub>1</sub>(k) is provided to a second input of the first mixer <b>1624</b> from a signal generator <b>1841</b>. The fourth demodulating signal D<sub>N</sub>(k) is provided to the N<sup>th </sup>mixer <b>1712</b> from an output of a signal generator <b>1831</b>. The noise demodulating signal D<sub>N</sub>(k) is provided to the noise channel mixer <b>1713</b> from an output of a signal generator <b>1832</b>. A control input to each of the signal generators <b>1831</b>, <b>1832</b>, and <b>1841</b> is provided by the output of the adaptive algorithm <b>1850</b>. In yet another embodiment, the adaptive algorithm <b>1850</b> may also be controlled by other signal processing elements downstream of the signal processor <b>1800</b>.</p>
    <p num="p-0145">The outputs of the mixers <b>1713</b>, <b>1624</b>, and <b>1712</b> are provided as respective inputs to adaptive decimation blocks <b>1840</b>, <b>1830</b>, and <b>1834</b> respectively. Each of the adaptive decimation blocks <b>1840</b>, <b>1830</b>, and <b>1834</b> has a control input provided by the output of the adaptive algorithm block <b>1850</b>. The output of the adaptive decimation block <b>1</b>.<b>840</b> is an estimate of the signal n(t) and it is provided to an input of the adaptive algorithm block <b>1850</b>. In an alternate embodiment, the signal estimates Ŝ<sub>i</sub>(k) are also provided to the adaptive algorithm block <b>1850</b>.</p>
    <p num="p-0146">An output of the decimator <b>1830</b> is a signal Ŝ<sub>1</sub>(k), which, as discussed above, is an estimate of the signal S<sub>1</sub>(k). Likewise, the output of the decimation block <b>1834</b> is an estimate of the signal S<sub>N</sub>(t). As shown above, the selection of the demodulating signals D<sub>i</sub>(t) for i=0 . . . N in accordance with the present invention substantially reduces or eliminates the effects of noise in the output signals Ŝ<sub>i</sub>(k) and n(k), and also substantially reduces or eliminates crosstalk between the signals.</p>
    <p num="p-0147">As shown in <figref idrefs="DRAWINGS">FIG. 18</figref>, a set of N+1 signals S<sub>1</sub>[k]i=1 . . . N, and n(k) are sampled at a rate T/QN, where T is a modulation period, and R<sub>1 </sub>is the decimation rate of the decimation block <b>1820</b>. The signals are combined according to the formula:
<br> <i>S</i>(<i>k</i>)=<i>M</i> <sub>1</sub>(<i>k</i>)<i>S</i> <sub>1</sub>(<i>k</i>)+ . . . +<i>M</i> <sub>N</sub>(<i>k</i>)<i>S</i> <sub>N</sub>(<i>k</i>)+<i>n</i>(<i>k</i>)  (52)</p>
    <p num="p-0148">Each of the adaptive decimators <b>1820</b>, <b>1840</b>, <b>1830</b>, and <b>1834</b> comprises a digital <b>5</b> lowpass filter and a sample rate compressor. The characteristics of the digital lowpass filters (e.g., the number of filter coefficients and values of the filter coefficients) and the sample rate compression factor of each adaptive decimator is provided to a control input of the adaptive decimator. The control inputs are driven by an adaptive algorithm <b>1850</b>. The signal generators <b>1831</b>, <b>1832</b> and <b>1841</b> generate the demodulation sequences for the demodulators <b>1624</b>, <b>1712</b>, and <b>1713</b> respectively. The demodulation sequences produced by the signal generators <b>1831</b>, <b>1832</b> and <b>1841</b> are controlled by the adaptive algorithm <b>1850</b>.</p>
    <p num="p-0149">The adaptive algorithm adjusts the pre-demodulation decimation rate R<sub>1 </sub>(in the adaptive demodulator <b>1820</b>), and the post-demodulation decimation rate R<sub>2 </sub>(in the adaptive demodulators <b>1830</b>,<b>1834</b> and <b>1840</b>) according to the noise in the noise estimate n(k)<b>1746</b> and (optionally) according to the signals Ŝ<sub>i</sub>(k). The product R<sub>1</sub>R<sub>2 </sub>is the total decimation rate from the signal S(k) at the output of the AID converter <b>199</b> to the signals Ŝ<sub>i</sub>(k) at the output of the signal processing block <b>1800</b>. The adaptive algorithm may adjust R<sub>1 </sub>and R<sub>2 </sub>such that the product R<sub>1</sub>R<sub>2 </sub>varies, or the adaptive algorithm may adjust R<sub>1 </sub>and R<sub>2 </sub>such that the product R<sub>1</sub>R<sub>2 </sub>is substantially constant. Typically, the adaptive algorithm will keep the R<sub>1</sub>R<sub>2 </sub>product constant so that the signal processing blocks downstream of the signal processor <b>1800</b> will operate at a substantially constant sample rate.</p>
    <p num="p-0150">Typically, each of the signal generators <b>1841</b>, <b>1831</b> and <b>1832</b> generates a repeating sequence of numbers. The number of elements in the sequence is a function of the decimation factor R<sub>1</sub>. As discussed above in connection with <figref idrefs="DRAWINGS">FIG. 3</figref>, when R<sub>1</sub>=1, there are preferably 148 values in each demodulation sequence. As discussed above in connection with <figref idrefs="DRAWINGS">FIG. 17</figref>, when R<sub>1</sub>=37, there are preferably only 4 values in the demodulation sequences.</p>
    <p num="p-0151">The adaptive algorithm selects R<sub>1</sub>, R<sub>2</sub>, and the filter transfer functions in the adaptive decimators <b>1820</b>, <b>1830</b>, <b>1834</b>, and <b>1840</b> to improve the quality of the output signals Ŝ<sub>i</sub>(k). For example, in high ambient noise environments, the higher order harmonics of the output signals are often contaminated by ambient noise (as discussed in connection with <figref idrefs="DRAWINGS">FIGS. 14 and 20</figref>). Thus, the higher order harmonics are preferably not demodulated when ambient noise is present. To avoid demodulation of the higher order harmonics the adaptive demodulator <b>1850</b> can set R<sub>1</sub>=1 and R<sub>2</sub>=37, and thereby demodulate according to the method described in connection with <figref idrefs="DRAWINGS">FIGS. 3-14</figref>. Alternatively, the adaptive demodulator <b>1850</b> can set R<sub>1</sub>=37, set R<sub>2</sub>=1, and set the transfer function of the lowpass filter in the adaptive decimator <b>1820</b> to provide a very fast rolloff (thereby filtering out the higher order harmonics).</p>
    <p num="p-0152">Conversely, in low ambient noise environments, the higher order harmonics of the output signal are less contaminated by ambient noise, and thus the higher order harmonics may be demodulated. In one embodiment, to demodulate the higher order harmonics, the adaptive demodulator <b>1850</b> can set R<sub>1</sub>=37 and set R<sub>2</sub>=1, to demodulate according to the method described in connection with <figref idrefs="DRAWINGS">FIG. 17</figref>. This is especially advantageous when perfusion is low, because, when perfusion is low the output signals Ŝ<sub>i</sub>(k) are typically very weak and are contaminated by random noise. Demodulating more of the higher order harmonics increases the signal-to-noise ratio because it adds the harmonics (which are correlated) to the output signals, and tends to average out the noise (which is uncorrelated). Thus, the signal strength increases, and the noise is reduced.</p>
    <p num="p-0153">One skilled in the art will recognize that the examples in the preceding two paragraphs are merely two points on a continuum and that the adaptive algorithm <b>1850</b> can generate many desirable solutions on the continuum.</p>
    <p num="h-0009">Ambient Light Rejection</p>
    <p num="p-0154">In the pulse oximeter, one of the major contributors to the noise signal n(t) is ambient light that is detected by the photodetector <b>150</b>. One aspect of the present invention advantageously provides a method for choosing the modulation sampling rate f<sub>s </sub>and the factor Q so that the effects of ambient light can, be removed by the post demodulation filtering and decimation stages. Note that Q is the number of samples during the on period (i.e., modulation signal sample turn on time Q) and is preferably also the decimation rate R<sub>1 </sub>for the pre-demodulation sample rate compressor <b>1622</b> (in general the values of Q and R<sub>1 </sub>may be different). The particular embodiment described by Equation 35 assumes that the value Q is also used as decimation rate R<sub>1 </sub>for the pre-demodulation decimator <b>1820</b>.</p>
    <p num="p-0155">In the system shown in <figref idrefs="DRAWINGS">FIGS. 3 and 16</figref>, which demodulates two harmonics, the period of a modulation cycle is given by:
<br>T−4Q/f<sub>s</sub>  (53)<br>
where f is the sample rate. Defining the two line equations
<br> <i>y</i>(<i>f</i> <sub>a</sub> <i>,n</i>)=<i>nf</i> <sub>a</sub>−1/<i>T</i>  (54)<br>
where
<br>f<sub>a</sub>=line frequencies of concern  (55)</p> <ul> <li id="ul0001-0001" num="0000"> <ul> <li id="ul0002-0001" num="0155">n=line frequency harmonic numbers of concern then the effects due to ambient light will be minimized when
<br>|<i>y</i>(<i>f</i> <sub>a</sub> <i>,n</i>|≧SBF<br>|<i>z</i>(<i>f</i> <sub>a</sub> <i>,n</i>|≧SBF  (56)<br>
where SBF is the stop band frequency of the post demodulation and decimation stages (e.g., the 10 Hz lowpass filter <b>1630</b> and the sample rate compressor <b>1632</b>, etc.).
</li> </ul> </li> </ul> <p num="p-0156"> <figref idrefs="DRAWINGS">FIG. 19</figref> is a flowchart showing a method for selecting f<sub>s </sub>and Q. The method begins at a process block <b>1902</b> wherein the ambient light frequencies f<sub>a </sub>and important harmonic components n are identified. Important harmonics are defined as those harmonics that will degrade system performance below acceptable levels when detected by the detector <b>150</b>. The process then advances from the process block <b>1902</b> to a process block <b>1904</b>. In the process block <b>1904</b>, the values of f<sub>a </sub>and n identified in the process block <b>1902</b> are used in conjunction with Equation 54 to identify a collection of acceptable values of T. Upon completion of the process block <b>1904</b>, the process advances to a process block <b>1906</b>. In the process <b>1906</b>, suitable values of f<sub>s </sub>and Q are chosen using the values of T obtained in the process block <b>1904</b> and the equation T=4Q/f<sub>s</sub>. One skilled in the art will recognize that, since T is proportional to the ratio of Q/f<sub>s</sub>, knowing T will not uniquely determine either f<sub>s</sub>; or Q.</p>
    <p num="p-0157">For example, given power line frequencies of 50±1 Hz and 60±1 Hz then the range of f<sub>a </sub>is given by approximately the union of the interval 49-51 Hz and the interval 59-61 Hz, which can be expressed mathematically as:
<br> <i>f</i> <sub>a</sub>[49,51]∪[59,61]  (57)</p>
    <p num="p-0158">Assuming that all harmonics up to the 18th harmonic are to be suppressed, then n=1 . . . 18. In a preferred embodiment, using these values for f<sub>a </sub>and n, application of the method in <figref idrefs="DRAWINGS">FIG. 19</figref> results in f<sub>s</sub>=46,875 Hz and acceptable Q values of 37 and 41.</p>
    <p num="p-0159">The process leading to Equation 57 is illustrated graphically by <figref idrefs="DRAWINGS">FIG. 20</figref>, where the harmonics of the ambient light frequency f<sub>a </sub>(in Hz) are plotted versus the plethysmograph signal frequency (also in Hz). <figref idrefs="DRAWINGS">FIG. 20</figref> has an x-axis showing the ambient light frequency from 44 Hz to 64 Hz. The ambient light frequency will usually correspond to the frequency of the power lines, which is nominally 60 Hz (in the U.S.) and 50 Hz (outside the U.S.). However, power line frequency regulation typically varies somewhat, and thus <figref idrefs="DRAWINGS">FIG. 20</figref> shows frequencies above and below the nominal frequencies.</p>
    <p num="p-0160"> <figref idrefs="DRAWINGS">FIG. 20</figref> also shows a y-axis showing the plethysmograph signal frequency from −10 Hz to 10 Hz. One skilled in the art will recognize that negative frequencies occur in the mathematics described above. In particular, a signal that is modulated from baseband up to some carrier frequency will exhibit two sidebands, a sideband above the carrier frequency corresponding to the frequency of the baseband signal, and a sideband below the carrier frequency corresponding to the negative of the baseband frequency. Thus, when dealing with modulation and demodulation, it is convenient to deal with positive and negative frequencies.</p>
    <p num="p-0161"> <figref idrefs="DRAWINGS">FIG. 20</figref> also shows harmonic lines corresponding to the 5th, 6th, 71h, 10t, 11th, 12th, 13th, and 14th harmonics of the ambient light frequency. The harmonic lines correspond to the harmonics produced in the plethysmograph signal by the demodulation (mixing down) of harmonics of the power line frequency. The lines in <figref idrefs="DRAWINGS">FIG. 20</figref> are calculated using Equation 54 for 1/T=316.72 Hz. Some of the harmonic lines correspond to y(f<sub>a</sub>,n) and some correspond to z(f<sub>a</sub>,n) from Equation 54. Harmonic lines that are not shown (e.g., the line corresponding to the 8th harmonic) fall outside the displayed limits of the x-axis and y-axis.</p>
    <p num="p-0162"> <figref idrefs="DRAWINGS">FIG. 20</figref> can be used to determine the stop band frequencies as shown in Equation 56. For example, the harmonic lines in <figref idrefs="DRAWINGS">FIG. 20</figref> show that for an ambient light frequency of 49 Hz, the 13‘x’ harmonic of the. ambient light frequency will appear in the plethysmograph signal at approximately 3 Hz. Thus, <figref idrefs="DRAWINGS">FIG. 20</figref> shows that for plethysmograph bandwidth of 10 Hz, none of the first 14 harmonics of the ambient light will appear in the plethysmograph signal for ambient light frequencies between approximately 612 Hz and approximately 58.5 Hz, which is consistent with Equation 57. The first ambient harmonics that do appear for a plethysmograph bandwidth of 10 Hz are the 5th harmonic and the 11 m harmonic.</p>
    <p num="h-0010">Other Embodiments</p>
    <p num="p-0163">In the preferred embodiment of the present invention, the hardware described above is implemented in a digital signal processor and associated circuitry. The LED modulation block <b>104</b> and the LED demodulation state table block <b>352</b> comprise algorithms implemented by program code executed by the digital signal processor. In addition, the configuration variables, such as for example, the hardware delay value, the hardware distortion value and the hardware scale value are provided as inputs to the digital signal processor when it is set up. For example, the main operating program of the digital signal processor may be stored in non-volatile ROM or PROM, and the variables may be stored in flash memory during a setup procedure. Techniques for communicating to and from a digital signal processor during such setup procedures axe well known to persons of skill in the art, and will not be described in detail herein. For example, the configuration bus <b>310</b>, discussed above, represents a communication path to the flash memory during such a setup procedure. The data provided to the configuration bus <b>310</b> may be provided by a system operator (not shown) or the data may be provided from look-up tables (not shown) maintained for different embodiments of the LEDs <b>106</b>, <b>108</b> and the detector <b>150</b>.</p>
    <p num="p-0164">Although described above in connection with a pulse oximetry system wherein a parameter to be measured is the attenuation of red and infrared light passing through a portion of a subject's body; it should be understood that the method and apparatus described herein can also be used for other measurements where two or more signals are passed through a system to be analyzed. In particular, the present invention can be used to demodulate two combined parametric signals responsive to the system to be analyzed where the two parametric signals have a predetermined timing relationship between them, as described herein.</p>
    <p num="p-0165">One skilled in the art will recognize that the lowpass filters provided in connection with the decimation blocks may provide other filter functions in addition to lowpass filtering. Thus, for example, the lowpass filters <b>1620</b>, <b>1622</b>, <b>1630</b>, <b>1640</b>, <b>1650</b>, <b>1720</b>, <b>1730</b>, and <b>1740</b>, and the decimators <b>1820</b>, <b>1830</b>, <b>1834</b>, and <b>1840</b> may provide other filter functions (in addition to lowpass filtering) such as, for example, bandpass filtering, bandstop filtering, etc. Moreover, the post-demodulation decimation rate R<sub>2 </sub>need not be the same for each output channel. Thus, for example, in <figref idrefs="DRAWINGS">FIG. 18</figref>, the decimator <b>1840</b> may have a first decimation rate R<sub>2</sub>=r<sub>1 </sub>while the decimators <b>1830</b> and <b>1834</b> have a second decimation rate R<sub>2</sub>=r<sub>2</sub>.</p>
    <p num="p-0166">Although described above in connection with a particular embodiment of the present invention, it should be understood the description of the embodiment is illustrative of the invention and are not intended to be limiting. Various modifications and applications may occur to those skilled in the art without departing from the true spirit and scope of the invention as defined in the appended claims.</p>
    </div></div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">Patent Citations</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Cited Patent</th><th class="patent-data-table-th">Filing date</th><th class="patent-data-table-th">Publication date</th><th class="patent-data-table-th">Applicant</th><th class="patent-data-table-th">Title</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US3638640">US3638640</a></td><td class="patent-data-table-td patent-date-value">Nov 1, 1967</td><td class="patent-data-table-td patent-date-value">Feb 1, 1972</td><td class="patent-data-table-td ">Robert F Shaw</td><td class="patent-data-table-td ">Oximeter and method for in vivo determination of oxygen saturation in blood using three or more different wavelengths</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US3704706">US3704706</a></td><td class="patent-data-table-td patent-date-value">Oct 23, 1969</td><td class="patent-data-table-td patent-date-value">Dec 5, 1972</td><td class="patent-data-table-td ">Univ Drexel</td><td class="patent-data-table-td ">Heart rate and respiratory monitor</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4407290">US4407290</a></td><td class="patent-data-table-td patent-date-value">Apr 1, 1981</td><td class="patent-data-table-td patent-date-value">Oct 4, 1983</td><td class="patent-data-table-td ">Biox Technology, Inc.</td><td class="patent-data-table-td ">Blood constituent measuring device and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4773422">US4773422</a></td><td class="patent-data-table-td patent-date-value">Apr 30, 1987</td><td class="patent-data-table-td patent-date-value">Sep 27, 1988</td><td class="patent-data-table-td ">Nonin Medical, Inc.</td><td class="patent-data-table-td ">For indicating the percentage of constituents of arterial blood</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4781195">US4781195</a></td><td class="patent-data-table-td patent-date-value">Dec 2, 1987</td><td class="patent-data-table-td patent-date-value">Nov 1, 1988</td><td class="patent-data-table-td ">The Boc Group, Inc.</td><td class="patent-data-table-td ">Blood monitoring apparatus and methods with amplifier input dark current correction</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4785463">US4785463</a></td><td class="patent-data-table-td patent-date-value">Sep 3, 1985</td><td class="patent-data-table-td patent-date-value">Nov 15, 1988</td><td class="patent-data-table-td ">Motorola, Inc.</td><td class="patent-data-table-td ">Digital global positioning system receiver</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4824242">US4824242</a></td><td class="patent-data-table-td patent-date-value">Sep 26, 1986</td><td class="patent-data-table-td patent-date-value">Apr 25, 1989</td><td class="patent-data-table-td ">Sensormedics Corporation</td><td class="patent-data-table-td ">Non-invasive oximeter and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4848901">US4848901</a></td><td class="patent-data-table-td patent-date-value">Oct 8, 1987</td><td class="patent-data-table-td patent-date-value">Jul 18, 1989</td><td class="patent-data-table-td ">Critikon, Inc.</td><td class="patent-data-table-td ">Pulse oximeter sensor control system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4863265">US4863265</a></td><td class="patent-data-table-td patent-date-value">Oct 16, 1987</td><td class="patent-data-table-td patent-date-value">Sep 5, 1989</td><td class="patent-data-table-td ">Mine Safety Appliances Company</td><td class="patent-data-table-td ">Apparatus and method for measuring blood constituents</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4867571">US4867571</a></td><td class="patent-data-table-td patent-date-value">Feb 28, 1989</td><td class="patent-data-table-td patent-date-value">Sep 19, 1989</td><td class="patent-data-table-td ">Sensormedics Corporation</td><td class="patent-data-table-td ">Wave form filter pulse detector and method for modulated signal</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US4948248">US4948248</a></td><td class="patent-data-table-td patent-date-value">Dec 15, 1989</td><td class="patent-data-table-td patent-date-value">Aug 14, 1990</td><td class="patent-data-table-td ">Invivo Research Inc.</td><td class="patent-data-table-td ">Detecting the oxygen saturation in the blood</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5193543">US5193543</a></td><td class="patent-data-table-td patent-date-value">Apr 6, 1992</td><td class="patent-data-table-td patent-date-value">Mar 16, 1993</td><td class="patent-data-table-td ">Critikon, Inc.</td><td class="patent-data-table-td ">Method and apparatus for measuring arterial blood constituents</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5276705">US5276705</a></td><td class="patent-data-table-td patent-date-value">Jan 6, 1993</td><td class="patent-data-table-td patent-date-value">Jan 4, 1994</td><td class="patent-data-table-td ">The Boeing Company</td><td class="patent-data-table-td ">CCD demodulator/correlator</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5349952">US5349952</a></td><td class="patent-data-table-td patent-date-value">Mar 5, 1991</td><td class="patent-data-table-td patent-date-value">Sep 27, 1994</td><td class="patent-data-table-td ">Sensormedics Corp.</td><td class="patent-data-table-td ">Photoplethysmographics using phase-division multiplexing</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5521938">US5521938</a></td><td class="patent-data-table-td patent-date-value">Jul 1, 1994</td><td class="patent-data-table-td patent-date-value">May 28, 1996</td><td class="patent-data-table-td ">Motorola, Inc.</td><td class="patent-data-table-td ">Apparatus for performing frequency conversion in a communication system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5555882">US5555882</a></td><td class="patent-data-table-td patent-date-value">Aug 24, 1994</td><td class="patent-data-table-td patent-date-value">Sep 17, 1996</td><td class="patent-data-table-td ">Nellcor Incorporated</td><td class="patent-data-table-td ">Method and apparatus for reducing ambient noise effects in electronic monitoring instruments</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5579341">US5579341</a></td><td class="patent-data-table-td patent-date-value">Dec 29, 1994</td><td class="patent-data-table-td patent-date-value">Nov 26, 1996</td><td class="patent-data-table-td ">Motorola, Inc.</td><td class="patent-data-table-td ">Multi-channel digital transceiver and method</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5640416">US5640416</a></td><td class="patent-data-table-td patent-date-value">Jun 7, 1995</td><td class="patent-data-table-td patent-date-value">Jun 17, 1997</td><td class="patent-data-table-td ">Comsat Corporation</td><td class="patent-data-table-td ">Digital downconverter/despreader for direct sequence spread spectrum communications system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5800348">US5800348</a></td><td class="patent-data-table-td patent-date-value">Sep 23, 1996</td><td class="patent-data-table-td patent-date-value">Sep 1, 1998</td><td class="patent-data-table-td ">Hewlett-Packard Company</td><td class="patent-data-table-td ">Apparatus and method for medical monitoring, in particular pulse oximeter</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5919134">US5919134</a></td><td class="patent-data-table-td patent-date-value">Jan 12, 1998</td><td class="patent-data-table-td patent-date-value">Jul 6, 1999</td><td class="patent-data-table-td ">Masimo Corp.</td><td class="patent-data-table-td ">Method and apparatus for demodulating signals in a pulse oximetry system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5921921">US5921921</a><span class='patent-tooltip-anchor' data-tooltip-text="Cited by examiner"> *</span></td><td class="patent-data-table-td patent-date-value">Dec 18, 1996</td><td class="patent-data-table-td patent-date-value">Jul 13, 1999</td><td class="patent-data-table-td ">Nellcor Puritan-Bennett</td><td class="patent-data-table-td ">Method of determining the blood oxygen saturation of an in vivo subject</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US5940346">US5940346</a></td><td class="patent-data-table-td patent-date-value">Dec 12, 1997</td><td class="patent-data-table-td patent-date-value">Aug 17, 1999</td><td class="patent-data-table-td ">Arizona Board Of Regents</td><td class="patent-data-table-td ">Modular robotic platform with acoustic navigation system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6229856">US6229856</a></td><td class="patent-data-table-td patent-date-value">Apr 10, 1998</td><td class="patent-data-table-td patent-date-value">May 8, 2001</td><td class="patent-data-table-td ">Masimo Corporation</td><td class="patent-data-table-td ">Method and apparatus for demodulating signals in a pulse oximetry system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6643530">US6643530</a></td><td class="patent-data-table-td patent-date-value">Dec 13, 2000</td><td class="patent-data-table-td patent-date-value">Nov 4, 2003</td><td class="patent-data-table-td ">Masimo Corporation</td><td class="patent-data-table-td ">Method and apparatus for demodulating signals in a pulse oximetry system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/USRE35122">USRE35122</a></td><td class="patent-data-table-td patent-date-value">Feb 24, 1992</td><td class="patent-data-table-td patent-date-value">Dec 19, 1995</td><td class="patent-data-table-td ">Nellcor Incorporated</td><td class="patent-data-table-td ">Method and apparatus for detecting optical pulses</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/DE3328862A1?cl=en">DE3328862A1</a></td><td class="patent-data-table-td patent-date-value">Aug 10, 1983</td><td class="patent-data-table-td patent-date-value">Feb 28, 1985</td><td class="patent-data-table-td ">Siemens Ag</td><td class="patent-data-table-td ">Tissue photometry method and device, in particular for quantatively determining the blood oxygen saturation from photometric measurements</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0335357A2?cl=en">EP0335357A2</a></td><td class="patent-data-table-td patent-date-value">Mar 29, 1989</td><td class="patent-data-table-td patent-date-value">Oct 4, 1989</td><td class="patent-data-table-td ">Nellcor Incorporated</td><td class="patent-data-table-td ">Improved method and apparatus for detecting optical pulses</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP0761159A2?cl=en">EP0761159A2</a></td><td class="patent-data-table-td patent-date-value">Aug 6, 1996</td><td class="patent-data-table-td patent-date-value">Mar 12, 1997</td><td class="patent-data-table-td ">Hewlett-Packard Company</td><td class="patent-data-table-td ">Apparatus for medical monitoring, in particular pulse oximeter</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="http://www.google.com/url?id=ev81BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3D2002051129A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGQOk4ZcdadrQkrt4HLdLFyfXZHTw">JP2002051129A</a></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">Title not available</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1994009698A1?cl=en">WO1994009698A1</a></td><td class="patent-data-table-td patent-date-value">Sep 24, 1993</td><td class="patent-data-table-td patent-date-value">May 11, 1994</td><td class="patent-data-table-td ">Nellcor Inc</td><td class="patent-data-table-td ">Method and apparatus for reducing ambient noise effects in electronic monitoring instruments</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1998046125A1?cl=en">WO1998046125A1</a></td><td class="patent-data-table-td patent-date-value">Apr 10, 1998</td><td class="patent-data-table-td patent-date-value">Oct 22, 1998</td><td class="patent-data-table-td ">Masimo Corp</td><td class="patent-data-table-td ">Method and apparatus for demodulating signals in a pulse oximetry system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO1999052420A1?cl=en">WO1999052420A1</a></td><td class="patent-data-table-td patent-date-value">Apr 9, 1999</td><td class="patent-data-table-td patent-date-value">Oct 21, 1999</td><td class="patent-data-table-td ">Masimo Corp</td><td class="patent-data-table-td ">Method and apparatus for demodulating signals in a pulse oximetry system</td></tr></table><div class="patent-section-footer">* Cited by examiner</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">Classifications</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">U.S. Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc600/defs600.htm&usg=AFQjCNGoRRWCr3AADgOfjOLv9kXGux4XKA#C600S310000">600/310</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://www.uspto.gov/web/patents/classification/uspc600/defs600.htm&usg=AFQjCNGoRRWCr3AADgOfjOLv9kXGux4XKA#C600S336000">600/336</a></span></td></tr><tr><td class="patent-data-table-td ">International Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=A61B0005145500">A61B5/1455</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=A61B0005000000">A61B5/00</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://web2.wipo.int/ipcpub/&usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&notion=scheme&version=20130101&symbol=A61B0005145000">A61B5/145</a></span></td></tr><tr><td class="patent-data-table-td ">Cooperative Classification</td><td class="patent-data-table-td "><span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=A61B5/7217">A61B5/7217</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=A61B5/7232">A61B5/7232</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=A61B2560/0242">A61B2560/0242</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=A61B5/14551">A61B5/14551</a></span>, <span class="nested-value"><a href="http://www.google.com/url?id=ev81BwABERAJ&q=http://worldwide.espacenet.com/classification&usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=A61B5/7228">A61B5/7228</a></span></td></tr><tr><td class="patent-data-table-td ">European Classification</td><td class="patent-data-table-td "><span class="nested-value">A61B5/1455N</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">Legal Events</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">Date</th><th class="patent-data-table-th">Code</th><th class="patent-data-table-th">Event</th><th class="patent-data-table-th">Description</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">May 27, 2014</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CORRECTIVE ASSIGNMENT TO CORRECT THE NATURE OF CONVEYANCE PREVIOUSLY RECORDED AT REEL: 032784 FRAME: 0864. ASSIGNOR(S) HEREBY CONFIRMS THE SECURITY AGREEMENT;ASSIGNORS:MASIMO AMERICAS, INC.;MASIMO CORPORATION;REEL/FRAME:033032/0426</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20140423</span></div><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">JPMORGAN CHASE BANK, NATIONAL ASSOCIATION, ILLINOI</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Apr 29, 2014</td><td class="patent-data-table-td ">AS</td><td class="patent-data-table-td ">Assignment</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">ASSIGNMENT OF ASSIGNORS INTEREST;ASSIGNORS:MASIMO CORPORATION;MASIMO AMERICAS, INC.;REEL/FRAME:032784/0864</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20140423</span></div><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">JPMORGAN CHASE BANK, NATIONAL ASSOCIATION, ILLINOI</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Jan 7, 2014</td><td class="patent-data-table-td ">B1</td><td class="patent-data-table-td ">Reexamination certificate first reexamination</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">THE PATENTABILITY OF CLAIMS 1-5, 7-16 AND 18-20 IS CONFIRMED.CLAIMS 6 AND 17 WERE NOT REEXAMINED.</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">Dec 11, 2012</td><td class="patent-data-table-td ">RR</td><td class="patent-data-table-td ">Request for reexamination filed</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20120913</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">Rotate</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">Original Image</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " Image not available"});</script></div></div></div></td></tr></table><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_4ff636b3d23669b7103f3b3a3a18b4cd.js", Host:"http://www.google.com/", IsBooksRentalEnabled:1, IsWebstoreDisplayCaseEnabled:1, IsObfuscationEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsGeoLayerEnabled:1, IsImageModeNotesEnabled:1, IsCopyMenuItemEnabled:1, IsGiftingEnabled:0, IsWebReaderUniversalPaginatorEnabled:0, IsOfflineBubbleEnabled:1, IsReaderEnabledForPlayRequests:1, IsFutureOnSaleVolumesEnabled:1, IsOfflineRestrictedCopyEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsRestrictedCopyEnabled:1, IsZipitFolderCollectionEnabled:1, IsEndOfSampleRecommendationsEnabled:1, IsRatingsOnBookcardsEnabled:1, IsAdsDisabled:0, IsIframePageDisplayEnabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:0, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsPreOrdersEnabled:0, IsDisabledRandomBookshelves:0, WebstoreDisplayCasePosition:3});_OC_Run({"enable_p13n":false,"add_vol_to_collection_base_url":"http://www.google.com/patents?op=add\u0026sig=ACfU3U22Vlo1YX-9HeZ5b0OGbQeOZG1QTg\u0026id=ev81BwABERAJ","remove_vol_from_collection_base_url":"http://www.google.com/patents?op=remove\u0026sig=ACfU3U3Y9D7q5YYASKGSnaClkVYgKQeEbw\u0026id=ev81BwABERAJ","logged_in":false,"p13n_save_user_settings_url":"http://www.google.com/patents?op=edit_user_settings\u0026sig=ACfU3U3beqIBHjKs4s9LpXoGClG9Z-siVg","is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=http://www.google.com/patents%3Fhl%3Den\u0026hl=en","is_play_enabled":true}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"http://www.google.com/patents/download/Method_and_apparatus_for_demodulating_si.pdf?id=ev81BwABERAJ\u0026output=pdf\u0026sig=ACfU3U2nTfQ_9FoVSwNXKixj2fjwpfCDuw"},"sample_url":"http://www.google.com/patents/reader?id=ev81BwABERAJ\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href=http://www.google.com/><nobr>Google&nbsp;Home</nobr></a> - <a href=//www.google.com/patents/sitemap/><nobr>Sitemap</nobr></a> - <a href=http://www.google.com/googlebooks/uspto.html><nobr>USPTO Bulk Downloads</nobr></a> - <a href=/intl/en/privacy/><nobr>Privacy Policy</nobr></a> - <a href=/intl/en/policies/terms/><nobr>Terms of Service</nobr></a> - <a href=https://support.google.com/faqs/answer/2539193?hl=en><nobr>About Google Patents</nobr></a> - <a href="http://www.google.com/tools/feedback/intl/en/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'en'});return false;}catch(e){}"><nobr>Send Feedback</nobr></a></div><span>Data provided by IFI CLAIMS Patent Services</span><br><span >&copy;2012 Google</span></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>